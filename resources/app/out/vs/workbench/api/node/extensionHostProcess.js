/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/var av=function(e,t){return av=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i[s]=r[s])},av(e,t)};export function __extends(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");av(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}export var __assign=function(){return __assign=Object.assign||function(t){for(var i,r=1,s=arguments.length;r<s;r++){i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},__assign.apply(this,arguments)};export function __rest(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(i[r[s]]=e[r[s]]);return i}export function __decorate(e,t,i,r){var s=arguments.length,n=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n}export function __param(e,t){return function(i,r){t(i,r,e)}}export function __esDecorate(e,t,i,r,s,n){function o(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var a=r.kind,c=a==="getter"?"get":a==="setter"?"set":"value",l=!t&&e?r.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),h,f=!1,p=i.length-1;p>=0;p--){var g={};for(var v in r)g[v]=v==="access"?{}:r[v];for(var v in r.access)g.access[v]=r.access[v];g.addInitializer=function(S){if(f)throw new TypeError("Cannot add initializers after decoration has completed");n.push(o(S||null))};var b=(0,i[p])(a==="accessor"?{get:u.get,set:u.set}:u[c],g);if(a==="accessor"){if(b===void 0)continue;if(b===null||typeof b!="object")throw new TypeError("Object expected");(h=o(b.get))&&(u.get=h),(h=o(b.set))&&(u.set=h),(h=o(b.init))&&s.unshift(h)}else(h=o(b))&&(a==="field"?s.unshift(h):u[c]=h)}l&&Object.defineProperty(l,r.name,u),f=!0}export function __runInitializers(e,t,i){for(var r=arguments.length>2,s=0;s<t.length;s++)i=r?t[s].call(e,i):t[s].call(e);return r?i:void 0}export function __propKey(e){return typeof e=="symbol"?e:"".concat(e)}export function __setFunctionName(e,t,i){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:i?"".concat(i," ",t):t})}export function __metadata(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}export function __awaiter(e,t,i,r){function s(n){return n instanceof i?n:new i(function(o){o(n)})}return new(i||(i=Promise))(function(n,o){function a(u){try{l(r.next(u))}catch(h){o(h)}}function c(u){try{l(r.throw(u))}catch(h){o(h)}}function l(u){u.done?n(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})}export function __generator(e,t){var i={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,s,n,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(r=1,s&&(n=l[0]&2?s.return:l[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,l[1])).done)return n;switch(s=0,n&&(l=[l[0]&2,n.value]),l[0]){case 0:case 1:n=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,s=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(n=i.trys,!(n=n.length>0&&n[n.length-1])&&(l[0]===6||l[0]===2)){i=0;continue}if(l[0]===3&&(!n||l[1]>n[0]&&l[1]<n[3])){i.label=l[1];break}if(l[0]===6&&i.label<n[1]){i.label=n[1],n=l;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(l);break}n[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(u){l=[6,u],s=0}finally{r=n=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}export var __createBinding=Object.create?function(e,t,i,r){r===void 0&&(r=i);var s=Object.getOwnPropertyDescriptor(t,i);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,s)}:function(e,t,i,r){r===void 0&&(r=i),e[r]=t[i]};export function __exportStar(e,t){for(var i in e)i!=="default"&&!Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(t,e,i)}export function __values(e){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}export function __read(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),s,n=[],o;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)n.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return n}export function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}export function __spreadArrays(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var r=Array(e),s=0,t=0;t<i;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,s++)r[s]=n[o];return r}export function __spreadArray(e,t,i){if(i||arguments.length===2)for(var r=0,s=t.length,n;r<s;r++)(n||!(r in t))&&(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}export function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}export function __asyncGenerator(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=i.apply(e,t||[]),s,n=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(p){return function(g){return Promise.resolve(g).then(p,h)}}function a(p,g){r[p]&&(s[p]=function(v){return new Promise(function(b,S){n.push([p,v,b,S])>1||c(p,v)})},g&&(s[p]=g(s[p])))}function c(p,g){try{l(r[p](g))}catch(v){f(n[0][3],v)}}function l(p){p.value instanceof __await?Promise.resolve(p.value.v).then(u,h):f(n[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,g){p(g),n.shift(),n.length&&c(n[0][0],n[0][1])}}export function __asyncDelegator(e){var t,i;return t={},r("next"),r("throw",function(s){throw s}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(s,n){t[s]=e[s]?function(o){return(i=!i)?{value:__await(e[s](o)),done:!1}:n?n(o):o}:n}}export function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],i;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i);function r(n){i[n]=e[n]&&function(o){return new Promise(function(a,c){o=e[n](o),s(a,c,o.done,o.value)})}}function s(n,o,a,c){Promise.resolve(c).then(function(l){n({value:l,done:a})},o)}}export function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var wR=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};export function __importStar(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)i!=="default"&&Object.prototype.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return wR(t,e),t}export function __importDefault(e){return e&&e.__esModule?e:{default:e}}export function __classPrivateFieldGet(e,t,i,r){if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?r:i==="a"?r.call(e):r?r.value:t.get(e)}export function __classPrivateFieldSet(e,t,i,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(e,i):s?s.value=i:t.set(e,i),i}export function __classPrivateFieldIn(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}export function __addDisposableResource(e,t,i){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(i){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],i&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(n){return Promise.reject(n)}}),e.stack.push({value:t,dispose:r,async:i})}else i&&e.stack.push({async:!0});return t}var bR=typeof SuppressedError=="function"?SuppressedError:function(e,t,i){var r=new Error(i);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};export function __disposeResources(e){function t(r){e.error=e.hasError?new bR(r,e.error,"An error was suppressed during disposal."):r,e.hasError=!0}function i(){for(;e.stack.length;){var r=e.stack.pop();try{var s=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(s).then(i,function(n){return t(n),i()})}catch(n){t(n)}}if(e.hasError)throw e.error}return i()}export default{__extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__createBinding,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__addDisposableResource,__disposeResources};var yR=Object.create,cv=Object.defineProperty,AR=Object.getOwnPropertyDescriptor,F5=Object.getOwnPropertyNames,SR=Object.getPrototypeOf,ER=Object.prototype.hasOwnProperty,xR=(e,t)=>function(){return t||(0,e[F5(e)[0]])((t={exports:{}}).exports,t),t.exports},kR=(e,t)=>{for(var i in t)cv(e,i,{get:t[i],enumerable:!0})},CR=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of F5(t))!ER.call(e,s)&&s!==i&&cv(e,s,{get:()=>t[s],enumerable:!(r=AR(t,s))||r.enumerable});return e},U5=(e,t,i)=>(i=e!=null?yR(SR(e)):{},CR(t||!e||!e.__esModule?cv(i,"default",{value:e,enumerable:!0}):i,e)),j5=xR({"node_modules/minimist/index.js"(e,t){"use strict";function i(n,o){var a=n;o.slice(0,-1).forEach(function(l){a=a[l]||{}});var c=o[o.length-1];return c in a}function r(n){return typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}function s(n,o){return o==="constructor"&&typeof n[o]=="function"||o==="__proto__"}t.exports=function(n,o){o||(o={});var a={bools:{},strings:{},unknownFn:null};typeof o.unknown=="function"&&(a.unknownFn=o.unknown),typeof o.boolean=="boolean"&&o.boolean?a.allBools=!0:[].concat(o.boolean).filter(Boolean).forEach(function(z){a.bools[z]=!0});var c={};function l(z){return c[z].some(function(ue){return a.bools[ue]})}Object.keys(o.alias||{}).forEach(function(z){c[z]=[].concat(o.alias[z]),c[z].forEach(function(ue){c[ue]=[z].concat(c[z].filter(function(Re){return ue!==Re}))})}),[].concat(o.string).filter(Boolean).forEach(function(z){a.strings[z]=!0,c[z]&&[].concat(c[z]).forEach(function(ue){a.strings[ue]=!0})});var u=o.default||{},h={_:[]};function f(z,ue){return a.allBools&&/^--[^=]+$/.test(ue)||a.strings[z]||a.bools[z]||c[z]}function p(z,ue,Re){for(var ae=z,Z=0;Z<ue.length-1;Z++){var _=ue[Z];if(s(ae,_))return;ae[_]===void 0&&(ae[_]={}),(ae[_]===Object.prototype||ae[_]===Number.prototype||ae[_]===String.prototype)&&(ae[_]={}),ae[_]===Array.prototype&&(ae[_]=[]),ae=ae[_]}var G=ue[ue.length-1];s(ae,G)||((ae===Object.prototype||ae===Number.prototype||ae===String.prototype)&&(ae={}),ae===Array.prototype&&(ae=[]),ae[G]===void 0||a.bools[G]||typeof ae[G]=="boolean"?ae[G]=Re:Array.isArray(ae[G])?ae[G].push(Re):ae[G]=[ae[G],Re])}function g(z,ue,Re){if(!(Re&&a.unknownFn&&!f(z,Re)&&a.unknownFn(Re)===!1)){var ae=!a.strings[z]&&r(ue)?Number(ue):ue;p(h,z.split("."),ae),(c[z]||[]).forEach(function(Z){p(h,Z.split("."),ae)})}}Object.keys(a.bools).forEach(function(z){g(z,u[z]===void 0?!1:u[z])});var v=[];n.indexOf("--")!==-1&&(v=n.slice(n.indexOf("--")+1),n=n.slice(0,n.indexOf("--")));for(var b=0;b<n.length;b++){var S=n[b],E,$;if(/^--.+=/.test(S)){var U=S.match(/^--([^=]+)=([\s\S]*)$/);E=U[1];var O=U[2];a.bools[E]&&(O=O!=="false"),g(E,O,S)}else if(/^--no-.+/.test(S))E=S.match(/^--no-(.+)/)[1],g(E,!1,S);else if(/^--.+/.test(S))E=S.match(/^--(.+)/)[1],$=n[b+1],$!==void 0&&!/^(-|--)[^-]/.test($)&&!a.bools[E]&&!a.allBools&&(!c[E]||!l(E))?(g(E,$,S),b+=1):/^(true|false)$/.test($)?(g(E,$==="true",S),b+=1):g(E,a.strings[E]?"":!0,S);else if(/^-[^-]+/.test(S)){for(var J=S.slice(1,-1).split(""),F=!1,V=0;V<J.length;V++){if($=S.slice(V+2),$==="-"){g(J[V],$,S);continue}if(/[A-Za-z]/.test(J[V])&&$[0]==="="){g(J[V],$.slice(1),S),F=!0;break}if(/[A-Za-z]/.test(J[V])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test($)){g(J[V],$,S),F=!0;break}if(J[V+1]&&J[V+1].match(/\W/)){g(J[V],S.slice(V+2),S),F=!0;break}else g(J[V],a.strings[J[V]]?"":!0,S)}E=S.slice(-1)[0],!F&&E!=="-"&&(n[b+1]&&!/^(-|--)[^-]/.test(n[b+1])&&!a.bools[E]&&(!c[E]||!l(E))?(g(E,n[b+1],S),b+=1):n[b+1]&&/^(true|false)$/.test(n[b+1])?(g(E,n[b+1]==="true",S),b+=1):g(E,a.strings[E]?"":!0,S))}else if((!a.unknownFn||a.unknownFn(S)!==!1)&&h._.push(a.strings._||!r(S)?S:Number(S)),o.stopEarly){h._.push.apply(h._,n.slice(b+1));break}}return Object.keys(u).forEach(function(z){i(h,z.split("."))||(p(h,z.split("."),u[z]),(c[z]||[]).forEach(function(ue){p(h,ue.split("."),u[z])}))}),o["--"]?h["--"]=v.slice():v.forEach(function(z){h._.push(z)}),h}}}),$R=U5(j5(),1);import*as IR from"net";var z5;function lv(e,t){const i=Object.create(null);for(const r of e){const s=t(r);let n=i[s];n||(n=i[s]=[]),n.push(r)}return i}function DR(e,t){const i=[],r=[];for(const s of e)t.has(s)||i.push(s);for(const s of t)e.has(s)||r.push(s);return{removed:i,added:r}}var hee=class{static{z5=Symbol.toStringTag}constructor(e,t){this.b=t,this.a=new Map,this[z5]="SetWithKey";for(const i of e)this.add(i)}get size(){return this.a.size}add(e){const t=this.b(e);return this.a.set(t,e),this}delete(e){return this.a.delete(this.b(e))}has(e){return this.a.has(this.b(e))}*entries(){for(const e of this.a.values())yield[e,e]}keys(){return this.values()}*values(){for(const e of this.a.values())yield e}clear(){this.a.clear()}forEach(e,t){this.a.forEach(i=>e.call(t,i,i,this))}[Symbol.iterator](){return this.values()}},PR=class{constructor(){this.b=[],this.a=function(e){setTimeout(()=>{throw e.stack?Wr.isErrorNoTelemetry(e)?new Wr(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.b.push(e),()=>{this.d(e)}}c(e){this.b.forEach(t=>{t(e)})}d(e){this.b.splice(this.b.indexOf(e),1)}setUnexpectedErrorHandler(e){this.a=e}getUnexpectedErrorHandler(){return this.a}onUnexpectedError(e){this.a(e),this.c(e)}onUnexpectedExternalError(e){this.a(e)}},Ql=new PR;function uv(e){Ql.setUnexpectedErrorHandler(e)}function TR(e){if(!e||typeof e!="object")return!1;const t=e;return t.code==="EPIPE"&&t.syscall?.toUpperCase()==="WRITE"}function zd(e){Ql.onUnexpectedError(e)}function lt(e){Ti(e)||Ql.onUnexpectedError(e)}function Hd(e){Ti(e)||Ql.onUnexpectedExternalError(e)}function Qa(e){if(e instanceof Error){const{name:t,message:i,cause:r}=e,s=e.stacktrace||e.stack;return{$isError:!0,name:t,message:i,stack:s,noTelemetry:Wr.isErrorNoTelemetry(e),cause:r?Qa(r):void 0,code:e.code}}return e}function H5(e){let t;return e.noTelemetry?t=new Wr:(t=new Error,t.name=e.name),t.message=e.message,t.stack=e.stack,e.code&&(t.code=e.code),e.cause&&(t.cause=H5(e.cause)),t}var Wd="Canceled";function Ti(e){return e instanceof dt?!0:e instanceof Error&&e.name===Wd&&e.message===Wd}var dt=class extends Error{constructor(){super(Wd),this.name=this.message}},hv=class j1 extends Error{static{this.a="PendingMigrationError"}static is(t){return t instanceof j1||t instanceof Error&&t.name===j1.a}constructor(t){super(t),this.name=j1.a}};function Yl(){const e=new Error(Wd);return e.name=e.message,e}function $e(e){return e?new Error(`Illegal argument: ${e}`):new Error("Illegal argument")}function dv(e){return e?new Error(`Illegal state: ${e}`):new Error("Illegal state")}var Do=class extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}};function W5(e){return e?e.message?e.message:e.stack?e.stack.split(`
`)[0]:String(e):"Error"}var MR=class extends Error{constructor(e){super("NotImplemented"),e&&(this.message=e)}},fv=class extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}},Wr=class o5 extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof o5)return t;const i=new o5;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},wi=class MM extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,MM.prototype)}};function pv(e,t){const i=this;let r=!1,s;return function(){if(r)return s;if(r=!0,t)try{s=e.apply(i,arguments)}finally{t()}else s=e.apply(i,arguments);return s}}function NR(e,t,i=e.length-1){const r=RR(e,t,i);if(r!==-1)return e[r]}function RR(e,t,i=e.length-1){for(let r=i;r>=0;r--){const s=e[r];if(t(s,r))return r}return-1}function LR(e,t,i=0,r=e.length){let s=i,n=r;for(;s<n;){const o=Math.floor((s+n)/2);t(e[o])?s=o+1:n=o}return s-1}function OR(e,t,i=0,r=e.length){let s=i,n=r;for(;s<n;){const o=Math.floor((s+n)/2);t(e[o])?n=o:s=o+1}return s}var dee=class NM{static{this.assertInvariants=!1}constructor(t){this.e=t,this.c=0}findLastMonotonous(t){if(NM.assertInvariants){if(this.d){for(const r of this.e)if(this.d(r)&&!t(r))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this.d=t}const i=LR(this.e,t,this.c);return this.c=i+1,i===-1?void 0:this.e[i]}};function Gi(e,t,i=(r,s)=>r===s){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;for(let r=0,s=e.length;r<s;r++)if(!i(e[r],t[r]))return!1;return!0}function FR(e,t){const i=[];let r;for(const s of e.slice(0).sort(t))!r||t(r[0],s)!==0?(r=[s],i.push(r)):r.push(s);return i}function B5(e,t,i){const r=[];function s(a,c,l){if(c===0&&l.length===0)return;const u=r[r.length-1];u&&u.start+u.deleteCount===a?(u.deleteCount+=c,u.toInsert.push(...l)):r.push({start:a,deleteCount:c,toInsert:l})}let n=0,o=0;for(;;){if(n===e.length){s(n,0,t.slice(o));break}if(o===t.length){s(n,e.length-n,[]);break}const a=e[n],c=t[o],l=i(a,c);l===0?(n+=1,o+=1):l<0?(s(n,1,[]),n+=1):l>0&&(s(n,0,[c]),o+=1)}return r}function UR(e,t,i){const r=B5(e,t,i),s=[],n=[];for(const o of r)s.push(...e.slice(o.start,o.start+o.deleteCount)),n.push(...o.toInsert);return{removed:s,added:n}}function jR(e,t,i,r,s){return i===0?Promise.resolve([]):new Promise((n,o)=>{(async()=>{const a=e.length,c=e.slice(0,i).sort(t);for(let l=i,u=Math.min(i+r,a);l<a;l=u,u=Math.min(u+r,a)){if(l>i&&await new Promise(h=>setTimeout(h)),s&&s.isCancellationRequested)throw new dt;zR(e,t,c,l,u)}return c})().then(n,o)})}function zR(e,t,i,r,s){for(const n=i.length;r<s;r++){const o=e[r];if(t(o,i[n-1])<0){i.pop();const a=OR(i,c=>t(o,c)<0);i.splice(a,0,o)}}}function gt(e){return e.filter(t=>!!t)}function HR(e){let t=0;for(let i=0;i<e.length;i++)e[i]&&(e[t]=e[i],t+=1);e.length=t}function gv(e){return!Array.isArray(e)||e.length===0}function Xl(e){return Array.isArray(e)&&e.length>0}function $n(e,t=i=>i){const i=new Set;return e.filter(r=>{const s=t(r);return i.has(s)?!1:(i.add(s),!0)})}function _5(e,t){return e.push(t),()=>WR(e,t)}function WR(e,t){const i=e.indexOf(t);if(i>-1)return e.splice(i,1),t}function V5(e,t){let i;if(typeof t=="number"){let r=t;i=()=>{const s=Math.sin(r++)*179426549;return s-Math.floor(s)}}else i=Math.random;for(let r=e.length-1;r>0;r-=1){const s=Math.floor(i()*(r+1)),n=e[r];e[r]=e[s],e[s]=n}}function Bd(e,t){return Array.isArray(e)?e.map(t):t(e)}function Sr(e){return Array.isArray(e)?e:[e]}var mv;(function(e){function t(n){return n<0}e.isLessThan=t;function i(n){return n<=0}e.isLessThanOrEqual=i;function r(n){return n>0}e.isGreaterThan=r;function s(n){return n===0}e.isNeitherLessOrGreaterThan=s,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(mv||(mv={}));function BR(e,t){return(i,r)=>t(e(i),e(r))}var _R=(e,t)=>e-t,fee=class z1{static{this.empty=new z1(t=>{})}constructor(t){this.iterate=t}forEach(t){this.iterate(i=>(t(i),!0))}toArray(){const t=[];return this.iterate(i=>(t.push(i),!0)),t}filter(t){return new z1(i=>this.iterate(r=>t(r)?i(r):!0))}map(t){return new z1(i=>this.iterate(r=>i(t(r))))}some(t){let i=!1;return this.iterate(r=>(i=t(r),!i)),i}findFirst(t){let i;return this.iterate(r=>t(r)?(i=r,!1):!0),i}findLast(t){let i;return this.iterate(r=>(t(r)&&(i=r),!0)),i}findLastMaxBy(t){let i,r=!0;return this.iterate(s=>((r||mv.isGreaterThan(t(s,i)))&&(r=!1,i=s),!0)),i}},q5,G5,Z5;function VR(e,t,i){let r=e.get(t);return r===void 0&&(r=i,e.set(t,r)),r}var qR=class{constructor(e,t){this.uri=e,this.value=t}};function GR(e){return Array.isArray(e)}var zt=class Id{static{this.c=t=>t.toString()}constructor(t,i){if(this[q5]="ResourceMap",t instanceof Id)this.d=new Map(t.d),this.e=i??Id.c;else if(GR(t)){this.d=new Map,this.e=i??Id.c;for(const[r,s]of t)this.set(r,s)}else this.d=new Map,this.e=t??Id.c}set(t,i){return this.d.set(this.e(t),new qR(t,i)),this}get(t){return this.d.get(this.e(t))?.value}has(t){return this.d.has(this.e(t))}get size(){return this.d.size}clear(){this.d.clear()}delete(t){return this.d.delete(this.e(t))}forEach(t,i){typeof i<"u"&&(t=t.bind(i));for(const[r,s]of this.d)t(s.value,s.uri,this)}*values(){for(const t of this.d.values())yield t.value}*keys(){for(const t of this.d.values())yield t.uri}*entries(){for(const t of this.d.values())yield[t.uri,t.value]}*[(q5=Symbol.toStringTag,Symbol.iterator)](){for(const[,t]of this.d)yield[t.uri,t.value]}},J5=class{constructor(e,t){this[G5]="ResourceSet",!e||typeof e=="function"?this.c=new zt(e):(this.c=new zt(t),e.forEach(this.add,this))}get size(){return this.c.size}add(e){return this.c.set(e,e),this}clear(){this.c.clear()}delete(e){return this.c.delete(e)}forEach(e,t){this.c.forEach((i,r)=>e.call(t,r,r,this))}has(e){return this.c.has(e)}entries(){return this.c.entries()}keys(){return this.c.keys()}values(){return this.c.keys()}[(G5=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}},Q5;(function(e){e[e.None=0]="None",e[e.AsOld=1]="AsOld",e[e.AsNew=2]="AsNew"})(Q5||(Q5={}));var ZR=class{constructor(){this[Z5]="LinkedMap",this.c=new Map,this.d=void 0,this.e=void 0,this.f=0,this.g=0}clear(){this.c.clear(),this.d=void 0,this.e=void 0,this.f=0,this.g++}isEmpty(){return!this.d&&!this.e}get size(){return this.f}get first(){return this.d?.value}get last(){return this.e?.value}has(e){return this.c.has(e)}get(e,t=0){const i=this.c.get(e);if(i)return t!==0&&this.n(i,t),i.value}set(e,t,i=0){let r=this.c.get(e);if(r)r.value=t,i!==0&&this.n(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.l(r);break;case 1:this.k(r);break;case 2:this.l(r);break;default:this.l(r);break}this.c.set(e,r),this.f++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this.c.get(e);if(t)return this.c.delete(e),this.m(t),this.f--,t.value}shift(){if(!this.d&&!this.e)return;if(!this.d||!this.e)throw new Error("Invalid list");const e=this.d;return this.c.delete(e.key),this.m(e),this.f--,e.value}forEach(e,t){const i=this.g;let r=this.d;for(;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this.g!==i)throw new Error("LinkedMap got modified during iteration.");r=r.next}}keys(){const e=this,t=this.g;let i=this.d;const r={[Symbol.iterator](){return r},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}values(){const e=this,t=this.g;let i=this.d;const r={[Symbol.iterator](){return r},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}entries(){const e=this,t=this.g;let i=this.d;const r={[Symbol.iterator](){return r},next(){if(e.g!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return r}[(Z5=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}h(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.d,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.next,i--;this.d=t,this.f=i,t&&(t.previous=void 0),this.g++}j(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this.e,i=this.size;for(;t&&i>e;)this.c.delete(t.key),t=t.previous,i--;this.e=t,this.f=i,t&&(t.next=void 0),this.g++}k(e){if(!this.d&&!this.e)this.e=e;else if(this.d)e.next=this.d,this.d.previous=e;else throw new Error("Invalid list");this.d=e,this.g++}l(e){if(!this.d&&!this.e)this.d=e;else if(this.e)e.previous=this.e,this.e.next=e;else throw new Error("Invalid list");this.e=e,this.g++}m(e){if(e===this.d&&e===this.e)this.d=void 0,this.e=void 0;else if(e===this.d){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this.d=e.next}else if(e===this.e){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this.e=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this.g++}n(e,t){if(!this.d||!this.e)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this.d)return;const i=e.next,r=e.previous;e===this.e?(r.next=void 0,this.e=r):(i.previous=r,r.next=i),e.previous=void 0,e.next=this.d,this.d.previous=e,this.d=e,this.g++}else if(t===2){if(e===this.e)return;const i=e.next,r=e.previous;e===this.d?(i.previous=void 0,this.d=i):(i.previous=r,r.next=i),e.next=void 0,e.previous=this.e,this.e.next=e,this.e=e,this.g++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}},JR=class extends ZR{constructor(e,t=1){super(),this.o=e,this.p=Math.min(Math.max(0,t),1)}get limit(){return this.o}set limit(e){this.o=e,this.q()}get ratio(){return this.p}set ratio(e){this.p=Math.min(Math.max(0,e),1),this.q()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}q(){this.size>this.o&&this.r(Math.round(this.o*this.p))}},Ya=class extends JR{constructor(e,t=1){super(e,t)}r(e){this.h(e)}set(e,t){return super.set(e,t),this.q(),this}},QR=class{constructor(e){if(this.c=new Map,this.d=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this.c.clear(),this.d.clear()}set(e,t){this.c.set(e,t),this.d.set(t,e)}get(e){return this.c.get(e)}getKey(e){return this.d.get(e)}delete(e){const t=this.c.get(e);return t===void 0?!1:(this.c.delete(e),this.d.delete(t),!0)}forEach(e,t){this.c.forEach((i,r)=>{e.call(t,i,r,this)})}keys(){return this.c.keys()}values(){return this.c.values()}},Y5=class{constructor(){this.c=new Map}add(e,t){let i=this.c.get(e);i||(i=new Set,this.c.set(e,i)),i.add(t)}delete(e,t){const i=this.c.get(e);i&&(i.delete(t),i.size===0&&this.c.delete(e))}forEach(e,t){const i=this.c.get(e);i&&i.forEach(t)}get(e){const t=this.c.get(e);return t||new Set}};function ki(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}function vv(e,t="Unreachable"){throw new Error(t)}function wv(e,t="unexpected state"){if(!e)throw typeof t=="string"?new wi(`Assertion Failed: ${t}`):t}function X5(e){if(!e()){debugger;e(),lt(new wi("Assertion Failed"))}}function Oe(e){return typeof e=="string"}function YR(e){return XR(e,Oe)}function XR(e,t){return Array.isArray(e)&&e.every(t)}function yt(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}function KR(e){const t=Object.getPrototypeOf(Uint8Array);return typeof e=="object"&&e instanceof t}function Er(e){return typeof e=="number"&&!isNaN(e)}function eL(e){return!!e&&typeof e[Symbol.iterator]=="function"}function K5(e){return e===!0||e===!1}function Kl(e){return typeof e>"u"}function hr(e){return!Ht(e)}function Ht(e){return Kl(e)||e===null}function bv(e,t){if(!e)throw new Error(t?`Unexpected type, expected '${t}'`:"Unexpected type")}function Xa(e){return wv(e!=null,"Argument is `undefined` or `null`."),e}var tL=Object.prototype.hasOwnProperty;function yv(e){if(!yt(e))return!1;for(const t in e)if(tL.call(e,t))return!1;return!0}function eE(e){return typeof e=="function"}function iL(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++)tE(e[r],t[r])}function tE(e,t){if(Oe(t)){if(typeof e!==t)throw new Error(`argument does not match constraint: typeof ${t}`)}else if(eE(t)){try{if(e instanceof t)return}catch{}if(!Ht(e)&&e.constructor===t||t.length===1&&t.call(void 0,e)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function In(e,t){for(const i in t)if(!(i in e))return!1;return!0}var Wt;(function(e){function t(F){return!!F&&typeof F=="object"&&typeof F[Symbol.iterator]=="function"}e.is=t;const i=Object.freeze([]);function r(){return i}e.empty=r;function*s(F){yield F}e.single=s;function n(F){return t(F)?F:s(F)}e.wrap=n;function o(F){return F??i}e.from=o;function*a(F){for(let V=F.length-1;V>=0;V--)yield F[V]}e.reverse=a;function c(F){return!F||F[Symbol.iterator]().next().done===!0}e.isEmpty=c;function l(F){return F[Symbol.iterator]().next().value}e.first=l;function u(F,V){let z=0;for(const ue of F)if(V(ue,z++))return!0;return!1}e.some=u;function h(F,V){let z=0;for(const ue of F)if(!V(ue,z++))return!1;return!0}e.every=h;function f(F,V){for(const z of F)if(V(z))return z}e.find=f;function*p(F,V){for(const z of F)V(z)&&(yield z)}e.filter=p;function*g(F,V){let z=0;for(const ue of F)yield V(ue,z++)}e.map=g;function*v(F,V){let z=0;for(const ue of F)yield*V(ue,z++)}e.flatMap=v;function*b(...F){for(const V of F)eL(V)?yield*V:yield V}e.concat=b;function S(F,V,z){let ue=z;for(const Re of F)ue=V(ue,Re);return ue}e.reduce=S;function E(F){let V=0;for(const z of F)V++;return V}e.length=E;function*$(F,V,z=F.length){for(V<-F.length&&(V=0),V<0&&(V+=F.length),z<0?z+=F.length:z>F.length&&(z=F.length);V<z;V++)yield F[V]}e.slice=$;function U(F,V=Number.POSITIVE_INFINITY){const z=[];if(V===0)return[z,F];const ue=F[Symbol.iterator]();for(let Re=0;Re<V;Re++){const ae=ue.next();if(ae.done)return[z,e.empty()];z.push(ae.value)}return[z,{[Symbol.iterator](){return ue}}]}e.consume=U;async function O(F){const V=[];for await(const z of F)V.push(z);return V}e.asyncToArray=O;async function J(F){let V=[];for await(const z of F)V=V.concat(z);return V}e.asyncToArrayFlat=J})(Wt||(Wt={}));var rL=!1,Po=null,pee=class RM{constructor(){this.b=new Map}static{this.a=0}c(t){let i=this.b.get(t);return i||(i={parent:null,source:null,isSingleton:!1,value:t,idx:RM.a++},this.b.set(t,i)),i}trackDisposable(t){const i=this.c(t);i.source||(i.source=new Error().stack)}setParent(t,i){const r=this.c(t);r.parent=i}markAsDisposed(t){this.b.delete(t)}markAsSingleton(t){this.c(t).isSingleton=!0}f(t,i){const r=i.get(t);if(r)return r;const s=t.parent?this.f(this.c(t.parent),i):t;return i.set(t,s),s}getTrackedDisposables(){const t=new Map;return[...this.b.entries()].filter(([,r])=>r.source!==null&&!this.f(r,t).isSingleton).flatMap(([r])=>r)}computeLeakingDisposables(t=10,i){let r;if(i)r=i;else{const c=new Map,l=[...this.b.values()].filter(h=>h.source!==null&&!this.f(h,c).isSingleton);if(l.length===0)return;const u=new Set(l.map(h=>h.value));if(r=l.filter(h=>!(h.parent&&u.has(h.parent))),r.length===0)throw new Error("There are cyclic diposable chains!")}if(!r)return;function s(c){function l(h,f){for(;h.length>0&&f.some(p=>typeof p=="string"?p===h[0]:h[0].match(p));)h.shift()}const u=c.source.split(`
`).map(h=>h.trim().replace("at ","")).filter(h=>h!=="");return l(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),u.reverse()}const n=new Y5;for(const c of r){const l=s(c);for(let u=0;u<=l.length;u++)n.add(l.slice(0,u).join(`
`),c)}r.sort(BR(c=>c.idx,_R));let o="",a=0;for(const c of r.slice(0,t)){a++;const l=s(c),u=[];for(let h=0;h<l.length;h++){let f=l[h];f=`(shared with ${n.get(l.slice(0,h+1).join(`
`)).size}/${r.length} leaks) at ${f}`;const g=n.get(l.slice(0,h).join(`
`)),v=lv([...g].map(b=>s(b)[h]),b=>b);delete v[l[h]];for(const[b,S]of Object.entries(v))S&&u.unshift(`    - stacktraces of ${S.length} other leaks continue with ${b}`);u.unshift(f)}o+=`


==================== Leaking disposable ${a}/${r.length}: ${c.value.constructor.name} ====================
${u.join(`
`)}
============================================================

`}return r.length>t&&(o+=`


... and ${r.length-t} more leaking disposables

`),{leaks:r,details:o}}};function sL(e){Po=e}if(rL){const e="__is_disposable_tracked__";sL(new class{trackDisposable(t){const i=new Error("Potentially leaked disposable").stack;setTimeout(()=>{t[e]||console.log(i)},3e3)}setParent(t,i){if(t&&t!==Q.None)try{t[e]=!0}catch{}}markAsDisposed(t){if(t&&t!==Q.None)try{t[e]=!0}catch{}}markAsSingleton(t){}})}function Ka(e){return Po?.trackDisposable(e),e}function ec(e){Po?.markAsDisposed(e)}function To(e,t){Po?.setParent(e,t)}function nL(e,t){if(Po)for(const i of e)Po.setParent(i,t)}function Av(e){return Po?.markAsSingleton(e),e}function iE(e){return typeof e=="object"&&e!==null&&typeof e.dispose=="function"&&e.dispose.length===0}function Zi(e){if(Wt.is(e)){const t=[];for(const i of e)if(i)try{i.dispose()}catch(r){t.push(r)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function Sv(...e){const t=te(()=>Zi(e));return nL(e,t),t}var oL=class{constructor(e){this.a=!1,this.b=e,Ka(this)}dispose(){if(!this.a){if(!this.b)throw new Error("Unbound disposable context: Need to use an arrow function to preserve the value of this");this.a=!0,ec(this),this.b()}}};function te(e){return new oL(e)}var ie=class LM{static{this.DISABLE_DISPOSED_WARNING=!1}constructor(){this.f=new Set,this.g=!1,Ka(this)}dispose(){this.g||(ec(this),this.g=!0,this.clear())}get isDisposed(){return this.g}clear(){if(this.f.size!==0)try{Zi(this.f)}finally{this.f.clear()}}add(t){if(!t||t===Q.None)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return To(t,this),this.g?LM.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this.f.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this.f.delete(t),t.dispose()}}deleteAndLeak(t){t&&this.f.delete(t)&&To(t,null)}assertNotDisposed(){this.g&&lt(new wi("Object disposed"))}},Q=class{static{this.None=Object.freeze({dispose(){}})}constructor(){this.B=new ie,Ka(this),To(this.B,this)}dispose(){ec(this),this.B.dispose()}D(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this.B.add(e)}},Br=class{constructor(){this.b=!1,Ka(this)}get value(){return this.b?void 0:this.a}set value(e){this.b||e===this.a||(this.a?.dispose(),e&&To(e,this),this.a=e)}clear(){this.value=void 0}dispose(){this.b=!0,ec(this),this.a?.dispose(),this.a=void 0}clearAndLeak(){const e=this.a;return this.a=void 0,e&&To(e,null),e}},Mo=class{constructor(e=new Map){this.b=!1,this.a=e,Ka(this)}dispose(){ec(this),this.b=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this.a.size)try{Zi(this.a.values())}finally{this.a.clear()}}has(e){return this.a.has(e)}get size(){return this.a.size}get(e){return this.a.get(e)}set(e,t,i=!1){this.b&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this.a.get(e)?.dispose(),this.a.set(e,t),To(t,this)}deleteAndDispose(e){this.a.get(e)?.dispose(),this.a.delete(e)}deleteAndLeak(e){const t=this.a.get(e);return t&&To(t,null),this.a.delete(e),t}keys(){return this.a.keys()}values(){return this.a.values()}[Symbol.iterator](){return this.a[Symbol.iterator]()}};function aL(e,t){return e.then(i=>(t.isDisposed?i.dispose():t.add(i),i))}var cL=class extends Mo{constructor(){super(new zt)}},Lt=class H1{static{this.Undefined=new H1(void 0)}constructor(t){this.element=t,this.next=H1.Undefined,this.prev=H1.Undefined}},Dn=class{constructor(){this.a=Lt.Undefined,this.b=Lt.Undefined,this.c=0}get size(){return this.c}isEmpty(){return this.a===Lt.Undefined}clear(){let e=this.a;for(;e!==Lt.Undefined;){const t=e.next;e.prev=Lt.Undefined,e.next=Lt.Undefined,e=t}this.a=Lt.Undefined,this.b=Lt.Undefined,this.c=0}unshift(e){return this.d(e,!1)}push(e){return this.d(e,!0)}d(e,t){const i=new Lt(e);if(this.a===Lt.Undefined)this.a=i,this.b=i;else if(t){const s=this.b;this.b=i,i.prev=s,s.next=i}else{const s=this.a;this.a=i,i.next=s,s.prev=i}this.c+=1;let r=!1;return()=>{r||(r=!0,this.e(i))}}shift(){if(this.a!==Lt.Undefined){const e=this.a.element;return this.e(this.a),e}}pop(){if(this.b!==Lt.Undefined){const e=this.b.element;return this.e(this.b),e}}peek(){if(this.b!==Lt.Undefined)return this.b.element}e(e){if(e.prev!==Lt.Undefined&&e.next!==Lt.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Lt.Undefined&&e.next===Lt.Undefined?(this.a=Lt.Undefined,this.b=Lt.Undefined):e.next===Lt.Undefined?(this.b=this.b.prev,this.b.next=Lt.Undefined):e.prev===Lt.Undefined&&(this.a=this.a.next,this.a.prev=Lt.Undefined);this.c-=1}*[Symbol.iterator](){let e=this.a;for(;e!==Lt.Undefined;)yield e.element,e=e.next}},lL=globalThis.performance.now.bind(globalThis.performance),Ji=class OM{static create(t){return new OM(t)}constructor(t){this.c=t===!1?Date.now:lL,this.a=this.c(),this.b=-1}stop(){this.b=this.c()}reset(){this.a=this.c(),this.b=-1}elapsed(){return this.b!==-1?this.b-this.a:this.c()-this.a}},rE=!1,uL=!1,Ie;(function(e){e.None=()=>Q.None;function t(Z){if(uL){const{onDidAddListener:_}=Z,G=Ev.create();let K=0;Z.onDidAddListener=()=>{++K===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),G.print()),_?.()}}}function i(Z,_){return p(Z,()=>{},0,void 0,!0,void 0,_)}e.defer=i;function r(Z){return(_,G=null,K)=>{let re=!1,Ae;return Ae=Z(Me=>{if(!re)return Ae?Ae.dispose():re=!0,_.call(G,Me)},null,K),re&&Ae.dispose(),Ae}}e.once=r;function s(Z,_){return e.once(e.filter(Z,_))}e.onceIf=s;function n(Z,_,G){return h((K,re=null,Ae)=>Z(Me=>K.call(re,_(Me)),null,Ae),G)}e.map=n;function o(Z,_,G){return h((K,re=null,Ae)=>Z(Me=>{_(Me),K.call(re,Me)},null,Ae),G)}e.forEach=o;function a(Z,_,G){return h((K,re=null,Ae)=>Z(Me=>_(Me)&&K.call(re,Me),null,Ae),G)}e.filter=a;function c(Z){return Z}e.signal=c;function l(...Z){return(_,G=null,K)=>{const re=Sv(...Z.map(Ae=>Ae(Me=>_.call(G,Me))));return f(re,K)}}e.any=l;function u(Z,_,G,K){let re=G;return n(Z,Ae=>(re=_(re,Ae),re),K)}e.reduce=u;function h(Z,_){let G;const K={onWillAddFirstListener(){G=Z(re.fire,re)},onDidRemoveLastListener(){G?.dispose()}};_||t(K);const re=new I(K);return _?.add(re),re.event}function f(Z,_){return _ instanceof Array?_.push(Z):_&&_.add(Z),Z}function p(Z,_,G=100,K=!1,re=!1,Ae,Me){let Ne,mt,_t,tt=0,Rt;const Si={leakWarningThreshold:Ae,onWillAddFirstListener(){Ne=Z(br=>{tt++,mt=_(mt,br),K&&!_t&&(ti.fire(mt),mt=void 0),Rt=()=>{const kn=mt;mt=void 0,_t=void 0,(!K||tt>1)&&ti.fire(kn),tt=0},typeof G=="number"?(_t&&clearTimeout(_t),_t=setTimeout(Rt,G)):_t===void 0&&(_t=null,queueMicrotask(Rt))})},onWillRemoveListener(){re&&tt>0&&Rt?.()},onDidRemoveLastListener(){Rt=void 0,Ne.dispose()}};Me||t(Si);const ti=new I(Si);return Me?.add(ti),ti.event}e.debounce=p;function g(Z,_=0,G){return e.debounce(Z,(K,re)=>K?(K.push(re),K):[re],_,void 0,!0,void 0,G)}e.accumulate=g;function v(Z,_=(K,re)=>K===re,G){let K=!0,re;return a(Z,Ae=>{const Me=K||!_(Ae,re);return K=!1,re=Ae,Me},G)}e.latch=v;function b(Z,_,G){return[e.filter(Z,_,G),e.filter(Z,K=>!_(K),G)]}e.split=b;function S(Z,_=!1,G=[],K){let re=G.slice(),Ae=Z(mt=>{re?re.push(mt):Ne.fire(mt)});K&&K.add(Ae);const Me=()=>{re?.forEach(mt=>Ne.fire(mt)),re=null},Ne=new I({onWillAddFirstListener(){Ae||(Ae=Z(mt=>Ne.fire(mt)),K&&K.add(Ae))},onDidAddFirstListener(){re&&(_?setTimeout(Me):Me())},onDidRemoveLastListener(){Ae&&Ae.dispose(),Ae=null}});return K&&K.add(Ne),Ne.event}e.buffer=S;function E(Z,_){return(K,re,Ae)=>{const Me=_(new U);return Z(function(Ne){const mt=Me.evaluate(Ne);mt!==$&&K.call(re,mt)},void 0,Ae)}}e.chain=E;const $=Symbol("HaltChainable");class U{constructor(){this.f=[]}map(_){return this.f.push(_),this}forEach(_){return this.f.push(G=>(_(G),G)),this}filter(_){return this.f.push(G=>_(G)?G:$),this}reduce(_,G){let K=G;return this.f.push(re=>(K=_(K,re),K)),this}latch(_=(G,K)=>G===K){let G=!0,K;return this.f.push(re=>{const Ae=G||!_(re,K);return G=!1,K=re,Ae?re:$}),this}evaluate(_){for(const G of this.f)if(_=G(_),_===$)break;return _}}function O(Z,_,G=K=>K){const K=(...Ne)=>Me.fire(G(...Ne)),re=()=>Z.on(_,K),Ae=()=>Z.removeListener(_,K),Me=new I({onWillAddFirstListener:re,onDidRemoveLastListener:Ae});return Me.event}e.fromNodeEventEmitter=O;function J(Z,_,G=K=>K){const K=(...Ne)=>Me.fire(G(...Ne)),re=()=>Z.addEventListener(_,K),Ae=()=>Z.removeEventListener(_,K),Me=new I({onWillAddFirstListener:re,onDidRemoveLastListener:Ae});return Me.event}e.fromDOMEventEmitter=J;function F(Z,_){let G,K;const re=new Promise(Ae=>{K=r(Z)(Ae),xv(K,_),G=()=>{oE(K,_)}});return re.cancel=G,_&&re.finally(()=>oE(K,_)),re}e.toPromise=F;function V(Z,_){return Z(G=>_.fire(G))}e.forward=V;function z(Z,_,G){return _(G),Z(K=>_(K))}e.runAndSubscribe=z;class ue{constructor(_,G){this._observable=_,this.f=0,this.g=!1;const K={onWillAddFirstListener:()=>{_.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{_.removeObserver(this)}};G||t(K),this.emitter=new I(K),G&&G.add(this.emitter)}beginUpdate(_){this.f++}handlePossibleChange(_){}handleChange(_,G){this.g=!0}endUpdate(_){this.f--,this.f===0&&(this._observable.reportChanges(),this.g&&(this.g=!1,this.emitter.fire(this._observable.get())))}}function Re(Z,_){return new ue(Z,_).emitter.event}e.fromObservable=Re;function ae(Z){return(_,G,K)=>{let re=0,Ae=!1;const Me={beginUpdate(){re++},endUpdate(){re--,re===0&&(Z.reportChanges(),Ae&&(Ae=!1,_.call(G)))},handlePossibleChange(){},handleChange(){Ae=!0}};Z.addObserver(Me),Z.reportChanges();const Ne={dispose(){Z.removeObserver(Me)}};return xv(Ne,K),Ne}}e.fromObservableLight=ae})(Ie||(Ie={}));var hL=class a5{static{this.all=new Set}static{this.f=0}constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${a5.f++}`,a5.all.add(this)}start(t){this.g=new Ji,this.listenerCount=t}stop(){if(this.g){const t=this.g.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this.g=void 0}}},sE=-1,dL=class FM{static{this.f=1}constructor(t,i,r=(FM.f++).toString(16).padStart(3,"0")){this.j=t,this.threshold=i,this.name=r,this.h=0}dispose(){this.g?.clear()}check(t,i){const r=this.threshold;if(r<=0||i<r)return;this.g||(this.g=new Map);const s=this.g.get(t.value)||0;if(this.g.set(t.value,s+1),this.h-=1,this.h<=0){this.h=r*.5;const[n,o]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a),console.warn(n);const c=new fL(a,n);this.j(c)}return()=>{const n=this.g.get(t.value)||0;this.g.set(t.value,n-1)}}getMostFrequentStack(){if(!this.g)return;let t,i=0;for(const[r,s]of this.g)(!t||i<s)&&(t=[r,s],i=s);return t}},Ev=class UM{static create(){const t=new Error;return new UM(t.stack??"")}constructor(t){this.value=t}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},fL=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},pL=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},gL=0,_d=class{constructor(e){this.value=e,this.id=gL++}},mL=2,nE=(e,t)=>{if(e instanceof _d)t(e);else for(let i=0;i<e.length;i++){const r=e[i];r&&t(r)}},I=class{constructor(e){this.A=0,this.g=e,this.j=sE>0||this.g?.leakWarningThreshold?new dL(e?.onListenerError??lt,this.g?.leakWarningThreshold??sE):void 0,this.m=this.g?._profName?new hL(this.g._profName):void 0,this.z=this.g?.deliveryQueue}dispose(){if(!this.q){if(this.q=!0,this.z?.current===this&&this.z.reset(),this.w){if(rE){const e=this.w;queueMicrotask(()=>{nE(e,t=>t.stack?.print())})}this.w=void 0,this.A=0}this.g?.onDidRemoveLastListener?.(),this.j?.dispose()}}get event(){return this.u??=(e,t,i)=>{if(this.j&&this.A>this.j.threshold**2){const a=`[${this.j.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this.A} vs ${this.j.threshold})`;console.warn(a);const c=this.j.getMostFrequentStack()??["UNKNOWN stack",-1],l=new pL(`${a}. HINT: Stack shows most frequent listener (${c[1]}-times)`,c[0]);return(this.g?.onListenerError||lt)(l),Q.None}if(this.q)return Q.None;t&&(e=e.bind(t));const r=new _d(e);let s,n;this.j&&this.A>=Math.ceil(this.j.threshold*.2)&&(r.stack=Ev.create(),s=this.j.check(r.stack,this.A+1)),rE&&(r.stack=n??Ev.create()),this.w?this.w instanceof _d?(this.z??=new vL,this.w=[this.w,r]):this.w.push(r):(this.g?.onWillAddFirstListener?.(this),this.w=r,this.g?.onDidAddFirstListener?.(this)),this.g?.onDidAddListener?.(this),this.A++;const o=te(()=>{s?.(),this.B(r)});return xv(o,i),o},this.u}B(e){if(this.g?.onWillRemoveListener?.(this),!this.w)return;if(this.A===1){this.w=void 0,this.g?.onDidRemoveLastListener?.(this),this.A=0;return}const t=this.w,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this.q),console.log("size?",this.A),console.log("arr?",JSON.stringify(this.w)),new Error("Attempted to dispose unknown listener");this.A--,t[i]=void 0;const r=this.z.current===this;if(this.A*mL<=t.length){let s=0;for(let n=0;n<t.length;n++)t[n]?t[s++]=t[n]:r&&s<this.z.end&&(this.z.end--,s<this.z.i&&this.z.i--);t.length=s}}C(e,t){if(!e)return;const i=this.g?.onListenerError||lt;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}D(e){const t=e.current.w;for(;e.i<e.end;)this.C(t[e.i++],e.value);e.reset()}fire(e){if(this.z?.current&&(this.D(this.z),this.m?.stop()),this.m?.start(this.A),this.w)if(this.w instanceof _d)this.C(this.w,e);else{const t=this.z;t.enqueue(this,e,this.w.length),this.D(t)}this.m?.stop()}hasListeners(){return this.A>0}},vL=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},eu=class extends I{async fireAsync(e,t,i){if(this.w)for(this.f||(this.f=new Dn),nE(this.w,r=>this.f.push([r.value,e]));this.f.size>0&&!t.isCancellationRequested;){const[r,s]=this.f.shift(),n=[],o={...s,token:t,waitUntil:a=>{if(Object.isFrozen(n))throw new Error("waitUntil can NOT be called asynchronous");i&&(a=i(a,r)),n.push(a)}};try{r(o)}catch(a){lt(a);continue}Object.freeze(n),await Promise.allSettled(n).then(a=>{for(const c of a)c.status==="rejected"&&lt(c.reason)})}}},tu=class extends I{get isPaused(){return this.f!==0}constructor(e){super(e),this.f=0,this.h=new Dn,this.s=e?.merge}pause(){this.f++}resume(){if(this.f!==0&&--this.f===0)if(this.s){if(this.h.size>0){const e=Array.from(this.h);this.h.clear(),super.fire(this.s(e))}}else for(;!this.f&&this.h.size!==0;)super.fire(this.h.shift())}fire(e){this.A&&(this.f!==0?this.h.push(e):super.fire(e))}},wL=class extends tu{constructor(e){super(e),this.k=e.delay??100}fire(e){this.o||(this.pause(),this.o=setTimeout(()=>{this.o=void 0,this.resume()},this.k)),super.fire(e)}},bL=class extends I{constructor(e){super(e),this.f=[],this.h=e?.merge}fire(e){this.hasListeners()&&(this.f.push(e),this.f.length===1&&queueMicrotask(()=>{this.h?super.fire(this.h(this.f)):this.f.forEach(t=>super.fire(t)),this.f=[]}))}},yL=class{constructor(){this.f=!1,this.g=Ie.None,this.h=Q.None,this.j=new I({onDidAddFirstListener:()=>{this.f=!0,this.h=this.g(this.j.fire,this.j)},onDidRemoveLastListener:()=>{this.f=!1,this.h.dispose()}}),this.event=this.j.event}set input(e){this.g=e,this.f&&(this.h.dispose(),this.h=e(this.j.fire,this.j))}dispose(){this.h.dispose(),this.j.dispose()}};function xv(e,t){t instanceof ie?t.add(e):Array.isArray(t)&&t.push(e)}function oE(e,t){if(t instanceof ie)t.delete(e);else if(Array.isArray(t)){const i=t.indexOf(e);i!==-1&&t.splice(i,1)}e.dispose()}var aE=Object.freeze(function(e,t){const i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}),Fe;(function(e){function t(i){return i===e.None||i===e.Cancelled||i instanceof Vd?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ie.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:aE})})(Fe||(Fe={}));var Vd=class{constructor(){this.a=!1,this.b=null}cancel(){this.a||(this.a=!0,this.b&&(this.b.fire(void 0),this.dispose()))}get isCancellationRequested(){return this.a}get onCancellationRequested(){return this.a?aE:(this.b||(this.b=new I),this.b.event)}dispose(){this.b&&(this.b.dispose(),this.b=null)}},Qe=class{constructor(e){this.f=void 0,this.g=void 0,this.g=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this.f||(this.f=new Vd),this.f}cancel(){this.f?this.f instanceof Vd&&this.f.cancel():this.f=Fe.Cancelled}dispose(e=!1){e&&this.cancel(),this.g?.dispose(),this.f?this.f instanceof Vd&&this.f.dispose():this.f=Fe.None}};function AL(){return globalThis._VSCODE_NLS_MESSAGES}function cE(){return globalThis._VSCODE_NLS_LANGUAGE}var SL=cE()==="pseudo"||typeof document<"u"&&document.location&&typeof document.location.hash=="string"&&document.location.hash.indexOf("pseudo=true")>=0;function qd(e,t){let i;return t.length===0?i=e:i=e.replace(/\{(\d+)\}/g,(r,s)=>{const n=s[0],o=t[n];let a=r;return typeof o=="string"?a=o:(typeof o=="number"||typeof o=="boolean"||o===void 0||o===null)&&(a=String(o)),a}),SL&&(i="\uFF3B"+i.replace(/[aouei]/g,"$&$&")+"\uFF3D"),i}function d(e,t,...i){return qd(typeof e=="number"?lE(e,t):t,i)}function lE(e,t){const i=AL()?.[e];if(typeof i!="string"){if(typeof t=="string")return t;throw new Error(`!!! NLS MISSING: ${e} !!!`)}return i}function Gd(e,t,...i){let r;typeof e=="number"?r=lE(e,t):r=t;const s=qd(r,i);return{value:s,original:t===r?s:qd(t,i)}}var Pn="en",iu=!1,ru=!1,su=!1,EL=!1,uE=!1,kv=!1,xL=!1,Cv=!1,hE=!1,dE=!1,Zd=void 0,Jd=Pn,fE=Pn,kL=void 0,_s=void 0,Vs=globalThis,Qi=void 0;typeof Vs.vscode<"u"&&typeof Vs.vscode.process<"u"?Qi=Vs.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Qi=process);var pE=typeof Qi?.versions?.electron=="string",CL=pE&&Qi?.type==="renderer";if(typeof Qi=="object"){iu=Qi.platform==="win32",ru=Qi.platform==="darwin",su=Qi.platform==="linux",EL=su&&!!Qi.env.SNAP&&!!Qi.env.SNAP_REVISION,xL=pE,hE=!!Qi.env.CI||!!Qi.env.BUILD_ARTIFACTSTAGINGDIRECTORY||!!Qi.env.GITHUB_WORKSPACE,Zd=Pn,Jd=Pn;const e=Qi.env.VSCODE_NLS_CONFIG;if(e)try{const t=JSON.parse(e);Zd=t.userLocale,fE=t.osLocale,Jd=t.resolvedLanguage||Pn,kL=t.languagePack?.translationsConfigFile}catch{}uE=!0}else typeof navigator=="object"&&!CL?(_s=navigator.userAgent,iu=_s.indexOf("Windows")>=0,ru=_s.indexOf("Macintosh")>=0,Cv=(_s.indexOf("Macintosh")>=0||_s.indexOf("iPad")>=0||_s.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,su=_s.indexOf("Linux")>=0,dE=_s?.indexOf("Mobi")>=0,kv=!0,Jd=cE()||Pn,Zd=navigator.language.toLowerCase(),fE=Zd):console.error("Unable to resolve platform.");var gE;(function(e){e[e.Web=0]="Web",e[e.Mac=1]="Mac",e[e.Linux=2]="Linux",e[e.Windows=3]="Windows"})(gE||(gE={}));function $L(e){switch(e){case 0:return"Web";case 1:return"Mac";case 2:return"Linux";case 3:return"Windows"}}var Qd=0;ru?Qd=1:iu?Qd=3:su&&(Qd=2);var ze=iu,Dt=ru,$t=su,mE=uE,No=kv,IL=kv&&typeof Vs.importScripts=="function",DL=IL?Vs.origin:void 0,PL=Cv,TL=dE,Ro=hE,ML=Qd,ms=_s,Tn=Jd,vE;(function(e){function t(){return Tn}e.value=t;function i(){return Tn.length===2?Tn==="en":Tn.length>=3?Tn[0]==="e"&&Tn[1]==="n"&&Tn[2]==="-":!1}e.isDefaultVariant=i;function r(){return Tn==="en"}e.isDefault=r})(vE||(vE={}));var NL=typeof Vs.postMessage=="function"&&!Vs.importScripts,wE=(()=>{if(NL){const e=[];Vs.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let r=0,s=e.length;r<s;r++){const n=e[r];if(n.id===i.data.vscodeScheduleAsyncWork){e.splice(r,1),n.callback();return}}});let t=0;return i=>{const r=++t;e.push({id:r,callback:i}),Vs.postMessage({vscodeScheduleAsyncWork:r},"*")}}return e=>setTimeout(e)})(),bE;(function(e){e[e.Windows=1]="Windows",e[e.Macintosh=2]="Macintosh",e[e.Linux=3]="Linux"})(bE||(bE={}));var Lo=ru||Cv?2:iu?1:3,yE=!0,AE=!1;function SE(){if(!AE){AE=!0;const e=new Uint8Array(2);e[0]=1,e[1]=2,yE=new Uint16Array(e.buffer)[0]===513}return yE}var $v=!!(ms&&ms.indexOf("Chrome")>=0),RL=!!(ms&&ms.indexOf("Firefox")>=0),LL=!!(!$v&&ms&&ms.indexOf("Safari")>=0),EE=!!(ms&&ms.indexOf("Edg/")>=0),gee=!!(ms&&ms.indexOf("Android")>=0),Oo,Iv=globalThis.vscode;if(typeof Iv<"u"&&typeof Iv.process<"u"){const e=Iv.process;Oo={get platform(){return e.platform},get arch(){return e.arch},get env(){return e.env},cwd(){return e.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Oo={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Oo={get platform(){return ze?"win32":Dt?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var Fo=Oo.cwd,Mn=Oo.env,OL=Oo.platform,mee=Oo.arch,FL=65,UL=97,jL=90,zL=122,Uo=46,hi=47,Yi=92,qs=58,HL=63,xE=class extends Error{constructor(e,t,i){let r;typeof t=="string"&&t.indexOf("not ")===0?(r="must not be",t=t.replace(/^not /,"")):r="must be";const s=e.indexOf(".")!==-1?"property":"argument";let n=`The "${e}" ${s} ${r} of type ${t}`;n+=`. Received type ${typeof i}`,super(n),this.code="ERR_INVALID_ARG_TYPE"}};function WL(e,t){if(e===null||typeof e!="object")throw new xE(t,"Object",e)}function Vt(e,t){if(typeof e!="string")throw new xE(t,"string",e)}var Xi=OL==="win32";function Ue(e){return e===hi||e===Yi}function Dv(e){return e===hi}function Gs(e){return e>=FL&&e<=jL||e>=UL&&e<=zL}function Yd(e,t,i,r){let s="",n=0,o=-1,a=0,c=0;for(let l=0;l<=e.length;++l){if(l<e.length)c=e.charCodeAt(l);else{if(r(c))break;c=hi}if(r(c)){if(!(o===l-1||a===1))if(a===2){if(s.length<2||n!==2||s.charCodeAt(s.length-1)!==Uo||s.charCodeAt(s.length-2)!==Uo){if(s.length>2){const u=s.lastIndexOf(i);u===-1?(s="",n=0):(s=s.slice(0,u),n=s.length-1-s.lastIndexOf(i)),o=l,a=0;continue}else if(s.length!==0){s="",n=0,o=l,a=0;continue}}t&&(s+=s.length>0?`${i}..`:"..",n=2)}else s.length>0?s+=`${i}${e.slice(o+1,l)}`:s=e.slice(o+1,l),n=l-o-1;o=l,a=0}else c===Uo&&a!==-1?++a:a=-1}return s}function BL(e){return e?`${e[0]==="."?"":"."}${e}`:""}function kE(e,t){WL(t,"pathObject");const i=t.dir||t.root,r=t.base||`${t.name||""}${BL(t.ext)}`;return i?i===t.root?`${i}${r}`:`${i}${e}${r}`:r}var qt={resolve(...e){let t="",i="",r=!1;for(let s=e.length-1;s>=-1;s--){let n;if(s>=0){if(n=e[s],Vt(n,`paths[${s}]`),n.length===0)continue}else t.length===0?n=Fo():(n=Mn[`=${t}`]||Fo(),(n===void 0||n.slice(0,2).toLowerCase()!==t.toLowerCase()&&n.charCodeAt(2)===Yi)&&(n=`${t}\\`));const o=n.length;let a=0,c="",l=!1;const u=n.charCodeAt(0);if(o===1)Ue(u)&&(a=1,l=!0);else if(Ue(u))if(l=!0,Ue(n.charCodeAt(1))){let h=2,f=h;for(;h<o&&!Ue(n.charCodeAt(h));)h++;if(h<o&&h!==f){const p=n.slice(f,h);for(f=h;h<o&&Ue(n.charCodeAt(h));)h++;if(h<o&&h!==f){for(f=h;h<o&&!Ue(n.charCodeAt(h));)h++;(h===o||h!==f)&&(c=`\\\\${p}\\${n.slice(f,h)}`,a=h)}}}else a=1;else Gs(u)&&n.charCodeAt(1)===qs&&(c=n.slice(0,2),a=2,o>2&&Ue(n.charCodeAt(2))&&(l=!0,a=3));if(c.length>0)if(t.length>0){if(c.toLowerCase()!==t.toLowerCase())continue}else t=c;if(r){if(t.length>0)break}else if(i=`${n.slice(a)}\\${i}`,r=l,l&&t.length>0)break}return i=Yd(i,!r,"\\",Ue),r?`${t}\\${i}`:`${t}${i}`||"."},normalize(e){Vt(e,"path");const t=e.length;if(t===0)return".";let i=0,r,s=!1;const n=e.charCodeAt(0);if(t===1)return Dv(n)?"\\":e;if(Ue(n))if(s=!0,Ue(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){const l=e.slice(c,a);for(c=a;a<t&&Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!Ue(e.charCodeAt(a));)a++;if(a===t)return`\\\\${l}\\${e.slice(c)}\\`;a!==c&&(r=`\\\\${l}\\${e.slice(c,a)}`,i=a)}}}else i=1;else Gs(n)&&e.charCodeAt(1)===qs&&(r=e.slice(0,2),i=2,t>2&&Ue(e.charCodeAt(2))&&(s=!0,i=3));let o=i<t?Yd(e.slice(i),!s,"\\",Ue):"";if(o.length===0&&!s&&(o="."),o.length>0&&Ue(e.charCodeAt(t-1))&&(o+="\\"),!s&&r===void 0&&e.includes(":")){if(o.length>=2&&Gs(o.charCodeAt(0))&&o.charCodeAt(1)===qs)return`.\\${o}`;let a=e.indexOf(":");do if(a===t-1||Ue(e.charCodeAt(a+1)))return`.\\${o}`;while((a=e.indexOf(":",a+1))!==-1)}return r===void 0?s?`\\${o}`:o:s?`${r}\\${o}`:`${r}${o}`},isAbsolute(e){Vt(e,"path");const t=e.length;if(t===0)return!1;const i=e.charCodeAt(0);return Ue(i)||t>2&&Gs(i)&&e.charCodeAt(1)===qs&&Ue(e.charCodeAt(2))},join(...e){if(e.length===0)return".";let t,i;for(let n=0;n<e.length;++n){const o=e[n];Vt(o,"path"),o.length>0&&(t===void 0?t=i=o:t+=`\\${o}`)}if(t===void 0)return".";let r=!0,s=0;if(typeof i=="string"&&Ue(i.charCodeAt(0))){++s;const n=i.length;n>1&&Ue(i.charCodeAt(1))&&(++s,n>2&&(Ue(i.charCodeAt(2))?++s:r=!1))}if(r){for(;s<t.length&&Ue(t.charCodeAt(s));)s++;s>=2&&(t=`\\${t.slice(s)}`)}return qt.normalize(t)},relative(e,t){if(Vt(e,"from"),Vt(t,"to"),e===t)return"";const i=qt.resolve(e),r=qt.resolve(t);if(i===r||(e=i.toLowerCase(),t=r.toLowerCase(),e===t))return"";if(i.length!==e.length||r.length!==t.length){const g=i.split("\\"),v=r.split("\\");g[g.length-1]===""&&g.pop(),v[v.length-1]===""&&v.pop();const b=g.length,S=v.length,E=b<S?b:S;let $;for($=0;$<E&&g[$].toLowerCase()===v[$].toLowerCase();$++);return $===0?r:$===E?S>E?v.slice($).join("\\"):b>E?"..\\".repeat(b-1-$)+"..":"":"..\\".repeat(b-$)+v.slice($).join("\\")}let s=0;for(;s<e.length&&e.charCodeAt(s)===Yi;)s++;let n=e.length;for(;n-1>s&&e.charCodeAt(n-1)===Yi;)n--;const o=n-s;let a=0;for(;a<t.length&&t.charCodeAt(a)===Yi;)a++;let c=t.length;for(;c-1>a&&t.charCodeAt(c-1)===Yi;)c--;const l=c-a,u=o<l?o:l;let h=-1,f=0;for(;f<u;f++){const g=e.charCodeAt(s+f);if(g!==t.charCodeAt(a+f))break;g===Yi&&(h=f)}if(f!==u){if(h===-1)return r}else{if(l>u){if(t.charCodeAt(a+f)===Yi)return r.slice(a+f+1);if(f===2)return r.slice(a+f)}o>u&&(e.charCodeAt(s+f)===Yi?h=f:f===2&&(h=3)),h===-1&&(h=0)}let p="";for(f=s+h+1;f<=n;++f)(f===n||e.charCodeAt(f)===Yi)&&(p+=p.length===0?"..":"\\..");return a+=h,p.length>0?`${p}${r.slice(a,c)}`:(r.charCodeAt(a)===Yi&&++a,r.slice(a,c))},toNamespacedPath(e){if(typeof e!="string"||e.length===0)return e;const t=qt.resolve(e);if(t.length<=2)return e;if(t.charCodeAt(0)===Yi){if(t.charCodeAt(1)===Yi){const i=t.charCodeAt(2);if(i!==HL&&i!==Uo)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(Gs(t.charCodeAt(0))&&t.charCodeAt(1)===qs&&t.charCodeAt(2)===Yi)return`\\\\?\\${t}`;return t},dirname(e){Vt(e,"path");const t=e.length;if(t===0)return".";let i=-1,r=0;const s=e.charCodeAt(0);if(t===1)return Ue(s)?e:".";if(Ue(s)){if(i=r=1,Ue(e.charCodeAt(1))){let a=2,c=a;for(;a<t&&!Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&Ue(e.charCodeAt(a));)a++;if(a<t&&a!==c){for(c=a;a<t&&!Ue(e.charCodeAt(a));)a++;if(a===t)return e;a!==c&&(i=r=a+1)}}}}else Gs(s)&&e.charCodeAt(1)===qs&&(i=t>2&&Ue(e.charCodeAt(2))?3:2,r=i);let n=-1,o=!0;for(let a=t-1;a>=r;--a)if(Ue(e.charCodeAt(a))){if(!o){n=a;break}}else o=!1;if(n===-1){if(i===-1)return".";n=i}return e.slice(0,n)},basename(e,t){t!==void 0&&Vt(t,"suffix"),Vt(e,"path");let i=0,r=-1,s=!0,n;if(e.length>=2&&Gs(e.charCodeAt(0))&&e.charCodeAt(1)===qs&&(i=2),t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=i;--n){const c=e.charCodeAt(n);if(Ue(c)){if(!s){i=n+1;break}}else a===-1&&(s=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=n):(o=-1,r=a))}return i===r?r=a:r===-1&&(r=e.length),e.slice(i,r)}for(n=e.length-1;n>=i;--n)if(Ue(e.charCodeAt(n))){if(!s){i=n+1;break}}else r===-1&&(s=!1,r=n+1);return r===-1?"":e.slice(i,r)},extname(e){Vt(e,"path");let t=0,i=-1,r=0,s=-1,n=!0,o=0;e.length>=2&&e.charCodeAt(1)===qs&&Gs(e.charCodeAt(0))&&(t=r=2);for(let a=e.length-1;a>=t;--a){const c=e.charCodeAt(a);if(Ue(c)){if(!n){r=a+1;break}continue}s===-1&&(n=!1,s=a+1),c===Uo?i===-1?i=a:o!==1&&(o=1):i!==-1&&(o=-1)}return i===-1||s===-1||o===0||o===1&&i===s-1&&i===r+1?"":e.slice(i,s)},format:kE.bind(null,"\\"),parse(e){Vt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.length;let r=0,s=e.charCodeAt(0);if(i===1)return Ue(s)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(Ue(s)){if(r=1,Ue(e.charCodeAt(1))){let h=2,f=h;for(;h<i&&!Ue(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&Ue(e.charCodeAt(h));)h++;if(h<i&&h!==f){for(f=h;h<i&&!Ue(e.charCodeAt(h));)h++;h===i?r=h:h!==f&&(r=h+1)}}}}else if(Gs(s)&&e.charCodeAt(1)===qs){if(i<=2)return t.root=t.dir=e,t;if(r=2,Ue(e.charCodeAt(2))){if(i===3)return t.root=t.dir=e,t;r=3}}r>0&&(t.root=e.slice(0,r));let n=-1,o=r,a=-1,c=!0,l=e.length-1,u=0;for(;l>=r;--l){if(s=e.charCodeAt(l),Ue(s)){if(!c){o=l+1;break}continue}a===-1&&(c=!1,a=l+1),s===Uo?n===-1?n=l:u!==1&&(u=1):n!==-1&&(u=-1)}return a!==-1&&(n===-1||u===0||u===1&&n===a-1&&n===o+1?t.base=t.name=e.slice(o,a):(t.name=e.slice(o,n),t.base=e.slice(o,a),t.ext=e.slice(n,a))),o>0&&o!==r?t.dir=e.slice(0,o-1):t.dir=t.root,t},sep:"\\",delimiter:";",win32:null,posix:null},_L=(()=>{if(Xi){const e=/\\/g;return()=>{const t=Fo().replace(e,"/");return t.slice(t.indexOf("/"))}}return()=>Fo()})(),Be={resolve(...e){let t="",i=!1;for(let r=e.length-1;r>=0&&!i;r--){const s=e[r];Vt(s,`paths[${r}]`),s.length!==0&&(t=`${s}/${t}`,i=s.charCodeAt(0)===hi)}if(!i){const r=_L();t=`${r}/${t}`,i=r.charCodeAt(0)===hi}return t=Yd(t,!i,"/",Dv),i?`/${t}`:t.length>0?t:"."},normalize(e){if(Vt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===hi,i=e.charCodeAt(e.length-1)===hi;return e=Yd(e,!t,"/",Dv),e.length===0?t?"/":i?"./":".":(i&&(e+="/"),t?`/${e}`:e)},isAbsolute(e){return Vt(e,"path"),e.length>0&&e.charCodeAt(0)===hi},join(...e){if(e.length===0)return".";const t=[];for(let i=0;i<e.length;++i){const r=e[i];Vt(r,"path"),r.length>0&&t.push(r)}return t.length===0?".":Be.normalize(t.join("/"))},relative(e,t){if(Vt(e,"from"),Vt(t,"to"),e===t||(e=Be.resolve(e),t=Be.resolve(t),e===t))return"";const i=1,r=e.length,s=r-i,n=1,o=t.length-n,a=s<o?s:o;let c=-1,l=0;for(;l<a;l++){const h=e.charCodeAt(i+l);if(h!==t.charCodeAt(n+l))break;h===hi&&(c=l)}if(l===a)if(o>a){if(t.charCodeAt(n+l)===hi)return t.slice(n+l+1);if(l===0)return t.slice(n+l)}else s>a&&(e.charCodeAt(i+l)===hi?c=l:l===0&&(c=0));let u="";for(l=i+c+1;l<=r;++l)(l===r||e.charCodeAt(l)===hi)&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(n+c)}`},toNamespacedPath(e){return e},dirname(e){if(Vt(e,"path"),e.length===0)return".";const t=e.charCodeAt(0)===hi;let i=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e.charCodeAt(s)===hi){if(!r){i=s;break}}else r=!1;return i===-1?t?"/":".":t&&i===1?"//":e.slice(0,i)},basename(e,t){t!==void 0&&Vt(t,"suffix"),Vt(e,"path");let i=0,r=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(n=e.length-1;n>=0;--n){const c=e.charCodeAt(n);if(c===hi){if(!s){i=n+1;break}}else a===-1&&(s=!1,a=n+1),o>=0&&(c===t.charCodeAt(o)?--o===-1&&(r=n):(o=-1,r=a))}return i===r?r=a:r===-1&&(r=e.length),e.slice(i,r)}for(n=e.length-1;n>=0;--n)if(e.charCodeAt(n)===hi){if(!s){i=n+1;break}}else r===-1&&(s=!1,r=n+1);return r===-1?"":e.slice(i,r)},extname(e){Vt(e,"path");let t=-1,i=0,r=-1,s=!0,n=0;for(let o=e.length-1;o>=0;--o){const a=e[o];if(a==="/"){if(!s){i=o+1;break}continue}r===-1&&(s=!1,r=o+1),a==="."?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||r===-1||n===0||n===1&&t===r-1&&t===i+1?"":e.slice(t,r)},format:kE.bind(null,"/"),parse(e){Vt(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;const i=e.charCodeAt(0)===hi;let r;i?(t.root="/",r=1):r=0;let s=-1,n=0,o=-1,a=!0,c=e.length-1,l=0;for(;c>=r;--c){const u=e.charCodeAt(c);if(u===hi){if(!a){n=c+1;break}continue}o===-1&&(a=!1,o=c+1),u===Uo?s===-1?s=c:l!==1&&(l=1):s!==-1&&(l=-1)}if(o!==-1){const u=n===0&&i?1:n;s===-1||l===0||l===1&&s===o-1&&s===n+1?t.base=t.name=e.slice(u,o):(t.name=e.slice(u,s),t.base=e.slice(u,o),t.ext=e.slice(s,o))}return n>0?t.dir=e.slice(0,n-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Be.win32=qt.win32=qt,Be.posix=qt.posix=Be;var Zs=Xi?qt.normalize:Be.normalize,xr=Xi?qt.isAbsolute:Be.isAbsolute,_e=Xi?qt.join:Be.join,VL=Xi?qt.resolve:Be.resolve,tc=Xi?qt.relative:Be.relative,Mi=Xi?qt.dirname:Be.dirname,At=Xi?qt.basename:Be.basename,Xd=Xi?qt.extname:Be.extname,vee=Xi?qt.format:Be.format,wee=Xi?qt.parse:Be.parse,bee=Xi?qt.toNamespacedPath:Be.toNamespacedPath,St=Xi?qt.sep:Be.sep,CE=Xi?qt.delimiter:Be.delimiter;function qL(e){return e}var GL=class{constructor(e,t){this.a=void 0,this.b=void 0,typeof e=="function"?(this.c=e,this.d=qL):(this.c=t,this.d=e.getCacheKey)}get(e){const t=this.d(e);return this.b!==t&&(this.b=t,this.a=this.c(e)),this.a}},Nn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Completed=2]="Completed"})(Nn||(Nn={}));var Pt=class{constructor(e){this.d=e,this.a=Nn.Uninitialized}get hasValue(){return this.a===Nn.Completed}get value(){if(this.a===Nn.Uninitialized){this.a=Nn.Running;try{this.b=this.d()}catch(e){this.c=e}finally{this.a=Nn.Completed}}else if(this.a===Nn.Running)throw new Error("Cannot read the value of a lazy that is being initialized");if(this.c)throw this.c;return this.b}get rawValue(){return this.b}};function nu(e){return!e||typeof e!="string"?!0:e.trim().length===0}var ZL=/{([^}]+)}/g;function $E(e,t){return Object.keys(t).length===0?e:e.replace(ZL,(i,r)=>t[r]??i)}function Rn(e){return e.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function JL(e,t){let i=0,r=e.indexOf(t);for(;r!==-1;)i++,r=e.indexOf(t,r+t.length);return i}function QL(e,t){if(!e||!t)return e;const i=t.length;let r=0;if(i===1){const s=t.charCodeAt(0);for(;r<e.length&&e.charCodeAt(r)===s;)r++}else for(;e.startsWith(t,r);)r+=i;return e.substring(r)}function Ln(e,t){if(!e||!t)return e;const i=t.length,r=e.length;if(i===1){let n=r;const o=t.charCodeAt(0);for(;n>0&&e.charCodeAt(n-1)===o;)n--;return e.substring(0,n)}let s=r;for(;s>0&&e.endsWith(t,s);)s-=i;return e.substring(0,s)}function IE(e,t,i={}){if(!e)throw new Error("Cannot create regex from empty string");t||(e=Rn(e)),i.wholeWord&&(/\B/.test(e.charAt(0))||(e="\\b"+e),/\B/.test(e.charAt(e.length-1))||(e=e+"\\b"));let r="";return i.global&&(r+="g"),i.matchCase||(r+="i"),i.multiline&&(r+="m"),i.unicode&&(r+="u"),new RegExp(e,r)}function DE(e){return e.source==="^"||e.source==="^$"||e.source==="$"||e.source==="^\\s*$"?!1:!!(e.exec("")&&e.lastIndex===0)}function PE(e){return e.split(/\r\n|\r|\n/)}function Pv(e){for(let t=0,i=e.length;t<i;t++){const r=e.charCodeAt(t);if(r!==32&&r!==9)return t}return-1}function YL(e,t=e.length-1){for(let i=t;i>=0;i--){const r=e.charCodeAt(i);if(r!==32&&r!==9)return i}return-1}function jo(e,t){return e<t?-1:e>t?1:0}function Tv(e,t,i=0,r=e.length,s=0,n=t.length){for(;i<r&&s<n;i++,s++){const c=e.charCodeAt(i),l=t.charCodeAt(s);if(c<l)return-1;if(c>l)return 1}const o=r-i,a=n-s;return o<a?-1:o>a?1:0}function Mv(e,t){return ic(e,t,0,e.length,0,t.length)}function ic(e,t,i=0,r=e.length,s=0,n=t.length){for(;i<r&&s<n;i++,s++){let c=e.charCodeAt(i),l=t.charCodeAt(s);if(c===l)continue;if(c>=128||l>=128)return Tv(e.toLowerCase(),t.toLowerCase(),i,r,s,n);TE(c)&&(c-=32),TE(l)&&(l-=32);const u=c-l;if(u!==0)return u}const o=r-i,a=n-s;return o<a?-1:o>a?1:0}function TE(e){return e>=97&&e<=122}function ME(e){return e>=65&&e<=90}function kr(e,t){return e.length===t.length&&ic(e,t)===0}function Kd(e,t){const i=t.length;return i<=e.length&&ic(e,t,0,i)===0}function XL(e,t){const i=e.length,r=i-t.length;return r>=0&&ic(e,t,r,i)===0}function KL(e,t){const i=Math.min(e.length,t.length);let r;for(r=0;r<i;r++)if(e.charCodeAt(r)!==t.charCodeAt(r))return r;return i}function ef(e){return 55296<=e&&e<=56319}function tf(e){return 56320<=e&&e<=57343}function Nv(e,t){return(e-55296<<10)+(t-56320)+65536}function NE(e,t,i){const r=e.charCodeAt(i);if(ef(r)&&i+1<t){const s=e.charCodeAt(i+1);if(tf(s))return Nv(r,s)}return r}function e2(e,t){const i=e.charCodeAt(t-1);if(tf(i)&&t>1){const r=e.charCodeAt(t-2);if(ef(r))return Nv(r,i)}return i}var t2=class{get offset(){return this.e}constructor(e,t=0){this.c=e,this.d=e.length,this.e=t}setOffset(e){this.e=e}prevCodePoint(){const e=e2(this.c,this.e);return this.e-=e>=65536?2:1,e}nextCodePoint(){const e=NE(this.c,this.d,this.e);return this.e+=e>=65536?2:1,e}eol(){return this.e>=this.d}},i2=class{get offset(){return this.c.offset}constructor(e,t=0){this.c=new t2(e,t)}nextGraphemeLength(){const e=zE.getInstance(),t=this.c,i=t.offset;let r=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,n=e.getGraphemeBreakType(t.nextCodePoint());if(UE(r,n)){t.setOffset(s);break}r=n}return t.offset-i}prevGraphemeLength(){const e=zE.getInstance(),t=this.c,i=t.offset;let r=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,n=e.getGraphemeBreakType(t.prevCodePoint());if(UE(n,r)){t.setOffset(s);break}r=n}return i-t.offset}eol(){return this.c.eol()}};function RE(e,t){return new i2(e,t).nextGraphemeLength()}var Rv=void 0;function r2(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function LE(e){return Rv||(Rv=r2()),Rv.test(e)}var s2=/^[\t\n\r\x20-\x7E]*$/;function n2(e){return s2.test(e)}var o2=/[\u2028\u2029]/;function OE(e){return o2.test(e)}var a2=/(?:\x1b\[|\x9b)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/,c2=/(?:\x1b\]|\x9d).*?(?:\x1b\\|\x07|\x9c)/,l2=/\x1b(?:[ #%\(\)\*\+\-\.\/]?[a-zA-Z0-9\|}~@])/,yee=new RegExp("(?:"+[a2.source,c2.source,l2.source].join("|")+")","g"),u2="\uFEFF";function h2(e){return!!(e&&e.length>0&&e.charCodeAt(0)===65279)}function d2(e,t){if(!e||!t||e.length<t.length)return!1;const i=t.length,r=e.toLowerCase();let s=0,n=-1;for(;s<i;){const o=r.indexOf(t[s],n+1);if(o<0)return!1;n=o,s++}return!0}function FE(e,t=!1){return e?(t&&(e=e.replace(/\\./g,"")),e.toLowerCase()!==e):!1}function f2(e){return e.charAt(0).toUpperCase()+e.slice(1)}function p2(e,t=1){if(t===0)return"";let i=-1;do i=e.indexOf(`
`,i+1),t--;while(t>0&&i>=0);return i===-1?e:(e[i-1]==="\r"&&i--,e.substr(0,i))}function UE(e,t){return e===0?t!==5&&t!==7:e===2&&t===3?!1:e===4||e===2||e===3||t===4||t===2||t===3?!0:!(e===8&&(t===8||t===9||t===11||t===12)||(e===11||e===9)&&(t===9||t===10)||(e===12||e===10)&&t===10||t===5||t===13||t===7||e===1||e===13&&t===14||e===6&&t===6)}var jE;(function(e){e[e.Other=0]="Other",e[e.Prepend=1]="Prepend",e[e.CR=2]="CR",e[e.LF=3]="LF",e[e.Control=4]="Control",e[e.Extend=5]="Extend",e[e.Regional_Indicator=6]="Regional_Indicator",e[e.SpacingMark=7]="SpacingMark",e[e.L=8]="L",e[e.V=9]="V",e[e.T=10]="T",e[e.LV=11]="LV",e[e.LVT=12]="LVT",e[e.ZWJ=13]="ZWJ",e[e.Extended_Pictographic=14]="Extended_Pictographic"})(jE||(jE={}));var zE=class Dd{static{this.c=null}static getInstance(){return Dd.c||(Dd.c=new Dd),Dd.c}constructor(){this.d=g2()}getGraphemeBreakType(t){if(t<32)return t===10?3:t===13?2:4;if(t<127)return 0;const i=this.d,r=i.length/3;let s=1;for(;s<=r;)if(t<i[3*s])s=2*s;else if(t>i[3*s+1])s=2*s+1;else return i[3*s+2];return 0}};function g2(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var HE;(function(e){e[e.zwj=8205]="zwj",e[e.emojiVariantSelector=65039]="emojiVariantSelector",e[e.enclosingKeyCap=8419]="enclosingKeyCap",e[e.space=32]="space"})(HE||(HE={}));var Aee=class Pd{static{this.c=new Pt(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}'))}static{this.d=new GL(t=>{const i=t.split(",");function r(h){const f=new Map;for(let p=0;p<h.length;p+=2)f.set(h[p],h[p+1]);return f}function s(h,f){const p=new Map(h);for(const[g,v]of f)p.set(g,v);return p}function n(h,f){if(!h)return f;const p=new Map;for(const[g,v]of h)f.has(g)&&p.set(g,v);return p}const o=this.c.value;let a=i.filter(h=>!h.startsWith("_")&&Object.hasOwn(o,h));a.length===0&&(a=["_default"]);let c;for(const h of a){const f=r(o[h]);c=n(c,f)}const l=r(o._common),u=s(l,c);return new Pd(u)})}static getInstance(t){return Pd.d.get(Array.from(t).join(","))}static{this.e=new Pt(()=>Object.keys(Pd.c.value).filter(t=>!t.startsWith("_")))}static getLocales(){return Pd.e.value}constructor(t){this.f=t}isAmbiguous(t){return this.f.has(t)}containsAmbiguousCharacter(t){for(let i=0;i<t.length;i++){const r=t.codePointAt(i);if(typeof r=="number"&&this.isAmbiguous(r))return!0}return!1}getPrimaryConfusable(t){return this.f.get(t)}getConfusableCodePoints(){return new Set(this.f.keys())}},See=class Td{static c(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static{this.d=void 0}static e(){return this.d||(this.d=new Set([...Object.values(Td.c())].flat())),this.d}static isInvisibleCharacter(t){return Td.e().has(t)}static containsInvisibleCharacter(t){for(let i=0;i<t.length;i++){const r=t.codePointAt(i);if(typeof r=="number"&&(Td.isInvisibleCharacter(r)||r===32))return!0}return!1}static get codePoints(){return Td.e()}};function On(e){return e===47||e===92}function WE(e){return e.replace(/[\\/]/g,Be.sep)}function m2(e){return e.indexOf("/")===-1&&(e=WE(e)),/^[a-zA-Z]:(\/|$)/.test(e)&&(e="/"+e),e}function Lv(e,t=Be.sep){if(!e)return"";const i=e.length,r=e.charCodeAt(0);if(On(r)){if(On(e.charCodeAt(1))&&!On(e.charCodeAt(2))){let n=3;const o=n;for(;n<i&&!On(e.charCodeAt(n));n++);if(o!==n&&!On(e.charCodeAt(n+1))){for(n+=1;n<i;n++)if(On(e.charCodeAt(n)))return e.slice(0,n+1).replace(/[\\/]/g,t)}}return t}else if(BE(r)&&e.charCodeAt(1)===58)return On(e.charCodeAt(2))?e.slice(0,2)+t:e.slice(0,2);let s=e.indexOf("://");if(s!==-1){for(s+=3;s<i;s++)if(On(e.charCodeAt(s)))return e.slice(0,s+1)}return""}var v2=/[\\/:\*\?"<>\|]/g,w2=/[/]/g,b2=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function y2(e,t=ze){const i=t?v2:w2;return!(!e||e.length===0||/^\s+$/.test(e)||(i.lastIndex=0,i.test(e))||t&&b2.test(e)||e==="."||e===".."||t&&e[e.length-1]==="."||t&&e.length!==e.trim().length||e.length>255)}function rf(e,t,i){const r=e===t;return!i||r?r:!e||!t?!1:kr(e,t)}function zo(e,t,i,r=St){if(e===t)return!0;if(!e||!t||t.length>e.length)return!1;if(i){if(!Kd(e,t))return!1;if(t.length===e.length)return!0;let n=t.length;return t.charAt(t.length-1)===r&&n--,e.charAt(n)===r}return t.charAt(t.length-1)!==r&&(t+=r),e.indexOf(t)===0}function BE(e){return e>=65&&e<=90||e>=97&&e<=122}function A2(e){return ze?(e=Ln(e,St),e.endsWith(":")&&(e+=St)):(e=Ln(e,St),e||(e=St)),e}function _E(e){const t=Zs(e);return ze?e.length>3?!1:Ov(t)&&(e.length===2||t.charCodeAt(2)===92):t===Be.sep}function Ov(e,t=ze){return t?BE(e.charCodeAt(0))&&e.charCodeAt(1)===58:!1}function VE(e,t=ze){return Ov(e,t)?e[0]:void 0}var S2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",E2="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function x2(e,t,i=8){let r="";for(let n=0;n<i;n++){let o;n===0&&ze&&!t&&(i===3||i===4)?o=E2:o=S2,r+=o.charAt(Math.floor(Math.random()*o.length))}let s;return t?s=`${t}-${r}`:s=r,e?_e(e,s):s}var k2=/^\w[\w\d+.-]*$/,C2=/^\//,$2=/^\/\//;function I2(e,t){if(!e.scheme&&t)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${e.authority}", path: "${e.path}", query: "${e.query}", fragment: "${e.fragment}"}`);if(e.scheme&&!k2.test(e.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(e.path){if(e.authority){if(!C2.test(e.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if($2.test(e.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function D2(e,t){return!e&&!t?"file":e}function P2(e,t){switch(e){case"https":case"http":case"file":t?t[0]!==_r&&(t=_r+t):t=_r;break}return t}var Et="",_r="/",T2=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,y=class W1{static isUri(t){return t instanceof W1?!0:!t||typeof t!="object"?!1:typeof t.authority=="string"&&typeof t.fragment=="string"&&typeof t.path=="string"&&typeof t.query=="string"&&typeof t.scheme=="string"&&typeof t.fsPath=="string"&&typeof t.with=="function"&&typeof t.toString=="function"}constructor(t,i,r,s,n,o=!1){typeof t=="object"?(this.scheme=t.scheme||Et,this.authority=t.authority||Et,this.path=t.path||Et,this.query=t.query||Et,this.fragment=t.fragment||Et):(this.scheme=D2(t,o),this.authority=i||Et,this.path=P2(this.scheme,r||Et),this.query=s||Et,this.fragment=n||Et,I2(this,o))}get fsPath(){return nf(this,!1)}with(t){if(!t)return this;let{scheme:i,authority:r,path:s,query:n,fragment:o}=t;return i===void 0?i=this.scheme:i===null&&(i=Et),r===void 0?r=this.authority:r===null&&(r=Et),s===void 0?s=this.path:s===null&&(s=Et),n===void 0?n=this.query:n===null&&(n=Et),o===void 0?o=this.fragment:o===null&&(o=Et),i===this.scheme&&r===this.authority&&s===this.path&&n===this.query&&o===this.fragment?this:new rc(i,r,s,n,o)}static parse(t,i=!1){const r=T2.exec(t);return r?new rc(r[2]||Et,of(r[4]||Et),of(r[5]||Et),of(r[7]||Et),of(r[9]||Et),i):new rc(Et,Et,Et,Et,Et)}static file(t){let i=Et;if(ze&&(t=t.replace(/\\/g,_r)),t[0]===_r&&t[1]===_r){const r=t.indexOf(_r,2);r===-1?(i=t.substring(2),t=_r):(i=t.substring(2,r),t=t.substring(r)||_r)}return new rc("file",i,t,Et,Et)}static from(t,i){return new rc(t.scheme,t.authority,t.path,t.query,t.fragment,i)}static joinPath(t,...i){if(!t.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let r;return ze&&t.scheme==="file"?r=W1.file(qt.join(nf(t,!0),...i)).path:r=Be.join(t.path,...i),t.with({path:r})}toString(t=!1){return Fv(this,t)}toJSON(){return this}static revive(t){if(t){if(t instanceof W1)return t;{const i=new rc(t);return i._formatted=t.external??null,i._fsPath=t._sep===qE?t.fsPath??null:null,i}}else return t}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}};function sf(e){return!e||typeof e!="object"?!1:typeof e.scheme=="string"&&(typeof e.authority=="string"||typeof e.authority>"u")&&(typeof e.path=="string"||typeof e.path>"u")&&(typeof e.query=="string"||typeof e.query>"u")&&(typeof e.fragment=="string"||typeof e.fragment>"u")}var qE=ze?1:void 0,rc=class extends y{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=nf(this,!1)),this._fsPath}toString(e=!1){return e?Fv(this,!0):(this._formatted||(this._formatted=Fv(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=qE),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}},GE={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function ZE(e,t,i){let r,s=-1;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||t&&o===47||i&&o===91||i&&o===93||i&&o===58)s!==-1&&(r+=encodeURIComponent(e.substring(s,n)),s=-1),r!==void 0&&(r+=e.charAt(n));else{r===void 0&&(r=e.substr(0,n));const a=GE[o];a!==void 0?(s!==-1&&(r+=encodeURIComponent(e.substring(s,n)),s=-1),r+=a):s===-1&&(s=n)}}return s!==-1&&(r+=encodeURIComponent(e.substring(s))),r!==void 0?r:e}function M2(e){let t;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);r===35||r===63?(t===void 0&&(t=e.substr(0,i)),t+=GE[r]):t!==void 0&&(t+=e[i])}return t!==void 0?t:e}function nf(e,t){let i;return e.authority&&e.path.length>1&&e.scheme==="file"?i=`//${e.authority}${e.path}`:e.path.charCodeAt(0)===47&&(e.path.charCodeAt(1)>=65&&e.path.charCodeAt(1)<=90||e.path.charCodeAt(1)>=97&&e.path.charCodeAt(1)<=122)&&e.path.charCodeAt(2)===58?t?i=e.path.substr(1):i=e.path[1].toLowerCase()+e.path.substr(2):i=e.path,ze&&(i=i.replace(/\//g,"\\")),i}function Fv(e,t){const i=t?M2:ZE;let r="",{scheme:s,authority:n,path:o,query:a,fragment:c}=e;if(s&&(r+=s,r+=":"),(n||s==="file")&&(r+=_r,r+=_r),n){let l=n.indexOf("@");if(l!==-1){const u=n.substr(0,l);n=n.substr(l+1),l=u.lastIndexOf(":"),l===-1?r+=i(u,!1,!1):(r+=i(u.substr(0,l),!1,!1),r+=":",r+=i(u.substr(l+1),!1,!0)),r+="@"}n=n.toLowerCase(),l=n.lastIndexOf(":"),l===-1?r+=i(n,!1,!0):(r+=i(n.substr(0,l),!1,!0),r+=n.substr(l))}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const l=o.charCodeAt(1);l>=65&&l<=90&&(o=`/${String.fromCharCode(l+32)}:${o.substr(3)}`)}else if(o.length>=2&&o.charCodeAt(1)===58){const l=o.charCodeAt(0);l>=65&&l<=90&&(o=`${String.fromCharCode(l+32)}:${o.substr(2)}`)}r+=i(o,!0,!1)}return a&&(r+="?",r+=i(a,!1,!1)),c&&(r+="#",r+=t?c:ZE(c,!1,!1)),r}function JE(e){try{return decodeURIComponent(e)}catch{return e.length>3?e.substr(0,3)+JE(e.substr(3)):e}}var QE=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function of(e){return e.match(QE)?e.replace(QE,t=>JE(t)):e}var q;(function(e){e.inMemory="inmemory",e.vscode="vscode",e.internal="private",e.walkThrough="walkThrough",e.walkThroughSnippet="walkThroughSnippet",e.http="http",e.https="https",e.file="file",e.mailto="mailto",e.untitled="untitled",e.data="data",e.command="command",e.vscodeRemote="vscode-remote",e.vscodeRemoteResource="vscode-remote-resource",e.vscodeManagedRemoteResource="vscode-managed-remote-resource",e.vscodeUserData="vscode-userdata",e.vscodeCustomEditor="vscode-custom-editor",e.vscodeNotebookCell="vscode-notebook-cell",e.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",e.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",e.vscodeNotebookCellOutput="vscode-notebook-cell-output",e.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",e.vscodeNotebookMetadata="vscode-notebook-metadata",e.vscodeInteractiveInput="vscode-interactive-input",e.vscodeSettings="vscode-settings",e.vscodeWorkspaceTrust="vscode-workspace-trust",e.vscodeTerminal="vscode-terminal",e.vscodeChatCodeBlock="vscode-chat-code-block",e.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",e.vscodeChatEditor="vscode-chat-editor",e.vscodeChatInput="chatSessionInput",e.vscodeLocalChatSession="vscode-chat-session",e.webviewPanel="webview-panel",e.vscodeWebview="vscode-webview",e.extension="extension",e.vscodeFileResource="vscode-file",e.tmp="tmp",e.vsls="vsls",e.vscodeSourceControl="vscode-scm",e.commentsInput="comment",e.codeSetting="code-setting",e.outputChannel="output",e.accessibleView="accessible-view",e.chatEditingSnapshotScheme="chat-editing-snapshot-text-model",e.chatEditingModel="chat-editing-text-model",e.copilotPr="copilot-pr"})(q||(q={}));function Uv(e,t){return y.isUri(e)?kr(e.scheme,t):Kd(e,t+":")}function N2(e,...t){return t.some(i=>Uv(e,i))}var R2="tkn",L2=class{constructor(){this.a=Object.create(null),this.b=Object.create(null),this.c=Object.create(null),this.d="http",this.e=null,this.f="/"}setPreferredWebSchema(e){this.d=e}setDelegate(e){this.e=e}setServerRootPath(e,t){this.f=Be.join(t??"/",O2(e))}getServerRootPath(){return this.f}get g(){return Be.join(this.f,q.vscodeRemoteResource)}set(e,t,i){this.a[e]=t,this.b[e]=i}setConnectionToken(e,t){this.c[e]=t}getPreferredWebSchema(){return this.d}rewrite(e){if(this.e)try{return this.e(e)}catch(o){return lt(o),e}const t=e.authority;let i=this.a[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const r=this.b[t],s=this.c[t];let n=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(n+=`&${R2}=${encodeURIComponent(s)}`),y.from({scheme:No?this.d:q.vscodeRemoteResource,authority:`${i}:${r}`,path:this.g,query:n})}},YE=new L2;function O2(e){return`${e.quality??"oss"}-${e.commit??"dev"}`}var F2="vs/../../node_modules",U2="vs/../../node_modules.asar",XE="vscode-app",j2=class B1{static{this.a=XE}asBrowserUri(t){const i=this.b(t);return this.uriToBrowserUri(i)}uriToBrowserUri(t){return t.scheme===q.vscodeRemote?YE.rewrite(t):t.scheme===q.file&&(mE||DL===`${q.vscodeFileResource}://${B1.a}`)?t.with({scheme:q.vscodeFileResource,authority:t.authority||B1.a,query:null,fragment:null}):t}asFileUri(t){const i=this.b(t);return this.uriToFileUri(i)}uriToFileUri(t){return t.scheme===q.vscodeFileResource?t.with({scheme:q.file,authority:t.authority!==B1.a?t.authority:null,query:null,fragment:null}):t}b(t){if(y.isUri(t))return t;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return y.joinPath(y.parse(i,!0),t);const r=_e(i,t);return y.file(r)}throw new Error("Cannot determine URI for module id!")}},af=new j2,Eee=Object.freeze({"Cache-Control":"no-cache, no-store"}),xee=Object.freeze({"Document-Policy":"include-js-call-stacks-in-crash-reports"}),KE;(function(e){const t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);e.CoopAndCoep=Object.freeze(t.get("3"));const i="vscode-coi";function r(n){let o;typeof n=="string"?o=new URL(n).searchParams:n instanceof URL?o=n.searchParams:y.isUri(n)&&(o=new URL(n.toString(!0)).searchParams);const a=o?.get(i);if(a)return t.get(a)}e.getHeadersFromQuery=r;function s(n,o,a){if(!globalThis.crossOriginIsolated)return;const c=o&&a?"3":a?"2":"1";n instanceof URLSearchParams?n.set(i,c):n[i]=c}e.addSearchParam=s})(KE||(KE={}));function Vr(e){return nf(e,!0)}var sc=class{constructor(e){this.a=e}compare(e,t,i=!1){return e===t?0:jo(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this.a(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this.a(e)}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===q.file)return zo(Vr(e),Vr(t),this.a(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(ix(e.authority,t.authority))return zo(e.path,t.path,this.a(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return y.joinPath(e,...t)}basenameOrAuthority(e){return dr(e)||e.authority}basename(e){return Be.basename(e.path)}extname(e){return Be.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===q.file?t=y.file(Mi(Vr(e))).path:(t=Be.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===q.file?t=y.file(Zs(Vr(e))).path:t=Be.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!ix(e.authority,t.authority))return;if(e.scheme===q.file){const s=tc(Vr(e),Vr(t));return ze?WE(s):s}let i=e.path||"/";const r=t.path||"/";if(this.a(e)){let s=0;for(const n=Math.min(i.length,r.length);s<n&&!(i.charCodeAt(s)!==r.charCodeAt(s)&&i.charAt(s).toLowerCase()!==r.charAt(s).toLowerCase());s++);i=r.substr(0,s)+i.substr(s)}return Be.relative(i,r)}resolvePath(e,t){if(e.scheme===q.file){const i=y.file(VL(Vr(e),t));return e.with({authority:i.authority,path:i.path})}return t=m2(t),e.with({path:Be.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&kr(e,t)}hasTrailingPathSeparator(e,t=St){if(e.scheme===q.file){const i=Vr(e);return i.length>Lv(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=St){return rx(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=St){let i=!1;if(e.scheme===q.file){const r=Vr(e);i=r!==void 0&&r.length===Lv(r).length&&r[r.length-1]===t}else{t="/";const r=e.path;i=r.length===1&&r.charCodeAt(r.length-1)===47}return!i&&!rx(e,t)?e.with({path:e.path+"/"}):e}},Ke=new sc(()=>!1),jv=new sc(e=>e.scheme===q.file?!$t:!0),z2=new sc(e=>!0),nc=Ke.isEqual.bind(Ke),kee=Ke.isEqualOrParent.bind(Ke),Cee=Ke.getComparisonKey.bind(Ke),zv=Ke.basenameOrAuthority.bind(Ke),dr=Ke.basename.bind(Ke),ex=Ke.extname.bind(Ke),ou=Ke.dirname.bind(Ke),It=Ke.joinPath.bind(Ke),$ee=Ke.normalizePath.bind(Ke),tx=Ke.relativePath.bind(Ke),Iee=Ke.resolvePath.bind(Ke),H2=Ke.isAbsolutePath.bind(Ke),ix=Ke.isEqualAuthority.bind(Ke),rx=Ke.hasTrailingPathSeparator.bind(Ke),Dee=Ke.removeTrailingPathSeparator.bind(Ke),Pee=Ke.addTrailingPathSeparator.bind(Ke),sx;(function(e){e.META_DATA_LABEL="label",e.META_DATA_DESCRIPTION="description",e.META_DATA_SIZE="size",e.META_DATA_MIME="mime";function t(i){const r=new Map;i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";")).split(";").forEach(o=>{const[a,c]=o.split(":");a&&c&&r.set(a,c)});const n=i.path.substring(0,i.path.indexOf(";"));return n&&r.set(e.META_DATA_MIME,n),r}e.parseMetaData=t})(sx||(sx={}));var W2=Symbol("MicrotaskDelay");function Fn(e){return!!e&&typeof e.then=="function"}function Js(e){const t=new Qe,i=e(t.token);let r=!1;const s=new Promise((n,o)=>{const a=t.token.onCancellationRequested(()=>{r=!0,a.dispose(),o(new dt)});Promise.resolve(i).then(c=>{a.dispose(),t.dispose(),r?iE(c)&&c.dispose():n(c)},c=>{a.dispose(),t.dispose(),o(c)})});return new class{cancel(){t.cancel(),t.dispose()}then(n,o){return s.then(n,o)}catch(n){return this.then(void 0,n)}finally(n){return s.finally(n)}}}function B2(e,t,i){return new Promise((r,s)=>{const n=t.onCancellationRequested(()=>{n.dispose(),r(i)});e.then(r,s).finally(()=>n.dispose())})}function cf(e,t){return new Promise((i,r)=>{const s=t.onCancellationRequested(()=>{s.dispose(),r(new dt)});e.then(i,r).finally(()=>s.dispose())})}function di(e){return new Promise((t,i)=>{const r=e();Fn(r)?r.then(t,i):t(r)})}function nx(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}var _2=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=new Qe}queue(e){if(this.f.token.isCancellationRequested)return Promise.reject(new Error("Throttler is disposed"));if(this.a){if(this.d=e,!this.b){const t=()=>{if(this.b=null,this.f.token.isCancellationRequested)return;const i=this.queue(this.d);return this.d=null,i};this.b=new Promise(i=>{this.a.then(t,t).then(i)})}return new Promise((t,i)=>{this.b.then(t,i)})}return this.a=e(this.f.token),new Promise((t,i)=>{this.a.then(r=>{this.a=null,t(r)},r=>{this.a=null,i(r)})})}dispose(){this.f.cancel()}},V2=class{constructor(){this.a=Promise.resolve(null)}queue(e){return this.a=this.a.then(()=>e(),()=>e())}},ox=class{constructor(){this.a=new Map}queue(e,t){const r=(this.a.get(e)??Promise.resolve()).catch(()=>{}).then(t).finally(()=>{this.a.get(e)===r&&this.a.delete(e)});return this.a.set(e,r),r}peek(e){return this.a.get(e)||void 0}keys(){return this.a.keys()}},q2=(e,t)=>{let i=!0;const r=setTimeout(()=>{i=!1,t()},e);return{isTriggered:()=>i,dispose:()=>{clearTimeout(r),i=!1}}},G2=e=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,e())}),{isTriggered:()=>t,dispose:()=>{t=!1}}},ax=class{constructor(e){this.defaultDelay=e,this.a=null,this.b=null,this.d=null,this.f=null,this.g=null}trigger(e,t=this.defaultDelay){this.g=e,this.h(),this.b||(this.b=new Promise((r,s)=>{this.d=r,this.f=s}).then(()=>{if(this.b=null,this.d=null,this.g){const r=this.g;return this.g=null,r()}}));const i=()=>{this.a=null,this.d?.(null)};return this.a=t===W2?G2(i):q2(t,i),this.b}isTriggered(){return!!this.a?.isTriggered()}cancel(){this.h(),this.b&&(this.f?.(new dt),this.b=null)}h(){this.a?.dispose(),this.a=null}dispose(){this.cancel()}},au=class{constructor(e){this.a=new ax(e),this.b=new _2}trigger(e,t){return this.a.trigger(()=>this.b.queue(e),t)}isTriggered(){return this.a.isTriggered()}cancel(){this.a.cancel()}dispose(){this.a.dispose(),this.b.dispose()}},fr=class{constructor(){this.a=!1,this.b=new Promise((e,t)=>{this.d=e})}isOpen(){return this.a}open(){this.a=!0,this.d(!0)}wait(){return this.b}};function ri(e,t){return t?new Promise((i,r)=>{const s=setTimeout(()=>{n.dispose(),i()},e),n=t.onCancellationRequested(()=>{clearTimeout(s),n.dispose(),r(new dt)})}):Js(i=>ri(e,i))}function Hv(e,t=0,i){const r=setTimeout(()=>{e(),i&&s.dispose()},t),s=te(()=>{clearTimeout(r),i?.delete(s)});return i?.add(s),s}function Z2(e,t=r=>!!r,i=null){if(e.length===0)return Promise.resolve(i);let r=e.length;const s=()=>{r=-1;for(const n of e)n.cancel?.()};return new Promise((n,o)=>{for(const a of e)a.then(c=>{--r>=0&&t(c)?(s(),n(c)):r===0&&n(i)}).catch(c=>{--r>=0&&(s(),o(c))})})}var J2=class{constructor(e){this.a=0,this.b=!1,this.f=e,this.g=[],this.d=0,this.h=new I}whenIdle(){return this.size>0?Ie.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this.h.event}get size(){return this.a}queue(e){if(this.b)throw new Error("Object has been disposed");return this.a++,new Promise((t,i)=>{this.g.push({factory:e,c:t,e:i}),this.j()})}j(){for(;this.g.length&&this.d<this.f;){const e=this.g.shift();this.d++;const t=e.factory();t.then(e.c,e.e),t.then(()=>this.k(),()=>this.k())}}k(){this.b||(this.d--,--this.a===0&&this.h.fire(),this.g.length>0&&this.j())}clear(){if(this.b)throw new Error("Object has been disposed");this.g.length=0,this.a=this.d}dispose(){this.b=!0,this.g.length=0,this.a=0,this.h.dispose()}},Q2=class extends J2{constructor(){super(1)}},cx=class{constructor(){this.a=new Map,this.b=new Set,this.d=void 0,this.f=0}async whenDrained(){if(this.g())return;const e=new Ni;return this.b.add(e),e.p}g(){for(const[,e]of this.a)if(e.size>0)return!1;return!0}queueSize(e,t=Ke){const i=t.getComparisonKey(e);return this.a.get(i)?.size??0}queueFor(e,t,i=Ke){const r=i.getComparisonKey(e);let s=this.a.get(r);if(!s){s=new Q2;const n=this.f++,o=Ie.once(s.onDrained)(()=>{s?.dispose(),this.a.delete(r),this.h(),this.d?.deleteAndDispose(n),this.d?.size===0&&(this.d.dispose(),this.d=void 0)});this.d||(this.d=new Mo),this.d.set(n,o),this.a.set(r,s)}return s.queue(t)}h(){this.g()&&this.j()}j(){for(const e of this.b)e.complete();this.b.clear()}dispose(){for(const[,e]of this.a)e.dispose();this.a.clear(),this.j(),this.d?.dispose()}},lx=class{constructor(e,t){this.b=!1,this.a=void 0,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this.b=!0}cancel(){this.a!==void 0&&(clearTimeout(this.a),this.a=void 0)}cancelAndSet(e,t){if(this.b)throw new wi("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this.a=setTimeout(()=>{this.a=void 0,e()},t)}setIfNotSet(e,t){if(this.b)throw new wi("Calling 'setIfNotSet' on a disposed TimeoutTimer");this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}},ux=class{constructor(){this.g=void 0,this.j=!1}cancel(){this.g?.dispose(),this.g=void 0}cancelAndSet(e,t,i=globalThis){if(this.j)throw new wi("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const r=i.setInterval(()=>{e()},t);this.g=te(()=>{i.clearInterval(r),this.g=void 0})}dispose(){this.cancel(),this.j=!0}},vs=class{constructor(e,t){this.b=void 0,this.a=e,this.d=t,this.f=this.g.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearTimeout(this.b),this.b=void 0)}schedule(e=this.d){this.cancel(),this.b=setTimeout(this.f,e)}get delay(){return this.d}set delay(e){this.d=e}isScheduled(){return this.b!==void 0}flush(){this.isScheduled()&&(this.cancel(),this.h())}g(){this.b=void 0,this.a&&this.h()}h(){this.a?.()}},hx=class{constructor(e,t){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.a=e,this.b=t,this.d=0,this.f=void 0,this.g=this.h.bind(this)}dispose(){this.cancel(),this.a=null}cancel(){this.isScheduled()&&(clearInterval(this.f),this.f=void 0)}schedule(e=this.b){e%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${e}ms is not a multiple of 1000ms.`),this.cancel(),this.d=Math.ceil(e/1e3),this.f=setInterval(this.g,1e3)}isScheduled(){return this.f!==void 0}h(){this.d--,!(this.d>0)&&(clearInterval(this.f),this.f=void 0,this.a?.())}},Y2=class extends vs{constructor(e,t){super(e,t),this.j=[]}work(e){this.j.push(e),this.isScheduled()||this.schedule()}h(){const e=this.j;this.j=[],this.a?.(e)}dispose(){this.j=[],super.dispose()}},dx=class extends Q{constructor(e,t){super(),this.h=e,this.j=t,this.a=[],this.b=this.D(new Br),this.f=!1,this.g=0}get pending(){return this.a.length}work(e){if(this.f)return!1;if(typeof this.h.maxBufferedWork=="number"){if(this.b.value){if(this.pending+e.length>this.h.maxBufferedWork)return!1}else if(this.pending+e.length-this.h.maxWorkChunkSize>this.h.maxBufferedWork)return!1}for(const i of e)this.a.push(i);const t=Date.now()-this.g;return!this.b.value&&(!this.h.waitThrottleDelayBetweenWorkUnits||t>=this.h.throttleDelay)?this.m():!this.b.value&&this.h.waitThrottleDelayBetweenWorkUnits&&this.q(Math.max(this.h.throttleDelay-t,0)),!0}m(){this.g=Date.now(),this.j(this.a.splice(0,this.h.maxWorkChunkSize)),this.a.length>0&&this.q()}q(e=this.h.throttleDelay){this.b.value=new vs(()=>{this.b.clear(),this.m()},e),this.b.value.schedule()}dispose(){super.dispose(),this.a.length=0,this.f=!0}},fx,lf;(function(){const e=globalThis;typeof e.requestIdleCallback!="function"||typeof e.cancelIdleCallback!="function"?lf=(t,i,r)=>{wE(()=>{if(s)return;const n=Date.now()+15;i(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let s=!1;return{dispose(){s||(s=!0)}}}:lf=(t,i,r)=>{const s=t.requestIdleCallback(i,typeof r=="number"?{timeout:r}:void 0);let n=!1;return{dispose(){n||(n=!0,t.cancelIdleCallback(s))}}},fx=(t,i)=>lf(globalThis,t,i)})();var X2=class{constructor(e,t){this.l=!1,this.g=()=>{try{this.m=t()}catch(i){this.o=i}finally{this.l=!0}},this.j=lf(e,()=>this.g())}dispose(){this.j.dispose()}get value(){if(this.l||(this.j.dispose(),this.g()),this.o)throw this.o;return this.m}get isInitialized(){return this.l}},K2=class extends X2{constructor(e){super(globalThis,e)}};async function eO(e,t,i){let r;for(let s=0;s<i;s++)try{return await e()}catch(n){r=n,await ri(t)}throw r}var px;(function(e){e[e.Resolved=0]="Resolved",e[e.Rejected=1]="Rejected"})(px||(px={}));var Ni=class jM{static fromPromise(t){const i=new jM;return i.settleWith(t),i}get isRejected(){return this.d?.outcome===1}get isResolved(){return this.d?.outcome===0}get isSettled(){return!!this.d}get value(){return this.d?.outcome===0?this.d?.value:void 0}constructor(){this.p=new Promise((t,i)=>{this.a=t,this.b=i})}complete(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.a(t),this.d={outcome:0,value:t},i()})}error(t){return this.isSettled?Promise.resolve():new Promise(i=>{this.b(t),this.d={outcome:1,value:t},i()})}settleWith(t){return t.then(i=>this.complete(i),i=>this.error(i))}cancel(){return this.error(new dt)}},Un;(function(e){async function t(r){let s;const n=await Promise.all(r.map(o=>o.then(a=>a,a=>{s||(s=a)})));if(typeof s<"u")throw s;return n}e.settled=t;function i(r){return new Promise(async(s,n)=>{try{await r(s,n)}catch(o){n(o)}})}e.withAsyncBody=i})(Un||(Un={}));var gx;(function(e){e[e.Initial=0]="Initial",e[e.DoneOK=1]="DoneOK",e[e.DoneError=2]="DoneError"})(gx||(gx={}));var Wv=class wr{static fromArray(t){return new wr(i=>{i.emitMany(t)})}static fromPromise(t){return new wr(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new wr(async i=>{await Promise.all(t.map(async r=>i.emitOne(await r)))})}static merge(t){return new wr(async i=>{await Promise.all(t.map(async r=>{for await(const s of r)i.emitOne(s)}))})}static{this.EMPTY=wr.fromArray([])}constructor(t,i){this.a=0,this.b=[],this.d=null,this.f=i,this.g=new I,queueMicrotask(async()=>{const r={emitOne:s=>this.h(s),emitMany:s=>this.j(s),reject:s=>this.l(s)};try{await Promise.resolve(t(r)),this.k()}catch(s){this.l(s)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this.a===2)throw this.d;if(t<this.b.length)return{done:!1,value:this.b[t++]};if(this.a===1)return{done:!0,value:void 0};await Ie.toPromise(this.g.event)}while(!0)},return:async()=>(this.f?.(),{done:!0,value:void 0})}}static map(t,i){return new wr(async r=>{for await(const s of t)r.emitOne(i(s))})}map(t){return wr.map(this,t)}static filter(t,i){return new wr(async r=>{for await(const s of t)i(s)&&r.emitOne(s)})}filter(t){return wr.filter(this,t)}static coalesce(t){return wr.filter(t,i=>!!i)}coalesce(){return wr.coalesce(this)}static async toPromise(t){const i=[];for await(const r of t)i.push(r);return i}toPromise(){return wr.toPromise(this)}h(t){this.a===0&&(this.b.push(t),this.g.fire())}j(t){this.a===0&&(this.b=this.b.concat(t),this.g.fire())}k(){this.a===0&&(this.a=1,this.g.fire())}l(t){this.a===0&&(this.a=2,this.d=t,this.g.fire())}},tO=class{constructor(e){this.a=new Ni,this.b=new Wv(r=>{if(t){r.reject(t);return}return i&&r.emitMany(i),this.d=s=>r.reject(s),this.f=s=>r.emitOne(s),this.g=s=>r.emitMany(s),this.a.p},e);let t,i;this.d=r=>{t||(t=r)},this.f=r=>{i||(i=[]),i.push(r)},this.g=r=>{i?r.forEach(s=>i.push(s)):i=r.slice()}}get asyncIterable(){return this.b}resolve(){this.a.complete()}reject(e){this.d(e),this.a.complete()}emitOne(e){this.f(e)}emitMany(e){this.g(e)}},iO=class{constructor(){this.a=[],this.b=[]}get hasFinalValue(){return!!this.d}produce(e){if(this.f(),this.a.length>0){const t=this.a.shift();this.g(t,e)}else this.b.push(e)}produceFinal(e){this.f(),this.d=e;for(const t of this.a)this.g(t,e);this.a.length=0}f(){if(this.d)throw new wi("ProducerConsumer: cannot produce after final value has been set")}g(e,t){t.ok?e.complete(t.value):e.error(t.error)}consume(){if(this.b.length>0||this.d){const e=this.b.length>0?this.b.shift():this.d;return e.ok?Promise.resolve(e.value):Promise.reject(e.error)}else{const e=new Ni;return this.a.push(e),e.p}}},mx=class ar{constructor(t,i){this.b=i,this.a=new iO,this.g={next:()=>this.a.consume(),return:()=>(this.b?.(),Promise.resolve({done:!0,value:void 0})),throw:async r=>(this.f(r),{done:!0,value:void 0})},queueMicrotask(async()=>{const r=t({emitOne:s=>this.a.produce({ok:!0,value:{done:!1,value:s}}),emitMany:s=>{for(const n of s)this.a.produce({ok:!0,value:{done:!1,value:n}})},reject:s=>this.f(s)});if(!this.a.hasFinalValue)try{await r,this.d()}catch(s){this.f(s)}})}static fromArray(t){return new ar(i=>{i.emitMany(t)})}static fromPromise(t){return new ar(async i=>{i.emitMany(await t)})}static fromPromisesResolveOrder(t){return new ar(async i=>{await Promise.all(t.map(async r=>i.emitOne(await r)))})}static merge(t){return new ar(async i=>{await Promise.all(t.map(async r=>{for await(const s of r)i.emitOne(s)}))})}static{this.EMPTY=ar.fromArray([])}static map(t,i){return new ar(async r=>{for await(const s of t)r.emitOne(i(s))})}static tee(t){let i,r;const s=new Ni,n=async()=>{if(!(!i||!r))try{for await(const c of t)i.emitOne(c),r.emitOne(c)}catch(c){i.reject(c),r.reject(c)}finally{s.complete()}},o=new ar(async c=>(i=c,n(),s.p)),a=new ar(async c=>(r=c,n(),s.p));return[o,a]}map(t){return ar.map(this,t)}static coalesce(t){return ar.filter(t,i=>!!i)}coalesce(){return ar.coalesce(this)}static filter(t,i){return new ar(async r=>{for await(const s of t)i(s)&&r.emitOne(s)})}filter(t){return ar.filter(this,t)}d(){this.a.hasFinalValue||this.a.produceFinal({ok:!0,value:{done:!0,value:void 0}})}f(t){this.a.hasFinalValue||this.a.produceFinal({ok:!1,error:t})}[Symbol.asyncIterator](){return this.g}},Tee=Symbol("AsyncReaderEndOfStream");function uf(e,t){return new rO(e,t)}var rO=class{constructor(e,t){this.e=e,this.f=t,this.a={flowing:!1,ended:!1,destroyed:!1},this.b={data:[],error:[]},this.c={data:[],error:[],end:[]},this.d=[]}pause(){this.a.destroyed||(this.a.flowing=!1)}resume(){this.a.destroyed||this.a.flowing||(this.a.flowing=!0,this.j(),this.k(),this.l())}write(e){if(!this.a.destroyed){if(this.a.flowing)this.g(e);else if(this.b.data.push(e),typeof this.f?.highWaterMark=="number"&&this.b.data.length>this.f.highWaterMark)return new Promise(t=>this.d.push(t))}}error(e){this.a.destroyed||(this.a.flowing?this.h(e):this.b.error.push(e))}end(e){this.a.destroyed||(typeof e<"u"&&this.write(e),this.a.flowing?(this.i(),this.destroy()):this.a.ended=!0)}g(e){this.c.data.slice(0).forEach(t=>t(e))}h(e){this.c.error.length===0?lt(e):this.c.error.slice(0).forEach(t=>t(e))}i(){this.c.end.slice(0).forEach(e=>e())}on(e,t){if(!this.a.destroyed)switch(e){case"data":this.c.data.push(t),this.resume();break;case"end":this.c.end.push(t),this.a.flowing&&this.l()&&this.destroy();break;case"error":this.c.error.push(t),this.a.flowing&&this.k();break}}removeListener(e,t){if(this.a.destroyed)return;let i;switch(e){case"data":i=this.c.data;break;case"end":i=this.c.end;break;case"error":i=this.c.error;break}if(i){const r=i.indexOf(t);r>=0&&i.splice(r,1)}}j(){if(this.b.data.length===0)return;if(typeof this.e=="function"){const t=this.e(this.b.data);this.g(t)}else for(const t of this.b.data)this.g(t);this.b.data.length=0;const e=[...this.d];this.d.length=0,e.forEach(t=>t())}k(){if(this.c.error.length>0){for(const e of this.b.error)this.h(e);this.b.error.length=0}}l(){return this.a.ended?(this.i(),this.c.end.length>0):!1}destroy(){this.a.destroyed||(this.a.destroyed=!0,this.a.ended=!0,this.b.data.length=0,this.b.error.length=0,this.c.data.length=0,this.c.error.length=0,this.c.end.length=0,this.d.length=0)}};function sO(e,t){const i=[];let r;for(;(r=e.read())!==null;)i.push(r);return t(i)}function vx(e,t){return new Promise((i,r)=>{const s=[];Bv(e,{onData:n=>{t&&s.push(n)},onError:n=>{t?r(n):i(void 0)},onEnd:()=>{i(t?t(s):void 0)}})})}function Bv(e,t,i){e.on("error",r=>{i?.isCancellationRequested||t.onError(r)}),e.on("end",()=>{i?.isCancellationRequested||t.onEnd()}),e.on("data",r=>{i?.isCancellationRequested||t.onData(r)})}function nO(e,t){const i=uf(t);return i.end(e),i}function oO(e,t,i){const r=uf(i);return Bv(e,{onData:s=>r.write(t.data(s)),onError:s=>r.error(t.error?t.error(s):s),onEnd:()=>r.end()}),r}var cu=typeof Buffer<"u",aO=new Pt(()=>new Uint8Array(256)),_v,Vv,W=class Fr{static alloc(t){return cu?new Fr(Buffer.allocUnsafe(t)):new Fr(new Uint8Array(t))}static wrap(t){return cu&&!Buffer.isBuffer(t)&&(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),new Fr(t)}static fromString(t,i){return!(i?.dontUseNodeBuffer||!1)&&cu?new Fr(Buffer.from(t)):(_v||(_v=new TextEncoder),new Fr(_v.encode(t)))}static fromByteArray(t){const i=Fr.alloc(t.length);for(let r=0,s=t.length;r<s;r++)i.buffer[r]=t[r];return i}static concat(t,i){if(typeof i>"u"){i=0;for(let n=0,o=t.length;n<o;n++)i+=t[n].byteLength}const r=Fr.alloc(i);let s=0;for(let n=0,o=t.length;n<o;n++){const a=t[n];r.set(a,s),s+=a.byteLength}return r}static isNativeBuffer(t){return cu&&Buffer.isBuffer(t)}constructor(t){this.buffer=t,this.byteLength=this.buffer.byteLength}clone(){const t=Fr.alloc(this.byteLength);return t.set(this),t}toString(){return cu?this.buffer.toString():(Vv||(Vv=new TextDecoder(void 0,{ignoreBOM:!0})),Vv.decode(this.buffer))}slice(t,i){return new Fr(this.buffer.subarray(t,i))}set(t,i){if(t instanceof Fr)this.buffer.set(t.buffer,i);else if(t instanceof Uint8Array)this.buffer.set(t,i);else if(t instanceof ArrayBuffer)this.buffer.set(new Uint8Array(t),i);else if(ArrayBuffer.isView(t))this.buffer.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i);else throw new Error("Unknown argument 'array'")}readUInt32BE(t){return hf(this.buffer,t)}writeUInt32BE(t,i){df(this.buffer,t,i)}readUInt32LE(t){return uO(this.buffer,t)}writeUInt32LE(t,i){hO(this.buffer,t,i)}readUInt8(t){return dO(this.buffer,t)}writeUInt8(t,i){fO(this.buffer,t,i)}indexOf(t,i=0){return wx(this.buffer,t instanceof Fr?t.buffer:t,i)}equals(t){return this===t?!0:this.byteLength!==t.byteLength?!1:this.buffer.every((i,r)=>i===t.buffer[r])}};function wx(e,t,i=0){const r=t.byteLength,s=e.byteLength;if(r===0)return 0;if(r===1)return e.indexOf(t[0]);if(r>s-i)return-1;const n=aO.value;n.fill(t.length);for(let l=0;l<t.length;l++)n[t[l]]=t.length-l-1;let o=i+t.length-1,a=o,c=-1;for(;o<s;)if(e[o]===t[a]){if(a===0){c=o;break}o--,a--}else o+=Math.max(t.length-a,n[e[o]]),a=t.length-1;return c}function cO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0}function lO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255}function hf(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function df(e,t,i){e[i+3]=t,t=t>>>8,e[i+2]=t,t=t>>>8,e[i+1]=t,t=t>>>8,e[i]=t}function uO(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function hO(e,t,i){e[i+0]=t&255,t=t>>>8,e[i+1]=t&255,t=t>>>8,e[i+2]=t&255,t=t>>>8,e[i+3]=t&255}function dO(e,t){return e[t]}function fO(e,t,i){e[i]=t}function pO(e){return sO(e,t=>W.concat(t))}function bx(e){return vx(e,t=>W.concat(t))}function gO(e){return nO(e,t=>W.concat(t))}function mO(e){return oO(e,{data:t=>typeof t=="string"?W.fromString(t):W.wrap(t)},t=>W.concat(t))}function Ho(e){let t=0,i=0,r=0;const s=new Uint8Array(Math.floor(e.length/4*3)),n=a=>{switch(i){case 3:s[r++]=t|a,i=0;break;case 2:s[r++]=t|a>>>2,t=a<<6,i=3;break;case 1:s[r++]=t|a>>>4,t=a<<4,i=2;break;default:t=a<<2,i=1}};for(let a=0;a<e.length;a++){const c=e.charCodeAt(a);if(c>=65&&c<=90)n(c-65);else if(c>=97&&c<=122)n(c-97+26);else if(c>=48&&c<=57)n(c-48+52);else if(c===43||c===45)n(62);else if(c===47||c===95)n(63);else{if(c===61)break;throw new SyntaxError(`Unexpected base64 character ${e[a]}`)}}const o=r;for(;i>0;)n(0);return W.wrap(s).slice(0,o)}var vO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wO="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function oc({buffer:e},t=!0,i=!1){const r=i?wO:vO;let s="";const n=e.byteLength%3;let o=0;for(;o<e.byteLength-n;o+=3){const a=e[o+0],c=e[o+1],l=e[o+2];s+=r[a>>>2],s+=r[(a<<4|c>>>4)&63],s+=r[(c<<2|l>>>6)&63],s+=r[l&63]}if(n===1){const a=e[o+0];s+=r[a>>>2],s+=r[a<<4&63],t&&(s+="==")}else if(n===2){const a=e[o+0],c=e[o+1];s+=r[a>>>2],s+=r[(a<<4|c>>>4)&63],s+=r[c<<2&63],t&&(s+="=")}return s}var yx="0123456789abcdef";function qv({buffer:e}){let t="";for(let i=0;i<e.length;i++){const r=e[i];t+=yx[r>>>4],t+=yx[r&15]}return t}function bO(e){if(e.length%2!==0)throw new SyntaxError("Hex string must have an even length");const t=new Uint8Array(e.length>>1);for(let i=0;i<e.length;)t[i>>1]=Ax(e,i++)<<4|Ax(e,i++);return W.wrap(t)}function Ax(e,t){const i=e.charCodeAt(t);if(i>=48&&i<=57)return i-48;if(i>=97&&i<=102)return i-87;if(i>=65&&i<=70)return i-55;throw new SyntaxError(`Invalid hex character at position ${t}`)}function Gv(e){const t=[];typeof e=="number"&&t.push("code/timeOrigin",e);function i(s,n){t.push(s,n?.startTime??Date.now())}function r(){const s=[];for(let n=0;n<t.length;n+=2)s.push({name:t[n],startTime:t[n+1]});return s}return{mark:i,getMarks:r}}function yO(){if(typeof performance=="object"&&typeof performance.mark=="function"&&!performance.nodeTiming)return typeof performance.timeOrigin!="number"&&!performance.timing?Gv():{mark(e,t){performance.mark(e,t)},getMarks(){let e=performance.timeOrigin;typeof e!="number"&&(e=(performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart)??0);const t=[{name:"code/timeOrigin",startTime:Math.round(e)}];for(const i of performance.getEntriesByType("mark"))t.push({name:i.name,startTime:Math.round(e+i.startTime)});return t}};if(typeof process=="object"){const e=performance?.timeOrigin;return Gv(e)}else return console.trace("perf-util loaded in UNKNOWN environment"),Gv()}function AO(e){return e.MonacoPerformanceMarks||(e.MonacoPerformanceMarks=yO()),e.MonacoPerformanceMarks}var Sx=AO(globalThis),Ot=Sx.mark,SO=Sx.getMarks,ff={};kR(ff,{Promises:()=>nt,RimRafMode:()=>Wo,SymlinkSupport:()=>Ri,configureFlushOnWrite:()=>Yv,realcase:()=>Xv,realpathSync:()=>Tx,whenDeleted:()=>TO,writeFileSync:()=>LO});import*as He from"fs";import{tmpdir as EO}from"os";import{promisify as lu}from"util";var xO=new Ya(1e4);function pf(e){return Ex(e,"NFC",xO)}var kO=new Ya(1e4);function Zv(e){return Ex(e,"NFD",kO)}var CO=/[^\u0000-\u0080]/;function Ex(e,t,i){if(!e)return e;const r=i.get(e);if(r)return r;let s;return CO.test(e)?s=e.normalize(t):s=e,i.set(e,s),s}var Ree=function(){const e=new Ya(1e4),t=/[\u0300-\u036f]/g;return function(i){const r=e.get(i);if(r)return r;const s=Zv(i).replace(t,""),n=(s.length===i.length?s:i).toLowerCase();return e.set(i,n),n}}(),Wo;(function(e){e[e.UNLINK=0]="UNLINK",e[e.MOVE=1]="MOVE"})(Wo||(Wo={}));async function xx(e,t=Wo.UNLINK,i){if(_E(e))throw new Error("rimraf - will refuse to recursively delete root");return t===Wo.UNLINK?Jv(e):$O(e,i)}async function $O(e,t=x2(EO())){try{try{await He.promises.rename(e,t)}catch(i){return i.code==="ENOENT"?void 0:Jv(e)}Jv(t).catch(()=>{})}catch(i){if(i.code!=="ENOENT")throw i}}async function Jv(e){return He.promises.rm(e,{recursive:!0,force:!0,maxRetries:3})}async function gf(e,t){try{return await kx(e,t)}catch(i){if(i.code==="ENOENT"&&ze&&_E(e))try{return await kx(`${e}.`,t)}catch{}throw i}}async function kx(e,t){return DO(await(t?IO(e):He.promises.readdir(e)))}async function IO(e){try{return await He.promises.readdir(e,{withFileTypes:!0})}catch(r){console.warn("[node.js fs] readdir with filetypes failed with error: ",r)}const t=[],i=await gf(e);for(const r of i){let s=!1,n=!1,o=!1;try{const a=await He.promises.lstat(_e(e,r));s=a.isFile(),n=a.isDirectory(),o=a.isSymbolicLink()}catch(a){console.warn("[node.js fs] unexpected error from lstat after readdir: ",a)}t.push({name:r,isFile:()=>s,isDirectory:()=>n,isSymbolicLink:()=>o})}return t}function DO(e){return e.map(t=>typeof t=="string"?Dt?pf(t):t:(t.name=Dt?pf(t.name):t.name,t))}async function PO(e){const t=await gf(e),i=[];for(const r of t)await Ri.existsDirectory(_e(e,r))&&i.push(r);return i}function TO(e,t=1e3){return new Promise(i=>{let r=!1;const s=setInterval(()=>{r||(r=!0,He.access(e,n=>{r=!1,n&&(clearInterval(s),i(void 0))}))},t)})}var Ri;(function(e){async function t(s){let n;try{if(n=await He.promises.lstat(s),!n.isSymbolicLink())return{stat:n}}catch{}try{return{stat:await He.promises.stat(s),symbolicLink:n?.isSymbolicLink()?{dangling:!1}:void 0}}catch(o){if(o.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};if(ze&&o.code==="EACCES")try{return{stat:await He.promises.stat(await He.promises.readlink(s)),symbolicLink:{dangling:!1}}}catch(a){if(a.code==="ENOENT"&&n)return{stat:n,symbolicLink:{dangling:!0}};throw a}throw o}}e.stat=t;async function i(s){try{const{stat:n,symbolicLink:o}=await e.stat(s);return n.isFile()&&o?.dangling!==!0}catch{}return!1}e.existsFile=i;async function r(s){try{const{stat:n,symbolicLink:o}=await e.stat(s);return n.isDirectory()&&o?.dangling!==!0}catch{}return!1}e.existsDirectory=r})(Ri||(Ri={}));var MO=new cx;function NO(e,t,i){return MO.queueFor(y.file(e),()=>{const r=Cx(i);return new Promise((s,n)=>RO(e,t,r,o=>o?n(o):s()))},jv)}var Qv=!0;function Yv(e){Qv=e}function RO(e,t,i,r){if(!Qv)return He.writeFile(e,t,{mode:i.mode,flag:i.flag},r);He.open(e,i.flag,i.mode,(s,n)=>{if(s)return r(s);He.writeFile(n,t,o=>{if(o)return He.close(n,()=>r(o));He.fdatasync(n,a=>(a&&(console.warn("[node.js fs] fdatasync is now disabled for this session because it failed: ",a),Yv(!1)),He.close(n,c=>r(c))))})})}function LO(e,t,i){const r=Cx(i);if(!Qv)return He.writeFileSync(e,t,{mode:r.mode,flag:r.flag});const s=He.openSync(e,r.flag,r.mode);try{He.writeFileSync(s,t);try{He.fdatasyncSync(s)}catch(n){console.warn("[node.js fs] fdatasyncSync is now disabled for this session because it failed: ",n),Yv(!1)}}finally{He.closeSync(s)}}function Cx(e){return e?{mode:typeof e.mode=="number"?e.mode:438,flag:typeof e.flag=="string"?e.flag:"w"}:{mode:438,flag:"w"}}async function OO(e,t,i=6e4){if(e!==t)try{ze&&typeof i=="number"?await $x(e,t,Date.now(),i):await He.promises.rename(e,t)}catch(r){if(e.toLowerCase()!==t.toLowerCase()&&r.code==="EXDEV"||e.endsWith("."))await Ix(e,t,{preserveSymlinks:!1}),await xx(e,Wo.MOVE);else throw r}}async function $x(e,t,i,r,s=0){try{return await He.promises.rename(e,t)}catch(n){if(n.code!=="EACCES"&&n.code!=="EPERM"&&n.code!=="EBUSY")throw n;if(Date.now()-i>=r)throw console.error(`[node.js fs] rename failed after ${s} retries with error: ${n}`),n;if(s===0){let o=!1;try{const{stat:a}=await Ri.stat(t);a.isFile()||(o=!0)}catch{}if(o)throw n}return await ri(Math.min(100,s*10)),$x(e,t,i,r,s+1)}}async function Ix(e,t,i){return Px(e,t,{root:{source:e,target:t},options:i,handledSourcePaths:new Set})}var Dx=511;async function Px(e,t,i){if(i.handledSourcePaths.has(e))return;i.handledSourcePaths.add(e);const{stat:r,symbolicLink:s}=await Ri.stat(e);if(s){if(i.options.preserveSymlinks)try{return await jO(e,t,i)}catch{}if(s.dangling)return}return r.isDirectory()?FO(e,t,r.mode&Dx,i):UO(e,t,r.mode&Dx)}async function FO(e,t,i,r){await He.promises.mkdir(t,{recursive:!0,mode:i});const s=await gf(e);for(const n of s)await Px(_e(e,n),_e(t,n),r)}async function UO(e,t,i){await He.promises.copyFile(e,t),await He.promises.chmod(t,i)}async function jO(e,t,i){let r=await He.promises.readlink(e);zo(r,i.root.source,!$t)&&(r=_e(i.root.target,r.substr(i.root.source.length+1))),await He.promises.symlink(r,t)}async function Xv(e,t){if($t)return e;const i=Mi(e);if(e===i)return e;const r=(At(e)||e).toLowerCase();try{if(t?.isCancellationRequested)return null;const n=(await nt.readdir(i)).filter(o=>o.toLowerCase()===r);if(n.length===1){const o=await Xv(i,t);if(o)return _e(o,n[0])}else if(n.length>1){const o=n.indexOf(r);if(o>=0){const a=await Xv(i,t);if(a)return _e(a,n[o])}}}catch{}return null}async function zO(e){try{return await lu(He.realpath)(e)}catch{const t=Mx(e);return await He.promises.access(t,He.constants.R_OK),t}}function Tx(e){try{return He.realpathSync(e)}catch{const t=Mx(e);return He.accessSync(t,He.constants.R_OK),t}}function Mx(e){return Ln(Zs(e),St)}var nt=new class{get read(){return(e,t,i,r,s)=>new Promise((n,o)=>{He.read(e,t,i,r,s,(a,c,l)=>a?o(a):n({bytesRead:c,buffer:l}))})}get write(){return(e,t,i,r,s)=>new Promise((n,o)=>{He.write(e,t,i,r,s,(a,c,l)=>a?o(a):n({bytesWritten:c,buffer:l}))})}get fdatasync(){return lu(He.fdatasync)}get open(){return lu(He.open)}get close(){return lu(He.close)}get ftruncate(){return lu(He.ftruncate)}async exists(e){try{return await He.promises.access(e),!0}catch{return!1}}get readdir(){return gf}get readDirsInDir(){return PO}get writeFile(){return NO}get rm(){return xx}get rename(){return OO}get copy(){return Ix}get realpath(){return zO}};function Nx(e){return(t,i,r)=>{let s=null,n=null;if(typeof r.value=="function"?(s="value",n=r.value):typeof r.get=="function"&&(s="get",n=r.get),!n||typeof i=="symbol")throw new Error("not supported");r[s]=e(n,i)}}function Rx(e,t,i){let r=null,s=null;if(typeof i.value=="function"?(r="value",s=i.value,s.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof i.get=="function"&&(r="get",s=i.get),!s)throw new Error("not supported");const n=`$memoize$${t}`;i[r]=function(...o){return this.hasOwnProperty(n)||Object.defineProperty(this,n,{configurable:!1,enumerable:!1,writable:!1,value:s.apply(this,o)}),this[n]}}function mf(e,t,i){return Nx((r,s)=>{const n=`$debounce$${s}`,o=`$debounce$result$${s}`;return function(...a){this[o]||(this[o]=i?i():void 0),clearTimeout(this[n]),t&&(this[o]=t(this[o],...a),a=[this[o]]),this[n]=setTimeout(()=>{r.apply(this,a),this[o]=i?i():void 0},e)}})}function HO(e,t,i){return Nx((r,s)=>{const n=`$throttle$timer$${s}`,o=`$throttle$result$${s}`,a=`$throttle$lastRun$${s}`,c=`$throttle$pending$${s}`;return function(...l){if(this[o]||(this[o]=i?i():void 0),(this[a]===null||this[a]===void 0)&&(this[a]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...l)),this[c])return;const u=this[a]+e;u<=Date.now()?(this[a]=Date.now(),r.apply(this,[this[o]]),this[o]=i?i():void 0):(this[c]=!0,this[n]=setTimeout(()=>{this[c]=!1,this[a]=Date.now(),r.apply(this,[this[o]]),this[o]=i?i():void 0},u-Date.now()))}})}function WO(e){return JSON.stringify(e,BO)}function Lx(e){let t=JSON.parse(e);return t=Gt(t),t}function BO(e,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:t.flags}:t}function Gt(e,t=0){if(!e||t>200)return e;if(typeof e=="object"){switch(e.$mid){case 1:return y.revive(e);case 2:return new RegExp(e.source,e.flags);case 17:return new Date(e.source)}if(e instanceof W||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=Gt(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=Gt(e[i],t+1))}return e}var Ox;(function(e){e[e.Promise=100]="Promise",e[e.PromiseCancel=101]="PromiseCancel",e[e.EventListen=102]="EventListen",e[e.EventDispose=103]="EventDispose"})(Ox||(Ox={}));function Fx(e){switch(e){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}var Ux;(function(e){e[e.Initialize=200]="Initialize",e[e.PromiseSuccess=201]="PromiseSuccess",e[e.PromiseError=202]="PromiseError",e[e.PromiseErrorObj=203]="PromiseErrorObj",e[e.EventFire=204]="EventFire"})(Ux||(Ux={}));function jx(e){switch(e){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}var Bo;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Idle=1]="Idle"})(Bo||(Bo={}));function ac(e){let t=0;for(let i=0;;i+=7){const r=e.read(1);if(t|=(r.buffer[0]&127)<<i,!(r.buffer[0]&128))return t}}var _O=jn(0);function cc(e,t){if(t===0){e.write(_O);return}let i=0;for(let s=t;s!==0;s=s>>>7)i++;const r=W.alloc(i);for(let s=0;t!==0;s++)r.buffer[s]=t&127,t=t>>>7,t>0&&(r.buffer[s]|=128);e.write(r)}var VO=class{constructor(e){this.b=e,this.a=0}read(e){const t=this.b.slice(this.a,this.a+e);return this.a+=t.byteLength,t}},qO=class{constructor(){this.a=[]}get buffer(){return W.concat(this.a)}write(e){this.a.push(e)}},Ci;(function(e){e[e.Undefined=0]="Undefined",e[e.String=1]="String",e[e.Buffer=2]="Buffer",e[e.VSBuffer=3]="VSBuffer",e[e.Array=4]="Array",e[e.Object=5]="Object",e[e.Int=6]="Int"})(Ci||(Ci={}));function jn(e){const t=W.alloc(1);return t.writeUInt8(e,0),t}var _o={Undefined:jn(Ci.Undefined),String:jn(Ci.String),Buffer:jn(Ci.Buffer),VSBuffer:jn(Ci.VSBuffer),Array:jn(Ci.Array),Object:jn(Ci.Object),Uint:jn(Ci.Int)};function Kv(e,t){if(typeof t>"u")e.write(_o.Undefined);else if(typeof t=="string"){const i=W.fromString(t);e.write(_o.String),cc(e,i.byteLength),e.write(i)}else if(W.isNativeBuffer(t)){const i=W.wrap(t);e.write(_o.Buffer),cc(e,i.byteLength),e.write(i)}else if(t instanceof W)e.write(_o.VSBuffer),cc(e,t.byteLength),e.write(t);else if(Array.isArray(t)){e.write(_o.Array),cc(e,t.length);for(const i of t)Kv(e,i)}else if(typeof t=="number"&&(t|0)===t)e.write(_o.Uint),cc(e,t);else{const i=W.fromString(JSON.stringify(t));e.write(_o.Object),cc(e,i.byteLength),e.write(i)}}function e0(e){switch(e.read(1).readUInt8(0)){case Ci.Undefined:return;case Ci.String:return e.read(ac(e)).toString();case Ci.Buffer:return e.read(ac(e)).buffer;case Ci.VSBuffer:return e.read(ac(e));case Ci.Array:{const i=ac(e),r=[];for(let s=0;s<i;s++)r.push(e0(e));return r}case Ci.Object:return JSON.parse(e.read(ac(e)).toString());case Ci.Int:return ac(e)}}var zx;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(zx||(zx={}));var Hx=class{constructor(e,t=null){this.l=e,this.a=!1,this.b=Bo.Uninitialized,this.d=new Set,this.f=new Map,this.g=0,this.k=new I,this.onDidInitialize=this.k.event,this.h=this.l.onMessage(i=>this.s(i)),this.j=t}getChannel(e){const t=this;return{call(i,r,s){return t.a?Promise.reject(new dt):t.m(e,i,r,s)},listen(i,r){return t.a?Ie.None:t.o(e,i,r)}}}m(e,t,i,r=Fe.None){const s=this.g++,o={id:s,type:100,channelName:e,name:t,arg:i};if(r.isCancellationRequested)return Promise.reject(new dt);let a,c;return new Promise((u,h)=>{if(r.isCancellationRequested)return h(new dt);const f=()=>{const v=b=>{switch(b.type){case 201:this.f.delete(s),u(b.data);break;case 202:{this.f.delete(s);const S=new Error(b.data.message);S.stack=Array.isArray(b.data.stack)?b.data.stack.join(`
`):b.data.stack,S.name=b.data.name,h(S);break}case 203:this.f.delete(s),h(b.data);break}};this.f.set(s,v),this.p(o)};let p=null;this.b===Bo.Idle?f():(p=Js(v=>this.u()),p.then(()=>{p=null,f()}));const g=()=>{p?(p.cancel(),p=null):this.p({id:s,type:101}),h(new dt)};a=r.onCancellationRequested(g),c={dispose:pv(()=>{g(),a.dispose()})},this.d.add(c)}).finally(()=>{a?.dispose(),this.d.delete(c)})}o(e,t,i){const r=this.g++,n={id:r,type:102,channelName:e,name:t,arg:i};let o=null;const a=new I({onWillAddFirstListener:()=>{const l=()=>{this.d.add(a),this.p(n)};this.b===Bo.Idle?l():(o=Js(u=>this.u()),o.then(()=>{o=null,l()}))},onDidRemoveLastListener:()=>{o?(o.cancel(),o=null):(this.d.delete(a),this.p({id:r,type:103}))}}),c=l=>a.fire(l.data);return this.f.set(r,c),a.event}p(e){switch(e.type){case 100:case 102:{const t=this.q([e.type,e.id,e.channelName,e.name],e.arg);this.j?.logOutgoing(t,e.id,0,`${Fx(e.type)}: ${e.channelName}.${e.name}`,e.arg);return}case 101:case 103:{const t=this.q([e.type,e.id]);this.j?.logOutgoing(t,e.id,0,Fx(e.type));return}}}q(e,t=void 0){const i=new qO;return Kv(i,e),Kv(i,t),this.r(i.buffer)}r(e){try{return this.l.send(e),e.byteLength}catch{return 0}}s(e){const t=new VO(e),i=e0(t),r=e0(t),s=i[0];switch(s){case 200:return this.j?.logIncoming(e.byteLength,0,0,jx(s)),this.t({type:i[0]});case 201:case 202:case 204:case 203:return this.j?.logIncoming(e.byteLength,i[1],0,jx(s),r),this.t({type:i[0],id:i[1],data:r})}}t(e){if(e.type===200){this.b=Bo.Idle,this.k.fire();return}this.f.get(e.id)?.(e)}get onDidInitializePromise(){return Ie.toPromise(this.onDidInitialize)}u(){return this.b===Bo.Idle?Promise.resolve():this.onDidInitializePromise}dispose(){this.a=!0,this.h&&(this.h.dispose(),this.h=null),Zi(this.d.values()),this.d.clear()}};__decorate([Rx],Hx.prototype,"onDidInitializePromise",null);function GO(e){let t=!1;return{call(i,r,s){return t?e.call(i,r,s):ri(0).then(()=>t=!0).then(()=>e.call(i,r,s))},listen(i,r){if(t)return e.listen(i,r);const s=new yL;return ri(0).then(()=>t=!0).then(()=>s.input=e.listen(i,r)),s.event}}}var t0;(function(e){function t(n,o,a){const c=n,l=a?.disableMarshalling,u=new Map;for(const h in c)r(h)&&u.set(h,Ie.buffer(c[h],!0,void 0,o));return new class{listen(h,f,p){const g=u.get(f);if(g)return g;const v=c[f];if(typeof v=="function"){if(s(f))return v.call(c,p);if(r(f))return u.set(f,Ie.buffer(c[f],!0,void 0,o)),u.get(f)}throw new Wr(`Event not found: ${f}`)}call(h,f,p){const g=c[f];if(typeof g=="function"){if(!l&&Array.isArray(p))for(let b=0;b<p.length;b++)p[b]=Gt(p[b]);let v=g.apply(c,p);return v instanceof Promise||(v=Promise.resolve(v)),v}throw new Wr(`Method not found: ${f}`)}}}e.fromService=t;function i(n,o){const a=o?.disableMarshalling;return new Proxy({},{get(c,l){if(typeof l=="string")return o?.properties?.has(l)?o.properties.get(l):s(l)?function(u){return n.listen(l,u)}:r(l)?n.listen(l):async function(...u){let h;o&&!Ht(o.context)?h=[o.context,...u]:h=u;const f=await n.call(l,h);return a?f:Gt(f)};throw new Wr(`Property not found: ${String(l)}`)}})}e.toService=i;function r(n){return n[0]==="o"&&n[1]==="n"&&ME(n.charCodeAt(2))}function s(n){return/^onDynamic/.test(n)&&ME(n.charCodeAt(9))}})(t0||(t0={}));var Wx;(function(e){e.Created="created",e.Read="read",e.Write="write",e.Open="open",e.Error="error",e.Close="close",e.BrowserWebSocketBlobReceived="browserWebSocketBlobReceived",e.NodeEndReceived="nodeEndReceived",e.NodeEndSent="nodeEndSent",e.NodeDrainBegin="nodeDrainBegin",e.NodeDrainEnd="nodeDrainEnd",e.zlibInflateError="zlibInflateError",e.zlibInflateData="zlibInflateData",e.zlibInflateInitialWrite="zlibInflateInitialWrite",e.zlibInflateInitialFlushFired="zlibInflateInitialFlushFired",e.zlibInflateWrite="zlibInflateWrite",e.zlibInflateFlushFired="zlibInflateFlushFired",e.zlibDeflateError="zlibDeflateError",e.zlibDeflateData="zlibDeflateData",e.zlibDeflateWrite="zlibDeflateWrite",e.zlibDeflateFlushFired="zlibDeflateFlushFired",e.WebSocketNodeSocketWrite="webSocketNodeSocketWrite",e.WebSocketNodeSocketPeekedHeader="webSocketNodeSocketPeekedHeader",e.WebSocketNodeSocketReadHeader="webSocketNodeSocketReadHeader",e.WebSocketNodeSocketReadData="webSocketNodeSocketReadData",e.WebSocketNodeSocketUnmaskedData="webSocketNodeSocketUnmaskedData",e.WebSocketNodeSocketDrainBegin="webSocketNodeSocketDrainBegin",e.WebSocketNodeSocketDrainEnd="webSocketNodeSocketDrainEnd",e.ProtocolHeaderRead="protocolHeaderRead",e.ProtocolMessageRead="protocolMessageRead",e.ProtocolHeaderWrite="protocolHeaderWrite",e.ProtocolMessageWrite="protocolMessageWrite",e.ProtocolWrite="protocolWrite"})(Wx||(Wx={}));var vf;(function(e){e.enableDiagnostics=!1,e.records=[];const t=new WeakMap;let i=0;function r(n,o){if(!t.has(n)){const a=String(++i);t.set(n,a)}return t.get(n)}function s(n,o,a,c){if(!e.enableDiagnostics)return;const l=r(n,o);if(c instanceof W||c instanceof Uint8Array||c instanceof ArrayBuffer||ArrayBuffer.isView(c)){const u=W.alloc(c.byteLength);u.set(c),e.records.push({timestamp:Date.now(),id:l,label:o,type:a,buff:u})}else e.records.push({timestamp:Date.now(),id:l,label:o,type:a,data:c})}e.traceSocketEvent=s})(vf||(vf={}));var Bx;(function(e){e[e.NodeSocketCloseEvent=0]="NodeSocketCloseEvent",e[e.WebSocketCloseEvent=1]="WebSocketCloseEvent"})(Bx||(Bx={}));var i0=null;function zn(){return i0||(i0=W.alloc(0)),i0}var _x=class{get byteLength(){return this.b}constructor(){this.a=[],this.b=0}acceptChunk(e){this.a.push(e),this.b+=e.byteLength}read(e){return this.c(e,!0)}peek(e){return this.c(e,!1)}c(e,t){if(e===0)return zn();if(e>this.b)throw new Error("Cannot read so many bytes!");if(this.a[0].byteLength===e){const n=this.a[0];return t&&(this.a.shift(),this.b-=e),n}if(this.a[0].byteLength>e){const n=this.a[0].slice(0,e);return t&&(this.a[0]=this.a[0].slice(e),this.b-=e),n}const i=W.alloc(e);let r=0,s=0;for(;e>0;){const n=this.a[s];if(n.byteLength>e){const o=n.slice(0,e);i.set(o,r),r+=e,t&&(this.a[s]=n.slice(e),this.b-=e),e-=e}else i.set(n,r),r+=n.byteLength,t?(this.a.shift(),this.b-=n.byteLength):s++,e-=n.byteLength}return i}},Vx;(function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.Control=2]="Control",e[e.Ack=3]="Ack",e[e.Disconnect=5]="Disconnect",e[e.ReplayRequest=6]="ReplayRequest",e[e.Pause=7]="Pause",e[e.Resume=8]="Resume",e[e.KeepAlive=9]="KeepAlive"})(Vx||(Vx={}));function qx(e){switch(e){case 0:return"None";case 1:return"Regular";case 2:return"Control";case 3:return"Ack";case 5:return"Disconnect";case 6:return"ReplayRequest";case 7:return"PauseWriting";case 8:return"ResumeWriting";case 9:return"KeepAlive"}}var Gx;(function(e){e[e.HeaderLength=13]="HeaderLength",e[e.AcknowledgeTime=2e3]="AcknowledgeTime",e[e.TimeoutTime=2e4]="TimeoutTime",e[e.ReconnectionGraceTime=108e5]="ReconnectionGraceTime",e[e.ReconnectionShortGraceTime=3e5]="ReconnectionShortGraceTime",e[e.KeepAliveSendTime=5e3]="KeepAliveSendTime"})(Gx||(Gx={}));var ws=class{constructor(e,t,i,r){this.type=e,this.id=t,this.ack=i,this.data=r,this.writtenTime=0}get size(){return this.data.byteLength}},Zx=class extends Q{constructor(e){super(),this.f=this.D(new I),this.onMessage=this.f.event,this.g={readHead:!0,readLen:13,messageType:0,id:0,ack:0},this.a=e,this.b=!1,this.c=new _x,this.D(this.a.onData(t=>this.acceptChunk(t))),this.lastReadTime=Date.now()}acceptChunk(e){if(!(!e||e.byteLength===0))for(this.lastReadTime=Date.now(),this.c.acceptChunk(e);this.c.byteLength>=this.g.readLen;){const t=this.c.read(this.g.readLen);if(this.g.readHead)this.g.readHead=!1,this.g.readLen=t.readUInt32BE(9),this.g.messageType=t.readUInt8(0),this.g.id=t.readUInt32BE(1),this.g.ack=t.readUInt32BE(5),this.a.traceSocketEvent("protocolHeaderRead",{messageType:qx(this.g.messageType),id:this.g.id,ack:this.g.ack,messageSize:this.g.readLen});else{const i=this.g.messageType,r=this.g.id,s=this.g.ack;if(this.g.readHead=!0,this.g.readLen=13,this.g.messageType=0,this.g.id=0,this.g.ack=0,this.a.traceSocketEvent("protocolMessageRead",t),this.f.fire(new ws(i,r,s,t)),this.b)break}}}readEntireBuffer(){return this.c.read(this.c.byteLength)}dispose(){this.b=!0,super.dispose()}},Jx=class{constructor(e){this.k=null,this.a=!1,this.b=!1,this.c=e,this.d=[],this.f=0,this.lastWriteTime=0}dispose(){try{this.flush()}catch{}this.a=!0}drain(){return this.flush(),this.c.drain()}flush(){this.m()}pause(){this.b=!0}resume(){this.b=!1,this.l()}write(e){if(this.a)return;e.writtenTime=Date.now(),this.lastWriteTime=Date.now();const t=W.alloc(13);t.writeUInt8(e.type,0),t.writeUInt32BE(e.id,1),t.writeUInt32BE(e.ack,5),t.writeUInt32BE(e.data.byteLength,9),this.c.traceSocketEvent("protocolHeaderWrite",{messageType:qx(e.type),id:e.id,ack:e.ack,messageSize:e.data.byteLength}),this.c.traceSocketEvent("protocolMessageWrite",e.data),this.j(t,e.data)}g(e,t){const i=this.f===0;return this.d.push(e,t),this.f+=e.byteLength+t.byteLength,i}h(){const e=W.concat(this.d,this.f);return this.d.length=0,this.f=0,e}j(e,t){this.g(e,t)&&this.l()}l(){this.k||(this.k=setTimeout(()=>{this.k=null,this.m()}))}m(){if(this.f===0||this.b)return;const e=this.h();this.c.traceSocketEvent("protocolWrite",{byteLength:e.byteLength}),this.c.write(e)}},Vo=class{constructor(){this.b=!1,this.c=!1,this.d=[],this.a=new I({onWillAddFirstListener:()=>{this.b=!0,queueMicrotask(()=>this.f())},onDidRemoveLastListener:()=>{this.b=!1}}),this.event=this.a.event}f(){if(!this.c){for(this.c=!0;this.b&&this.d.length>0;)this.a.fire(this.d.shift());this.c=!1}}fire(e){this.b?this.d.length>0?this.d.push(e):this.a.fire(e):this.d.push(e)}flushBuffer(){this.d=[]}},ZO=class{constructor(e){this.data=e,this.next=null}},JO=class{constructor(){this.a=null,this.b=null}length(){let e=0,t=this.a;for(;t;)t=t.next,e++;return e}peek(){return this.a?this.a.data:null}toArray(){const e=[];let t=0,i=this.a;for(;i;)e[t++]=i.data,i=i.next;return e}pop(){if(this.a){if(this.a===this.b){this.a=null,this.b=null;return}this.a=this.a.next}}push(e){const t=new ZO(e);if(!this.a){this.a=t,this.b=t;return}this.b.next=t,this.b=t}},QO=class js{static{this.a=10}static{this.b=null}static getInstance(){return js.b||(js.b=new js),js.b}constructor(){this.c=[];const t=Date.now();for(let i=0;i<js.a;i++)this.c[i]=t-1e3*i;setInterval(()=>{for(let i=js.a;i>=1;i--)this.c[i]=this.c[i-1];this.c[0]=Date.now()},1e3)}d(){const t=Date.now(),i=(1+js.a)*1e3;let r=0;for(let s=0;s<js.a;s++)t-this.c[s]<=i&&r++;return 1-r/js.a}hasHighLoad(){return this.d()>=.5}},r0=class{get unacknowledgedCount(){return this.d-this.f}constructor(e){this.v=new Vo,this.onControlMessage=this.v.event,this.w=new Vo,this.onMessage=this.w.event,this.x=new Vo,this.onDidDispose=this.x.event,this.y=new Vo,this.onSocketClose=this.y.event,this.z=new Vo,this.onSocketTimeout=this.z.event,this.t=e.loadEstimator??QO.getInstance(),this.u=e.sendKeepAlive??!0,this.a=!1,this.c=new JO,this.d=0,this.f=0,this.g=null,this.h=0,this.j=0,this.k=0,this.l=null,this.n=0,this.o=Date.now(),this.s=new ie,this.p=e.socket,this.q=this.s.add(new Jx(this.p)),this.r=this.s.add(new Zx(this.p)),this.s.add(this.r.onMessage(t=>this.A(t))),this.s.add(this.p.onClose(t=>this.y.fire(t))),e.initialChunk&&this.r.acceptChunk(e.initialChunk),this.u?this.m=setInterval(()=>{this.E()},5e3):this.m=null}dispose(){this.g&&(clearTimeout(this.g),this.g=null),this.l&&(clearTimeout(this.l),this.l=null),this.m&&(clearInterval(this.m),this.m=null),this.s.dispose()}drain(){return this.q.drain()}sendDisconnect(){if(!this.b){this.b=!0;const e=new ws(5,0,0,zn());this.q.write(e),this.q.flush()}}sendPause(){const e=new ws(7,0,0,zn());this.q.write(e)}sendResume(){const e=new ws(8,0,0,zn());this.q.write(e)}pauseSocketWriting(){this.q.pause()}getSocket(){return this.p}getMillisSinceLastIncomingData(){return Date.now()-this.r.lastReadTime}beginAcceptReconnection(e,t){this.a=!0,this.s.dispose(),this.s=new ie,this.v.flushBuffer(),this.y.flushBuffer(),this.z.flushBuffer(),this.p.dispose(),this.n=0,this.o=Date.now(),this.p=e,this.q=this.s.add(new Jx(this.p)),this.r=this.s.add(new Zx(this.p)),this.s.add(this.r.onMessage(i=>this.A(i))),this.s.add(this.p.onClose(i=>this.y.fire(i))),this.r.acceptChunk(t)}endAcceptReconnection(){this.a=!1,this.j=this.h;const e=new ws(3,0,this.j,zn());this.q.write(e);const t=this.c.toArray();for(let i=0,r=t.length;i<r;i++)this.q.write(t[i]);this.C()}acceptDisconnect(){this.x.fire()}A(e){if(e.ack>this.f){this.f=e.ack;do{const t=this.c.peek();if(t&&t.id<=e.ack)this.c.pop();else break}while(!0)}switch(e.type){case 0:break;case 1:{if(e.id>this.h)if(e.id!==this.h+1){const t=Date.now();t-this.n>1e4&&(this.n=t,this.q.write(new ws(6,0,0,zn())))}else this.h=e.id,this.k=Date.now(),this.B(),this.w.fire(e.data);break}case 2:{this.v.fire(e.data);break}case 3:break;case 5:{this.x.fire();break}case 6:{const t=this.c.toArray();for(let i=0,r=t.length;i<r;i++)this.q.write(t[i]);this.C();break}case 7:{this.q.pause();break}case 8:{this.q.resume();break}case 9:break}}readEntireBuffer(){return this.r.readEntireBuffer()}flush(){this.q.flush()}send(e){const t=++this.d;this.j=this.h;const i=new ws(1,t,this.j,e);this.c.push(i),this.a||(this.q.write(i),this.C())}sendControl(e){const t=new ws(2,0,0,e);this.q.write(t)}B(){if(this.h<=this.j||this.l)return;const e=Date.now()-this.k;if(e>=2e3){this.D();return}this.l=setTimeout(()=>{this.l=null,this.B()},2e3-e+5)}C(){if(this.d<=this.f||this.g||this.a)return;const e=this.c.peek(),t=Date.now()-e.writtenTime,i=Date.now()-this.r.lastReadTime,r=Date.now()-this.o;if(t>=2e4&&i>=2e4&&r>=2e4&&!this.t.hasHighLoad()){this.o=Date.now(),this.z.fire({unacknowledgedMsgCount:this.c.length(),timeSinceOldestUnacknowledgedMsg:t,timeSinceLastReceivedSomeData:i});return}const s=Math.max(2e4-t,2e4-i,2e4-r,500);this.g=setTimeout(()=>{this.g=null,this.C()},s)}D(){if(this.h<=this.j)return;this.j=this.h;const e=new ws(3,0,this.j,zn());this.q.write(e)}E(){this.j=this.h;const e=new ws(9,0,this.j,zn());this.q.write(e)}};import"crypto";import"net";import{tmpdir as YO}from"os";import{createDeflateRaw as XO,createInflateRaw as KO}from"zlib";var Tt=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let r=0,s="";return s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+="-",s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s+=t[e[r++]],s}}(),eF=3e4,uu=class{traceSocketEvent(e,t){vf.traceSocketEvent(this.socket,this.debugLabel,e,t)}constructor(e,t=""){this.d=!0,this.debugLabel=t,this.socket=e,this.traceSocketEvent("created",{type:"NodeSocket"}),this.a=r=>{if(this.traceSocketEvent("error",{code:r?.code,message:r?.message}),r){if(r.code==="EPIPE")return;lt(r)}},this.socket.on("error",this.a);let i;this.b=r=>{this.traceSocketEvent("close",{hadError:r}),this.d=!1,i&&clearTimeout(i)},this.socket.on("close",this.b),this.c=()=>{this.traceSocketEvent("nodeEndReceived"),this.d=!1,i=setTimeout(()=>e.destroy(),eF)},this.socket.on("end",this.c)}dispose(){this.socket.off("error",this.a),this.socket.off("close",this.b),this.socket.off("end",this.c),this.socket.destroy()}onData(e){const t=i=>{this.traceSocketEvent("read",i),e(W.wrap(i))};return this.socket.on("data",t),{dispose:()=>this.socket.off("data",t)}}onClose(e){const t=i=>{e({type:0,hadError:i,error:void 0})};return this.socket.on("close",t),{dispose:()=>this.socket.off("close",t)}}onEnd(e){const t=()=>{e()};return this.socket.on("end",t),{dispose:()=>this.socket.off("end",t)}}write(e){if(!(this.socket.destroyed||!this.d))try{this.traceSocketEvent("write",e),this.socket.write(e.buffer,t=>{if(t){if(t.code==="EPIPE")return;lt(t)}})}catch(t){if(t.code==="EPIPE")return;lt(t)}}end(){this.traceSocketEvent("nodeEndSent"),this.socket.end()}drain(){return this.traceSocketEvent("nodeDrainBegin"),new Promise((e,t)=>{if(this.socket.bufferSize===0){this.traceSocketEvent("nodeDrainEnd"),e();return}const i=()=>{this.socket.off("close",i),this.socket.off("end",i),this.socket.off("error",i),this.socket.off("timeout",i),this.socket.off("drain",i),this.traceSocketEvent("nodeDrainEnd"),e()};this.socket.on("close",i),this.socket.on("end",i),this.socket.on("error",i),this.socket.on("timeout",i),this.socket.on("drain",i)})}},Qx;(function(e){e[e.MinHeaderByteSize=2]="MinHeaderByteSize",e[e.MaxWebSocketMessageLength=262144]="MaxWebSocketMessageLength"})(Qx||(Qx={}));var Yx;(function(e){e[e.PeekHeader=1]="PeekHeader",e[e.ReadHeader=2]="ReadHeader",e[e.ReadBody=3]="ReadBody",e[e.Fin=4]="Fin"})(Yx||(Yx={}));var tF=class extends Q{get permessageDeflate(){return this.a.permessageDeflate}get recordedInflateBytes(){return this.a.recordedInflateBytes}traceSocketEvent(e,t){this.socket.traceSocketEvent(e,t)}constructor(e,t,i,r){super(),this.c=this.D(new I),this.f=this.D(new I),this.g=!1,this.h={state:1,readLen:2,fin:0,compressed:!1,firstFrameOfMessage:!0,mask:0,opcode:0},this.socket=e,this.traceSocketEvent("created",{type:"WebSocketNodeSocket",permessageDeflate:t,inflateBytesLength:i?.byteLength||0,recordInflateBytes:r}),this.a=this.D(new iF(this,t,i,r,this.c,(s,n)=>this.j(s,n))),this.D(this.a.onError(s=>{console.error(s),lt(s),this.f.fire({type:0,hadError:!0,error:s})})),this.b=new _x,this.D(this.socket.onData(s=>this.m(s))),this.D(this.socket.onClose(async s=>{this.a.isProcessingReadQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingReadQueue),this.f.fire(s)}))}dispose(){this.a.isProcessingWriteQueue()?this.D(this.a.onDidFinishProcessingWriteQueue(()=>{this.dispose()})):(this.socket.dispose(),super.dispose())}onData(e){return this.c.event(e)}onClose(e){return this.f.event(e)}onEnd(e){return this.socket.onEnd(e)}write(e){let t=0;for(;t<e.byteLength;)this.a.writeMessage(e.slice(t,Math.min(t+262144,e.byteLength)),{compressed:!0,opcode:2}),t+=262144}j(e,{compressed:t,opcode:i}){if(this.g)return;this.traceSocketEvent("webSocketNodeSocketWrite",e);let r=2;e.byteLength<126?r+=0:e.byteLength<2**16?r+=2:r+=8;const s=W.alloc(r),n=t?64:0,o=i&15;if(s.writeUInt8(128|n|o,0),e.byteLength<126)s.writeUInt8(e.byteLength,1);else if(e.byteLength<2**16){s.writeUInt8(126,1);let a=1;s.writeUInt8(e.byteLength>>>8&255,++a),s.writeUInt8(e.byteLength>>>0&255,++a)}else{s.writeUInt8(127,1);let a=1;s.writeUInt8(0,++a),s.writeUInt8(0,++a),s.writeUInt8(0,++a),s.writeUInt8(0,++a),s.writeUInt8(e.byteLength>>>24&255,++a),s.writeUInt8(e.byteLength>>>16&255,++a),s.writeUInt8(e.byteLength>>>8&255,++a),s.writeUInt8(e.byteLength>>>0&255,++a)}this.socket.write(W.concat([s,e]))}end(){this.g=!0,this.socket.end()}m(e){if(e.byteLength!==0){for(this.b.acceptChunk(e);this.b.byteLength>=this.h.readLen;)if(this.h.state===1){const t=this.b.peek(this.h.readLen),i=t.readUInt8(0),r=(i&128)>>>7,s=(i&64)>>>6,n=i&15,o=t.readUInt8(1),a=(o&128)>>>7,c=o&127;this.h.state=2,this.h.readLen=2+(a?4:0)+(c===126?2:0)+(c===127?8:0),this.h.fin=r,this.h.firstFrameOfMessage&&(this.h.compressed=!!s),this.h.firstFrameOfMessage=!!r,this.h.mask=0,this.h.opcode=n,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{headerSize:this.h.readLen,compressed:this.h.compressed,fin:this.h.fin,opcode:this.h.opcode})}else if(this.h.state===2){const t=this.b.read(this.h.readLen),i=t.readUInt8(1),r=(i&128)>>>7;let s=i&127,n=1;s===126?s=t.readUInt8(++n)*2**8+t.readUInt8(++n):s===127&&(s=t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*0+t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n));let o=0;r&&(o=t.readUInt8(++n)*2**24+t.readUInt8(++n)*2**16+t.readUInt8(++n)*2**8+t.readUInt8(++n)),this.h.state=3,this.h.readLen=s,this.h.mask=o,this.traceSocketEvent("webSocketNodeSocketPeekedHeader",{bodySize:this.h.readLen,compressed:this.h.compressed,fin:this.h.fin,mask:this.h.mask,opcode:this.h.opcode})}else if(this.h.state===3){const t=this.b.read(this.h.readLen);this.traceSocketEvent("webSocketNodeSocketReadData",t),nF(t,this.h.mask),this.traceSocketEvent("webSocketNodeSocketUnmaskedData",t),this.h.state=1,this.h.readLen=2,this.h.mask=0,this.h.opcode<=2?this.a.acceptFrame(t,this.h.compressed,!!this.h.fin):this.h.opcode===9&&this.a.writeMessage(t,{compressed:!1,opcode:10})}}}async drain(){this.traceSocketEvent("webSocketNodeSocketDrainBegin"),this.a.isProcessingWriteQueue()&&await Ie.toPromise(this.a.onDidFinishProcessingWriteQueue),await this.socket.drain(),this.traceSocketEvent("webSocketNodeSocketDrainEnd")}},iF=class extends Q{get permessageDeflate(){return!!(this.b&&this.c)}get recordedInflateBytes(){return this.b?this.b.recordedInflateBytes:W.alloc(0)}constructor(e,t,i,r,s,n){super(),this.m=e,this.n=s,this.q=n,this.a=this.D(new I),this.onError=this.a.event,this.f=[],this.g=[],this.h=this.D(new I),this.onDidFinishProcessingReadQueue=this.h.event,this.j=this.D(new I),this.onDidFinishProcessingWriteQueue=this.j.event,this.r=!1,this.u=!1,t?(this.b=this.D(new rF(this.m,r,i,{windowBits:15})),this.c=this.D(new sF(this.m,{windowBits:15})),this.D(this.b.onError(o=>this.a.fire(o))),this.D(this.c.onError(o=>this.a.fire(o)))):(this.b=null,this.c=null)}writeMessage(e,t){this.f.push({data:e,options:t}),this.s()}async s(){if(!this.r){for(this.r=!0;this.f.length>0;){const{data:e,options:t}=this.f.shift();if(this.c&&t.compressed){const i=await this.t(this.c,e);this.q(i,t)}else this.q(e,{...t,compressed:!1})}this.r=!1,this.j.fire()}}isProcessingWriteQueue(){return this.r}t(e,t){return new Promise((i,r)=>{e.write(t),e.flush(s=>i(s))})}acceptFrame(e,t,i){this.g.push({data:e,isCompressed:t,isLastFrameOfMessage:i}),this.w()}async w(){if(!this.u){for(this.u=!0;this.g.length>0;){const e=this.g.shift();if(this.b&&e.isCompressed){const t=await this.y(this.b,e.data,e.isLastFrameOfMessage);this.n.fire(t)}else this.n.fire(e.data)}this.u=!1,this.h.fire()}}isProcessingReadQueue(){return this.u}y(e,t,i){return new Promise((r,s)=>{e.write(t),i&&e.write(W.fromByteArray([0,0,255,255])),e.flush(n=>r(n))})}},rF=class extends Q{get recordedInflateBytes(){return this.h?W.concat(this.c):W.alloc(0)}constructor(e,t,i,r){super(),this.g=e,this.h=t,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.f=[],this.b=KO(r),this.b.on("error",s=>{this.g.traceSocketEvent("zlibInflateError",{message:s?.message,code:s?.code}),this.a.fire(s)}),this.b.on("data",s=>{this.g.traceSocketEvent("zlibInflateData",s),this.f.push(W.wrap(s))}),i&&(this.g.traceSocketEvent("zlibInflateInitialWrite",i.buffer),this.b.write(i.buffer),this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateInitialFlushFired"),this.f.length=0}))}write(e){this.h&&this.c.push(e.clone()),this.g.traceSocketEvent("zlibInflateWrite",e),this.b.write(e.buffer)}flush(e){this.b.flush(()=>{this.g.traceSocketEvent("zlibInflateFlushFired");const t=W.concat(this.f);this.f.length=0,e(t)})}},sF=class extends Q{constructor(e,t){super(),this.f=e,this.a=this.D(new I),this.onError=this.a.event,this.c=[],this.b=XO({windowBits:15}),this.b.on("error",i=>{this.f.traceSocketEvent("zlibDeflateError",{message:i?.message,code:i?.code}),this.a.fire(i)}),this.b.on("data",i=>{this.f.traceSocketEvent("zlibDeflateData",i),this.c.push(W.wrap(i))})}write(e){this.f.traceSocketEvent("zlibDeflateWrite",e.buffer),this.b.write(e.buffer)}flush(e){this.b.flush(2,()=>{this.f.traceSocketEvent("zlibDeflateFlushFired");let t=W.concat(this.c);this.c.length=0,t=t.slice(0,t.byteLength-4),e(t)})}};function nF(e,t){if(t===0)return;const i=e.byteLength>>>2;for(let c=0;c<i;c++){const l=e.readUInt32BE(c*4);e.writeUInt32BE(l^t,c*4)}const r=i*4,s=e.byteLength-r,n=t>>>24&255,o=t>>>16&255,a=t>>>8&255;s>=1&&e.writeUInt8(e.readUInt8(r)^n,r),s>=2&&e.writeUInt8(e.readUInt8(r+1)^o,r+1),s>=3&&e.writeUInt8(e.readUInt8(r+2)^a,r+2)}var Xx=process.env.XDG_RUNTIME_DIR,oF={2:107,1:103};function aF(){const e=Tt();if(process.platform==="win32")return`\\\\.\\pipe\\vscode-ipc-${e}-sock`;const t=process.platform!=="darwin"&&Xx?Xx:YO(),i=_e(t,`vscode-ipc-${e}.sock`);return cF(i),i}function cF(e){const t=oF[ML];typeof t=="number"&&e.length>=t&&console.warn(`WARNING: IPC handle "${e}" is longer than ${t} chars, try a shorter --user-data-dir`)}function ot(e){if(!e||typeof e!="object"||e instanceof RegExp)return e;const t=Array.isArray(e)?[]:{};return Object.entries(e).forEach(([i,r])=>{t[i]=r&&typeof r=="object"?ot(r):r}),t}function s0(e){if(!e||typeof e!="object")return e;const t=[e];for(;t.length>0;){const i=t.shift();Object.freeze(i);for(const r in i)if(Kx.call(i,r)){const s=i[r];typeof s=="object"&&!Object.isFrozen(s)&&!KR(s)&&t.push(s)}}return e}var Kx=Object.prototype.hasOwnProperty;function lc(e,t){return n0(e,t,new Set)}function n0(e,t,i){if(Ht(e))return e;const r=t(e);if(typeof r<"u")return r;if(Array.isArray(e)){const s=[];for(const n of e)s.push(n0(n,t,i));return s}if(yt(e)){if(i.has(e))throw new Error("Cannot clone recursive data-structure");i.add(e);const s={};for(const n in e)Kx.call(e,n)&&(s[n]=n0(e[n],t,i));return i.delete(e),s}return e}function Qs(e,t,i=!0){return yt(e)?(yt(t)&&Object.keys(t).forEach(r=>{r in e?i&&(yt(e[r])&&yt(t[r])?Qs(e[r],t[r],i):e[r]=t[r]):e[r]=t[r]}),e):t}function Li(e,t){if(e===t)return!0;if(e==null||t===null||t===void 0||typeof e!=typeof t||typeof e!="object"||Array.isArray(e)!==Array.isArray(t))return!1;let i,r;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!Li(e[i],t[i]))return!1}else{const s=[];for(r in e)s.push(r);s.sort();const n=[];for(r in t)n.push(r);if(n.sort(),!Li(s,n))return!1;for(i=0;i<s.length;i++)if(!Li(e[s[i]],t[s[i]]))return!1}return!0}function lF(e){const t=new Set;return JSON.stringify(e,(i,r)=>{if(yt(r)||Array.isArray(r)){if(t.has(r))return"[Circular]";t.add(r)}return typeof r=="bigint"?`[BigInt ${r.toString()}]`:r})}function ek(e,t){const i=t.toLowerCase(),r=Object.keys(e).find(s=>s.toLowerCase()===i);return r?e[r]:e[t]}function tk(e,t){const i=Object.create(null);for(const[r,s]of Object.entries(e))t(r,s)&&(i[r]=s);return i}var uF=new class{constructor(){this.a=0,this.b=new I,this.onDidChangeZoomLevel=this.b.event}getZoomLevel(){return this.a}setZoomLevel(e){e=Math.min(Math.max(-5,e),20),this.a!==e&&(this.a=e,this.b.fire(this.a))}},hF=Dt?1.5:1.35,o0=8,dF=class c5{static _create(t,i,r,s,n,o,a,c,l){o===0?o=hF*r:o<o0&&(o=o*r),o=Math.round(o),o<o0&&(o=o0);const u=1+(l?0:uF.getZoomLevel()*.1);return r*=u,o*=u,n===rk&&(i==="normal"||i==="bold"?n=ik:(n=`'wght' ${parseInt(i,10)}`,i="normal")),new c5({pixelRatio:c,fontFamily:t,fontWeight:i,fontSize:r,fontFeatureSettings:s,fontVariationSettings:n,lineHeight:o,letterSpacing:a})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=t.lineHeight|0,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=bs.fontFamily,i=c5.a(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static a(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}},fF=2,pF=class extends dF{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=fF,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}},ik="normal",rk="translate",gF="Consolas, 'Courier New', monospace",mF="Menlo, Monaco, 'Courier New', monospace",vF="'Droid Sans Mono', 'monospace', monospace",bs={fontFamily:Dt?mF:ze?gF:vF,fontWeight:"normal",fontSize:Dt?12:14,lineHeight:0,letterSpacing:0},sk={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}},nk="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function wF(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const i of nk)e.indexOf(i)>=0||(t+="\\"+i);return t+="\\s]+)",new RegExp(t,"g")}var bF=wF();function ok(e){let t=bF;if(e&&e instanceof RegExp)if(e.global)t=e;else{let i="g";e.ignoreCase&&(i+="i"),e.multiline&&(i+="m"),e.unicode&&(i+="u"),t=new RegExp(e.source,i)}return t.lastIndex=0,t}var ak=new Dn;ak.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function ck(e,t,i,r,s){if(t=ok(t),s||(s=Wt.first(ak)),i.length>s.maxLen){let l=e-s.maxLen/2;return l<0?l=0:r+=l,i=i.substring(l,e+s.maxLen/2),ck(e,t,i,r,s)}const n=Date.now(),o=e-1-r;let a=-1,c=null;for(let l=1;!(Date.now()-n>=s.timeBudget);l++){const u=o-s.windowSize*l;t.lastIndex=Math.max(0,u);const h=yF(t,i,o,a);if(!h&&c||(c=h,u<=0))break;a=u}if(c){const l={word:c[0],startColumn:r+1+c.index,endColumn:r+1+c.index+c[0].length};return t.lastIndex=0,l}return null}function yF(e,t,i,r){let s;for(;s=e.exec(t);){const n=s.index||0;if(n<=i&&e.lastIndex>=i)return s;if(r>0&&n>r)return null}return null}var lk;(function(e){e[e.None=0]="None",e[e.Keep=1]="Keep",e[e.Brackets=2]="Brackets",e[e.Advanced=3]="Advanced",e[e.Full=4]="Full"})(lk||(lk={}));var AF=8,SF=class{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}},at=class{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return bf(e,t)}compute(e,t,i){return i}},wf=class{constructor(e,t){this.newValue=e,this.didChange=t}};function bf(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return new wf(t,e!==t);if(Array.isArray(e)||Array.isArray(t)){const r=Array.isArray(e)&&Array.isArray(t)&&Gi(e,t);return new wf(t,!r)}let i=!1;for(const r in t)if(t.hasOwnProperty(r)){const s=bf(e[r],t[r]);s.didChange&&(e[r]=s.newValue,i=!0)}return new wf(e,i)}var Hn=class{constructor(e,t){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=t}applyUpdate(e,t){return bf(e,t)}validate(e){return this.defaultValue}},uc=class{constructor(e,t,i,r){this.id=e,this.name=t,this.defaultValue=i,this.schema=r}applyUpdate(e,t){return bf(e,t)}compute(e,t,i){return i}};function ee(e,t){return typeof e>"u"?t:e==="false"?!1:!!e}var fe=class extends uc{constructor(e,t,i,r=void 0){typeof r<"u"&&(r.type="boolean",r.default=i),super(e,t,i,r)}validate(e){return ee(e,this.defaultValue)}};function EF(e,t,i,r){if(typeof e=="string"&&(e=parseInt(e,10)),typeof e!="number"||isNaN(e))return t;let s=e;return s=Math.max(i,s),s=Math.min(r,s),s|0}var We=class zM extends uc{static clampedInt(t,i,r,s){return EF(t,i,r,s)}constructor(t,i,r,s,n,o=void 0){typeof o<"u"&&(o.type="integer",o.default=r,o.minimum=s,o.maximum=n),super(t,i,r,o),this.minimum=s,this.maximum=n}validate(t){return zM.clampedInt(t,this.defaultValue,this.minimum,this.maximum)}},Cr=class HM extends uc{static clamp(t,i,r){return t<i?i:t>r?r:t}static float(t,i){return typeof t=="string"&&(t=parseFloat(t)),typeof t!="number"||isNaN(t)?i:t}constructor(t,i,r,s,n,o,a){typeof n<"u"&&(n.type="number",n.default=r,n.minimum=o,n.maximum=a),super(t,i,r,n),this.validationFn=s,this.minimum=o,this.maximum=a}validate(t){return this.validationFn(HM.float(t,this.defaultValue))}},$i=class WM extends uc{static string(t,i){return typeof t!="string"?i:t}constructor(t,i,r,s=void 0){typeof s<"u"&&(s.type="string",s.default=r),super(t,i,r,s)}validate(t){return WM.string(t,this.defaultValue)}};function rt(e,t,i,r){return typeof e!="string"?t:r&&e in r?r[e]:i.indexOf(e)===-1?t:e}var ct=class extends uc{constructor(e,t,i,r,s=void 0){typeof s<"u"&&(s.type="string",s.enum=r.slice(0),s.default=i),super(e,t,i,s),this.c=r}validate(e){return rt(e,this.defaultValue,this.c)}},hu=class extends at{constructor(e,t,i,r,s,n,o=void 0){typeof o<"u"&&(o.type="string",o.enum=s,o.default=r),super(e,t,i,o),this.c=s,this.d=n}validate(e){return typeof e!="string"?this.defaultValue:this.c.indexOf(e)===-1?this.defaultValue:this.d(e)}};function xF(e){switch(e){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}var kF=class extends at{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[d(315,null),d(316,null),d(317,null)],default:"auto",tags:["accessibility"],description:d(318,null)})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}},CF=class extends at{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(29,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:d(319,null)},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:d(320,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:ee(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ee(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}},uk;(function(e){e[e.Hidden=0]="Hidden",e[e.Blink=1]="Blink",e[e.Smooth=2]="Smooth",e[e.Phase=3]="Phase",e[e.Expand=4]="Expand",e[e.Solid=5]="Solid"})(uk||(uk={}));function $F(e){switch(e){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var $r;(function(e){e[e.Line=1]="Line",e[e.Block=2]="Block",e[e.Underline=3]="Underline",e[e.LineThin=4]="LineThin",e[e.BlockOutline=5]="BlockOutline",e[e.UnderlineThin=6]="UnderlineThin"})($r||($r={}));function hk(e){switch(e){case"line":return $r.Line;case"block":return $r.Block;case"underline":return $r.Underline;case"line-thin":return $r.LineThin;case"block-outline":return $r.BlockOutline;case"underline-thin":return $r.UnderlineThin}}var IF=class extends Hn{constructor(){super(162,"")}compute(e,t,i){const r=["monaco-editor"];return t.get(48)&&r.push(t.get(48)),e.extraEditorClassName&&r.push(e.extraEditorClassName),t.get(82)==="default"?r.push("mouse-default"):t.get(82)==="copy"&&r.push("mouse-copy"),t.get(127)&&r.push("showUnused"),t.get(157)&&r.push("showDeprecated"),r.join(" ")}},DF=class extends fe{constructor(){super(45,"emptySelectionClipboard",!0,{description:d(321,null)})}compute(e,t,i){return i&&e.emptySelectionClipboard}},PF=class extends at{constructor(){const e={cursorMoveOnType:!0,findOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0,history:"workspace",replaceHistory:"workspace"};super(50,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:d(322,null)},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[d(323,null),d(324,null),d(325,null)],description:d(326,null)},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[d(327,null),d(328,null),d(329,null)],description:d(330,null)},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:d(331,null),included:Dt},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:d(332,null)},"editor.find.loop":{type:"boolean",default:e.loop,description:d(333,null)},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(334,null),d(335,null)],description:d(336,null)},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[d(337,null),d(338,null)],description:d(339,null)},"editor.find.findOnType":{type:"boolean",default:e.findOnType,description:d(340,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:ee(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),findOnType:ee(t.findOnType,this.defaultValue.findOnType),seedSearchStringFromSelection:typeof t.seedSearchStringFromSelection=="boolean"?t.seedSearchStringFromSelection?"always":"never":rt(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof t.autoFindInSelection=="boolean"?t.autoFindInSelection?"always":"never":rt(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ee(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ee(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ee(t.loop,this.defaultValue.loop),history:rt(t.history,this.defaultValue.history,["never","workspace"]),replaceHistory:rt(t.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}},TF=class Ul extends at{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(60,"fontLigatures",Ul.OFF,{anyOf:[{type:"boolean",description:d(341,null)},{type:"string",description:d(342,null)}],description:d(343,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"||t.length===0?Ul.OFF:t==="true"?Ul.ON:t:t?Ul.ON:Ul.OFF}},MF=class jl extends at{static{this.OFF=ik}static{this.TRANSLATE=rk}constructor(){super(63,"fontVariations",jl.OFF,{anyOf:[{type:"boolean",description:d(344,null)},{type:"string",description:d(345,null)}],description:d(346,null),default:!1})}validate(t){return typeof t>"u"?this.defaultValue:typeof t=="string"?t==="false"?jl.OFF:t==="true"?jl.TRANSLATE:t:t?jl.TRANSLATE:jl.OFF}compute(t,i,r){return t.fontInfo.fontVariationSettings}},NF=class extends Hn{constructor(){super(59,new pF({pixelRatio:0,fontFamily:"",fontWeight:"",fontSize:0,fontFeatureSettings:"",fontVariationSettings:"",lineHeight:0,letterSpacing:0,isMonospace:!1,typicalHalfwidthCharacterWidth:0,typicalFullwidthCharacterWidth:0,canUseHalfwidthRightwardsArrow:!1,spaceWidth:0,middotWidth:0,wsmiddotWidth:0,maxDigitWidth:0},!1))}compute(e,t,i){return e.fontInfo}},RF=class extends Hn{constructor(){super(161,$r.Line)}compute(e,t,i){return e.inputMode==="overtype"?t.get(92):t.get(34)}},LF=class extends Hn{constructor(){super(170,!1)}compute(e,t){return e.editContextSupported&&t.get(44)}},OF=class extends Hn{constructor(){super(172,!1)}compute(e,t){return e.accessibilitySupport===2?t.get(7):t.get(6)}},FF=class extends uc{constructor(){super(61,"fontSize",bs.fontSize,{type:"number",minimum:6,maximum:100,default:bs.fontSize,description:d(347,null)})}validate(e){const t=Cr.float(e,this.defaultValue);return t===0?bs.fontSize:Cr.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}},UF=class zl extends at{static{this.c=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.d=1}static{this.e=1e3}constructor(){super(62,"fontWeight",bs.fontWeight,{anyOf:[{type:"number",minimum:zl.d,maximum:zl.e,errorMessage:d(348,null)},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:zl.c}],default:bs.fontWeight,description:d(349,null)})}validate(t){return t==="normal"||t==="bold"?t:String(We.clampedInt(t,bs.fontWeight,zl.d,zl.e))}},jF=class extends at{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[d(350,null),d(351,null),d(352,null)]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(67,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:d(353,null)},"editor.gotoLocation.multipleDefinitions":{description:d(354,null),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:d(355,null),...t},"editor.gotoLocation.multipleDeclarations":{description:d(356,null),...t},"editor.gotoLocation.multipleImplementations":{description:d(357,null),...t},"editor.gotoLocation.multipleReferences":{description:d(358,null),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:d(359,null)},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:d(360,null)},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:d(361,null)},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:d(362,null)},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:d(363,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:rt(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:rt(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:rt(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:rt(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:rt(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:rt(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:rt(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:$i.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:$i.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:$i.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:$i.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:$i.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:$i.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}},zF=class extends at{constructor(){const e={enabled:"on",delay:300,hidingDelay:300,sticky:!0,above:!0};super(69,"hover",e,{"editor.hover.enabled":{type:"string",enum:["on","off","onKeyboardModifier"],default:e.enabled,markdownEnumDescriptions:[d(364,null),d(365,null),d(366,null,Dt?"Command":"Control")],description:d(367,null)},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:d(368,null)},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:d(369,null)},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,markdownDescription:d(370,null)},"editor.hover.above":{type:"boolean",default:e.above,description:d(371,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:rt(t.enabled,this.defaultValue.enabled,["on","off","onKeyboardModifier"]),delay:We.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:ee(t.sticky,this.defaultValue.sticky),hidingDelay:We.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ee(t.above,this.defaultValue.above)}}},dk;(function(e){e[e.None=0]="None",e[e.Text=1]="Text",e[e.Blocks=2]="Blocks"})(dk||(dk={}));var HF=class _1 extends Hn{constructor(){super(165,{width:0,height:0,glyphMarginLeft:0,glyphMarginWidth:0,glyphMarginDecorationLaneCount:0,lineNumbersLeft:0,lineNumbersWidth:0,decorationsLeft:0,decorationsWidth:0,contentLeft:0,contentWidth:0,minimap:{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:0,minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:0},viewportColumn:0,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1,verticalScrollbarWidth:0,horizontalScrollbarHeight:0,overviewRuler:{top:0,width:0,height:0,right:0}})}compute(t,i,r){return _1.computeLayout(i,{memory:t.memory,outerWidth:t.outerWidth,outerHeight:t.outerHeight,isDominatedByLongLines:t.isDominatedByLongLines,lineHeight:t.fontInfo.lineHeight,viewLineCount:t.viewLineCount,lineNumbersDigitCount:t.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:t.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:t.fontInfo.maxDigitWidth,pixelRatio:t.pixelRatio,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(t){const i=t.height/t.lineHeight,r=Math.floor(t.paddingTop/t.lineHeight);let s=Math.floor(t.paddingBottom/t.lineHeight);t.scrollBeyondLastLine&&(s=Math.max(s,i-1));const n=(r+t.viewLineCount+s)/(t.pixelRatio*t.height),o=Math.floor(t.viewLineCount/n);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:r,extraLinesBeyondLastLine:s,desiredRatio:n,minimapLineCount:o}}static c(t,i){const r=t.outerWidth,s=t.outerHeight,n=t.pixelRatio;if(!t.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(n*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s};const o=i.stableMinimapLayoutInput,a=o&&t.outerHeight===o.outerHeight&&t.lineHeight===o.lineHeight&&t.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&t.pixelRatio===o.pixelRatio&&t.scrollBeyondLastLine===o.scrollBeyondLastLine&&t.paddingTop===o.paddingTop&&t.paddingBottom===o.paddingBottom&&t.minimap.enabled===o.minimap.enabled&&t.minimap.side===o.minimap.side&&t.minimap.size===o.minimap.size&&t.minimap.showSlider===o.minimap.showSlider&&t.minimap.renderCharacters===o.minimap.renderCharacters&&t.minimap.maxColumn===o.minimap.maxColumn&&t.minimap.scale===o.minimap.scale&&t.verticalScrollbarWidth===o.verticalScrollbarWidth&&t.isViewportWrapping===o.isViewportWrapping,c=t.lineHeight,l=t.typicalHalfwidthCharacterWidth,u=t.scrollBeyondLastLine,h=t.minimap.renderCharacters;let f=n>=2?Math.round(t.minimap.scale*2):t.minimap.scale;const p=t.minimap.maxColumn,g=t.minimap.size,v=t.minimap.side,b=t.verticalScrollbarWidth,S=t.viewLineCount,E=t.remainingWidth,$=t.isViewportWrapping,U=h?2:3;let O=Math.floor(n*s);const J=O/n;let F=!1,V=!1,z=U*f,ue=f/n,Re=1;if(g==="fill"||g==="fit"){const{typicalViewportLineCount:Ae,extraLinesBeforeFirstLine:Me,extraLinesBeyondLastLine:Ne,desiredRatio:mt,minimapLineCount:_t}=_1.computeContainedMinimapLineCount({viewLineCount:S,scrollBeyondLastLine:u,paddingTop:t.paddingTop,paddingBottom:t.paddingBottom,height:s,lineHeight:c,pixelRatio:n});if(S/_t>1)F=!0,V=!0,f=1,z=1,ue=f/n;else{let Rt=!1,Si=f+1;if(g==="fit"){const ti=Math.ceil((Me+S+Ne)*z);$&&a&&E<=i.stableFitRemainingWidth?(Rt=!0,Si=i.stableFitMaxMinimapScale):Rt=ti>O}if(g==="fill"||Rt){F=!0;const ti=f;z=Math.min(c*n,Math.max(1,Math.floor(1/mt))),$&&a&&E<=i.stableFitRemainingWidth&&(Si=i.stableFitMaxMinimapScale),f=Math.min(Si,Math.max(1,Math.floor(z/U))),f>ti&&(Re=Math.min(2,f/ti)),ue=f/n/Re,O=Math.ceil(Math.max(Ae,Me+S+Ne)*z),$?(i.stableMinimapLayoutInput=t,i.stableFitRemainingWidth=E,i.stableFitMaxMinimapScale=f):(i.stableMinimapLayoutInput=null,i.stableFitRemainingWidth=0)}}}const ae=Math.floor(p*ue),Z=Math.min(ae,Math.max(0,Math.floor((E-b-2)*ue/(l+ue)))+AF);let _=Math.floor(n*Z);const G=_/n;_=Math.floor(_*Re);const K=h?1:2,re=v==="left"?0:r-Z-b;return{renderMinimap:K,minimapLeft:re,minimapWidth:Z,minimapHeightIsEditorHeight:F,minimapIsSampling:V,minimapScale:f,minimapLineHeight:z,minimapCanvasInnerWidth:_,minimapCanvasInnerHeight:O,minimapCanvasOuterWidth:G,minimapCanvasOuterHeight:J}}static computeLayout(t,i){const r=i.outerWidth|0,s=i.outerHeight|0,n=i.lineHeight|0,o=i.lineNumbersDigitCount|0,a=i.typicalHalfwidthCharacterWidth,c=i.maxDigitWidth,l=i.pixelRatio,u=i.viewLineCount,h=t.get(154),f=h==="inherit"?t.get(153):h,p=f==="inherit"?t.get(149):f,g=t.get(152),v=i.isDominatedByLongLines,b=t.get(66),S=t.get(76).renderType!==0,E=t.get(77),$=t.get(119),U=t.get(96),O=t.get(81),J=t.get(117),F=J.verticalScrollbarSize,V=J.verticalHasArrows,z=J.arrowSize,ue=J.horizontalScrollbarSize,Re=t.get(52),ae=t.get(126)!=="never";let Z=t.get(74);Re&&ae&&(Z+=16);let _=0;if(S){const kn=Math.max(o,E);_=Math.round(kn*c)}let G=0;b&&(G=n*i.glyphMarginDecorationLaneCount);let K=0,re=K+G,Ae=re+_,Me=Ae+Z;const Ne=r-G-_-Z;let mt=!1,_t=!1,tt=-1;t.get(2)===2&&f==="inherit"&&v?(mt=!0,_t=!0):p==="on"||p==="bounded"?_t=!0:p==="wordWrapColumn"&&(tt=g);const Rt=_1.c({outerWidth:r,outerHeight:s,lineHeight:n,typicalHalfwidthCharacterWidth:a,pixelRatio:l,scrollBeyondLastLine:$,paddingTop:U.top,paddingBottom:U.bottom,minimap:O,verticalScrollbarWidth:F,viewLineCount:u,remainingWidth:Ne,isViewportWrapping:_t},i.memory||new SF);Rt.renderMinimap!==0&&Rt.minimapLeft===0&&(K+=Rt.minimapWidth,re+=Rt.minimapWidth,Ae+=Rt.minimapWidth,Me+=Rt.minimapWidth);const Si=Ne-Rt.minimapWidth,ti=Math.max(1,Math.floor((Si-F-2)/a)),br=V?z:0;return _t&&(tt=Math.max(1,ti),p==="bounded"&&(tt=Math.min(tt,g))),{width:r,height:s,glyphMarginLeft:K,glyphMarginWidth:G,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:re,lineNumbersWidth:_,decorationsLeft:Ae,decorationsWidth:Z,contentLeft:Me,contentWidth:Si,minimap:Rt,viewportColumn:ti,isWordWrapMinified:mt,isViewportWrapping:_t,wrappingColumn:tt,verticalScrollbarWidth:F,horizontalScrollbarHeight:ue,overviewRuler:{top:br,width:F,height:s-2*br,right:0}}}},WF=class extends at{constructor(){super(156,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[d(372,null),d(373,null)],type:"string",enum:["simple","advanced"],default:"simple",description:d(374,null)}})}validate(e){return rt(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}},Ys;(function(e){e.Off="off",e.OnCode="onCode",e.On="on"})(Ys||(Ys={}));var BF=class extends at{constructor(){const e={enabled:Ys.OnCode};super(73,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[Ys.Off,Ys.OnCode,Ys.On],default:e.enabled,enumDescriptions:[d(375,null),d(376,null),d(377,null)],description:d(378,null)}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:rt(e.enabled,this.defaultValue.enabled,[Ys.Off,Ys.OnCode,Ys.On])}}},_F=class extends at{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(131,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:d(379,null)},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:d(380,null)},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:d(381,null)},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:d(382,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),maxLineCount:We.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:rt(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ee(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}},VF=class extends at{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1,maximumLength:43};super(159,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:d(383,null),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[d(384,null),d(385,null,Dt?"Ctrl+Option":"Ctrl+Alt"),d(386,null,Dt?"Ctrl+Option":"Ctrl+Alt"),d(387,null)]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:d(388,null,"`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:d(389,null,"`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:d(390,null)},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:d(391,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:rt(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:We.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:$i.string(t.fontFamily,this.defaultValue.fontFamily),padding:ee(t.padding,this.defaultValue.padding),maximumLength:We.clampedInt(t.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}},qF=class extends at{constructor(){super(74,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):We.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?We.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}},GF=class extends Cr{constructor(){super(75,"lineHeight",bs.lineHeight,e=>Cr.clamp(e,0,150),{markdownDescription:d(392,null)},0,150)}compute(e,t,i){return e.fontInfo.lineHeight}},ZF=class extends at{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:"none",renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(81,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:d(393,null)},"editor.minimap.autohide":{type:"string",enum:["none","mouseover","scroll"],enumDescriptions:[d(394,null),d(395,null),d(396,null)],default:e.autohide,description:d(397,null)},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[d(398,null),d(399,null),d(400,null)],default:e.size,description:d(401,null)},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:d(402,null)},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:d(403,null)},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:d(404,null)},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:d(405,null)},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:d(406,null)},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:d(407,null)},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:d(408,null)},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:d(409,null)},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:d(410,null)},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:d(411,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;let i=this.defaultValue.markSectionHeaderRegex;const r=t.markSectionHeaderRegex;if(typeof r=="string")try{new RegExp(r,"d"),i=r}catch{}return{enabled:ee(t.enabled,this.defaultValue.enabled),autohide:rt(t.autohide,this.defaultValue.autohide,["none","mouseover","scroll"]),size:rt(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:rt(t.side,this.defaultValue.side,["right","left"]),showSlider:rt(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ee(t.renderCharacters,this.defaultValue.renderCharacters),scale:We.clampedInt(t.scale,1,1,3),maxColumn:We.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ee(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ee(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:i,sectionHeaderFontSize:Cr.clamp(Cr.float(t.sectionHeaderFontSize,this.defaultValue.sectionHeaderFontSize),4,32),sectionHeaderLetterSpacing:Cr.clamp(Cr.float(t.sectionHeaderLetterSpacing,this.defaultValue.sectionHeaderLetterSpacing),0,5)}}};function JF(e){return e==="ctrlCmd"?Dt?"metaKey":"ctrlKey":"altKey"}var QF=class extends at{constructor(){super(96,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:d(412,null)},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:d(413,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:We.clampedInt(t.top,0,0,1e3),bottom:We.clampedInt(t.bottom,0,0,1e3)}}},YF=class extends at{constructor(){const e={enabled:!0,cycle:!0};super(98,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:d(414,null)},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:d(415,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),cycle:ee(t.cycle,this.defaultValue.cycle)}}},XF=class extends Hn{constructor(){super(163,1)}compute(e,t,i){return e.pixelRatio}},KF=class extends at{constructor(){super(100,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}},eU=class extends at{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[d(416,null),d(417,null),d(418,null)]}];super(102,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:d(419,null)},comments:{anyOf:t,default:e.comments,description:d(420,null)},other:{anyOf:t,default:e.other,description:d(421,null)}},default:e,markdownDescription:d(422,null,"`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:r}=e,s=["on","inline","off"];let n,o,a;return typeof t=="boolean"?n=t?"on":"off":n=rt(t,this.defaultValue.other,s),typeof i=="boolean"?o=i?"on":"off":o=rt(i,this.defaultValue.comments,s),typeof r=="boolean"?a=r?"on":"off":a=rt(r,this.defaultValue.strings,s),{other:n,comments:o,strings:a}}},fk;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval",e[e.Custom=4]="Custom"})(fk||(fk={}));var tU=class extends at{constructor(){super(76,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[d(423,null),d(424,null),d(425,null),d(426,null)],default:"on",description:d(427,null)})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}},iU=class extends at{constructor(){const e=[],t={type:"number",description:d(428,null)};super(116,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:d(429,null),format:"color-hex"}}}]},default:e,description:d(430,null)})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:We.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const r=i;t.push({column:We.clampedInt(r.column,0,0,1e4),color:r.color})}return t.sort((i,r)=>i.column-r.column),t}return this.defaultValue}},rU=class extends at{constructor(){super(105,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}};function pk(e,t){if(typeof e!="string")return t;switch(e){case"hidden":return 2;case"visible":return 3;default:return 1}}var sU=class extends at{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(117,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(431,null),d(432,null),d(433,null)],default:"auto",description:d(434,null)},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[d(435,null),d(436,null),d(437,null)],default:"auto",description:d(438,null)},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:d(439,null)},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:d(440,null)},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:d(441,null)},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:d(442,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=We.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),r=We.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:We.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:pk(t.vertical,this.defaultValue.vertical),horizontal:pk(t.horizontal,this.defaultValue.horizontal),useShadows:ee(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:ee(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ee(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ee(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ee(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:We.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:r,verticalSliderSize:We.clampedInt(t.verticalSliderSize,r,0,1e3),scrollByPage:ee(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ee(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}},qr="inUntrustedWorkspace",qo={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"},nU=class extends at{constructor(){const e={nonBasicASCII:qr,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:qr,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(142,"unicodeHighlight",e,{[qo.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,qr],default:e.nonBasicASCII,description:d(443,null)},[qo.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:d(444,null)},[qo.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:d(445,null)},[qo.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,qr],default:e.includeComments,description:d(446,null)},[qo.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,qr],default:e.includeStrings,description:d(447,null)},[qo.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:d(448,null),additionalProperties:{type:"boolean"}},[qo.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:d(449,null)}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(Li(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(Li(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const r=super.applyUpdate(e,t);return i?new wf(r.newValue,!0):r}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:hc(t.nonBasicASCII,qr,[!0,!1,qr]),invisibleCharacters:ee(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ee(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:hc(t.includeComments,qr,[!0,!1,qr]),includeStrings:hc(t.includeStrings,qr,[!0,!1,qr]),allowedCharacters:this.c(t.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.c(t.allowedLocales,this.defaultValue.allowedLocales)}}c(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[r,s]of Object.entries(e))s===!0&&(i[r]=!0);return i}},oU=class extends at{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default",syntaxHighlightingEnabled:!0,minShowDelay:0,suppressInSnippetMode:!0,edits:{enabled:!0,showCollapsed:!1,renderSideBySide:"auto",allowCodeShifting:"always",showLongDistanceHint:!0},triggerCommandOnProviderChange:!1,experimental:{suppressInlineSuggestions:"",showOnSuggestConflict:"never",emptyResponseInformation:!0}};super(71,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:d(450,null)},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[d(451,null),d(452,null),d(453,null)],description:d(454,null)},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:d(455,null)},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:d(456,null)},"editor.inlineSuggest.suppressInSnippetMode":{type:"boolean",default:e.suppressInSnippetMode,description:d(457,null)},"editor.inlineSuggest.minShowDelay":{type:"number",default:0,minimum:0,maximum:1e4,description:d(458,null)},"editor.inlineSuggest.experimental.suppressInlineSuggestions":{type:"string",default:e.experimental.suppressInlineSuggestions,tags:["experimental"],description:d(459,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.emptyResponseInformation":{type:"boolean",default:e.experimental.emptyResponseInformation,tags:["experimental"],description:d(460,null),experiment:{mode:"auto"}},"editor.inlineSuggest.triggerCommandOnProviderChange":{type:"boolean",default:e.triggerCommandOnProviderChange,tags:["experimental"],description:d(461,null),experiment:{mode:"auto"}},"editor.inlineSuggest.experimental.showOnSuggestConflict":{type:"string",default:e.experimental.showOnSuggestConflict,tags:["experimental"],enum:["always","never","whenSuggestListIsIncomplete"],description:d(462,null),experiment:{mode:"auto"}},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:d(463,null)},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:d(464,null),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showLongDistanceHint":{type:"boolean",default:e.edits.showLongDistanceHint,description:d(465,null),tags:["nextEditSuggestions","experimental"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:d(466,null),enum:["auto","never"],enumDescriptions:[d(467,null),d(468,null)],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:d(469,null),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),mode:rt(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:rt(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ee(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ee(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:$i.string(t.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:ee(t.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),minShowDelay:We.clampedInt(t.minShowDelay,0,0,1e4),suppressInSnippetMode:ee(t.suppressInSnippetMode,this.defaultValue.suppressInSnippetMode),edits:this.c(t.edits),triggerCommandOnProviderChange:ee(t.triggerCommandOnProviderChange,this.defaultValue.triggerCommandOnProviderChange),experimental:this.d(t.experimental)}}c(e){if(!e||typeof e!="object")return this.defaultValue.edits;const t=e;return{enabled:ee(t.enabled,this.defaultValue.edits.enabled),showCollapsed:ee(t.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:rt(t.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),showLongDistanceHint:ee(t.showLongDistanceHint,this.defaultValue.edits.showLongDistanceHint),renderSideBySide:rt(t.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"])}}d(e){if(!e||typeof e!="object")return this.defaultValue.experimental;const t=e;return{suppressInlineSuggestions:$i.string(t.suppressInlineSuggestions,this.defaultValue.experimental.suppressInlineSuggestions),showOnSuggestConflict:rt(t.showOnSuggestConflict,this.defaultValue.experimental.showOnSuggestConflict,["always","never","whenSuggestListIsIncomplete"]),emptyResponseInformation:ee(t.emptyResponseInformation,this.defaultValue.experimental.emptyResponseInformation)}}},aU=class extends at{constructor(){const e={enabled:sk.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:sk.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(21,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(470,null,"`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:d(471,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ee(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}},cU=class extends at{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(22,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(472,null),d(473,null),d(474,null)],default:e.bracketPairs,description:d(475,null)},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[d(476,null),d(477,null),d(478,null)],default:e.bracketPairsHorizontal,description:d(479,null)},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:d(480,null)},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:d(481,null)},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[d(482,null),d(483,null),d(484,null)],default:e.highlightActiveIndentation,description:d(485,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:hc(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:hc(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:ee(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ee(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:hc(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}};function hc(e,t,i){const r=i.indexOf(e);return r===-1?t:i[r]}var lU=class extends at{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(134,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[d(486,null),d(487,null)],default:e.insertMode,description:d(488,null)},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:d(489,null)},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:d(490,null)},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:d(491,null)},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[d(492,null),d(493,null),d(494,null),d(495,null)],default:e.selectionMode,markdownDescription:d(496,null,"`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:d(497,null)},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:d(498,null)},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:d(499,null)},"editor.suggest.preview":{type:"boolean",default:e.preview,description:d(500,null)},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:d(501,null)},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:d(502,null)},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:d(503,null)},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:d(504,null)},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:d(505,null)},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:d(506,null)},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:d(507,null)},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:d(508,null)},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:d(509,null)},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:d(510,null)},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:d(511,null)},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:d(512,null)},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:d(513,null)},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:d(514,null)},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:d(515,null)},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:d(516,null)},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:d(517,null)},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:d(518,null)},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:d(519,null)},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:d(520,null)},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:d(521,null)},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:d(522,null)},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:d(523,null)},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:d(524,null)},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:d(525,null)},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:d(526,null)},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:d(527,null)},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:d(528,null)},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:d(529,null)},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:d(530,null)},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:d(531,null)},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:d(532,null)},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:d(533,null)}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:rt(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ee(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ee(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ee(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ee(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:rt(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ee(t.showIcons,this.defaultValue.showIcons),showStatusBar:ee(t.showStatusBar,this.defaultValue.showStatusBar),preview:ee(t.preview,this.defaultValue.preview),previewMode:rt(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ee(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ee(t.showMethods,this.defaultValue.showMethods),showFunctions:ee(t.showFunctions,this.defaultValue.showFunctions),showConstructors:ee(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:ee(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ee(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ee(t.showFields,this.defaultValue.showFields),showVariables:ee(t.showVariables,this.defaultValue.showVariables),showClasses:ee(t.showClasses,this.defaultValue.showClasses),showStructs:ee(t.showStructs,this.defaultValue.showStructs),showInterfaces:ee(t.showInterfaces,this.defaultValue.showInterfaces),showModules:ee(t.showModules,this.defaultValue.showModules),showProperties:ee(t.showProperties,this.defaultValue.showProperties),showEvents:ee(t.showEvents,this.defaultValue.showEvents),showOperators:ee(t.showOperators,this.defaultValue.showOperators),showUnits:ee(t.showUnits,this.defaultValue.showUnits),showValues:ee(t.showValues,this.defaultValue.showValues),showConstants:ee(t.showConstants,this.defaultValue.showConstants),showEnums:ee(t.showEnums,this.defaultValue.showEnums),showEnumMembers:ee(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ee(t.showKeywords,this.defaultValue.showKeywords),showWords:ee(t.showWords,this.defaultValue.showWords),showColors:ee(t.showColors,this.defaultValue.showColors),showFiles:ee(t.showFiles,this.defaultValue.showFiles),showReferences:ee(t.showReferences,this.defaultValue.showReferences),showFolders:ee(t.showFolders,this.defaultValue.showFolders),showTypeParameters:ee(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ee(t.showSnippets,this.defaultValue.showSnippets),showUsers:ee(t.showUsers,this.defaultValue.showUsers),showIssues:ee(t.showIssues,this.defaultValue.showIssues)}}},uU=class extends at{constructor(){super(129,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:d(534,null),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:d(535,null),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:ee(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ee(e.selectSubwords,this.defaultValue.selectSubwords)}}},hU=class extends at{constructor(){const e=[];super(147,"wordSegmenterLocales",e,{anyOf:[{type:"string"},{type:"array",items:{type:"string"}}],description:d(536,null),type:"array",items:{type:"string"},default:e})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}},gk;(function(e){e[e.None=0]="None",e[e.Same=1]="Same",e[e.Indent=2]="Indent",e[e.DeepIndent=3]="DeepIndent"})(gk||(gk={}));var dU=class extends at{constructor(){super(155,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[d(537,null),d(538,null),d(539,null),d(540,null)],description:d(541,null),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}},fU=class extends Hn{constructor(){super(166,{isDominatedByLongLines:!1,isWordWrapMinified:!1,isViewportWrapping:!1,wrappingColumn:-1})}compute(e,t,i){const r=t.get(165);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:r.isWordWrapMinified,isViewportWrapping:r.isViewportWrapping,wrappingColumn:r.wrappingColumn}}},pU=class extends at{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(43,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(542,null)},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:d(543,null),enum:["afterDrop","never"],enumDescriptions:[d(544,null),d(545,null)],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),showDropSelector:rt(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}},gU=class extends at{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(97,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:d(546,null)},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:d(547,null),enum:["afterPaste","never"],enumDescriptions:[d(548,null),d(549,null)],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:ee(t.enabled,this.defaultValue.enabled),showPasteSelector:rt(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}},mU=[];function M(e){return mU[e.id]=e,e}var mk;(function(e){e[e.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",e[e.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",e[e.accessibilitySupport=2]="accessibilitySupport",e[e.accessibilityPageSize=3]="accessibilityPageSize",e[e.allowOverflow=4]="allowOverflow",e[e.allowVariableLineHeights=5]="allowVariableLineHeights",e[e.allowVariableFonts=6]="allowVariableFonts",e[e.allowVariableFontsInAccessibilityMode=7]="allowVariableFontsInAccessibilityMode",e[e.ariaLabel=8]="ariaLabel",e[e.ariaRequired=9]="ariaRequired",e[e.autoClosingBrackets=10]="autoClosingBrackets",e[e.autoClosingComments=11]="autoClosingComments",e[e.screenReaderAnnounceInlineSuggestion=12]="screenReaderAnnounceInlineSuggestion",e[e.autoClosingDelete=13]="autoClosingDelete",e[e.autoClosingOvertype=14]="autoClosingOvertype",e[e.autoClosingQuotes=15]="autoClosingQuotes",e[e.autoIndent=16]="autoIndent",e[e.autoIndentOnPaste=17]="autoIndentOnPaste",e[e.autoIndentOnPasteWithinString=18]="autoIndentOnPasteWithinString",e[e.automaticLayout=19]="automaticLayout",e[e.autoSurround=20]="autoSurround",e[e.bracketPairColorization=21]="bracketPairColorization",e[e.guides=22]="guides",e[e.codeLens=23]="codeLens",e[e.codeLensFontFamily=24]="codeLensFontFamily",e[e.codeLensFontSize=25]="codeLensFontSize",e[e.colorDecorators=26]="colorDecorators",e[e.colorDecoratorsLimit=27]="colorDecoratorsLimit",e[e.columnSelection=28]="columnSelection",e[e.comments=29]="comments",e[e.contextmenu=30]="contextmenu",e[e.copyWithSyntaxHighlighting=31]="copyWithSyntaxHighlighting",e[e.cursorBlinking=32]="cursorBlinking",e[e.cursorSmoothCaretAnimation=33]="cursorSmoothCaretAnimation",e[e.cursorStyle=34]="cursorStyle",e[e.cursorSurroundingLines=35]="cursorSurroundingLines",e[e.cursorSurroundingLinesStyle=36]="cursorSurroundingLinesStyle",e[e.cursorWidth=37]="cursorWidth",e[e.cursorHeight=38]="cursorHeight",e[e.disableLayerHinting=39]="disableLayerHinting",e[e.disableMonospaceOptimizations=40]="disableMonospaceOptimizations",e[e.domReadOnly=41]="domReadOnly",e[e.dragAndDrop=42]="dragAndDrop",e[e.dropIntoEditor=43]="dropIntoEditor",e[e.editContext=44]="editContext",e[e.emptySelectionClipboard=45]="emptySelectionClipboard",e[e.experimentalGpuAcceleration=46]="experimentalGpuAcceleration",e[e.experimentalWhitespaceRendering=47]="experimentalWhitespaceRendering",e[e.extraEditorClassName=48]="extraEditorClassName",e[e.fastScrollSensitivity=49]="fastScrollSensitivity",e[e.find=50]="find",e[e.fixedOverflowWidgets=51]="fixedOverflowWidgets",e[e.folding=52]="folding",e[e.foldingStrategy=53]="foldingStrategy",e[e.foldingHighlight=54]="foldingHighlight",e[e.foldingImportsByDefault=55]="foldingImportsByDefault",e[e.foldingMaximumRegions=56]="foldingMaximumRegions",e[e.unfoldOnClickAfterEndOfLine=57]="unfoldOnClickAfterEndOfLine",e[e.fontFamily=58]="fontFamily",e[e.fontInfo=59]="fontInfo",e[e.fontLigatures=60]="fontLigatures",e[e.fontSize=61]="fontSize",e[e.fontWeight=62]="fontWeight",e[e.fontVariations=63]="fontVariations",e[e.formatOnPaste=64]="formatOnPaste",e[e.formatOnType=65]="formatOnType",e[e.glyphMargin=66]="glyphMargin",e[e.gotoLocation=67]="gotoLocation",e[e.hideCursorInOverviewRuler=68]="hideCursorInOverviewRuler",e[e.hover=69]="hover",e[e.inDiffEditor=70]="inDiffEditor",e[e.inlineSuggest=71]="inlineSuggest",e[e.letterSpacing=72]="letterSpacing",e[e.lightbulb=73]="lightbulb",e[e.lineDecorationsWidth=74]="lineDecorationsWidth",e[e.lineHeight=75]="lineHeight",e[e.lineNumbers=76]="lineNumbers",e[e.lineNumbersMinChars=77]="lineNumbersMinChars",e[e.linkedEditing=78]="linkedEditing",e[e.links=79]="links",e[e.matchBrackets=80]="matchBrackets",e[e.minimap=81]="minimap",e[e.mouseStyle=82]="mouseStyle",e[e.mouseWheelScrollSensitivity=83]="mouseWheelScrollSensitivity",e[e.mouseWheelZoom=84]="mouseWheelZoom",e[e.multiCursorMergeOverlapping=85]="multiCursorMergeOverlapping",e[e.multiCursorModifier=86]="multiCursorModifier",e[e.mouseMiddleClickAction=87]="mouseMiddleClickAction",e[e.multiCursorPaste=88]="multiCursorPaste",e[e.multiCursorLimit=89]="multiCursorLimit",e[e.occurrencesHighlight=90]="occurrencesHighlight",e[e.occurrencesHighlightDelay=91]="occurrencesHighlightDelay",e[e.overtypeCursorStyle=92]="overtypeCursorStyle",e[e.overtypeOnPaste=93]="overtypeOnPaste",e[e.overviewRulerBorder=94]="overviewRulerBorder",e[e.overviewRulerLanes=95]="overviewRulerLanes",e[e.padding=96]="padding",e[e.pasteAs=97]="pasteAs",e[e.parameterHints=98]="parameterHints",e[e.peekWidgetDefaultFocus=99]="peekWidgetDefaultFocus",e[e.placeholder=100]="placeholder",e[e.definitionLinkOpensInPeek=101]="definitionLinkOpensInPeek",e[e.quickSuggestions=102]="quickSuggestions",e[e.quickSuggestionsDelay=103]="quickSuggestionsDelay",e[e.readOnly=104]="readOnly",e[e.readOnlyMessage=105]="readOnlyMessage",e[e.renameOnType=106]="renameOnType",e[e.renderRichScreenReaderContent=107]="renderRichScreenReaderContent",e[e.renderControlCharacters=108]="renderControlCharacters",e[e.renderFinalNewline=109]="renderFinalNewline",e[e.renderLineHighlight=110]="renderLineHighlight",e[e.renderLineHighlightOnlyWhenFocus=111]="renderLineHighlightOnlyWhenFocus",e[e.renderValidationDecorations=112]="renderValidationDecorations",e[e.renderWhitespace=113]="renderWhitespace",e[e.revealHorizontalRightPadding=114]="revealHorizontalRightPadding",e[e.roundedSelection=115]="roundedSelection",e[e.rulers=116]="rulers",e[e.scrollbar=117]="scrollbar",e[e.scrollBeyondLastColumn=118]="scrollBeyondLastColumn",e[e.scrollBeyondLastLine=119]="scrollBeyondLastLine",e[e.scrollPredominantAxis=120]="scrollPredominantAxis",e[e.selectionClipboard=121]="selectionClipboard",e[e.selectionHighlight=122]="selectionHighlight",e[e.selectionHighlightMaxLength=123]="selectionHighlightMaxLength",e[e.selectionHighlightMultiline=124]="selectionHighlightMultiline",e[e.selectOnLineNumbers=125]="selectOnLineNumbers",e[e.showFoldingControls=126]="showFoldingControls",e[e.showUnused=127]="showUnused",e[e.snippetSuggestions=128]="snippetSuggestions",e[e.smartSelect=129]="smartSelect",e[e.smoothScrolling=130]="smoothScrolling",e[e.stickyScroll=131]="stickyScroll",e[e.stickyTabStops=132]="stickyTabStops",e[e.stopRenderingLineAfter=133]="stopRenderingLineAfter",e[e.suggest=134]="suggest",e[e.suggestFontSize=135]="suggestFontSize",e[e.suggestLineHeight=136]="suggestLineHeight",e[e.suggestOnTriggerCharacters=137]="suggestOnTriggerCharacters",e[e.suggestSelection=138]="suggestSelection",e[e.tabCompletion=139]="tabCompletion",e[e.tabIndex=140]="tabIndex",e[e.trimWhitespaceOnDelete=141]="trimWhitespaceOnDelete",e[e.unicodeHighlighting=142]="unicodeHighlighting",e[e.unusualLineTerminators=143]="unusualLineTerminators",e[e.useShadowDOM=144]="useShadowDOM",e[e.useTabStops=145]="useTabStops",e[e.wordBreak=146]="wordBreak",e[e.wordSegmenterLocales=147]="wordSegmenterLocales",e[e.wordSeparators=148]="wordSeparators",e[e.wordWrap=149]="wordWrap",e[e.wordWrapBreakAfterCharacters=150]="wordWrapBreakAfterCharacters",e[e.wordWrapBreakBeforeCharacters=151]="wordWrapBreakBeforeCharacters",e[e.wordWrapColumn=152]="wordWrapColumn",e[e.wordWrapOverride1=153]="wordWrapOverride1",e[e.wordWrapOverride2=154]="wordWrapOverride2",e[e.wrappingIndent=155]="wrappingIndent",e[e.wrappingStrategy=156]="wrappingStrategy",e[e.showDeprecated=157]="showDeprecated",e[e.inertialScroll=158]="inertialScroll",e[e.inlayHints=159]="inlayHints",e[e.wrapOnEscapedLineFeeds=160]="wrapOnEscapedLineFeeds",e[e.effectiveCursorStyle=161]="effectiveCursorStyle",e[e.editorClassName=162]="editorClassName",e[e.pixelRatio=163]="pixelRatio",e[e.tabFocusMode=164]="tabFocusMode",e[e.layoutInfo=165]="layoutInfo",e[e.wrappingInfo=166]="wrappingInfo",e[e.defaultColorDecorators=167]="defaultColorDecorators",e[e.colorDecoratorsActivatedOn=168]="colorDecoratorsActivatedOn",e[e.inlineCompletionsAccessibilityVerbose=169]="inlineCompletionsAccessibilityVerbose",e[e.effectiveEditContext=170]="effectiveEditContext",e[e.scrollOnMiddleClick=171]="scrollOnMiddleClick",e[e.effectiveAllowVariableFonts=172]="effectiveAllowVariableFonts"})(mk||(mk={}));var Wee={acceptSuggestionOnCommitCharacter:M(new fe(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:d(550,null)})),acceptSuggestionOnEnter:M(new ct(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",d(551,null),""],markdownDescription:d(552,null)})),accessibilitySupport:M(new kF),accessibilityPageSize:M(new We(3,"accessibilityPageSize",500,1,1073741824,{description:d(553,null),tags:["accessibility"]})),allowOverflow:M(new fe(4,"allowOverflow",!0)),allowVariableLineHeights:M(new fe(5,"allowVariableLineHeights",!0,{description:d(554,null)})),allowVariableFonts:M(new fe(6,"allowVariableFonts",!0,{description:d(555,null)})),allowVariableFontsInAccessibilityMode:M(new fe(7,"allowVariableFontsInAccessibilityMode",!1,{description:d(556,null),tags:["accessibility"]})),ariaLabel:M(new $i(8,"ariaLabel",d(557,null))),ariaRequired:M(new fe(9,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:M(new fe(12,"screenReaderAnnounceInlineSuggestion",!0,{description:d(558,null),tags:["accessibility"]})),autoClosingBrackets:M(new ct(10,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(559,null),d(560,null),""],description:d(561,null)})),autoClosingComments:M(new ct(11,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(562,null),d(563,null),""],description:d(564,null)})),autoClosingDelete:M(new ct(13,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",d(565,null),""],description:d(566,null)})),autoClosingOvertype:M(new ct(14,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",d(567,null),""],description:d(568,null)})),autoClosingQuotes:M(new ct(15,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",d(569,null),d(570,null),""],description:d(571,null)})),autoIndent:M(new hu(16,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],xF,{enumDescriptions:[d(572,null),d(573,null),d(574,null),d(575,null),d(576,null)],description:d(577,null)})),autoIndentOnPaste:M(new fe(17,"autoIndentOnPaste",!1,{description:d(578,null)})),autoIndentOnPasteWithinString:M(new fe(18,"autoIndentOnPasteWithinString",!0,{description:d(579,null)})),automaticLayout:M(new fe(19,"automaticLayout",!1)),autoSurround:M(new ct(20,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[d(580,null),d(581,null),d(582,null),""],description:d(583,null)})),bracketPairColorization:M(new aU),bracketPairGuides:M(new cU),stickyTabStops:M(new fe(132,"stickyTabStops",!1,{description:d(584,null)})),codeLens:M(new fe(23,"codeLens",!0,{description:d(585,null)})),codeLensFontFamily:M(new $i(24,"codeLensFontFamily","",{description:d(586,null)})),codeLensFontSize:M(new We(25,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:d(587,null)})),colorDecorators:M(new fe(26,"colorDecorators",!0,{description:d(588,null)})),colorDecoratorActivatedOn:M(new ct(168,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[d(589,null),d(590,null),d(591,null)],description:d(592,null)})),colorDecoratorsLimit:M(new We(27,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:d(593,null)})),columnSelection:M(new fe(28,"columnSelection",!1,{description:d(594,null)})),comments:M(new CF),contextmenu:M(new fe(30,"contextmenu",!0)),copyWithSyntaxHighlighting:M(new fe(31,"copyWithSyntaxHighlighting",!0,{description:d(595,null)})),cursorBlinking:M(new hu(32,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],$F,{description:d(596,null)})),cursorSmoothCaretAnimation:M(new ct(33,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[d(597,null),d(598,null),d(599,null)],description:d(600,null)})),cursorStyle:M(new hu(34,"cursorStyle",$r.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],hk,{description:d(601,null)})),overtypeCursorStyle:M(new hu(92,"overtypeCursorStyle",$r.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],hk,{description:d(602,null)})),cursorSurroundingLines:M(new We(35,"cursorSurroundingLines",0,0,1073741824,{description:d(603,null)})),cursorSurroundingLinesStyle:M(new ct(36,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[d(604,null),d(605,null)],markdownDescription:d(606,null)})),cursorWidth:M(new We(37,"cursorWidth",0,0,1073741824,{markdownDescription:d(607,null)})),cursorHeight:M(new We(38,"cursorHeight",0,0,1073741824,{markdownDescription:d(608,null)})),disableLayerHinting:M(new fe(39,"disableLayerHinting",!1)),disableMonospaceOptimizations:M(new fe(40,"disableMonospaceOptimizations",!1)),domReadOnly:M(new fe(41,"domReadOnly",!1)),dragAndDrop:M(new fe(42,"dragAndDrop",!0,{description:d(609,null)})),emptySelectionClipboard:M(new DF),dropIntoEditor:M(new pU),editContext:M(new fe(44,"editContext",!0,{description:d(610,null),included:$v||EE||mE})),renderRichScreenReaderContent:M(new fe(107,"renderRichScreenReaderContent",!1,{markdownDescription:d(611,null)})),stickyScroll:M(new _F),experimentalGpuAcceleration:M(new ct(46,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[d(612,null),d(613,null)],description:d(614,null)})),experimentalWhitespaceRendering:M(new ct(47,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[d(615,null),d(616,null),d(617,null)],description:d(618,null)})),extraEditorClassName:M(new $i(48,"extraEditorClassName","")),fastScrollSensitivity:M(new Cr(49,"fastScrollSensitivity",5,e=>e<=0?5:e,{markdownDescription:d(619,null)})),find:M(new PF),fixedOverflowWidgets:M(new fe(51,"fixedOverflowWidgets",!1)),folding:M(new fe(52,"folding",!0,{description:d(620,null)})),foldingStrategy:M(new ct(53,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[d(621,null),d(622,null)],description:d(623,null)})),foldingHighlight:M(new fe(54,"foldingHighlight",!0,{description:d(624,null)})),foldingImportsByDefault:M(new fe(55,"foldingImportsByDefault",!1,{description:d(625,null)})),foldingMaximumRegions:M(new We(56,"foldingMaximumRegions",5e3,10,65e3,{description:d(626,null)})),unfoldOnClickAfterEndOfLine:M(new fe(57,"unfoldOnClickAfterEndOfLine",!1,{description:d(627,null)})),fontFamily:M(new $i(58,"fontFamily",bs.fontFamily,{description:d(628,null)})),fontInfo:M(new NF),fontLigatures2:M(new TF),fontSize:M(new FF),fontWeight:M(new UF),fontVariations:M(new MF),formatOnPaste:M(new fe(64,"formatOnPaste",!1,{description:d(629,null)})),formatOnType:M(new fe(65,"formatOnType",!1,{description:d(630,null)})),glyphMargin:M(new fe(66,"glyphMargin",!0,{description:d(631,null)})),gotoLocation:M(new jF),hideCursorInOverviewRuler:M(new fe(68,"hideCursorInOverviewRuler",!1,{description:d(632,null)})),hover:M(new zF),inDiffEditor:M(new fe(70,"inDiffEditor",!1)),inertialScroll:M(new fe(158,"inertialScroll",!1,{description:d(633,null)})),letterSpacing:M(new Cr(72,"letterSpacing",bs.letterSpacing,e=>Cr.clamp(e,-5,20),{description:d(634,null)})),lightbulb:M(new BF),lineDecorationsWidth:M(new qF),lineHeight:M(new GF),lineNumbers:M(new tU),lineNumbersMinChars:M(new We(77,"lineNumbersMinChars",5,1,300)),linkedEditing:M(new fe(78,"linkedEditing",!1,{description:d(635,null)})),links:M(new fe(79,"links",!0,{description:d(636,null)})),matchBrackets:M(new ct(80,"matchBrackets","always",["always","near","never"],{description:d(637,null)})),minimap:M(new ZF),mouseStyle:M(new ct(82,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:M(new Cr(83,"mouseWheelScrollSensitivity",1,e=>e===0?1:e,{markdownDescription:d(638,null)})),mouseWheelZoom:M(new fe(84,"mouseWheelZoom",!1,{markdownDescription:d(Dt?639:640,null)})),multiCursorMergeOverlapping:M(new fe(85,"multiCursorMergeOverlapping",!0,{description:d(641,null)})),multiCursorModifier:M(new hu(86,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],JF,{markdownEnumDescriptions:[d(642,null),d(643,null)],markdownDescription:d(644,null)})),mouseMiddleClickAction:M(new ct(87,"mouseMiddleClickAction","default",["default","openLink","ctrlLeftClick"],{description:d(645,null)})),multiCursorPaste:M(new ct(88,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[d(646,null),d(647,null)],markdownDescription:d(648,null)})),multiCursorLimit:M(new We(89,"multiCursorLimit",1e4,1,1e5,{markdownDescription:d(649,null)})),occurrencesHighlight:M(new ct(90,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[d(650,null),d(651,null),d(652,null)],markdownDescription:d(653,null)})),occurrencesHighlightDelay:M(new We(91,"occurrencesHighlightDelay",0,0,2e3,{description:d(654,null),tags:["preview"]})),overtypeOnPaste:M(new fe(93,"overtypeOnPaste",!0,{description:d(655,null)})),overviewRulerBorder:M(new fe(94,"overviewRulerBorder",!0,{description:d(656,null)})),overviewRulerLanes:M(new We(95,"overviewRulerLanes",3,0,3)),padding:M(new QF),pasteAs:M(new gU),parameterHints:M(new YF),peekWidgetDefaultFocus:M(new ct(99,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[d(657,null),d(658,null)],description:d(659,null)})),placeholder:M(new KF),definitionLinkOpensInPeek:M(new fe(101,"definitionLinkOpensInPeek",!1,{description:d(660,null)})),quickSuggestions:M(new eU),quickSuggestionsDelay:M(new We(103,"quickSuggestionsDelay",10,0,1073741824,{description:d(661,null),experiment:{mode:"auto"}})),readOnly:M(new fe(104,"readOnly",!1)),readOnlyMessage:M(new rU),renameOnType:M(new fe(106,"renameOnType",!1,{description:d(662,null),markdownDeprecationMessage:d(663,null)})),renderControlCharacters:M(new fe(108,"renderControlCharacters",!0,{description:d(664,null),restricted:!0})),renderFinalNewline:M(new ct(109,"renderFinalNewline",$t?"dimmed":"on",["off","on","dimmed"],{description:d(665,null)})),renderLineHighlight:M(new ct(110,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",d(666,null)],description:d(667,null)})),renderLineHighlightOnlyWhenFocus:M(new fe(111,"renderLineHighlightOnlyWhenFocus",!1,{description:d(668,null)})),renderValidationDecorations:M(new ct(112,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:M(new ct(113,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",d(669,null),d(670,null),d(671,null),""],description:d(672,null)})),revealHorizontalRightPadding:M(new We(114,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:M(new fe(115,"roundedSelection",!0,{description:d(673,null)})),rulers:M(new iU),scrollbar:M(new sU),scrollBeyondLastColumn:M(new We(118,"scrollBeyondLastColumn",4,0,1073741824,{description:d(674,null)})),scrollBeyondLastLine:M(new fe(119,"scrollBeyondLastLine",!0,{description:d(675,null)})),scrollOnMiddleClick:M(new fe(171,"scrollOnMiddleClick",!1,{description:d(676,null)})),scrollPredominantAxis:M(new fe(120,"scrollPredominantAxis",!0,{description:d(677,null)})),selectionClipboard:M(new fe(121,"selectionClipboard",!0,{description:d(678,null),included:$t})),selectionHighlight:M(new fe(122,"selectionHighlight",!0,{description:d(679,null)})),selectionHighlightMaxLength:M(new We(123,"selectionHighlightMaxLength",200,0,1073741824,{description:d(680,null)})),selectionHighlightMultiline:M(new fe(124,"selectionHighlightMultiline",!1,{description:d(681,null)})),selectOnLineNumbers:M(new fe(125,"selectOnLineNumbers",!0)),showFoldingControls:M(new ct(126,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[d(682,null),d(683,null),d(684,null)],description:d(685,null)})),showUnused:M(new fe(127,"showUnused",!0,{description:d(686,null)})),showDeprecated:M(new fe(157,"showDeprecated",!0,{description:d(687,null)})),inlayHints:M(new VF),snippetSuggestions:M(new ct(128,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[d(688,null),d(689,null),d(690,null),d(691,null)],description:d(692,null)})),smartSelect:M(new uU),smoothScrolling:M(new fe(130,"smoothScrolling",!1,{description:d(693,null)})),stopRenderingLineAfter:M(new We(133,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:M(new lU),inlineSuggest:M(new oU),inlineCompletionsAccessibilityVerbose:M(new fe(169,"inlineCompletionsAccessibilityVerbose",!1,{description:d(694,null)})),suggestFontSize:M(new We(135,"suggestFontSize",0,0,1e3,{markdownDescription:d(695,null,"`0`","`#editor.fontSize#`")})),suggestLineHeight:M(new We(136,"suggestLineHeight",0,0,1e3,{markdownDescription:d(696,null,"`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:M(new fe(137,"suggestOnTriggerCharacters",!0,{description:d(697,null)})),suggestSelection:M(new ct(138,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[d(698,null),d(699,null),d(700,null)],description:d(701,null)})),tabCompletion:M(new ct(139,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[d(702,null),d(703,null),d(704,null)],description:d(705,null)})),tabIndex:M(new We(140,"tabIndex",0,-1,1073741824)),trimWhitespaceOnDelete:M(new fe(141,"trimWhitespaceOnDelete",!1,{description:d(706,null)})),unicodeHighlight:M(new nU),unusualLineTerminators:M(new ct(143,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[d(707,null),d(708,null),d(709,null)],description:d(710,null)})),useShadowDOM:M(new fe(144,"useShadowDOM",!0)),useTabStops:M(new fe(145,"useTabStops",!0,{description:d(711,null)})),wordBreak:M(new ct(146,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[d(712,null),d(713,null)],description:d(714,null)})),wordSegmenterLocales:M(new hU),wordSeparators:M(new $i(148,"wordSeparators",nk,{description:d(715,null)})),wordWrap:M(new ct(149,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[d(716,null),d(717,null),d(718,null),d(719,null)],description:d(720,null)})),wordWrapBreakAfterCharacters:M(new $i(150,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;\xA2\xB0\u2032\u2033\u2030\u2103\u3001\u3002\uFF61\uFF64\uFFE0\uFF0C\uFF0E\uFF1A\uFF1B\uFF1F\uFF01\uFF05\u30FB\uFF65\u309D\u309E\u30FD\u30FE\u30FC\u30A1\u30A3\u30A5\u30A7\u30A9\u30C3\u30E3\u30E5\u30E7\u30EE\u30F5\u30F6\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308E\u3095\u3096\u31F0\u31F1\u31F2\u31F3\u31F4\u31F5\u31F6\u31F7\u31F8\u31F9\u31FA\u31FB\u31FC\u31FD\u31FE\u31FF\u3005\u303B\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\u201D\u3009\u300B\u300D\u300F\u3011\u3015\uFF09\uFF3D\uFF5D\uFF63")),wordWrapBreakBeforeCharacters:M(new $i(151,"wordWrapBreakBeforeCharacters","([{\u2018\u201C\u3008\u300A\u300C\u300E\u3010\u3014\uFF08\uFF3B\uFF5B\uFF62\xA3\xA5\uFF04\uFFE1\uFFE5+\uFF0B")),wordWrapColumn:M(new We(152,"wordWrapColumn",80,1,1073741824,{markdownDescription:d(721,null)})),wordWrapOverride1:M(new ct(153,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:M(new ct(154,"wordWrapOverride2","inherit",["off","on","inherit"])),wrapOnEscapedLineFeeds:M(new fe(160,"wrapOnEscapedLineFeeds",!1,{markdownDescription:d(722,null)})),effectiveCursorStyle:M(new RF),editorClassName:M(new IF),defaultColorDecorators:M(new ct(167,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[d(723,null),d(724,null),d(725,null)],description:d(726,null)})),pixelRatio:M(new XF),tabFocusMode:M(new fe(164,"tabFocusMode",!1,{markdownDescription:d(727,null)})),layoutInfo:M(new HF),wrappingInfo:M(new fU),wrappingIndent:M(new dU),wrappingStrategy:M(new WF),effectiveEditContextEnabled:M(new LF),effectiveAllowVariableFonts:M(new OF)},Ki,a0=globalThis.vscode;if(typeof a0<"u"&&typeof a0.context<"u"){const e=a0.context.configuration();if(e)Ki=e.product;else throw new Error("Sandbox: unable to resolve product configuration from preload script.")}else if(globalThis._VSCODE_PRODUCT_JSON&&globalThis._VSCODE_PACKAGE_JSON){if(Ki=globalThis._VSCODE_PRODUCT_JSON,Mn.VSCODE_DEV&&Object.assign(Ki,{nameShort:`${Ki.nameShort} Dev`,nameLong:`${Ki.nameLong} Dev`,dataFolderName:`${Ki.dataFolderName}-dev`,serverDataFolderName:Ki.serverDataFolderName?`${Ki.serverDataFolderName}-dev`:void 0}),!Ki.version){const e=globalThis._VSCODE_PACKAGE_JSON;Object.assign(Ki,{version:e.version})}}else Ki={},Object.keys(Ki).length===0&&Object.assign(Ki,{version:"1.104.0-dev",nameShort:"Code - OSS Dev",nameLong:"Code - OSS Dev",applicationName:"code-oss",dataFolderName:".vscode-oss",urlProtocol:"code-oss",reportIssueUrl:"https://github.com/microsoft/vscode/issues/new",licenseName:"MIT",licenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt",serverLicenseUrl:"https://github.com/microsoft/vscode/blob/main/LICENSE.txt"});var bi=Ki,vk=class BM{static{this.count=0}constructor(t){this._proxyIdentifierBrand=void 0,this.sid=t,this.nid=++BM.count}},wk=[];function N(e){const t=new vk(e);return wk[t.nid]=t,t}function yf(e){return wk[e].sid}var fi=class{constructor(e){this.value=e}},bk;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(bk||(bk={}));var yk;(function(e){e[e.UnknownInput=0]="UnknownInput",e[e.TextInput=1]="TextInput",e[e.TextDiffInput=2]="TextDiffInput",e[e.TextMergeInput=3]="TextMergeInput",e[e.NotebookInput=4]="NotebookInput",e[e.NotebookDiffInput=5]="NotebookDiffInput",e[e.CustomEditorInput=6]="CustomEditorInput",e[e.WebviewEditorInput=7]="WebviewEditorInput",e[e.TerminalEditorInput=8]="TerminalEditorInput",e[e.InteractiveEditorInput=9]="InteractiveEditorInput",e[e.ChatEditorInput=10]="ChatEditorInput",e[e.MultiDiffEditorInput=11]="MultiDiffEditorInput"})(yk||(yk={}));var Ak;(function(e){e[e.TAB_OPEN=0]="TAB_OPEN",e[e.TAB_CLOSE=1]="TAB_CLOSE",e[e.TAB_UPDATE=2]="TAB_UPDATE",e[e.TAB_MOVE=3]="TAB_MOVE"})(Ak||(Ak={}));var Sk;(function(e){e[e.Editable=0]="Editable",e[e.SupportsHotExit=1]="SupportsHotExit"})(Sk||(Sk={}));var Ek;(function(e){e[e.Int8Array=1]="Int8Array",e[e.Uint8Array=2]="Uint8Array",e[e.Uint8ClampedArray=3]="Uint8ClampedArray",e[e.Int16Array=4]="Int16Array",e[e.Uint16Array=5]="Uint16Array",e[e.Int32Array=6]="Int32Array",e[e.Uint32Array=7]="Uint32Array",e[e.Float32Array=8]="Float32Array",e[e.Float64Array=9]="Float64Array",e[e.BigInt64Array=10]="BigInt64Array",e[e.BigUint64Array=11]="BigUint64Array"})(Ek||(Ek={}));var xk;(function(e){e[e.Text=1]="Text",e[e.Error=2]="Error",e[e.Rich=3]="Rich"})(xk||(xk={}));var kk;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(kk||(kk={}));var c0;(function(e){e[e.None=0]="None",e[e.Process=1]="Process",e[e.Output=2]="Output",e[e.Hybrid=3]="Hybrid"})(c0||(c0={}));var Bee=class _M{static{this.a=0}static mixin(t){return t._id=_M.a++,t}},Ck;(function(e){e.label="a",e.kind="b",e.detail="c",e.documentation="d",e.sortText="e",e.filterText="f",e.preselect="g",e.insertText="h",e.insertTextRules="i",e.range="j",e.commitCharacters="k",e.additionalTextEdits="l",e.kindModifier="m",e.commandIdent="n",e.commandId="o",e.commandArguments="p"})(Ck||(Ck={}));var $k;(function(e){e.defaultRanges="a",e.completions="b",e.isIncomplete="c",e.duration="d"})($k||($k={}));var Ik;(function(e){e[e.Workspace=0]="Workspace",e[e.TextDocument=1]="TextDocument"})(Ik||(Ik={}));var X={MainThreadAuthentication:N("MainThreadAuthentication"),MainThreadBulkEdits:N("MainThreadBulkEdits"),MainThreadLanguageModels:N("MainThreadLanguageModels"),MainThreadEmbeddings:N("MainThreadEmbeddings"),MainThreadChatAgents2:N("MainThreadChatAgents2"),MainThreadCodeMapper:N("MainThreadCodeMapper"),MainThreadLanguageModelTools:N("MainThreadChatSkills"),MainThreadClipboard:N("MainThreadClipboard"),MainThreadCommands:N("MainThreadCommands"),MainThreadComments:N("MainThreadComments"),MainThreadConfiguration:N("MainThreadConfiguration"),MainThreadConsole:N("MainThreadConsole"),MainThreadDebugService:N("MainThreadDebugService"),MainThreadDecorations:N("MainThreadDecorations"),MainThreadDiagnostics:N("MainThreadDiagnostics"),MainThreadDialogs:N("MainThreadDiaglogs"),MainThreadDocuments:N("MainThreadDocuments"),MainThreadDocumentContentProviders:N("MainThreadDocumentContentProviders"),MainThreadTextEditors:N("MainThreadTextEditors"),MainThreadEditorInsets:N("MainThreadEditorInsets"),MainThreadEditorTabs:N("MainThreadEditorTabs"),MainThreadErrors:N("MainThreadErrors"),MainThreadTreeViews:N("MainThreadTreeViews"),MainThreadDownloadService:N("MainThreadDownloadService"),MainThreadLanguageFeatures:N("MainThreadLanguageFeatures"),MainThreadLanguages:N("MainThreadLanguages"),MainThreadLogger:N("MainThreadLogger"),MainThreadMessageService:N("MainThreadMessageService"),MainThreadOutputService:N("MainThreadOutputService"),MainThreadProgress:N("MainThreadProgress"),MainThreadQuickDiff:N("MainThreadQuickDiff"),MainThreadQuickOpen:N("MainThreadQuickOpen"),MainThreadStatusBar:N("MainThreadStatusBar"),MainThreadSecretState:N("MainThreadSecretState"),MainThreadStorage:N("MainThreadStorage"),MainThreadSpeech:N("MainThreadSpeechProvider"),MainThreadTelemetry:N("MainThreadTelemetry"),MainThreadTerminalService:N("MainThreadTerminalService"),MainThreadTerminalShellIntegration:N("MainThreadTerminalShellIntegration"),MainThreadWebviews:N("MainThreadWebviews"),MainThreadWebviewPanels:N("MainThreadWebviewPanels"),MainThreadWebviewViews:N("MainThreadWebviewViews"),MainThreadCustomEditors:N("MainThreadCustomEditors"),MainThreadUrls:N("MainThreadUrls"),MainThreadUriOpeners:N("MainThreadUriOpeners"),MainThreadProfileContentHandlers:N("MainThreadProfileContentHandlers"),MainThreadWorkspace:N("MainThreadWorkspace"),MainThreadFileSystem:N("MainThreadFileSystem"),MainThreadFileSystemEventService:N("MainThreadFileSystemEventService"),MainThreadExtensionService:N("MainThreadExtensionService"),MainThreadSCM:N("MainThreadSCM"),MainThreadSearch:N("MainThreadSearch"),MainThreadShare:N("MainThreadShare"),MainThreadTask:N("MainThreadTask"),MainThreadWindow:N("MainThreadWindow"),MainThreadLabelService:N("MainThreadLabelService"),MainThreadNotebook:N("MainThreadNotebook"),MainThreadNotebookDocuments:N("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:N("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:N("MainThreadNotebookKernels"),MainThreadNotebookRenderers:N("MainThreadNotebookRenderers"),MainThreadInteractive:N("MainThreadInteractive"),MainThreadTheming:N("MainThreadTheming"),MainThreadTunnelService:N("MainThreadTunnelService"),MainThreadManagedSockets:N("MainThreadManagedSockets"),MainThreadTimeline:N("MainThreadTimeline"),MainThreadTesting:N("MainThreadTesting"),MainThreadLocalization:N("MainThreadLocalizationShape"),MainThreadMcp:N("MainThreadMcpShape"),MainThreadAiRelatedInformation:N("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:N("MainThreadAiEmbeddingVector"),MainThreadChatStatus:N("MainThreadChatStatus"),MainThreadAiSettingsSearch:N("MainThreadAiSettingsSearch"),MainThreadDataChannels:N("MainThreadDataChannels"),MainThreadChatSessions:N("MainThreadChatSessions"),MainThreadChatOutputRenderer:N("MainThreadChatOutputRenderer"),MainThreadChatContext:N("MainThreadChatContext")},ne={ExtHostCodeMapper:N("ExtHostCodeMapper"),ExtHostCommands:N("ExtHostCommands"),ExtHostConfiguration:N("ExtHostConfiguration"),ExtHostDiagnostics:N("ExtHostDiagnostics"),ExtHostDebugService:N("ExtHostDebugService"),ExtHostDecorations:N("ExtHostDecorations"),ExtHostDocumentsAndEditors:N("ExtHostDocumentsAndEditors"),ExtHostDocuments:N("ExtHostDocuments"),ExtHostDocumentContentProviders:N("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:N("ExtHostDocumentSaveParticipant"),ExtHostEditors:N("ExtHostEditors"),ExtHostTreeViews:N("ExtHostTreeViews"),ExtHostFileSystem:N("ExtHostFileSystem"),ExtHostFileSystemInfo:N("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:N("ExtHostFileSystemEventService"),ExtHostLanguages:N("ExtHostLanguages"),ExtHostLanguageFeatures:N("ExtHostLanguageFeatures"),ExtHostQuickOpen:N("ExtHostQuickOpen"),ExtHostQuickDiff:N("ExtHostQuickDiff"),ExtHostStatusBar:N("ExtHostStatusBar"),ExtHostShare:N("ExtHostShare"),ExtHostExtensionService:N("ExtHostExtensionService"),ExtHostLogLevelServiceShape:N("ExtHostLogLevelServiceShape"),ExtHostTerminalService:N("ExtHostTerminalService"),ExtHostTerminalShellIntegration:N("ExtHostTerminalShellIntegration"),ExtHostSCM:N("ExtHostSCM"),ExtHostSearch:N("ExtHostSearch"),ExtHostTask:N("ExtHostTask"),ExtHostWorkspace:N("ExtHostWorkspace"),ExtHostWindow:N("ExtHostWindow"),ExtHostWebviews:N("ExtHostWebviews"),ExtHostWebviewPanels:N("ExtHostWebviewPanels"),ExtHostCustomEditors:N("ExtHostCustomEditors"),ExtHostWebviewViews:N("ExtHostWebviewViews"),ExtHostEditorInsets:N("ExtHostEditorInsets"),ExtHostEditorTabs:N("ExtHostEditorTabs"),ExtHostProgress:N("ExtHostProgress"),ExtHostComments:N("ExtHostComments"),ExtHostSecretState:N("ExtHostSecretState"),ExtHostStorage:N("ExtHostStorage"),ExtHostUrls:N("ExtHostUrls"),ExtHostUriOpeners:N("ExtHostUriOpeners"),ExtHostChatOutputRenderer:N("ExtHostChatOutputRenderer"),ExtHostProfileContentHandlers:N("ExtHostProfileContentHandlers"),ExtHostOutputService:N("ExtHostOutputService"),ExtHostLabelService:N("ExtHostLabelService"),ExtHostNotebook:N("ExtHostNotebook"),ExtHostNotebookDocuments:N("ExtHostNotebookDocuments"),ExtHostNotebookEditors:N("ExtHostNotebookEditors"),ExtHostNotebookKernels:N("ExtHostNotebookKernels"),ExtHostNotebookRenderers:N("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:N("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:N("ExtHostInteractive"),ExtHostChatAgents2:N("ExtHostChatAgents"),ExtHostLanguageModelTools:N("ExtHostChatSkills"),ExtHostChatProvider:N("ExtHostChatProvider"),ExtHostChatContext:N("ExtHostChatContext"),ExtHostSpeech:N("ExtHostSpeech"),ExtHostEmbeddings:N("ExtHostEmbeddings"),ExtHostAiRelatedInformation:N("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:N("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:N("ExtHostAiSettingsSearch"),ExtHostTheming:N("ExtHostTheming"),ExtHostTunnelService:N("ExtHostTunnelService"),ExtHostManagedSockets:N("ExtHostManagedSockets"),ExtHostAuthentication:N("ExtHostAuthentication"),ExtHostTimeline:N("ExtHostTimeline"),ExtHostTesting:N("ExtHostTesting"),ExtHostTelemetry:N("ExtHostTelemetry"),ExtHostLocalization:N("ExtHostLocalization"),ExtHostMcp:N("ExtHostMcp"),ExtHostDataChannels:N("ExtHostDataChannels"),ExtHostChatSessions:N("ExtHostChatSessions")};function Dk(e){return e.toJSON()}var vU=class{constructor(e){this.a=e}transformIncoming(e){const t=this.a.transformIncoming(e);return t===e?e:Dk(y.from(t))}transformOutgoing(e){const t=this.a.transformOutgoing(e);return t===e?e:Dk(y.from(t))}transformOutgoingURI(e){const t=this.a.transformOutgoing(e);return t===e?e:y.from(t)}transformOutgoingScheme(e){return this.a.transformOutgoingScheme(e)}},_ee=new class{transformIncoming(e){return e}transformOutgoing(e){return e}transformOutgoingURI(e){return e}transformOutgoingScheme(e){return e}};function Pk(e,t,i,r){if(!e||r>200)return null;if(typeof e=="object"){if(e.$mid===1)return i?y.revive(t.transformIncoming(e)):t.transformIncoming(e);if(e instanceof W)return null;for(const s in e)if(Object.hasOwnProperty.call(e,s)){const n=Pk(e[s],t,i,r+1);n!==null&&(e[s]=n)}}return null}function du(e,t){const i=Pk(e,t,!1,0);return i===null?e:i}var Tk=class{constructor(){this.a=null,this.b=null,this.d=null,this.f=!1,this.g=null,this.h=!1,this.i=null}get[Symbol.toStringTag](){return this.toString()}j(){return this.a||(this.a=new Promise((e,t)=>{this.b=e,this.d=t,this.f&&this.b(this.g),this.h&&this.d(this.i)})),this.a}resolveOk(e){this.f||this.h||(this.f=!0,this.g=e,this.a&&this.b(e))}resolveErr(e){this.f||this.h||(this.h=!0,this.i=e,this.a?this.d(e):lt(e))}then(e,t){return this.j().then(e,t)}catch(e){return this.j().then(void 0,e)}finally(e){return this.j().finally(e)}},wU=class extends Tk{constructor(){super(),this.h=!0,this.i=new dt}},Mk;function l0(e,t){try{return JSON.stringify(e,t)}catch{return"null"}}var u0="$$ref$$",bU={[u0]:-1};function Nk(e,t=null,i=!1){const r=[];return{jsonString:(i?l0:JSON.stringify)(e,(n,o)=>{if(typeof o>"u")return bU;if(typeof o=="object"){if(o instanceof W){const a=r.push(o)-1;return{[u0]:a}}if(t)return t(n,o)}return o}),referencedBuffers:r}}function Rk(e,t,i){return JSON.parse(e,(r,s)=>{if(s){const n=s[u0];if(typeof n=="number")return t[n];if(i&&s.$mid===1)return i.transformIncoming(s)}return s})}function Lk(e,t){return JSON.stringify(e,t)}function yU(e){return e?(t,i)=>i&&i.$mid===1?e.transformOutgoing(i):i:null}var Ok;(function(e){e[e.LocalSide=0]="LocalSide",e[e.OtherSide=1]="OtherSide"})(Ok||(Ok={}));var Fk;(function(e){e[e.Responsive=0]="Responsive",e[e.Unresponsive=1]="Unresponsive"})(Fk||(Fk={}));var AU=()=>{},SU=Symbol.for("rpcProtocol"),EU=Symbol.for("rpcProxy"),xU=class l5 extends Q{static{Mk=SU}static{this.a=3*1e3}constructor(t,i=null,r=null){super(),this[Mk]=!0,this.b=this.D(new I),this.onDidChangeResponsiveState=this.b.event,this.c=t,this.f=i,this.g=r,this.h=yU(this.g),this.j=!1,this.m=[],this.q=[];for(let s=0,n=vk.count;s<n;s++)this.m[s]=null,this.q[s]=null;this.s=0,this.t=Object.create(null),this.u={},this.w=0,this.y=0,this.z=0,this.C=this.D(new vs(()=>this.H(),1e3)),this.D(this.c.onMessage(s=>this.L(s)))}dispose(){this.j=!0,Object.keys(this.u).forEach(t=>{const i=this.u[t];delete this.u[t],i.resolveErr(Yl())}),super.dispose()}drain(){return typeof this.c.drain=="function"?this.c.drain():Promise.resolve()}F(t){this.y===0&&(this.z=Date.now()+l5.a),this.y++,this.C.isScheduled()||this.C.schedule()}G(t){this.z=Date.now()+l5.a,this.y--,this.y===0&&this.C.cancel(),this.I(0)}H(){this.y!==0&&(Date.now()>this.z?this.I(1):this.C.schedule())}I(t){this.w!==t&&(this.w=t,this.b.fire(this.w))}get responsiveState(){return this.w}transformIncomingURIs(t){return this.g?du(t,this.g):t}getProxy(t){const{nid:i,sid:r}=t;return this.q[i]||(this.q[i]=this.J(i,r)),this.q[i]}J(t,i){const r={get:(s,n)=>(typeof n=="string"&&!s[n]&&n.charCodeAt(0)===36&&(s[n]=(...o)=>this.U(t,n,o)),n===EU?i:s[n])};return new Proxy(Object.create(null),r)}set(t,i){return this.m[t.nid]=i,i}assertRegistered(t){for(let i=0,r=t.length;i<r;i++){const s=t[i];if(!this.m[s.nid])throw new Error(`Missing proxy instance ${s.sid}`)}}L(t){if(this.j)return;const i=t.byteLength,r=Bt.read(t,0),s=r.readUInt8(),n=r.readUInt32();switch(s){case 1:case 2:{let{rpcId:o,method:a,args:c}=Ir.deserializeRequestJSONArgs(r);this.g&&(c=du(c,this.g)),this.M(i,n,o,a,c,s===2);break}case 3:case 4:{let{rpcId:o,method:a,args:c}=Ir.deserializeRequestMixedArgs(r);this.g&&(c=du(c,this.g)),this.M(i,n,o,a,c,s===4);break}case 5:{this.f?.logIncoming(i,n,0,"ack"),this.G(n);break}case 6:{this.N(i,n);break}case 7:{this.O(i,n,void 0);break}case 9:{let o=Ir.deserializeReplyOKJSON(r);this.g&&(o=du(o,this.g)),this.O(i,n,o);break}case 10:{const o=Ir.deserializeReplyOKJSONWithBuffers(r,this.g);this.O(i,n,o);break}case 8:{const o=Ir.deserializeReplyOKVSBuffer(r);this.O(i,n,o);break}case 11:{let o=Ir.deserializeReplyErrError(r);this.g&&(o=du(o,this.g)),this.P(i,n,o);break}case 12:{this.P(i,n,void 0);break}default:console.error("received unexpected message"),console.error(t)}}M(t,i,r,s,n,o){this.f?.logIncoming(t,i,1,`receiveRequest ${yf(r)}.${s}(`,n);const a=String(i);let c,l;if(o){const h=new Qe;n.push(h.token),c=this.Q(r,s,n),l=()=>h.cancel()}else c=this.Q(r,s,n),l=AU;this.t[a]=l;const u=Ir.serializeAcknowledged(i);this.f?.logOutgoing(u.byteLength,i,1,"ack"),this.c.send(u),c.then(h=>{delete this.t[a];const f=Ir.serializeReplyOK(i,h,this.h);this.f?.logOutgoing(f.byteLength,i,1,"reply:",h),this.c.send(f)},h=>{delete this.t[a];const f=Ir.serializeReplyErr(i,h);this.f?.logOutgoing(f.byteLength,i,1,"replyErr:",h),this.c.send(f)})}N(t,i){this.f?.logIncoming(t,i,1,"receiveCancel");const r=String(i);this.t[r]?.()}O(t,i,r){this.f?.logIncoming(t,i,0,"receiveReply:",r);const s=String(i);if(!this.u.hasOwnProperty(s))return;const n=this.u[s];delete this.u[s],n.resolveOk(r)}P(t,i,r){this.f?.logIncoming(t,i,0,"receiveReplyErr:",r);const s=String(i);if(!this.u.hasOwnProperty(s))return;const n=this.u[s];delete this.u[s];let o;r&&(r.$isError?(o=new Error,o.name=r.name,o.message=r.message,o.stack=r.stack):o=r),n.resolveErr(o)}Q(t,i,r){try{return Promise.resolve(this.S(t,i,r))}catch(s){return Promise.reject(s)}}S(t,i,r){const s=this.m[t];if(!s)throw new Error("Unknown actor "+yf(t));const n=s[i];if(typeof n!="function")throw new Error("Unknown method "+i+" on actor "+yf(t));return n.apply(s,r)}U(t,i,r){if(this.j)return new wU;let s=null;if(r.length>0&&Fe.isCancellationToken(r[r.length-1])&&(s=r.pop()),s&&s.isCancellationRequested)return Promise.reject(Yl());const n=Ir.serializeRequestArguments(r,this.h),o=++this.s,a=String(o),c=new Tk,l=new ie;s&&l.add(s.onCancellationRequested(()=>{const h=Ir.serializeCancel(o);this.f?.logOutgoing(h.byteLength,o,0,"cancel"),this.c.send(h)})),this.u[a]=new kU(c,l),this.F(o);const u=Ir.serializeRequest(o,t,i,n,!!s);return this.f?.logOutgoing(u.byteLength,o,0,`request: ${yf(t)}.${i}(`,r),this.c.send(u),c}},kU=class{constructor(e,t){this.a=e,this.b=t}resolveOk(e){this.a.resolveOk(e),this.b.dispose()}resolveErr(e){this.a.resolveErr(e),this.b.dispose()}},Bt=class u5{static alloc(t,i,r){const s=new u5(W.alloc(r+1+4),0);return s.writeUInt8(t),s.writeUInt32(i),s}static read(t,i){return new u5(t,i)}get buffer(){return this.a}constructor(t,i){this.a=t,this.b=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(t){this.a.writeUInt8(t,this.b),this.b+=1}readUInt8(){const t=this.a.readUInt8(this.b);return this.b+=1,t}writeUInt32(t){this.a.writeUInt32BE(t,this.b),this.b+=4}readUInt32(){const t=this.a.readUInt32BE(this.b);return this.b+=4,t}static sizeShortString(t){return 1+t.byteLength}writeShortString(t){this.a.writeUInt8(t.byteLength,this.b),this.b+=1,this.a.set(t,this.b),this.b+=t.byteLength}readShortString(){const t=this.a.readUInt8(this.b);this.b+=1;const r=this.a.slice(this.b,this.b+t).toString();return this.b+=t,r}static sizeLongString(t){return 4+t.byteLength}writeLongString(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readLongString(){const t=this.a.readUInt32BE(this.b);this.b+=4;const r=this.a.slice(this.b,this.b+t).toString();return this.b+=t,r}writeBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}static sizeVSBuffer(t){return 4+t.byteLength}writeVSBuffer(t){this.a.writeUInt32BE(t.byteLength,this.b),this.b+=4,this.a.set(t,this.b),this.b+=t.byteLength}readVSBuffer(){const t=this.a.readUInt32BE(this.b);this.b+=4;const i=this.a.slice(this.b,this.b+t);return this.b+=t,i}static sizeMixedArray(t){let i=0;i+=1;for(let r=0,s=t.length;r<s;r++){const n=t[r];switch(i+=1,n.type){case 1:i+=this.sizeLongString(n.value);break;case 2:i+=this.sizeVSBuffer(n.value);break;case 3:i+=this.sizeUInt32,i+=this.sizeLongString(n.value);for(let o=0;o<n.buffers.length;++o)i+=this.sizeVSBuffer(n.buffers[o]);break;case 4:break}}return i}writeMixedArray(t){this.a.writeUInt8(t.length,this.b),this.b+=1;for(let i=0,r=t.length;i<r;i++){const s=t[i];switch(s.type){case 1:this.writeUInt8(1),this.writeLongString(s.value);break;case 2:this.writeUInt8(2),this.writeVSBuffer(s.value);break;case 3:this.writeUInt8(3),this.writeUInt32(s.buffers.length),this.writeLongString(s.value);for(let n=0;n<s.buffers.length;++n)this.writeBuffer(s.buffers[n]);break;case 4:this.writeUInt8(4);break}}}readMixedArray(){const t=this.a.readUInt8(this.b);this.b+=1;const i=new Array(t);for(let r=0;r<t;r++)switch(this.readUInt8()){case 1:i[r]=this.readLongString();break;case 2:i[r]=this.readVSBuffer();break;case 3:{const n=this.readUInt32(),o=this.readLongString(),a=[];for(let c=0;c<n;++c)a.push(this.readVSBuffer());i[r]=new fi(Rk(o,a,null));break}case 4:i[r]=void 0;break}return i}},Uk;(function(e){e[e.Simple=0]="Simple",e[e.Mixed=1]="Mixed"})(Uk||(Uk={}));var Ir=class{static a(e){for(let t=0,i=e.length;t<i;t++)if(e[t]instanceof W||e[t]instanceof fi||typeof e[t]>"u")return!0;return!1}static serializeRequestArguments(e,t){if(this.a(e)){const i=[];for(let r=0,s=e.length;r<s;r++){const n=e[r];if(n instanceof W)i[r]={type:2,value:n};else if(typeof n>"u")i[r]={type:4};else if(n instanceof fi){const{jsonString:o,referencedBuffers:a}=Nk(n.value,t);i[r]={type:3,value:W.fromString(o),buffers:a}}else i[r]={type:1,value:W.fromString(Lk(n,t))}}return{type:1,args:i}}return{type:0,args:Lk(e,t)}}static serializeRequest(e,t,i,r,s){switch(r.type){case 0:return this.b(e,t,i,r.args,s);case 1:return this.c(e,t,i,r.args,s)}}static b(e,t,i,r,s){const n=W.fromString(i),o=W.fromString(r);let a=0;a+=Bt.sizeUInt8(),a+=Bt.sizeShortString(n),a+=Bt.sizeLongString(o);const c=Bt.alloc(s?2:1,e,a);return c.writeUInt8(t),c.writeShortString(n),c.writeLongString(o),c.buffer}static deserializeRequestJSONArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readLongString();return{rpcId:t,method:i,args:JSON.parse(r)}}static c(e,t,i,r,s){const n=W.fromString(i);let o=0;o+=Bt.sizeUInt8(),o+=Bt.sizeShortString(n),o+=Bt.sizeMixedArray(r);const a=Bt.alloc(s?4:3,e,o);return a.writeUInt8(t),a.writeShortString(n),a.writeMixedArray(r),a.buffer}static deserializeRequestMixedArgs(e){const t=e.readUInt8(),i=e.readShortString(),r=e.readMixedArray(),s=new Array(r.length);for(let n=0,o=r.length;n<o;n++){const a=r[n];typeof a=="string"?s[n]=JSON.parse(a):s[n]=a}return{rpcId:t,method:i,args:s}}static serializeAcknowledged(e){return Bt.alloc(5,e,0).buffer}static serializeCancel(e){return Bt.alloc(6,e,0).buffer}static serializeReplyOK(e,t,i){if(typeof t>"u")return this.d(e);if(t instanceof W)return this.e(e,t);if(t instanceof fi){const{jsonString:r,referencedBuffers:s}=Nk(t.value,i,!0);return this.g(e,r,s)}else return this.f(e,l0(t,i))}static d(e){return Bt.alloc(7,e,0).buffer}static e(e,t){let i=0;i+=Bt.sizeVSBuffer(t);const r=Bt.alloc(8,e,i);return r.writeVSBuffer(t),r.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static f(e,t){const i=W.fromString(t);let r=0;r+=Bt.sizeLongString(i);const s=Bt.alloc(9,e,r);return s.writeLongString(i),s.buffer}static g(e,t,i){const r=W.fromString(t);let s=0;s+=Bt.sizeUInt32,s+=Bt.sizeLongString(r);for(const o of i)s+=Bt.sizeVSBuffer(o);const n=Bt.alloc(10,e,s);n.writeUInt32(i.length),n.writeLongString(r);for(const o of i)n.writeBuffer(o);return n.buffer}static deserializeReplyOKJSON(e){const t=e.readLongString();return JSON.parse(t)}static deserializeReplyOKJSONWithBuffers(e,t){const i=e.readUInt32(),r=e.readLongString(),s=[];for(let n=0;n<i;++n)s.push(e.readVSBuffer());return new fi(Rk(r,s,t))}static serializeReplyErr(e,t){const i=t?l0(Qa(t),null):void 0;if(typeof i!="string")return this.h(e);const r=W.fromString(i);let s=0;s+=Bt.sizeLongString(r);const n=Bt.alloc(11,e,s);return n.writeLongString(r),n.buffer}static deserializeReplyErrError(e){const t=e.readLongString();return JSON.parse(t)}static h(e){return Bt.alloc(12,e,0).buffer}},jk;(function(e){e[e.RequestJSONArgs=1]="RequestJSONArgs",e[e.RequestJSONArgsWithCancellation=2]="RequestJSONArgsWithCancellation",e[e.RequestMixedArgs=3]="RequestMixedArgs",e[e.RequestMixedArgsWithCancellation=4]="RequestMixedArgsWithCancellation",e[e.Acknowledged=5]="Acknowledged",e[e.Cancel=6]="Cancel",e[e.ReplyOKEmpty=7]="ReplyOKEmpty",e[e.ReplyOKVSBuffer=8]="ReplyOKVSBuffer",e[e.ReplyOKJSON=9]="ReplyOKJSON",e[e.ReplyOKJSONWithBuffers=10]="ReplyOKJSONWithBuffers",e[e.ReplyErrError=11]="ReplyErrError",e[e.ReplyErrEmpty=12]="ReplyErrEmpty"})(jk||(jk={}));var zk;(function(e){e[e.String=1]="String",e[e.VSBuffer=2]="VSBuffer",e[e.SerializedObjectWithBuffers=3]="SerializedObjectWithBuffers",e[e.Undefined=4]="Undefined"})(zk||(zk={}));var Gr;(function(e){e.serviceIds=new Map,e.DI_TARGET="$di$target",e.DI_DEPENDENCIES="$di$dependencies";function t(i){return i[e.DI_DEPENDENCIES]||[]}e.getServiceDependencies=t})(Gr||(Gr={}));var dc=H("instantiationService");function CU(e,t,i){t[Gr.DI_TARGET]===t?t[Gr.DI_DEPENDENCIES].push({id:e,index:i}):(t[Gr.DI_DEPENDENCIES]=[{id:e,index:i}],t[Gr.DI_TARGET]=t)}function H(e){if(Gr.serviceIds.has(e))return Gr.serviceIds.get(e);const t=function(i,r,s){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");CU(t,i,s)};return t.toString=()=>e,Gr.serviceIds.set(e,t),t}function Vee(e){return e}function h0(e){if(!e)return;const t=e.indexOf("+");return t<0?e:e.substr(0,t)}var Hk=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"],Wk;(function(e){e[e.System=0]="System",e[e.User=1]="User"})(Wk||(Wk={}));var Bk;(function(e){e.WIN32_X64="win32-x64",e.WIN32_ARM64="win32-arm64",e.LINUX_X64="linux-x64",e.LINUX_ARM64="linux-arm64",e.LINUX_ARMHF="linux-armhf",e.ALPINE_X64="alpine-x64",e.ALPINE_ARM64="alpine-arm64",e.DARWIN_X64="darwin-x64",e.DARWIN_ARM64="darwin-arm64",e.WEB="web",e.UNIVERSAL="universal",e.UNKNOWN="unknown",e.UNDEFINED="undefined"})(Bk||(Bk={}));var Ye=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){if(typeof e>"u"||e===null)return typeof t>"u"||t===null;if(typeof t>"u"||t===null)return!1;if(typeof e=="string"||typeof t=="string"){const i=typeof e=="string"?e:e.value,r=typeof t=="string"?t:t.value;return kr(i,r)}return e._lower===t._lower}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}},Go=class{get size(){return this.c.size}constructor(e){if(this.c=new Set,e)for(const t of e)this.add(t)}add(e){this.c.add(Ye.toKey(e))}delete(e){return this.c.delete(Ye.toKey(e))}has(e){return this.c.has(Ye.toKey(e))}},Wn=class{constructor(){this.c=new Map}clear(){this.c.clear()}delete(e){this.c.delete(Ye.toKey(e))}get(e){return this.c.get(Ye.toKey(e))}has(e){return this.c.has(Ye.toKey(e))}set(e,t){this.c.set(Ye.toKey(e),t)}values(){return this.c.values()}forEach(e){this.c.forEach(e)}[Symbol.iterator](){return this.c[Symbol.iterator]()}},_k=class extends Error{constructor(e,t,i){super(`Error in extension ${Ye.toKey(e)}: ${i??t.message}`,{cause:t}),this.name="ExtensionError",this.extension=e}},qee=H("IBuiltinExtensionsScannerService");function d0(e,t){return t&&(e.stack||e.stacktrace)?d(110,null,qk(e),Vk(e.stack)||Vk(e.stacktrace)):qk(e)}function Vk(e){return Array.isArray(e)?e.join(`
`):e}function qk(e){return e.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${e.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof e.code=="string"&&typeof e.errno=="number"&&typeof e.syscall=="string"?d(111,null,e.message):e.message||d(112,null)}function ys(e=null,t=!1){if(!e)return d(113,null);if(Array.isArray(e)){const i=gt(e),r=ys(i[0],t);return i.length>1?d(114,null,r,i.length):r}if(Oe(e))return e;if(e.detail){const i=e.detail;if(i.error)return d0(i.error,t);if(i.exception)return d0(i.exception,t)}return e.stack?d0(e,t):e.message?e.message:d(115,null)}function Xs(e){return f0(e,0)}function f0(e,t){switch(typeof e){case"object":return e===null?Ks(349,t):Array.isArray(e)?IU(e,t):DU(e,t);case"string":return p0(e,t);case"boolean":return $U(e,t);case"number":return Ks(e,t);case"undefined":return Ks(937,t);default:return Ks(617,t)}}function Ks(e,t){return(t<<5)-t+e|0}function $U(e,t){return Ks(e?433:863,t)}function p0(e,t){t=Ks(149417,t);for(let i=0,r=e.length;i<r;i++)t=Ks(e.charCodeAt(i),t);return t}function IU(e,t){return t=Ks(104579,t),e.reduce((i,r)=>f0(r,i),t)}function DU(e,t){return t=Ks(181387,t),Object.keys(e).sort().reduce((i,r)=>(i=p0(r,i),f0(e[r],i)),t)}var Gk;(function(e){e[e.BLOCK_SIZE=64]="BLOCK_SIZE",e[e.UNICODE_REPLACEMENT=65533]="UNICODE_REPLACEMENT"})(Gk||(Gk={}));function g0(e,t,i=32){const r=i-t,s=~((1<<r)-1);return(e<<t|(s&e)>>>r)>>>0}function fu(e,t=32){return e instanceof ArrayBuffer?qv(W.wrap(new Uint8Array(e))):(e>>>0).toString(16).padStart(t/4,"0")}var Gee=class VM{static{this.g=new DataView(new ArrayBuffer(320))}constructor(){this.h=1732584193,this.l=4023233417,this.m=2562383102,this.n=271733878,this.o=3285377520,this.p=new Uint8Array(67),this.q=new DataView(this.p.buffer),this.r=0,this.t=0,this.u=0,this.v=!1}update(t){const i=t.length;if(i===0)return;const r=this.p;let s=this.r,n=this.u,o,a;for(n!==0?(o=n,a=-1,n=0):(o=t.charCodeAt(0),a=0);;){let c=o;if(ef(o))if(a+1<i){const l=t.charCodeAt(a+1);tf(l)?(a++,c=Nv(o,l)):c=65533}else{n=o;break}else tf(o)&&(c=65533);if(s=this.w(r,s,c),a++,a<i)o=t.charCodeAt(a);else break}this.r=s,this.u=n}w(t,i,r){return r<128?t[i++]=r:r<2048?(t[i++]=192|(r&1984)>>>6,t[i++]=128|(r&63)>>>0):r<65536?(t[i++]=224|(r&61440)>>>12,t[i++]=128|(r&4032)>>>6,t[i++]=128|(r&63)>>>0):(t[i++]=240|(r&1835008)>>>18,t[i++]=128|(r&258048)>>>12,t[i++]=128|(r&4032)>>>6,t[i++]=128|(r&63)>>>0),i>=64&&(this.y(),i-=64,this.t+=64,t[0]=t[64],t[1]=t[65],t[2]=t[66]),i}digest(){return this.v||(this.v=!0,this.u&&(this.u=0,this.r=this.w(this.p,this.r,65533)),this.t+=this.r,this.x()),fu(this.h)+fu(this.l)+fu(this.m)+fu(this.n)+fu(this.o)}x(){this.p[this.r++]=128,this.p.subarray(this.r).fill(0),this.r>56&&(this.y(),this.p.fill(0));const t=8*this.t;this.q.setUint32(56,Math.floor(t/4294967296),!1),this.q.setUint32(60,t%4294967296,!1),this.y()}y(){const t=VM.g,i=this.q;for(let h=0;h<64;h+=4)t.setUint32(h,i.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)t.setUint32(h,g0(t.getUint32(h-12,!1)^t.getUint32(h-32,!1)^t.getUint32(h-56,!1)^t.getUint32(h-64,!1),1),!1);let r=this.h,s=this.l,n=this.m,o=this.n,a=this.o,c,l,u;for(let h=0;h<80;h++)h<20?(c=s&n|~s&o,l=1518500249):h<40?(c=s^n^o,l=1859775393):h<60?(c=s&n|s&o|n&o,l=2400959708):(c=s^n^o,l=3395469782),u=g0(r,5)+c+a+l+t.getUint32(h*4,!1)&4294967295,a=o,o=n,n=g0(s,30),s=r,r=u;this.h=this.h+r&4294967295,this.l=this.l+s&4294967295,this.m=this.m+n&4294967295,this.n=this.n+o&4294967295,this.o=this.o+a&4294967295}},Zk;(function(e){e[e.LParen=0]="LParen",e[e.RParen=1]="RParen",e[e.Neg=2]="Neg",e[e.Eq=3]="Eq",e[e.NotEq=4]="NotEq",e[e.Lt=5]="Lt",e[e.LtEq=6]="LtEq",e[e.Gt=7]="Gt",e[e.GtEq=8]="GtEq",e[e.RegexOp=9]="RegexOp",e[e.RegexStr=10]="RegexStr",e[e.True=11]="True",e[e.False=12]="False",e[e.In=13]="In",e[e.Not=14]="Not",e[e.And=15]="And",e[e.Or=16]="Or",e[e.Str=17]="Str",e[e.QuotedStr=18]="QuotedStr",e[e.Error=19]="Error",e[e.EOF=20]="EOF"})(Zk||(Zk={}));function m0(...e){switch(e.length){case 1:return d(1870,null,e[0]);case 2:return d(1871,null,e[0],e[1]);case 3:return d(1872,null,e[0],e[1],e[2]);default:return}}var PU=d(1873,null),TU=d(1874,null),pu=class h5{constructor(){this.c="",this.d=0,this.e=0,this.f=[],this.g=[],this.m=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(t){switch(t.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return t.isTripleEq?"===":"==";case 4:return t.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return t.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return t.lexeme;case 18:return t.lexeme;case 19:return t.lexeme;case 20:return"EOF";default:throw dv(`unhandled token type: ${JSON.stringify(t)}; have you forgotten to add a case?`)}}static{this.a=new Set(["i","g","s","m","y","u"].map(t=>t.charCodeAt(0)))}static{this.b=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this.g}reset(t){return this.c=t,this.d=0,this.e=0,this.f=[],this.g=[],this}scan(){for(;!this.r();)switch(this.d=this.e,this.i()){case 40:this.k(0);break;case 41:this.k(1);break;case 33:if(this.h(61)){const i=this.h(61);this.f.push({type:4,offset:this.d,isTripleEq:i})}else this.k(2);break;case 39:this.o();break;case 47:this.q();break;case 61:if(this.h(61)){const i=this.h(61);this.f.push({type:3,offset:this.d,isTripleEq:i})}else this.h(126)?this.k(9):this.l(m0("==","=~"));break;case 60:this.k(this.h(61)?6:5);break;case 62:this.k(this.h(61)?8:7);break;case 38:this.h(38)?this.k(15):this.l(m0("&&"));break;case 124:this.h(124)?this.k(16):this.l(m0("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this.n()}return this.d=this.e,this.k(20),Array.from(this.f)}h(t){return this.r()||this.c.charCodeAt(this.e)!==t?!1:(this.e++,!0)}i(){return this.c.charCodeAt(this.e++)}j(){return this.r()?0:this.c.charCodeAt(this.e)}k(t){this.f.push({type:t,offset:this.d})}l(t){const i=this.d,r=this.c.substring(this.d,this.e),s={type:19,offset:this.d,lexeme:r};this.g.push({offset:i,lexeme:r,additionalInfo:t}),this.f.push(s)}n(){this.m.lastIndex=this.d;const t=this.m.exec(this.c);if(t){this.e=this.d+t[0].length;const i=this.c.substring(this.d,this.e),r=h5.b.get(i);r?this.k(r):this.f.push({type:17,lexeme:i,offset:this.d})}}o(){for(;this.j()!==39&&!this.r();)this.i();if(this.r()){this.l(PU);return}this.i(),this.f.push({type:18,lexeme:this.c.substring(this.d+1,this.e-1),offset:this.d+1})}q(){let t=this.e,i=!1,r=!1;for(;;){if(t>=this.c.length){this.e=t,this.l(TU);return}const n=this.c.charCodeAt(t);if(i)i=!1;else if(n===47&&!r){t++;break}else n===91?r=!0:n===92?i=!0:n===93&&(r=!1);t++}for(;t<this.c.length&&h5.a.has(this.c.charCodeAt(t));)t++;this.e=t;const s=this.c.substring(this.d,this.e);this.f.push({type:10,lexeme:s,offset:this.d})}r(){return this.e>=this.c.length}},ci=new Map;ci.set("false",!1),ci.set("true",!0),ci.set("isMac",Dt),ci.set("isLinux",$t),ci.set("isWindows",ze),ci.set("isWeb",No),ci.set("isMacNative",Dt&&!No),ci.set("isEdge",EE),ci.set("isFirefox",RL),ci.set("isChrome",$v),ci.set("isSafari",LL);var MU=Object.prototype.hasOwnProperty,Jk;(function(e){e[e.False=0]="False",e[e.True=1]="True",e[e.Defined=2]="Defined",e[e.Not=3]="Not",e[e.Equals=4]="Equals",e[e.NotEquals=5]="NotEquals",e[e.And=6]="And",e[e.Regex=7]="Regex",e[e.NotRegex=8]="NotRegex",e[e.Or=9]="Or",e[e.In=10]="In",e[e.NotIn=11]="NotIn",e[e.Greater=12]="Greater",e[e.GreaterEquals=13]="GreaterEquals",e[e.Smaller=14]="Smaller",e[e.SmallerEquals=15]="SmallerEquals"})(Jk||(Jk={}));var NU={regexParsingWithErrorRecovery:!0},RU=d(1850,null),LU=d(1851,null),OU=d(1852,null),Qk=d(1853,null),FU=d(1854,null),UU=d(1855,null),jU=d(1856,null),zU=d(1857,null),Yk=class Md{static{this.c=new Error}get lexingErrors(){return this.d.errors}get parsingErrors(){return this.h}constructor(t=NU){this.k=t,this.d=new pu,this.f=[],this.g=0,this.h=[],this.v=/g|y/g}parse(t){if(t===""){this.h.push({message:RU,offset:0,lexeme:"",additionalInfo:LU});return}this.f=this.d.reset(t).scan(),this.g=0,this.h=[];try{const i=this.l();if(!this.E()){const r=this.D(),s=r.type===17?UU:void 0;throw this.h.push({message:FU,offset:r.offset,lexeme:pu.getLexeme(r),additionalInfo:s}),Md.c}return i}catch(i){if(i!==Md.c)throw i;return}}l(){return this.m()}m(){const t=[this.o()];for(;this.y(16);){const i=this.o();t.push(i)}return t.length===1?t[0]:xt.or(...t)}o(){const t=[this.s()];for(;this.y(15);){const i=this.s();t.push(i)}return t.length===1?t[0]:xt.and(...t)}s(){if(this.y(2)){const t=this.D();switch(t.type){case 11:return this.z(),Oi.INSTANCE;case 12:return this.z(),er.INSTANCE;case 0:{this.z();const i=this.l();return this.A(1,Qk),i?.negate()}case 17:return this.z(),vu.create(t.lexeme);default:throw this.B("KEY | true | false | '(' expression ')'",t)}}return this.t()}t(){const t=this.D();switch(t.type){case 11:return this.z(),xt.true();case 12:return this.z(),xt.false();case 0:{this.z();const i=this.l();return this.A(1,Qk),i}case 17:{const i=t.lexeme;if(this.z(),this.y(9)){const s=this.D();if(!this.k.regexParsingWithErrorRecovery){if(this.z(),s.type!==10)throw this.B("REGEX",s);const n=s.lexeme,o=n.lastIndexOf("/"),a=o===n.length-1?void 0:this.w(n.substring(o+1));let c;try{c=new RegExp(n.substring(1,o),a)}catch{throw this.B("REGEX",s)}return S0.create(i,c)}switch(s.type){case 10:case 19:{const n=[s.lexeme];this.z();let o=this.D(),a=0;for(let f=0;f<s.lexeme.length;f++)s.lexeme.charCodeAt(f)===40?a++:s.lexeme.charCodeAt(f)===41&&a--;for(;!this.E()&&o.type!==15&&o.type!==16;){switch(o.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++)o.lexeme.charCodeAt(f)===40?a++:s.lexeme.charCodeAt(f)===41&&a--}if(a<0)break;n.push(pu.getLexeme(o)),this.z(),o=this.D()}const c=n.join(""),l=c.lastIndexOf("/"),u=l===c.length-1?void 0:this.w(c.substring(l+1));let h;try{h=new RegExp(c.substring(1,l),u)}catch{throw this.B("REGEX",s)}return xt.regex(i,h)}case 18:{const n=s.lexeme;this.z();let o=null;if(!nu(n)){const a=n.indexOf("/"),c=n.lastIndexOf("/");if(a!==c&&a>=0){const l=n.slice(a+1,c),u=n[c+1]==="i"?"i":"";try{o=new RegExp(l,u)}catch{throw this.B("REGEX",s)}}}if(o===null)throw this.B("REGEX",s);return S0.create(i,o)}default:throw this.B("REGEX",this.D())}}if(this.y(14)){this.A(13,OU);const s=this.u();return xt.notIn(i,s)}switch(this.D().type){case 3:{this.z();const s=this.u();if(this.x().type===18)return xt.equals(i,s);switch(s){case"true":return xt.has(i);case"false":return xt.not(i);default:return xt.equals(i,s)}}case 4:{this.z();const s=this.u();if(this.x().type===18)return xt.notEquals(i,s);switch(s){case"true":return xt.not(i);case"false":return xt.has(i);default:return xt.notEquals(i,s)}}case 5:return this.z(),y0.create(i,this.u());case 6:return this.z(),A0.create(i,this.u());case 7:return this.z(),Sf.create(i,this.u());case 8:return this.z(),b0.create(i,this.u());case 13:return this.z(),xt.in(i,this.u());default:return xt.has(i)}}case 20:throw this.h.push({message:jU,offset:t.offset,lexeme:"",additionalInfo:zU}),Md.c;default:throw this.B(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this.D())}}u(){const t=this.D();switch(t.type){case 17:case 18:return this.z(),t.lexeme;case 11:return this.z(),"true";case 12:return this.z(),"false";case 13:return this.z(),"in";default:return""}}w(t){return t.replaceAll(this.v,"")}x(){return this.f[this.g-1]}y(t){return this.C(t)?(this.z(),!0):!1}z(){return this.E()||this.g++,this.x()}A(t,i){if(this.C(t))return this.z();throw this.B(i,this.D())}B(t,i,r){const s=d(1858,null,t,pu.getLexeme(i)),n=i.offset,o=pu.getLexeme(i);return this.h.push({message:s,offset:n,lexeme:o,additionalInfo:r}),Md.c}C(t){return this.D().type===t}D(){return this.f[this.g]}E(){return this.D().type===20}},xt=class{static false(){return Oi.INSTANCE}static true(){return er.INSTANCE}static has(e){return mu.create(e)}static equals(e,t){return v0.create(e,t)}static notEquals(e,t){return w0.create(e,t)}static regex(e,t){return S0.create(e,t)}static in(e,t){return Xk.create(e,t)}static notIn(e,t){return Kk.create(e,t)}static not(e){return vu.create(e)}static and(...e){return tC.create(e,null,!0)}static or(...e){return E0.create(e,null,!0)}static greater(e,t){return Sf.create(e,t)}static greaterEquals(e,t){return b0.create(e,t)}static smaller(e,t){return y0.create(e,t)}static smallerEquals(e,t){return A0.create(e,t)}static{this.c=new Yk({regexParsingWithErrorRecovery:!1})}static deserialize(e){return e==null?void 0:this.c.parse(e)}};function HU(e){const t=new Yk({regexParsingWithErrorRecovery:!1});return e.map(i=>(t.parse(i),t.lexingErrors.length>0?t.lexingErrors.map(r=>({errorMessage:r.additionalInfo?d(1859,null,r.additionalInfo):d(1860,null),offset:r.offset,length:r.lexeme.length})):t.parsingErrors.length>0?t.parsingErrors.map(r=>({errorMessage:r.additionalInfo?`${r.message}. ${r.additionalInfo}`:r.message,offset:r.offset,length:r.lexeme.length})):[]))}function gu(e,t){return e.cmp(t)}var Oi=class qM{static{this.INSTANCE=new qM}constructor(){this.type=0}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!1}serialize(){return"false"}keys(){return[]}map(t){return this}negate(){return er.INSTANCE}},er=class GM{static{this.INSTANCE=new GM}constructor(){this.type=1}cmp(t){return this.type-t.type}equals(t){return t.type===this.type}substituteConstants(){return this}evaluate(t){return!0}serialize(){return"true"}keys(){return[]}map(t){return this}negate(){return Oi.INSTANCE}},mu=class ZM{static create(t,i=null){const r=ci.get(t);return typeof r=="boolean"?r?er.INSTANCE:Oi.INSTANCE:new ZM(t,i)}constructor(t,i){this.key=t,this.c=i,this.type=2}cmp(t){return t.type!==this.type?this.type-t.type:iC(this.key,t.key)}equals(t){return t.type===this.type?this.key===t.key:!1}substituteConstants(){const t=ci.get(this.key);return typeof t=="boolean"?t?er.INSTANCE:Oi.INSTANCE:this}evaluate(t){return!!t.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(t){return t.mapDefined(this.key)}negate(){return this.c||(this.c=vu.create(this.key,this)),this.c}},v0=class JM{static create(t,i,r=null){if(typeof i=="boolean")return i?mu.create(t,r):vu.create(t,r);const s=ci.get(t);return typeof s=="boolean"?i===(s?"true":"false")?er.INSTANCE:Oi.INSTANCE:new JM(t,i,r)}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=4}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=ci.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?er.INSTANCE:Oi.INSTANCE}return this}evaluate(t){return t.getValue(this.c)==this.d}serialize(){return`${this.c} == '${this.d}'`}keys(){return[this.c]}map(t){return t.mapEquals(this.c,this.d)}negate(){return this.f||(this.f=w0.create(this.c,this.d,this)),this.f}},Xk=class QM{static create(t,i){return new QM(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=10,this.c=null}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.d,this.f,t.d,t.f)}equals(t){return t.type===this.type?this.d===t.d&&this.f===t.f:!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.f),r=t.getValue(this.d);return Array.isArray(i)?i.includes(r):typeof r=="string"&&typeof i=="object"&&i!==null?MU.call(i,r):!1}serialize(){return`${this.d} in '${this.f}'`}keys(){return[this.d,this.f]}map(t){return t.mapIn(this.d,this.f)}negate(){return this.c||(this.c=Kk.create(this.d,this.f)),this.c}},Kk=class YM{static create(t,i){return new YM(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=11,this.c=Xk.create(t,i)}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`${this.d} not in '${this.f}'`}keys(){return this.c.keys()}map(t){return t.mapNotIn(this.d,this.f)}negate(){return this.c}},w0=class XM{static create(t,i,r=null){if(typeof i=="boolean")return i?vu.create(t,r):mu.create(t,r);const s=ci.get(t);return typeof s=="boolean"?i===(s?"true":"false")?Oi.INSTANCE:er.INSTANCE:new XM(t,i,r)}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=5}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){const t=ci.get(this.c);if(typeof t=="boolean"){const i=t?"true":"false";return this.d===i?Oi.INSTANCE:er.INSTANCE}return this}evaluate(t){return t.getValue(this.c)!=this.d}serialize(){return`${this.c} != '${this.d}'`}keys(){return[this.c]}map(t){return t.mapNotEquals(this.c,this.d)}negate(){return this.f||(this.f=v0.create(this.c,this.d,this)),this.f}},vu=class KM{static create(t,i=null){const r=ci.get(t);return typeof r=="boolean"?r?Oi.INSTANCE:er.INSTANCE:new KM(t,i)}constructor(t,i){this.c=t,this.d=i,this.type=3}cmp(t){return t.type!==this.type?this.type-t.type:iC(this.c,t.c)}equals(t){return t.type===this.type?this.c===t.c:!1}substituteConstants(){const t=ci.get(this.c);return typeof t=="boolean"?t?Oi.INSTANCE:er.INSTANCE:this}evaluate(t){return!t.getValue(this.c)}serialize(){return`!${this.c}`}keys(){return[this.c]}map(t){return t.mapNot(this.c)}negate(){return this.d||(this.d=mu.create(this.c,this)),this.d}};function Af(e,t){if(typeof e=="string"){const i=parseFloat(e);isNaN(i)||(e=i)}return typeof e=="string"||typeof e=="number"?t(e):Oi.INSTANCE}var Sf=class eN{static create(t,i,r=null){return Af(i,s=>new eN(t,s,r))}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=12}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>this.d}serialize(){return`${this.c} > ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreater(this.c,this.d)}negate(){return this.f||(this.f=A0.create(this.c,this.d,this)),this.f}},b0=class tN{static create(t,i,r=null){return Af(i,s=>new tN(t,s,r))}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=13}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))>=this.d}serialize(){return`${this.c} >= ${this.d}`}keys(){return[this.c]}map(t){return t.mapGreaterEquals(this.c,this.d)}negate(){return this.f||(this.f=y0.create(this.c,this.d,this)),this.f}},y0=class iN{static create(t,i,r=null){return Af(i,s=>new iN(t,s,r))}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=14}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<this.d}serialize(){return`${this.c} < ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmaller(this.c,this.d)}negate(){return this.f||(this.f=b0.create(this.c,this.d,this)),this.f}},A0=class rN{static create(t,i,r=null){return Af(i,s=>new rN(t,s,r))}constructor(t,i,r){this.c=t,this.d=i,this.f=r,this.type=15}cmp(t){return t.type!==this.type?this.type-t.type:Zo(this.c,this.d,t.c,t.d)}equals(t){return t.type===this.type?this.c===t.c&&this.d===t.d:!1}substituteConstants(){return this}evaluate(t){return typeof this.d=="string"?!1:parseFloat(t.getValue(this.c))<=this.d}serialize(){return`${this.c} <= ${this.d}`}keys(){return[this.c]}map(t){return t.mapSmallerEquals(this.c,this.d)}negate(){return this.f||(this.f=Sf.create(this.c,this.d,this)),this.f}},S0=class sN{static create(t,i){return new sN(t,i)}constructor(t,i){this.d=t,this.f=i,this.type=7,this.c=null}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.d<t.d)return-1;if(this.d>t.d)return 1;const i=this.f?this.f.source:"",r=t.f?t.f.source:"";return i<r?-1:i>r?1:0}equals(t){if(t.type===this.type){const i=this.f?this.f.source:"",r=t.f?t.f.source:"";return this.d===t.d&&i===r}return!1}substituteConstants(){return this}evaluate(t){const i=t.getValue(this.d);return this.f?this.f.test(i):!1}serialize(){const t=this.f?`/${this.f.source}/${this.f.flags}`:"/invalid/";return`${this.d} =~ ${t}`}keys(){return[this.d]}map(t){return t.mapRegex(this.d,this.f)}negate(){return this.c||(this.c=WU.create(this)),this.c}},WU=class d5{static create(t){return new d5(t)}constructor(t){this.c=t,this.type=8}cmp(t){return t.type!==this.type?this.type-t.type:this.c.cmp(t.c)}equals(t){return t.type===this.type?this.c.equals(t.c):!1}substituteConstants(){return this}evaluate(t){return!this.c.evaluate(t)}serialize(){return`!(${this.c.serialize()})`}keys(){return this.c.keys()}map(t){return new d5(this.c.map(t))}negate(){return this.c}};function eC(e){let t=null;for(let i=0,r=e.length;i<r;i++){const s=e[i].substituteConstants();if(e[i]!==s&&t===null){t=[];for(let n=0;n<i;n++)t[n]=e[n]}t!==null&&(t[i]=s)}return t===null?e:t}var tC=class Hl{static create(t,i,r){return Hl.d(t,i,r)}constructor(t,i){this.expr=t,this.c=i,this.type=6}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,r=this.expr.length;i<r;i++){const s=gu(this.expr[i],t.expr[i]);if(s!==0)return s}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=eC(this.expr);return t===this.expr?this:Hl.create(t,this.c,!1)}evaluate(t){for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].evaluate(t))return!1;return!0}static d(t,i,r){const s=[];let n=!1;for(const o of t)if(o){if(o.type===1){n=!0;continue}if(o.type===0)return Oi.INSTANCE;if(o.type===6){s.push(...o.expr);continue}s.push(o)}if(s.length===0&&n)return er.INSTANCE;if(s.length!==0){if(s.length===1)return s[0];s.sort(gu);for(let o=1;o<s.length;o++)s[o-1].equals(s[o])&&(s.splice(o,1),o--);if(s.length===1)return s[0];for(;s.length>1;){const o=s[s.length-1];if(o.type!==9)break;s.pop();const a=s.pop(),c=s.length===0,l=E0.create(o.expr.map(u=>Hl.create([u,a],null,r)),null,c);l&&(s.push(l),s.sort(gu))}if(s.length===1)return s[0];if(r){for(let o=0;o<s.length;o++)for(let a=o+1;a<s.length;a++)if(s[o].negate().equals(s[a]))return Oi.INSTANCE;if(s.length===1)return s[0]}return new Hl(s,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" && ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Hl(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());this.c=E0.create(t,this,!0)}return this.c}},E0=class Ba{static create(t,i,r){return Ba.d(t,i,r)}constructor(t,i){this.expr=t,this.c=i,this.type=9}cmp(t){if(t.type!==this.type)return this.type-t.type;if(this.expr.length<t.expr.length)return-1;if(this.expr.length>t.expr.length)return 1;for(let i=0,r=this.expr.length;i<r;i++){const s=gu(this.expr[i],t.expr[i]);if(s!==0)return s}return 0}equals(t){if(t.type===this.type){if(this.expr.length!==t.expr.length)return!1;for(let i=0,r=this.expr.length;i<r;i++)if(!this.expr[i].equals(t.expr[i]))return!1;return!0}return!1}substituteConstants(){const t=eC(this.expr);return t===this.expr?this:Ba.create(t,this.c,!1)}evaluate(t){for(let i=0,r=this.expr.length;i<r;i++)if(this.expr[i].evaluate(t))return!0;return!1}static d(t,i,r){let s=[],n=!1;if(t){for(let o=0,a=t.length;o<a;o++){const c=t[o];if(c){if(c.type===0){n=!0;continue}if(c.type===1)return er.INSTANCE;if(c.type===9){s=s.concat(c.expr);continue}s.push(c)}}if(s.length===0&&n)return Oi.INSTANCE;s.sort(gu)}if(s.length!==0){if(s.length===1)return s[0];for(let o=1;o<s.length;o++)s[o-1].equals(s[o])&&(s.splice(o,1),o--);if(s.length===1)return s[0];if(r){for(let o=0;o<s.length;o++)for(let a=o+1;a<s.length;a++)if(s[o].negate().equals(s[a]))return er.INSTANCE;if(s.length===1)return s[0]}return new Ba(s,i)}}serialize(){return this.expr.map(t=>t.serialize()).join(" || ")}keys(){const t=[];for(const i of this.expr)t.push(...i.keys());return t}map(t){return new Ba(this.expr.map(i=>i.map(t)),null)}negate(){if(!this.c){const t=[];for(const i of this.expr)t.push(i.negate());for(;t.length>1;){const i=t.shift(),r=t.shift(),s=[];for(const n of rC(i))for(const o of rC(r))s.push(tC.create([n,o],null,!1));t.unshift(Ba.create(s,null,!1))}this.c=Ba.create(t,this,!0)}return this.c}},k=class V1 extends mu{static{this.d=[]}static all(){return V1.d.values()}constructor(t,i,r){super(t,null),this.f=i,typeof r=="object"?V1.d.push({...r,key:t}):r!==!0&&V1.d.push({key:t,description:r,type:i!=null?typeof i:void 0})}bindTo(t){return t.createKey(this.key,this.f)}getValue(t){return t.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(t){return v0.create(this.key,t)}notEqualsTo(t){return w0.create(this.key,t)}greater(t){return Sf.create(this.key,t)}},Bn=H("contextKeyService");function iC(e,t){return e<t?-1:e>t?1:0}function Zo(e,t,i,r){return e<i?-1:e>i?1:t<r?-1:t>r?1:0}function rC(e){return e.type===9?e.expr:[e]}var Se=H("logService"),_n=H("loggerService"),Y;(function(e){e[e.Off=0]="Off",e[e.Trace=1]="Trace",e[e.Debug=2]="Debug",e[e.Info=3]="Info",e[e.Warning=4]="Warning",e[e.Error=5]="Error"})(Y||(Y={}));var BU=Y.Info;function x0(e,t){return e!==Y.Off&&e<=t}function _U(e,t,i){switch(t){case Y.Trace:e.trace(i);break;case Y.Debug:e.debug(i);break;case Y.Info:e.info(i);break;case Y.Warning:e.warn(i);break;case Y.Error:e.error(i);break;case Y.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function fc(e,t=!1){let i="";for(let r=0;r<e.length;r++){let s=e[r];if(s instanceof Error&&(s=ys(s,t)),typeof s=="object")try{s=JSON.stringify(s)}catch{}i+=(r>0?" ":"")+s}return i}var sC=class extends Q{constructor(){super(...arguments),this.b=BU,this.c=this.D(new I)}get onDidChangeLogLevel(){return this.c.event}setLevel(e){this.b!==e&&(this.b=e,this.c.fire(this.b))}getLevel(){return this.b}f(e){return x0(this.b,e)}g(e){return this.B.isDisposed?!1:this.f(e)}},k0=class extends sC{constructor(e){super(),this.h=e}f(e){return this.h||super.f(e)}trace(e,...t){this.g(Y.Trace)&&this.m(Y.Trace,fc([e,...t],!0))}debug(e,...t){this.g(Y.Debug)&&this.m(Y.Debug,fc([e,...t]))}info(e,...t){this.g(Y.Info)&&this.m(Y.Info,fc([e,...t]))}warn(e,...t){this.g(Y.Warning)&&this.m(Y.Warning,fc([e,...t]))}error(e,...t){if(this.g(Y.Error))if(e instanceof Error){const i=Array.prototype.slice.call(arguments);i[0]=e.stack,this.m(Y.Error,fc(i))}else this.m(Y.Error,fc([e,...t]))}flush(){}},VU=class extends sC{constructor(e){super(),this.h=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.h)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.h)i.trace(e,...t)}debug(e,...t){for(const i of this.h)i.debug(e,...t)}info(e,...t){for(const i of this.h)i.info(e,...t)}warn(e,...t){for(const i of this.h)i.warn(e,...t)}error(e,...t){for(const i of this.h)i.error(e,...t)}flush(){for(const e of this.h)e.flush()}dispose(){for(const e of this.h)e.dispose();super.dispose()}},qU=class extends Q{constructor(e,t,i){if(super(),this.j=e,this.m=t,this.b=new zt,this.f=this.D(new I),this.onDidChangeLoggers=this.f.event,this.g=this.D(new I),this.onDidChangeLogLevel=this.g.event,this.h=this.D(new I),this.onDidChangeVisibility=this.h.event,i)for(const r of i)this.b.set(r.resource,{logger:void 0,info:r})}n(e){return Oe(e)?[...this.b.values()].find(t=>t.info.id===e):this.b.get(e)}getLogger(e){return this.n(e)?.logger}createLogger(e,t){const i=this.q(e),r=Oe(e)?e:t?.id??Xs(i.toString()).toString(16);let s=this.b.get(i)?.logger;const n=t?.logLevel==="always"?Y.Trace:t?.logLevel;s||(s=this.s(i,n??this.getLogLevel(i)??this.j,{...t,id:r}));const o={logger:s,info:{resource:i,id:r,logLevel:n,name:t?.name,hidden:t?.hidden,group:t?.group,extensionId:t?.extensionId,when:t?.when}};return this.registerLogger(o.info),this.b.set(i,o),s}q(e){return Oe(e)?It(this.m,`${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`):e}setLogLevel(e,t){if(y.isUri(e)){const i=e,r=t,s=this.b.get(i);s&&r!==s.info.logLevel&&(s.info.logLevel=r===this.j?void 0:r,s.logger?.setLevel(r),this.b.set(s.info.resource,s),this.g.fire([i,r]))}else{this.j=e;for(const[i,r]of this.b.entries())this.b.get(i)?.info.logLevel===void 0&&r.logger?.setLevel(this.j);this.g.fire(this.j)}}setVisibility(e,t){const i=this.n(e);i&&t!==!i.info.hidden&&(i.info.hidden=!t,this.b.set(i.info.resource,i),this.h.fire([i.info.resource,t]))}getLogLevel(e){let t;return e&&(t=this.b.get(e)?.info.logLevel),t??this.j}registerLogger(e){const t=this.b.get(e.resource);t?t.info.hidden!==e.hidden&&this.setVisibility(e.resource,!e.hidden):(this.b.set(e.resource,{info:e,logger:void 0}),this.f.fire({added:[e],removed:[]}))}deregisterLogger(e){const t=this.q(e),i=this.b.get(t);i&&(i.logger&&i.logger.dispose(),this.b.delete(t),this.f.fire({added:[],removed:[i.info]}))}*getRegisteredLoggers(){for(const e of this.b.values())yield e.info}getRegisteredLogger(e){return this.b.get(e)?.info}dispose(){this.b.forEach(e=>e.logger?.dispose()),this.b.clear(),super.dispose()}};function GU(e){switch(e){case Y.Trace:return"trace";case Y.Debug:return"debug";case Y.Info:return"info";case Y.Warning:return"warn";case Y.Error:return"error";case Y.Off:return"off"}}function ZU(e){switch(e){case"trace":return Y.Trace;case"debug":return Y.Debug;case"info":return Y.Info;case"warn":return Y.Warning;case"error":return Y.Error;case"critical":return Y.Error;case"off":return Y.Off}}var Zee=new k("logLevel",GU(Y.Info)),As=class{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}},nC=[],oC;(function(e){e[e.Eager=0]="Eager",e[e.Delayed=1]="Delayed"})(oC||(oC={}));function De(e,t,i){t instanceof As||(t=new As(t,[],!!i)),nC.push([e,t])}function JU(){return nC}var C0=class{constructor(...e){this.a=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this.a.get(e);return this.a.set(e,t),i}has(e){return this.a.has(e)}get(e){return this.a.get(e)}},Ft=H("IExtHostInitDataService"),QU=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}},aC=class{constructor(e){this.b=e,this.a=new Map}roots(){const e=[];for(const t of this.a.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),r=this.lookupOrInsertNode(t);i.outgoing.set(r.key,r),r.incoming.set(i.key,i)}removeNode(e){const t=this.b(e);this.a.delete(t);for(const i of this.a.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this.b(e);let i=this.a.get(t);return i||(i=new QU(t,e),this.a.set(t,i)),i}lookup(e){return this.a.get(this.b(e))}isEmpty(){return this.a.size===0}toString(){const e=[];for(const[t,i]of this.a)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this.a){const i=new Set([e]),r=this.c(t,i);if(r)return r}}c(e,t){for(const[i,r]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this.c(r,t);if(s)return s;t.delete(i)}}},YU=!1,cC=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},XU=class f5{constructor(t=new C0,i=!1,r,s=YU){this.i=t,this.j=i,this.k=r,this.l=s,this.f=!1,this.g=new Set,this.h=new Set,this.t=new Set,this.i.set(dc,this),this._globalGraph=s?r?._globalGraph??new aC(n=>n):void 0}dispose(){if(!this.f){this.f=!0,Zi(this.h),this.h.clear();for(const t of this.g)iE(t)&&t.dispose();this.g.clear()}}m(){if(this.f)throw new Error("InstantiationService has been disposed")}createChild(t,i){this.m();const r=this,s=new class extends f5{dispose(){r.h.delete(s),super.dispose()}}(t,this.j,this,this.l);return this.h.add(s),i?.add(s),s}invokeFunction(t,...i){this.m();const r=$0.traceInvocation(this.l,t);let s=!1;try{return t({get:o=>{if(s)throw dv("service accessor is only valid during the invocation of its target method");const a=this.s(o,r);return a||this.y(`[invokeFunction] unknown service '${o}'`,!1),a}},...i)}finally{s=!0,r.stop()}}createInstance(t,...i){this.m();let r,s;return t instanceof As?(r=$0.traceCreation(this.l,t.ctor),s=this.o(t.ctor,t.staticArguments.concat(i),r)):(r=$0.traceCreation(this.l,t),s=this.o(t,i,r)),r.stop(),s}o(t,i=[],r){const s=Gr.getServiceDependencies(t).sort((a,c)=>a.index-c.index),n=[];for(const a of s){const c=this.s(a.id,r);c||this.y(`[createInstance] ${t.name} depends on UNKNOWN service ${a.id}.`,!1),n.push(c)}const o=s.length>0?s[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${t.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;a>0?i=i.concat(new Array(a)):i=i.slice(0,o)}return Reflect.construct(t,i.concat(n))}q(t,i){if(this.i.get(t)instanceof As)this.i.set(t,i);else if(this.k)this.k.q(t,i);else throw new Error("illegalState - setting UNKNOWN service instance")}r(t){const i=this.i.get(t);return!i&&this.k?this.k.r(t):i}s(t,i){this._globalGraph&&this.c&&this._globalGraph.insertEdge(this.c,String(t));const r=this.r(t);return r instanceof As?this.u(t,r,i.branch(t,!0)):(i.branch(t,!1),r)}u(t,i,r){if(this.t.has(t))throw new Error(`illegal state - RECURSIVELY instantiating service '${t}'`);this.t.add(t);try{return this.v(t,i,r)}finally{this.t.delete(t)}}v(t,i,r){const s=new aC(c=>c.id.toString());let n=0;const o=[{id:t,desc:i,_trace:r}],a=new Set;for(;o.length;){const c=o.pop();if(!a.has(String(c.id))){if(a.add(String(c.id)),s.lookupOrInsertNode(c),n++>1e3)throw new cC(s);for(const l of Gr.getServiceDependencies(c.desc.ctor)){const u=this.r(l.id);if(u||this.y(`[createInstance] ${t} depends on ${l.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(c.id),String(l.id)),u instanceof As){const h={id:l.id,desc:u,_trace:c._trace.branch(l.id,!0)};s.insertEdge(c,h),o.push(h)}}}}for(;;){const c=s.roots();if(c.length===0){if(!s.isEmpty())throw new cC(s);break}for(const{data:l}of c){if(this.r(l.id)instanceof As){const h=this.w(l.id,l.desc.ctor,l.desc.staticArguments,l.desc.supportsDelayedInstantiation,l._trace);this.q(l.id,h)}s.removeNode(l)}}return this.r(t)}w(t,i,r=[],s,n){if(this.i.get(t)instanceof As)return this.x(t,i,r,s,n,this.g);if(this.k)return this.k.w(t,i,r,s,n);throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}x(t,i,r=[],s,n,o){if(s){const a=new f5(void 0,this.j,this,this.l);a.c=String(t);const c=new Map,l=new K2(()=>{const u=a.o(i,r,n);for(const[h,f]of c){const p=u[h];if(typeof p=="function")for(const g of f)g.disposable=p.apply(u,g.listener)}return c.clear(),o.add(u),u});return new Proxy(Object.create(null),{get(u,h){if(!l.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let g=c.get(h);return g||(g=new Dn,c.set(h,g)),(b,S,E)=>{if(l.isInitialized)return l.value[h](b,S,E);{const $={listener:[b,S,E],disposable:void 0},U=g.push($);return te(()=>{U(),$.disposable?.dispose()})}}}if(h in u)return u[h];const f=l.value;let p=f[h];return typeof p!="function"||(p=p.bind(f),u[h]=p),p},set(u,h,f){return l.value[h]=f,!0},getPrototypeOf(u){return i.prototype}})}else{const a=this.o(i,r,n);return o.add(a),a}}y(t,i){if(i&&console.warn(t),this.j)throw new Error(t)}},lC;(function(e){e[e.None=0]="None",e[e.Creation=1]="Creation",e[e.Invocation=2]="Invocation",e[e.Branch=3]="Branch"})(lC||(lC={}));var $0=class zs{static{this.all=new Set}static{this.c=new class extends zs{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(t,i){return t?new zs(2,i.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):zs.c}static traceCreation(t,i){return t?new zs(1,i.name):zs.c}static{this.f=0}constructor(t,i){this.type=t,this.name=i,this.g=Date.now(),this.h=[]}branch(t,i){const r=new zs(3,t.toString());return this.h.push([t,i,r]),r}stop(){const t=Date.now()-this.g;zs.f+=t;let i=!1;function r(n,o){const a=[],c=new Array(n+1).join("	");for(const[l,u,h]of o.h)if(u&&h){i=!0,a.push(`${c}CREATES -> ${l}`);const f=r(n+1,h);f&&a.push(f)}else a.push(`${c}uses -> ${l}`);return a.join(`
`)}const s=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${r(1,this)}`,`DONE, took ${t.toFixed(2)}ms (grand total ${zs.f.toFixed(2)}ms)`];(t>2||i)&&zs.all.add(s.join(`
`))}},Ce=H("IExtHostRpcService"),KU=class{constructor(e){this.getProxy=e.getProxy.bind(e),this.set=e.set.bind(e),this.dispose=e.dispose.bind(e),this.assertRegistered=e.assertRegistered.bind(e),this.drain=e.drain.bind(e)}},wu=H("IURITransformerService"),ej=class{constructor(e){e?(this.transformIncoming=e.transformIncoming.bind(e),this.transformOutgoing=e.transformOutgoing.bind(e),this.transformOutgoingURI=e.transformOutgoingURI.bind(e),this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)):(this.transformIncoming=t=>t,this.transformOutgoing=t=>t,this.transformOutgoingURI=t=>t,this.transformOutgoingScheme=t=>t)}},tj=class{constructor(){this.b="",this.c=0}reset(e){return this.b=e,this.c=0,this}next(){return this.c+=1,this}hasNext(){return this.c<this.b.length-1}cmp(e){const t=e.charCodeAt(0),i=this.b.charCodeAt(this.c);return t-i}value(){return this.b[this.c]}},ij=class{constructor(e=!0){this.e=e}reset(e){return this.b=e,this.c=0,this.d=0,this.next()}hasNext(){return this.d<this.b.length}next(){this.c=this.d;let e=!0;for(;this.d<this.b.length;this.d++)if(this.b.charCodeAt(this.d)===46)if(e)this.c++;else break;else e=!1;return this}cmp(e){return this.e?Tv(e,this.b,0,e.length,this.c,this.d):ic(e,this.b,0,e.length,this.c,this.d)}value(){return this.b.substring(this.c,this.d)}},uC=class{constructor(e=!0,t=!0){this.f=e,this.g=t}reset(e){this.d=0,this.e=0,this.b=e,this.c=e.length;for(let t=e.length-1;t>=0;t--,this.c--){const i=this.b.charCodeAt(t);if(!(i===47||this.f&&i===92))break}return this.next()}hasNext(){return this.e<this.c}next(){this.d=this.e;let e=!0;for(;this.e<this.c;this.e++){const t=this.b.charCodeAt(this.e);if(t===47||this.f&&t===92)if(e)this.d++;else break;else e=!1}return this}cmp(e){return this.g?Tv(e,this.b,0,e.length,this.d,this.e):ic(e,this.b,0,e.length,this.d,this.e)}value(){return this.b.substring(this.d,this.e)}},hC;(function(e){e[e.Scheme=1]="Scheme",e[e.Authority=2]="Authority",e[e.Path=3]="Path",e[e.Query=4]="Query",e[e.Fragment=5]="Fragment"})(hC||(hC={}));var dC=class{constructor(e,t){this.f=e,this.g=t,this.d=[],this.e=0}reset(e){return this.c=e,this.d=[],this.c.scheme&&this.d.push(1),this.c.authority&&this.d.push(2),this.c.path&&(this.b=new uC(!1,!this.f(e)),this.b.reset(e.path),this.b.value()&&this.d.push(3)),this.g(e)||(this.c.query&&this.d.push(4),this.c.fragment&&this.d.push(5)),this.e=0,this}next(){return this.d[this.e]===3&&this.b.hasNext()?this.b.next():this.e+=1,this}hasNext(){return this.d[this.e]===3&&this.b.hasNext()||this.e<this.d.length-1}cmp(e){if(this.d[this.e]===1)return Mv(e,this.c.scheme);if(this.d[this.e]===2)return Mv(e,this.c.authority);if(this.d[this.e]===3)return this.b.cmp(e);if(this.d[this.e]===4)return jo(e,this.c.query);if(this.d[this.e]===5)return jo(e,this.c.fragment);throw new Error}value(){if(this.d[this.e]===1)return this.c.scheme;if(this.d[this.e]===2)return this.c.authority;if(this.d[this.e]===3)return this.b.value();if(this.d[this.e]===4)return this.c.query;if(this.d[this.e]===5)return this.c.fragment;throw new Error}},Jo=class p5{static{this.Val=Symbol("undefined_placeholder")}static wrap(t){return t===void 0?p5.Val:t}static unwrap(t){return t===p5.Val?void 0:t}},Ef=class{constructor(){this.height=1,this.value=void 0,this.key=void 0,this.left=void 0,this.mid=void 0,this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}},fC;(function(e){e[e.Left=-1]="Left",e[e.Mid=0]="Mid",e[e.Right=1]="Right"})(fC||(fC={}));var Vn=class Nd{static forUris(t=()=>!1,i=()=>!1){return new Nd(new dC(t,i))}static forPaths(t=!1){return new Nd(new uC(void 0,!t))}static forStrings(){return new Nd(new tj)}static forConfigKeys(){return new Nd(new ij)}constructor(t){this.b=t}clear(){this.c=void 0}fill(t,i){if(i){const r=i.slice(0);V5(r);for(const s of r)this.set(s,t)}else{const r=t.slice(0);V5(r);for(const s of r)this.set(s[0],s[1])}}set(t,i){const r=this.b.reset(t);let s;this.c||(this.c=new Ef,this.c.segment=r.value());const n=[];for(s=this.c;;){const a=r.cmp(s.segment);if(a>0)s.left||(s.left=new Ef,s.left.segment=r.value()),n.push([-1,s]),s=s.left;else if(a<0)s.right||(s.right=new Ef,s.right.segment=r.value()),n.push([1,s]),s=s.right;else if(r.hasNext())r.next(),s.mid||(s.mid=new Ef,s.mid.segment=r.value()),n.push([0,s]),s=s.mid;else break}const o=Jo.unwrap(s.value);s.value=Jo.wrap(i),s.key=t;for(let a=n.length-1;a>=0;a--){const c=n[a][1];c.updateHeight();const l=c.balanceFactor();if(l<-1||l>1){const u=n[a][0],h=n[a+1][0];if(u===1&&h===1)n[a][1]=c.rotateLeft();else if(u===-1&&h===-1)n[a][1]=c.rotateRight();else if(u===1&&h===-1)c.right=n[a+1][1]=n[a+1][1].rotateRight(),n[a][1]=c.rotateLeft();else if(u===-1&&h===1)c.left=n[a+1][1]=n[a+1][1].rotateLeft(),n[a][1]=c.rotateRight();else throw new Error;if(a>0)switch(n[a-1][0]){case-1:n[a-1][1].left=n[a][1];break;case 1:n[a-1][1].right=n[a][1];break;case 0:n[a-1][1].mid=n[a][1];break}else this.c=n[0][1]}}return o}get(t){return Jo.unwrap(this.d(t)?.value)}d(t){const i=this.b.reset(t);let r=this.c;for(;r;){const s=i.cmp(r.segment);if(s>0)r=r.left;else if(s<0)r=r.right;else if(i.hasNext())i.next(),r=r.mid;else break}return r}has(t){const i=this.d(t);return!(i?.value===void 0&&i?.mid===void 0)}delete(t){return this.e(t,!1)}deleteSuperstr(t){return this.e(t,!0)}e(t,i){const r=this.b.reset(t),s=[];let n=this.c;for(;n;){const o=r.cmp(n.segment);if(o>0)s.push([-1,n]),n=n.left;else if(o<0)s.push([1,n]),n=n.right;else if(r.hasNext())r.next(),s.push([0,n]),n=n.mid;else break}if(n){if(i?(n.left=void 0,n.mid=void 0,n.right=void 0,n.height=1):(n.key=void 0,n.value=void 0),!n.mid&&!n.value)if(n.left&&n.right){const o=[[1,n]],a=this.f(n.right,o);if(a.key){n.key=a.key,n.value=a.value,n.segment=a.segment;const c=a.right;if(o.length>1){const[u,h]=o[o.length-1];switch(u){case-1:h.left=c;break;case 0:wv(!1);case 1:wv(!1)}}else n.right=c;const l=this.g(o);if(s.length>0){const[u,h]=s[s.length-1];switch(u){case-1:h.left=l;break;case 0:h.mid=l;break;case 1:h.right=l;break}}else this.c=l}}else{const o=n.left??n.right;if(s.length>0){const[a,c]=s[s.length-1];switch(a){case-1:c.left=o;break;case 0:c.mid=o;break;case 1:c.right=o;break}}else this.c=o}this.c=this.g(s)??this.c}}f(t,i){for(;t.left;)i.push([-1,t]),t=t.left;return t}g(t){for(let i=t.length-1;i>=0;i--){const r=t[i][1];r.updateHeight();const s=r.balanceFactor();if(s>1?(r.right.balanceFactor()>=0||(r.right=r.right.rotateRight()),t[i][1]=r.rotateLeft()):s<-1&&(r.left.balanceFactor()<=0||(r.left=r.left.rotateLeft()),t[i][1]=r.rotateRight()),i>0)switch(t[i-1][0]){case-1:t[i-1][1].left=t[i][1];break;case 1:t[i-1][1].right=t[i][1];break;case 0:t[i-1][1].mid=t[i][1];break}else return t[0][1]}}findSubstr(t){const i=this.b.reset(t);let r=this.c,s;for(;r;){const n=i.cmp(r.segment);if(n>0)r=r.left;else if(n<0)r=r.right;else if(i.hasNext())i.next(),s=Jo.unwrap(r.value)||s,r=r.mid;else break}return r&&Jo.unwrap(r.value)||s}findSuperstr(t){return this.h(t,!1)}h(t,i){const r=this.b.reset(t);let s=this.c;for(;s;){const n=r.cmp(s.segment);if(n>0)s=s.left;else if(n<0)s=s.right;else if(r.hasNext())r.next(),s=s.mid;else return s.mid?this.j(s.mid):i?Jo.unwrap(s.value):void 0}}hasElementOrSubtree(t){return this.h(t,!0)!==void 0}forEach(t){for(const[i,r]of this)t(r,i)}*[Symbol.iterator](){yield*this.j(this.c)}j(t){const i=[];return this.l(t,i),i[Symbol.iterator]()}l(t,i){t&&(t.left&&this.l(t.left,i),t.value!==void 0&&i.push([t.key,Jo.unwrap(t.value)]),t.mid&&this.l(t.mid,i),t.right&&this.l(t.right,i))}_isBalanced(){const t=i=>{if(!i)return!0;const r=i.balanceFactor();return r<-1||r>1?!1:t(i.left)&&t(i.right)};return t(this.c)}};function rj(e,t,i){return Math.min(Math.max(e,t),i)}var sj=class{constructor(){this.a=0}getNext(){return this.a++}},nj=class{constructor(){this.a=1,this.b=0}update(e){return this.b=this.b+(e-this.b)/this.a,this.a+=1,this.b}get value(){return this.b}},bu;(function(e){e[e.Ignore=0]="Ignore",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(bu||(bu={})),function(e){const t="error",i="warning",r="warn",s="info",n="ignore";function o(c){return c?kr(t,c)?e.Error:kr(i,c)||kr(r,c)?e.Warning:kr(s,c)?e.Info:e.Ignore:e.Ignore}e.fromValue=o;function a(c){switch(c){case e.Error:return t;case e.Warning:return i;case e.Info:return s;default:return n}}e.toString=a}(bu||(bu={}));var Mt=bu,oj=Mt,Jee=H("notificationService"),pC;(function(e){e[e.DEFAULT=0]="DEFAULT",e[e.OPTIONAL=1]="OPTIONAL",e[e.SILENT=2]="SILENT",e[e.URGENT=3]="URGENT"})(pC||(pC={}));var gC;(function(e){e[e.WORKSPACE=0]="WORKSPACE",e[e.PROFILE=1]="PROFILE",e[e.APPLICATION=2]="APPLICATION"})(gC||(gC={}));var mC;(function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR"})(mC||(mC={}));var xf=H("contextService");function aj(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.uri)}function cj(e){const t=e;return typeof t?.id=="string"&&y.isUri(t.configPath)}var vC;(function(e){e[e.EMPTY=1]="EMPTY",e[e.FOLDER=2]="FOLDER",e[e.WORKSPACE=3]="WORKSPACE"})(vC||(vC={}));var lj=class{get folders(){return this.g}set folders(e){this.g=e,this.n()}constructor(e,t,i,r,s){this.h=e,this.j=i,this.k=r,this.l=s,this.c=Vn.forUris(this.l,()=>!0),this.folders=t}update(e){this.h=e.id,this.k=e.configuration,this.j=e.transient,this.l=e.l,this.folders=e.folders}get id(){return this.h}get transient(){return this.j}get configuration(){return this.k}set configuration(e){this.k=e}getFolder(e){return e&&this.c.findSubstr(e)||null}n(){this.c=Vn.forUris(this.l,()=>!0);for(const e of this.folders)this.c.set(e.uri,e)}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}},I0=class{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toResource(e){return It(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}};function D0(e){return new I0({uri:e,index:0,name:zv(e)},{uri:e.toString()})}var wC="code-workspace",uj=`.${wC}`,Qee=[{name:d(2760,null),extensions:[wC]}];function hj(e){return(typeof e=="string"?Xd(e):ex(e))===uj}var dj=class{constructor(){this.a=new Set(Object.keys(q)),this.b=new Map,this.extUri=new sc(e=>{const t=this.b.get(e.scheme);return!(t===void 0||t&1024)})}$acceptProviderInfos(e,t){t===null?this.b.delete(e.scheme):this.b.set(e.scheme,t)}isFreeScheme(e){return!this.b.has(e)&&!this.a.has(e)}getCapabilities(e){return this.b.get(e)}},pc=H("IExtHostFileSystemInfo"),P0=Object.freeze({create:e=>$n(e.map(t=>t.toString())).join(`\r
`),split:e=>e.split(`\r
`),parse:e=>P0.split(e).filter(t=>!t.startsWith("#"))}),Yee=new Uint32Array(10),bC;(function(e){e[e.InitialConsonant=4352]="InitialConsonant",e[e.Vowel=4449]="Vowel",e[e.FinalConsonant=4520]="FinalConsonant",e[e.CompatibilityJamo=12593]="CompatibilityJamo"})(bC||(bC={}));var yC;(function(e){e[e.NUL=0]="NUL",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z"})(yC||(yC={}));var AC;(function(e){e[e.fa=24934]="fa",e[e.fg=26470]="fg",e[e.fq=29030]="fq",e[e.fr=29286]="fr",e[e.ft=29798]="ft",e[e.fv=30310]="fv",e[e.fx=30822]="fx",e[e.hk=27496]="hk",e[e.hl=27752]="hl",e[e.ho=28520]="ho",e[e.ml=27757]="ml",e[e.nj=27246]="nj",e[e.nl=27758]="nl",e[e.np=28782]="np",e[e.qt=29809]="qt",e[e.rt=29810]="rt",e[e.sg=26483]="sg",e[e.sw=30579]="sw"})(AC||(AC={}));var Xee=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),Kee=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),ete=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),tte=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function SC(...e){return function(t,i){for(let r=0,s=e.length;r<s;r++){const n=e[r](t,i);if(n)return n}return null}}var ite=EC.bind(void 0,!1),T0=EC.bind(void 0,!0);function EC(e,t,i){if(!i||i.length<t.length)return null;let r;return e?r=Kd(i,t):r=i.indexOf(t)===0,r?t.length>0?[{start:0,end:t.length}]:[]:null}function fj(e,t){if(e.length>t.length)return null;const i=t.toLowerCase().indexOf(e.toLowerCase());return i===-1?null:[{start:i,end:i+e.length}]}function pj(e,t){return e.length>t.length?null:M0(e.toLowerCase(),t.toLowerCase(),0,0)}function M0(e,t,i,r){if(i===e.length)return[];if(r===t.length)return null;if(e[i]===t[r]){let s=null;return(s=M0(e,t,i+1,r+1))?kC({start:r,end:r+1},s):null}return M0(e,t,i,r+1)}function N0(e){return 97<=e&&e<=122}function yu(e){return 65<=e&&e<=90}function R0(e){return 48<=e&&e<=57}function gj(e){return e===32||e===9||e===10||e===13}var mj=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(e=>mj.add(e.charCodeAt(0)));function xC(e){return N0(e)||yu(e)||R0(e)}function kC(e,t){return t.length===0?t=[e]:e.end===t[0].start?t[0].start=e.start:t.unshift(e),t}function CC(e,t){for(let i=t;i<e.length;i++){const r=e.charCodeAt(i);if(yu(r)||R0(r)||i>0&&!xC(e.charCodeAt(i-1)))return i}return e.length}function L0(e,t,i,r){if(i===e.length)return[];if(r===t.length)return null;if(e[i]!==t[r].toLowerCase())return null;{let s=null,n=r+1;for(s=L0(e,t,i+1,r+1);!s&&(n=CC(t,n))<t.length;)s=L0(e,t,i+1,n),n++;return s===null?null:kC({start:r,end:r+1},s)}}function vj(e){let t=0,i=0,r=0,s=0,n=0;for(let u=0;u<e.length;u++)n=e.charCodeAt(u),yu(n)&&t++,N0(n)&&i++,xC(n)&&r++,R0(n)&&s++;const o=t/e.length,a=i/e.length,c=r/e.length,l=s/e.length;return{upperPercent:o,lowerPercent:a,alphaPercent:c,numericPercent:l}}function wj(e){const{upperPercent:t,lowerPercent:i}=e;return i===0&&t>.6}function bj(e){const{upperPercent:t,lowerPercent:i,alphaPercent:r,numericPercent:s}=e;return i>.2&&t<.8&&r>.6&&s<.2}function yj(e){let t=0,i=0,r=0,s=0;for(let n=0;n<e.length;n++)r=e.charCodeAt(n),yu(r)&&t++,N0(r)&&i++,gj(r)&&s++;return(t===0||i===0)&&s===0?e.length<=30:t<=5}function $C(e,t){if(!t||(t=t.trim(),t.length===0)||!yj(e))return null;t.length>60&&(t=t.substring(0,60));const i=vj(t);if(!bj(i)){if(!wj(i))return null;t=t.toLowerCase()}let r=null,s=0;for(e=e.toLowerCase();s<t.length&&(r=L0(e,t,0,s))===null;)s=CC(t,s+1);return r}var rte=SC(T0,$C,fj),ste=SC(T0,$C,pj),nte=new Ya(1e4),kf=128;function O0(){const e=[],t=[];for(let i=0;i<=kf;i++)t[i]=0;for(let i=0;i<=kf;i++)e.push(t.slice(0));return e}function IC(e){const t=[];for(let i=0;i<=e;i++)t[i]=0;return t}var ote=IC(2*kf),ate=IC(2*kf),cte=O0(),lte=O0(),ute=O0(),DC;(function(e){e[e.Diag=1]="Diag",e[e.Left=2]="Left",e[e.LeftLeft=3]="LeftLeft"})(DC||(DC={}));var PC;(function(e){e.Default=[-100,0];function t(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}e.isDefault=t})(PC||(PC={}));var hte=class{static{this.default={boostFullMatch:!0,firstMatchCanBeWeak:!1}}constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}},F0=Object.create(null);function m(e,t){if(Oe(t)){const i=F0[t];if(i===void 0)throw new Error(`${e} references an unknown codicon: ${t}`);t=i}return F0[e]=t,{id:e}}function Aj(){return F0}var Sj={add:m("add",6e4),plus:m("plus",6e4),gistNew:m("gist-new",6e4),repoCreate:m("repo-create",6e4),lightbulb:m("lightbulb",60001),lightBulb:m("light-bulb",60001),repo:m("repo",60002),repoDelete:m("repo-delete",60002),gistFork:m("gist-fork",60003),repoForked:m("repo-forked",60003),gitPullRequest:m("git-pull-request",60004),gitPullRequestAbandoned:m("git-pull-request-abandoned",60004),recordKeys:m("record-keys",60005),keyboard:m("keyboard",60005),tag:m("tag",60006),gitPullRequestLabel:m("git-pull-request-label",60006),tagAdd:m("tag-add",60006),tagRemove:m("tag-remove",60006),person:m("person",60007),personFollow:m("person-follow",60007),personOutline:m("person-outline",60007),personFilled:m("person-filled",60007),sourceControl:m("source-control",60008),mirror:m("mirror",60009),mirrorPublic:m("mirror-public",60009),star:m("star",60010),starAdd:m("star-add",60010),starDelete:m("star-delete",60010),starEmpty:m("star-empty",60010),comment:m("comment",60011),commentAdd:m("comment-add",60011),alert:m("alert",60012),warning:m("warning",60012),search:m("search",60013),searchSave:m("search-save",60013),logOut:m("log-out",60014),signOut:m("sign-out",60014),logIn:m("log-in",60015),signIn:m("sign-in",60015),eye:m("eye",60016),eyeUnwatch:m("eye-unwatch",60016),eyeWatch:m("eye-watch",60016),circleFilled:m("circle-filled",60017),primitiveDot:m("primitive-dot",60017),closeDirty:m("close-dirty",60017),debugBreakpoint:m("debug-breakpoint",60017),debugBreakpointDisabled:m("debug-breakpoint-disabled",60017),debugHint:m("debug-hint",60017),terminalDecorationSuccess:m("terminal-decoration-success",60017),primitiveSquare:m("primitive-square",60018),edit:m("edit",60019),pencil:m("pencil",60019),info:m("info",60020),issueOpened:m("issue-opened",60020),gistPrivate:m("gist-private",60021),gitForkPrivate:m("git-fork-private",60021),lock:m("lock",60021),mirrorPrivate:m("mirror-private",60021),close:m("close",60022),removeClose:m("remove-close",60022),x:m("x",60022),repoSync:m("repo-sync",60023),sync:m("sync",60023),clone:m("clone",60024),desktopDownload:m("desktop-download",60024),beaker:m("beaker",60025),microscope:m("microscope",60025),vm:m("vm",60026),deviceDesktop:m("device-desktop",60026),file:m("file",60027),more:m("more",60028),ellipsis:m("ellipsis",60028),kebabHorizontal:m("kebab-horizontal",60028),mailReply:m("mail-reply",60029),reply:m("reply",60029),organization:m("organization",60030),organizationFilled:m("organization-filled",60030),organizationOutline:m("organization-outline",60030),newFile:m("new-file",60031),fileAdd:m("file-add",60031),newFolder:m("new-folder",60032),fileDirectoryCreate:m("file-directory-create",60032),trash:m("trash",60033),trashcan:m("trashcan",60033),history:m("history",60034),clock:m("clock",60034),folder:m("folder",60035),fileDirectory:m("file-directory",60035),symbolFolder:m("symbol-folder",60035),logoGithub:m("logo-github",60036),markGithub:m("mark-github",60036),github:m("github",60036),terminal:m("terminal",60037),console:m("console",60037),repl:m("repl",60037),zap:m("zap",60038),symbolEvent:m("symbol-event",60038),error:m("error",60039),stop:m("stop",60039),variable:m("variable",60040),symbolVariable:m("symbol-variable",60040),array:m("array",60042),symbolArray:m("symbol-array",60042),symbolModule:m("symbol-module",60043),symbolPackage:m("symbol-package",60043),symbolNamespace:m("symbol-namespace",60043),symbolObject:m("symbol-object",60043),symbolMethod:m("symbol-method",60044),symbolFunction:m("symbol-function",60044),symbolConstructor:m("symbol-constructor",60044),symbolBoolean:m("symbol-boolean",60047),symbolNull:m("symbol-null",60047),symbolNumeric:m("symbol-numeric",60048),symbolNumber:m("symbol-number",60048),symbolStructure:m("symbol-structure",60049),symbolStruct:m("symbol-struct",60049),symbolParameter:m("symbol-parameter",60050),symbolTypeParameter:m("symbol-type-parameter",60050),symbolKey:m("symbol-key",60051),symbolText:m("symbol-text",60051),symbolReference:m("symbol-reference",60052),goToFile:m("go-to-file",60052),symbolEnum:m("symbol-enum",60053),symbolValue:m("symbol-value",60053),symbolRuler:m("symbol-ruler",60054),symbolUnit:m("symbol-unit",60054),activateBreakpoints:m("activate-breakpoints",60055),archive:m("archive",60056),arrowBoth:m("arrow-both",60057),arrowDown:m("arrow-down",60058),arrowLeft:m("arrow-left",60059),arrowRight:m("arrow-right",60060),arrowSmallDown:m("arrow-small-down",60061),arrowSmallLeft:m("arrow-small-left",60062),arrowSmallRight:m("arrow-small-right",60063),arrowSmallUp:m("arrow-small-up",60064),arrowUp:m("arrow-up",60065),bell:m("bell",60066),bold:m("bold",60067),book:m("book",60068),bookmark:m("bookmark",60069),debugBreakpointConditionalUnverified:m("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:m("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:m("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:m("debug-breakpoint-data-unverified",60072),debugBreakpointData:m("debug-breakpoint-data",60073),debugBreakpointDataDisabled:m("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:m("debug-breakpoint-log-unverified",60074),debugBreakpointLog:m("debug-breakpoint-log",60075),debugBreakpointLogDisabled:m("debug-breakpoint-log-disabled",60075),briefcase:m("briefcase",60076),broadcast:m("broadcast",60077),browser:m("browser",60078),bug:m("bug",60079),calendar:m("calendar",60080),caseSensitive:m("case-sensitive",60081),check:m("check",60082),checklist:m("checklist",60083),chevronDown:m("chevron-down",60084),chevronLeft:m("chevron-left",60085),chevronRight:m("chevron-right",60086),chevronUp:m("chevron-up",60087),chromeClose:m("chrome-close",60088),chromeMaximize:m("chrome-maximize",60089),chromeMinimize:m("chrome-minimize",60090),chromeRestore:m("chrome-restore",60091),circleOutline:m("circle-outline",60092),circle:m("circle",60092),debugBreakpointUnverified:m("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:m("terminal-decoration-incomplete",60092),circleSlash:m("circle-slash",60093),circuitBoard:m("circuit-board",60094),clearAll:m("clear-all",60095),clippy:m("clippy",60096),closeAll:m("close-all",60097),cloudDownload:m("cloud-download",60098),cloudUpload:m("cloud-upload",60099),code:m("code",60100),collapseAll:m("collapse-all",60101),colorMode:m("color-mode",60102),commentDiscussion:m("comment-discussion",60103),creditCard:m("credit-card",60105),dash:m("dash",60108),dashboard:m("dashboard",60109),database:m("database",60110),debugContinue:m("debug-continue",60111),debugDisconnect:m("debug-disconnect",60112),debugPause:m("debug-pause",60113),debugRestart:m("debug-restart",60114),debugStart:m("debug-start",60115),debugStepInto:m("debug-step-into",60116),debugStepOut:m("debug-step-out",60117),debugStepOver:m("debug-step-over",60118),debugStop:m("debug-stop",60119),debug:m("debug",60120),deviceCameraVideo:m("device-camera-video",60121),deviceCamera:m("device-camera",60122),deviceMobile:m("device-mobile",60123),diffAdded:m("diff-added",60124),diffIgnored:m("diff-ignored",60125),diffModified:m("diff-modified",60126),diffRemoved:m("diff-removed",60127),diffRenamed:m("diff-renamed",60128),diff:m("diff",60129),diffSidebyside:m("diff-sidebyside",60129),discard:m("discard",60130),editorLayout:m("editor-layout",60131),emptyWindow:m("empty-window",60132),exclude:m("exclude",60133),extensions:m("extensions",60134),eyeClosed:m("eye-closed",60135),fileBinary:m("file-binary",60136),fileCode:m("file-code",60137),fileMedia:m("file-media",60138),filePdf:m("file-pdf",60139),fileSubmodule:m("file-submodule",60140),fileSymlinkDirectory:m("file-symlink-directory",60141),fileSymlinkFile:m("file-symlink-file",60142),fileZip:m("file-zip",60143),files:m("files",60144),filter:m("filter",60145),flame:m("flame",60146),foldDown:m("fold-down",60147),foldUp:m("fold-up",60148),fold:m("fold",60149),folderActive:m("folder-active",60150),folderOpened:m("folder-opened",60151),gear:m("gear",60152),gift:m("gift",60153),gistSecret:m("gist-secret",60154),gist:m("gist",60155),gitCommit:m("git-commit",60156),gitCompare:m("git-compare",60157),compareChanges:m("compare-changes",60157),gitMerge:m("git-merge",60158),githubAction:m("github-action",60159),githubAlt:m("github-alt",60160),globe:m("globe",60161),grabber:m("grabber",60162),graph:m("graph",60163),gripper:m("gripper",60164),heart:m("heart",60165),home:m("home",60166),horizontalRule:m("horizontal-rule",60167),hubot:m("hubot",60168),inbox:m("inbox",60169),issueReopened:m("issue-reopened",60171),issues:m("issues",60172),italic:m("italic",60173),jersey:m("jersey",60174),json:m("json",60175),kebabVertical:m("kebab-vertical",60176),key:m("key",60177),law:m("law",60178),lightbulbAutofix:m("lightbulb-autofix",60179),linkExternal:m("link-external",60180),link:m("link",60181),listOrdered:m("list-ordered",60182),listUnordered:m("list-unordered",60183),liveShare:m("live-share",60184),loading:m("loading",60185),location:m("location",60186),mailRead:m("mail-read",60187),mail:m("mail",60188),markdown:m("markdown",60189),megaphone:m("megaphone",60190),mention:m("mention",60191),milestone:m("milestone",60192),gitPullRequestMilestone:m("git-pull-request-milestone",60192),mortarBoard:m("mortar-board",60193),move:m("move",60194),multipleWindows:m("multiple-windows",60195),mute:m("mute",60196),noNewline:m("no-newline",60197),note:m("note",60198),octoface:m("octoface",60199),openPreview:m("open-preview",60200),package:m("package",60201),paintcan:m("paintcan",60202),pin:m("pin",60203),play:m("play",60204),run:m("run",60204),plug:m("plug",60205),preserveCase:m("preserve-case",60206),preview:m("preview",60207),project:m("project",60208),pulse:m("pulse",60209),question:m("question",60210),quote:m("quote",60211),radioTower:m("radio-tower",60212),reactions:m("reactions",60213),references:m("references",60214),refresh:m("refresh",60215),regex:m("regex",60216),remoteExplorer:m("remote-explorer",60217),remote:m("remote",60218),remove:m("remove",60219),replaceAll:m("replace-all",60220),replace:m("replace",60221),repoClone:m("repo-clone",60222),repoForcePush:m("repo-force-push",60223),repoPull:m("repo-pull",60224),repoPush:m("repo-push",60225),report:m("report",60226),requestChanges:m("request-changes",60227),rocket:m("rocket",60228),rootFolderOpened:m("root-folder-opened",60229),rootFolder:m("root-folder",60230),rss:m("rss",60231),ruby:m("ruby",60232),saveAll:m("save-all",60233),saveAs:m("save-as",60234),save:m("save",60235),screenFull:m("screen-full",60236),screenNormal:m("screen-normal",60237),searchStop:m("search-stop",60238),server:m("server",60240),settingsGear:m("settings-gear",60241),settings:m("settings",60242),shield:m("shield",60243),smiley:m("smiley",60244),sortPrecedence:m("sort-precedence",60245),splitHorizontal:m("split-horizontal",60246),splitVertical:m("split-vertical",60247),squirrel:m("squirrel",60248),starFull:m("star-full",60249),starHalf:m("star-half",60250),symbolClass:m("symbol-class",60251),symbolColor:m("symbol-color",60252),symbolConstant:m("symbol-constant",60253),symbolEnumMember:m("symbol-enum-member",60254),symbolField:m("symbol-field",60255),symbolFile:m("symbol-file",60256),symbolInterface:m("symbol-interface",60257),symbolKeyword:m("symbol-keyword",60258),symbolMisc:m("symbol-misc",60259),symbolOperator:m("symbol-operator",60260),symbolProperty:m("symbol-property",60261),wrench:m("wrench",60261),wrenchSubaction:m("wrench-subaction",60261),symbolSnippet:m("symbol-snippet",60262),tasklist:m("tasklist",60263),telescope:m("telescope",60264),textSize:m("text-size",60265),threeBars:m("three-bars",60266),thumbsdown:m("thumbsdown",60267),thumbsup:m("thumbsup",60268),tools:m("tools",60269),triangleDown:m("triangle-down",60270),triangleLeft:m("triangle-left",60271),triangleRight:m("triangle-right",60272),triangleUp:m("triangle-up",60273),twitter:m("twitter",60274),unfold:m("unfold",60275),unlock:m("unlock",60276),unmute:m("unmute",60277),unverified:m("unverified",60278),verified:m("verified",60279),versions:m("versions",60280),vmActive:m("vm-active",60281),vmOutline:m("vm-outline",60282),vmRunning:m("vm-running",60283),watch:m("watch",60284),whitespace:m("whitespace",60285),wholeWord:m("whole-word",60286),window:m("window",60287),wordWrap:m("word-wrap",60288),zoomIn:m("zoom-in",60289),zoomOut:m("zoom-out",60290),listFilter:m("list-filter",60291),listFlat:m("list-flat",60292),listSelection:m("list-selection",60293),selection:m("selection",60293),listTree:m("list-tree",60294),debugBreakpointFunctionUnverified:m("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:m("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:m("debug-breakpoint-function-disabled",60296),debugStackframeActive:m("debug-stackframe-active",60297),circleSmallFilled:m("circle-small-filled",60298),debugStackframeDot:m("debug-stackframe-dot",60298),terminalDecorationMark:m("terminal-decoration-mark",60298),debugStackframe:m("debug-stackframe",60299),debugStackframeFocused:m("debug-stackframe-focused",60299),debugBreakpointUnsupported:m("debug-breakpoint-unsupported",60300),symbolString:m("symbol-string",60301),debugReverseContinue:m("debug-reverse-continue",60302),debugStepBack:m("debug-step-back",60303),debugRestartFrame:m("debug-restart-frame",60304),debugAlt:m("debug-alt",60305),callIncoming:m("call-incoming",60306),callOutgoing:m("call-outgoing",60307),menu:m("menu",60308),expandAll:m("expand-all",60309),feedback:m("feedback",60310),gitPullRequestReviewer:m("git-pull-request-reviewer",60310),groupByRefType:m("group-by-ref-type",60311),ungroupByRefType:m("ungroup-by-ref-type",60312),account:m("account",60313),gitPullRequestAssignee:m("git-pull-request-assignee",60313),bellDot:m("bell-dot",60314),debugConsole:m("debug-console",60315),library:m("library",60316),output:m("output",60317),runAll:m("run-all",60318),syncIgnored:m("sync-ignored",60319),pinned:m("pinned",60320),githubInverted:m("github-inverted",60321),serverProcess:m("server-process",60322),serverEnvironment:m("server-environment",60323),pass:m("pass",60324),issueClosed:m("issue-closed",60324),stopCircle:m("stop-circle",60325),playCircle:m("play-circle",60326),record:m("record",60327),debugAltSmall:m("debug-alt-small",60328),vmConnect:m("vm-connect",60329),cloud:m("cloud",60330),merge:m("merge",60331),export:m("export",60332),graphLeft:m("graph-left",60333),magnet:m("magnet",60334),notebook:m("notebook",60335),redo:m("redo",60336),checkAll:m("check-all",60337),pinnedDirty:m("pinned-dirty",60338),passFilled:m("pass-filled",60339),circleLargeFilled:m("circle-large-filled",60340),circleLarge:m("circle-large",60341),circleLargeOutline:m("circle-large-outline",60341),combine:m("combine",60342),gather:m("gather",60342),table:m("table",60343),variableGroup:m("variable-group",60344),typeHierarchy:m("type-hierarchy",60345),typeHierarchySub:m("type-hierarchy-sub",60346),typeHierarchySuper:m("type-hierarchy-super",60347),gitPullRequestCreate:m("git-pull-request-create",60348),runAbove:m("run-above",60349),runBelow:m("run-below",60350),notebookTemplate:m("notebook-template",60351),debugRerun:m("debug-rerun",60352),workspaceTrusted:m("workspace-trusted",60353),workspaceUntrusted:m("workspace-untrusted",60354),workspaceUnknown:m("workspace-unknown",60355),terminalCmd:m("terminal-cmd",60356),terminalDebian:m("terminal-debian",60357),terminalLinux:m("terminal-linux",60358),terminalPowershell:m("terminal-powershell",60359),terminalTmux:m("terminal-tmux",60360),terminalUbuntu:m("terminal-ubuntu",60361),terminalBash:m("terminal-bash",60362),arrowSwap:m("arrow-swap",60363),copy:m("copy",60364),personAdd:m("person-add",60365),filterFilled:m("filter-filled",60366),wand:m("wand",60367),debugLineByLine:m("debug-line-by-line",60368),inspect:m("inspect",60369),layers:m("layers",60370),layersDot:m("layers-dot",60371),layersActive:m("layers-active",60372),compass:m("compass",60373),compassDot:m("compass-dot",60374),compassActive:m("compass-active",60375),azure:m("azure",60376),issueDraft:m("issue-draft",60377),gitPullRequestClosed:m("git-pull-request-closed",60378),gitPullRequestDraft:m("git-pull-request-draft",60379),debugAll:m("debug-all",60380),debugCoverage:m("debug-coverage",60381),runErrors:m("run-errors",60382),folderLibrary:m("folder-library",60383),debugContinueSmall:m("debug-continue-small",60384),beakerStop:m("beaker-stop",60385),graphLine:m("graph-line",60386),graphScatter:m("graph-scatter",60387),pieChart:m("pie-chart",60388),bracket:m("bracket",60175),bracketDot:m("bracket-dot",60389),bracketError:m("bracket-error",60390),lockSmall:m("lock-small",60391),azureDevops:m("azure-devops",60392),verifiedFilled:m("verified-filled",60393),newline:m("newline",60394),layout:m("layout",60395),layoutActivitybarLeft:m("layout-activitybar-left",60396),layoutActivitybarRight:m("layout-activitybar-right",60397),layoutPanelLeft:m("layout-panel-left",60398),layoutPanelCenter:m("layout-panel-center",60399),layoutPanelJustify:m("layout-panel-justify",60400),layoutPanelRight:m("layout-panel-right",60401),layoutPanel:m("layout-panel",60402),layoutSidebarLeft:m("layout-sidebar-left",60403),layoutSidebarRight:m("layout-sidebar-right",60404),layoutStatusbar:m("layout-statusbar",60405),layoutMenubar:m("layout-menubar",60406),layoutCentered:m("layout-centered",60407),target:m("target",60408),indent:m("indent",60409),recordSmall:m("record-small",60410),errorSmall:m("error-small",60411),terminalDecorationError:m("terminal-decoration-error",60411),arrowCircleDown:m("arrow-circle-down",60412),arrowCircleLeft:m("arrow-circle-left",60413),arrowCircleRight:m("arrow-circle-right",60414),arrowCircleUp:m("arrow-circle-up",60415),layoutSidebarRightOff:m("layout-sidebar-right-off",60416),layoutPanelOff:m("layout-panel-off",60417),layoutSidebarLeftOff:m("layout-sidebar-left-off",60418),blank:m("blank",60419),heartFilled:m("heart-filled",60420),map:m("map",60421),mapHorizontal:m("map-horizontal",60421),foldHorizontal:m("fold-horizontal",60421),mapFilled:m("map-filled",60422),mapHorizontalFilled:m("map-horizontal-filled",60422),foldHorizontalFilled:m("fold-horizontal-filled",60422),circleSmall:m("circle-small",60423),bellSlash:m("bell-slash",60424),bellSlashDot:m("bell-slash-dot",60425),commentUnresolved:m("comment-unresolved",60426),gitPullRequestGoToChanges:m("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:m("git-pull-request-new-changes",60428),searchFuzzy:m("search-fuzzy",60429),commentDraft:m("comment-draft",60430),send:m("send",60431),sparkle:m("sparkle",60432),insert:m("insert",60433),mic:m("mic",60434),thumbsdownFilled:m("thumbsdown-filled",60435),thumbsupFilled:m("thumbsup-filled",60436),coffee:m("coffee",60437),snake:m("snake",60438),game:m("game",60439),vr:m("vr",60440),chip:m("chip",60441),piano:m("piano",60442),music:m("music",60443),micFilled:m("mic-filled",60444),repoFetch:m("repo-fetch",60445),copilot:m("copilot",60446),lightbulbSparkle:m("lightbulb-sparkle",60447),robot:m("robot",60448),sparkleFilled:m("sparkle-filled",60449),diffSingle:m("diff-single",60450),diffMultiple:m("diff-multiple",60451),surroundWith:m("surround-with",60452),share:m("share",60453),gitStash:m("git-stash",60454),gitStashApply:m("git-stash-apply",60455),gitStashPop:m("git-stash-pop",60456),vscode:m("vscode",60457),vscodeInsiders:m("vscode-insiders",60458),codeOss:m("code-oss",60459),runCoverage:m("run-coverage",60460),runAllCoverage:m("run-all-coverage",60461),coverage:m("coverage",60462),githubProject:m("github-project",60463),mapVertical:m("map-vertical",60464),foldVertical:m("fold-vertical",60464),mapVerticalFilled:m("map-vertical-filled",60465),foldVerticalFilled:m("fold-vertical-filled",60465),goToSearch:m("go-to-search",60466),percentage:m("percentage",60467),sortPercentage:m("sort-percentage",60467),attach:m("attach",60468),goToEditingSession:m("go-to-editing-session",60469),editSession:m("edit-session",60470),codeReview:m("code-review",60471),copilotWarning:m("copilot-warning",60472),python:m("python",60473),copilotLarge:m("copilot-large",60474),copilotWarningLarge:m("copilot-warning-large",60475),keyboardTab:m("keyboard-tab",60476),copilotBlocked:m("copilot-blocked",60477),copilotNotConnected:m("copilot-not-connected",60478),flag:m("flag",60479),lightbulbEmpty:m("lightbulb-empty",60480),symbolMethodArrow:m("symbol-method-arrow",60481),copilotUnavailable:m("copilot-unavailable",60482),repoPinned:m("repo-pinned",60483),keyboardTabAbove:m("keyboard-tab-above",60484),keyboardTabBelow:m("keyboard-tab-below",60485),gitPullRequestDone:m("git-pull-request-done",60486),mcp:m("mcp",60487),extensionsLarge:m("extensions-large",60488),layoutPanelDock:m("layout-panel-dock",60489),layoutSidebarLeftDock:m("layout-sidebar-left-dock",60490),layoutSidebarRightDock:m("layout-sidebar-right-dock",60491),copilotInProgress:m("copilot-in-progress",60492),copilotError:m("copilot-error",60493),copilotSuccess:m("copilot-success",60494),chatSparkle:m("chat-sparkle",60495),searchSparkle:m("search-sparkle",60496),editSparkle:m("edit-sparkle",60497),copilotSnooze:m("copilot-snooze",60498),sendToRemoteAgent:m("send-to-remote-agent",60499),commentDiscussionSparkle:m("comment-discussion-sparkle",60500),chatSparkleWarning:m("chat-sparkle-warning",60501),chatSparkleError:m("chat-sparkle-error",60502),collection:m("collection",60503),newCollection:m("new-collection",60504),thinking:m("thinking",60505),build:m("build",60506),commentDiscussionQuote:m("comment-discussion-quote",60507),cursor:m("cursor",60508),eraser:m("eraser",60509),fileText:m("file-text",60510),gitLens:m("git-lens",60511),quotes:m("quotes",60512),rename:m("rename",60513),runWithDeps:m("run-with-deps",60514),debugConnected:m("debug-connected",60515),strikethrough:m("strikethrough",60516),openInProduct:m("open-in-product",60517),indexZero:m("index-zero",60518),agent:m("agent",60519),editCode:m("edit-code",60520),repoSelected:m("repo-selected",60521),skip:m("skip",60522),mergeInto:m("merge-into",60523),gitBranchChanges:m("git-branch-changes",60524),gitBranchStagedChanges:m("git-branch-staged-changes",60525),gitBranchConflicts:m("git-branch-conflicts",60526),gitBranch:m("git-branch",60527),gitBranchCreate:m("git-branch-create",60527),gitBranchDelete:m("git-branch-delete",60527),searchLarge:m("search-large",60528),terminalGitBash:m("terminal-git-bash",60529),windowActive:m("window-active",60530),forward:m("forward",60531),download:m("download",60532),clockface:m("clockface",60533),unarchive:m("unarchive",60534),sessionInProgress:m("session-in-progress",60535),collectionSmall:m("collection-small",60536),vmSmall:m("vm-small",60537),cloudSmall:m("cloud-small",60538)},Ej={dialogError:m("dialog-error","error"),dialogWarning:m("dialog-warning","warning"),dialogInfo:m("dialog-info","info"),dialogClose:m("dialog-close","close"),treeItemExpanded:m("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:m("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:m("tree-filter-on-type-off","list-selection"),treeFilterClear:m("tree-filter-clear","close"),treeItemLoading:m("tree-item-loading","loading"),menuSelection:m("menu-selection","check"),menuSubmenu:m("menu-submenu","chevron-right"),menuBarMore:m("menubar-more","more"),scrollbarButtonLeft:m("scrollbar-button-left","triangle-left"),scrollbarButtonRight:m("scrollbar-button-right","triangle-right"),scrollbarButtonUp:m("scrollbar-button-up","triangle-up"),scrollbarButtonDown:m("scrollbar-button-down","triangle-down"),toolBarMore:m("toolbar-more","more"),quickInputBack:m("quick-input-back","arrow-left"),dropDownButton:m("drop-down-button",60084),symbolCustomColor:m("symbol-customcolor",60252),exportIcon:m("export",60332),workspaceUnspecified:m("workspace-unspecified",60355),newLine:m("newline",60394),thumbsDownFilled:m("thumbsdown-filled",60435),thumbsUpFilled:m("thumbsup-filled",60436),gitFetch:m("git-fetch",60445),lightbulbSparkleAutofix:m("lightbulb-sparkle-autofix",60447),debugBreakpointPending:m("debug-breakpoint-pending",60377)},oe={...Sj,...Ej},gc;(function(e){function t(i){return!!i&&typeof i=="object"&&typeof i.id=="string"}e.isThemeColor=t})(gc||(gc={}));var Nt;(function(e){e.iconNameSegment="[A-Za-z0-9]+",e.iconNameExpression="[A-Za-z0-9-]+",e.iconModifierExpression="~[A-Za-z]+",e.iconNameCharacter="[A-Za-z0-9~-]";const t=new RegExp(`^(${e.iconNameExpression})(${e.iconModifierExpression})?$`);function i(g){const v=t.exec(g.id);if(!v)return i(oe.error);const[,b,S]=v,E=["codicon","codicon-"+b];return S&&E.push("codicon-modifier-"+S.substring(1)),E}e.asClassNameArray=i;function r(g){return i(g).join(" ")}e.asClassName=r;function s(g){return"."+i(g).join(".")}e.asCSSSelector=s;function n(g){return!!g&&typeof g=="object"&&typeof g.id=="string"&&(typeof g.color>"u"||gc.isThemeColor(g.color))}e.isThemeIcon=n;const o=new RegExp(`^\\$\\((${e.iconNameExpression}(?:${e.iconModifierExpression})?)\\)$`);function a(g){const v=o.exec(g);if(!v)return;const[,b]=v;return{id:b}}e.fromString=a;function c(g){return{id:g}}e.fromId=c;function l(g,v){let b=g.id;const S=b.lastIndexOf("~");return S!==-1&&(b=b.substring(0,S)),v&&(b=`${b}~${v}`),{id:b}}e.modify=l;function u(g){const v=g.id.lastIndexOf("~");if(v!==-1)return g.id.substring(v+1)}e.getModifier=u;function h(g,v){return g.id===v.id&&g.color?.id===v.color?.id}e.isEqual=h;function f(g){return g?.id===oe.file.id}e.isFile=f;function p(g){return g?.id===oe.folder.id}e.isFolder=p})(Nt||(Nt={}));var U0=new RegExp(`\\$\\(${Nt.iconNameExpression}(?:${Nt.iconModifierExpression})?\\)`,"g"),xj=new RegExp(`(\\\\)?${U0.source}`,"g");function kj(e){return e.replace(xj,(t,i)=>i?t:`\\${t}`)}var dte=new RegExp(`\\\\${U0.source}`,"g"),fte=new RegExp(`(\\s)?(\\\\)?${U0.source}(\\s)?`,"g"),pte=new RegExp(`\\$\\(${Nt.iconNameCharacter}+\\)`,"g"),TC;(function(e){e[e.Paragraph=0]="Paragraph",e[e.Break=1]="Break"})(TC||(TC={}));var qn=class nN{static lift(t){const i=new nN(t.value,t);return i.uris=t.uris,i.baseUri=t.baseUri?y.revive(t.baseUri):void 0,i}constructor(t="",i=!1){if(this.value=t,typeof this.value!="string")throw $e("value");typeof i=="boolean"?(this.isTrusted=i,this.supportThemeIcons=!1,this.supportHtml=!1,this.supportAlertSyntax=!1):(this.isTrusted=i.isTrusted??void 0,this.supportThemeIcons=i.supportThemeIcons??!1,this.supportHtml=i.supportHtml??!1,this.supportAlertSyntax=i.supportAlertSyntax??!1)}appendText(t,i=0){return this.value+=Cj(this.supportThemeIcons?kj(t):t).replace(/([ \t]+)/g,(r,s)=>"&nbsp;".repeat(s.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===1?`\\
`:`

`),this}appendMarkdown(t){return this.value+=t,this}appendCodeblock(t,i){return this.value+=`
${$j(i,t)}
`,this}appendLink(t,i,r){return this.value+="[",this.value+=this.c(i,"]"),this.value+="](",this.value+=this.c(String(t),")"),r&&(this.value+=` "${this.c(this.c(r,'"'),")")}"`),this.value+=")",this}c(t,i){const r=new RegExp(Rn(i),"g");return t.replace(r,(s,n)=>t.charAt(n-1)!=="\\"?`\\${s}`:s)}};function Gn(e){return e instanceof qn?!0:e&&typeof e=="object"?typeof e.value=="string"&&(typeof e.isTrusted=="boolean"||typeof e.isTrusted=="object"||e.isTrusted===void 0)&&(typeof e.supportThemeIcons=="boolean"||e.supportThemeIcons===void 0)&&(typeof e.supportAlertSyntax=="boolean"||e.supportAlertSyntax===void 0):!1}function Cj(e){return e.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function $j(e,t){const i=e.match(/^`+/gm)?.reduce((s,n)=>s.length>n.length?s:n).length??0,r=i>=3?i+1:3;return[`${"`".repeat(r)}${t}`,e,`${"`".repeat(r)}`].join(`
`)}function Ij(e){const t=[],i=e.split("|").map(s=>s.trim());e=i[0];const r=i[1];if(r){const s=/height=(\d+)/.exec(r),n=/width=(\d+)/.exec(r),o=s?s[1]:"",a=n?n[1]:"",c=isFinite(parseInt(a)),l=isFinite(parseInt(o));c&&t.push(`width="${a}"`),l&&t.push(`height="${o}"`)}return{href:e,dimensions:t}}function j0(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Qo=j0();function MC(e){Qo=e}var NC=/[&<>"']/,Dj=new RegExp(NC.source,"g"),RC=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Pj=new RegExp(RC.source,"g"),Tj={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},LC=e=>Tj[e];function pr(e,t){if(t){if(NC.test(e))return e.replace(Dj,LC)}else if(RC.test(e))return e.replace(Pj,LC);return e}var Mj=/(^|[^\[])\^/g;function vt(e,t){let i=typeof e=="string"?e:e.source;t=t||"";const r={replace:(s,n)=>{let o=typeof n=="string"?n:n.source;return o=o.replace(Mj,"$1"),i=i.replace(s,o),r},getRegex:()=>new RegExp(i,t)};return r}function OC(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}var Au={exec:()=>null};function FC(e,t){const i=e.replace(/\|/g,(n,o,a)=>{let c=!1,l=o;for(;--l>=0&&a[l]==="\\";)c=!c;return c?"|":" |"}),r=i.split(/ \|/);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(/\\\|/g,"|");return r}function Su(e,t,i){const r=e.length;if(r===0)return"";let s=0;for(;s<r;){const n=e.charAt(r-s-1);if(n===t&&!i)s++;else if(n!==t&&i)s++;else break}return e.slice(0,r-s)}function Nj(e,t){if(e.indexOf(t[1])===-1)return-1;let i=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])i++;else if(e[r]===t[1]&&(i--,i<0))return r;return-1}function UC(e,t,i,r){const s=t.href,n=t.title?pr(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){r.state.inLink=!0;const a={type:"link",raw:i,href:s,title:n,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,a}return{type:"image",raw:i,href:s,title:n,text:pr(o)}}function Rj(e,t){const i=e.match(/^(\s+)(?:```)/);if(i===null)return t;const r=i[1];return t.split(`
`).map(s=>{const n=s.match(/^\s+/);if(n===null)return s;const[o]=n;return o.length>=r.length?s.slice(r.length):s}).join(`
`)}var Cf=class{options;rules;lexer;constructor(e){this.options=e||Qo}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Su(i,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=Rj(i,t[3]||"");return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(/#$/.test(i)){const r=Su(i,"#");(this.options.pedantic||!r||/ $/.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Su(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=Su(t[0],`
`).split(`
`),r="",s="";const n=[];for(;i.length>0;){let o=!1;const a=[];let c;for(c=0;c<i.length;c++)if(/^ {0,3}>/.test(i[c]))a.push(i[c]),o=!0;else if(!o)a.push(i[c]);else break;i=i.slice(c);const l=a.join(`
`),u=l.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");r=r?`${r}
${l}`:l,s=s?`${s}
${u}`:u;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,n,!0),this.lexer.state.top=h,i.length===0)break;const f=n[n.length-1];if(f?.type==="code")break;if(f?.type==="blockquote"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.blockquote(g);n[n.length-1]=v,r=r.substring(0,r.length-p.raw.length)+v.raw,s=s.substring(0,s.length-p.text.length)+v.text;break}else if(f?.type==="list"){const p=f,g=p.raw+`
`+i.join(`
`),v=this.list(g);n[n.length-1]=v,r=r.substring(0,r.length-f.raw.length)+v.raw,s=s.substring(0,s.length-p.raw.length)+v.raw,i=g.substring(n[n.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:n,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,s={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const n=new RegExp(`^( {0,3}${i})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o=!1;for(;e;){let a=!1,c="",l="";if(!(t=n.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let u=t[2].split(`
`,1)[0].replace(/^\t+/,b=>" ".repeat(3*b.length)),h=e.split(`
`,1)[0],f=!u.trim(),p=0;if(this.options.pedantic?(p=2,l=u.trimStart()):f?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,l=u.slice(p),p+=t[1].length),f&&/^ *$/.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),a=!0),!a){const b=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),S=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),E=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),$=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const U=e.split(`
`,1)[0];if(h=U,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),E.test(h)||$.test(h)||b.test(h)||S.test(e))break;if(h.search(/[^ ]/)>=p||!h.trim())l+=`
`+h.slice(p);else{if(f||u.search(/[^ ]/)>=4||E.test(u)||$.test(u)||S.test(u))break;l+=`
`+h}!f&&!h.trim()&&(f=!0),c+=U+`
`,e=e.substring(U.length+1),u=h.slice(p)}}s.loose||(o?s.loose=!0:/\n *\n *$/.test(c)&&(o=!0));let g=null,v;this.options.gfm&&(g=/^\[[ xX]\] /.exec(l),g&&(v=g[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:c,task:!!g,checked:v,loose:!1,text:l,tokens:[]}),s.raw+=c}s.items[s.items.length-1].raw=s.items[s.items.length-1].raw.trimEnd(),s.items[s.items.length-1].text=s.items[s.items.length-1].text.trimEnd(),s.raw=s.raw.trimEnd();for(let a=0;a<s.items.length;a++)if(this.lexer.state.top=!1,s.items[a].tokens=this.lexer.blockTokens(s.items[a].text,[]),!s.loose){const c=s.items[a].tokens.filter(u=>u.type==="space"),l=c.length>0&&c.some(u=>/\n.*\n/.test(u.raw));s.loose=l}if(s.loose)for(let a=0;a<s.items.length;a++)s.items[a].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const i=FC(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],n={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const o of r)/^ *-+: *$/.test(o)?n.align.push("right"):/^ *:-+: *$/.test(o)?n.align.push("center"):/^ *:-+ *$/.test(o)?n.align.push("left"):n.align.push(null);for(let o=0;o<i.length;o++)n.header.push({text:i[o],tokens:this.lexer.inline(i[o]),header:!0,align:n.align[o]});for(const o of s)n.rows.push(FC(o,n.header.length).map((a,c)=>({text:a,tokens:this.lexer.inline(a),header:!1,align:n.align[c]})));return n}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:pr(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const n=Su(i.slice(0,-1),"\\");if((i.length-n.length)%2===0)return}else{const n=Nj(t[2],"()");if(n>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+n;t[2]=t[2].substring(0,n),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const n=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);n&&(r=n[1],s=n[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(i)?r=r.slice(1):r=r.slice(1,-1)),UC(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const r=(i[2]||i[1]).replace(/\s+/g," "),s=t[r.toLowerCase()];if(!s){const n=i[0].charAt(0);return{type:"text",raw:n,text:n}}return UC(i,s,i[0],this.lexer)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&i.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const n=[...r[0]].length-1;let o,a,c=n,l=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+n);(r=u.exec(t))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(a=[...o].length,r[3]||r[4]){c+=a;continue}else if((r[5]||r[6])&&n%3&&!((n+a)%3)){l+=a;continue}if(c-=a,c>0)continue;a=Math.min(a,a+c+l);const h=[...r[0]][0].length,f=e.slice(0,n+r.index+h+a);if(Math.min(n,a)%2){const g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(/\n/g," ");const r=/[^ ]/.test(i),s=/^ /.test(i)&&/ $/.test(i);return r&&s&&(i=i.substring(1,i.length-1)),i=pr(i,!0),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return t[2]==="@"?(i=pr(t[1]),r="mailto:"+i):(i=pr(t[1]),r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,r;if(t[2]==="@")i=pr(t[0]),r="mailto:"+i;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);i=pr(t[0]),t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let i;return this.lexer.state.inRawBlock?i=t[0]:i=pr(t[0]),{type:"text",raw:t[0],text:i}}}},Lj=/^(?: *(?:\n|$))+/,Oj=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Fj=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Eu=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Uj=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,jC=/(?:[*+-]|\d{1,9}[.)])/,zC=vt(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,jC).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),z0=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,jj=/^[^\n]+/,H0=/(?!\s*\])(?:\\.|[^\[\]\\])+/,zj=vt(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",H0).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Hj=vt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,jC).getRegex(),$f="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",W0=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Wj=vt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",W0).replace("tag",$f).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),HC=vt(z0).replace("hr",Eu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$f).getRegex(),Bj=vt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",HC).getRegex(),B0={blockquote:Bj,code:Oj,def:zj,fences:Fj,heading:Uj,hr:Eu,html:Wj,lheading:zC,list:Hj,newline:Lj,paragraph:HC,table:Au,text:jj},WC=vt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Eu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$f).getRegex(),_j={...B0,table:WC,paragraph:vt(z0).replace("hr",Eu).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",WC).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",$f).getRegex()},Vj={...B0,html:vt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",W0).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Au,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:vt(z0).replace("hr",Eu).replace("heading",` *#{1,6} *[^
]`).replace("lheading",zC).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},BC=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,qj=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,_C=/^( {2,}|\\)\n(?!\s*$)/,Gj=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,xu="\\p{P}\\p{S}",Zj=vt(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,xu).getRegex(),Jj=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Qj=vt(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,xu).getRegex(),Yj=vt("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,xu).getRegex(),Xj=vt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,xu).getRegex(),Kj=vt(/\\([punct])/,"gu").replace(/punct/g,xu).getRegex(),ez=vt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tz=vt(W0).replace("(?:-->|$)","-->").getRegex(),iz=vt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tz).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),If=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,rz=vt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",If).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),VC=vt(/^!?\[(label)\]\[(ref)\]/).replace("label",If).replace("ref",H0).getRegex(),qC=vt(/^!?\[(ref)\](?:\[\])?/).replace("ref",H0).getRegex(),sz=vt("reflink|nolink(?!\\()","g").replace("reflink",VC).replace("nolink",qC).getRegex(),_0={_backpedal:Au,anyPunctuation:Kj,autolink:ez,blockSkip:Jj,br:_C,code:qj,del:Au,emStrongLDelim:Qj,emStrongRDelimAst:Yj,emStrongRDelimUnd:Xj,escape:BC,link:rz,nolink:qC,punctuation:Zj,reflink:VC,reflinkSearch:sz,tag:iz,text:Gj,url:Au},nz={..._0,link:vt(/^!?\[(label)\]\((.*?)\)/).replace("label",If).getRegex(),reflink:vt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",If).getRegex()},V0={..._0,escape:vt(BC).replace("])","~|])").getRegex(),url:vt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},oz={...V0,br:vt(_C).replace("{2,}","*").getRegex(),text:vt(V0.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Df={normal:B0,gfm:_j,pedantic:Vj},ku={normal:_0,gfm:V0,breaks:oz,pedantic:nz},Yo=class g5{tokens;options;state;tokenizer;inlineQueue;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Qo,this.options.tokenizer=this.options.tokenizer||new Cf,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const i={block:Df.normal,inline:ku.normal};this.options.pedantic?(i.block=Df.pedantic,i.inline=ku.pedantic):this.options.gfm&&(i.block=Df.gfm,this.options.breaks?i.inline=ku.breaks:i.inline=ku.gfm),this.tokenizer.rules=i}static get rules(){return{block:Df,inline:ku}}static lex(t,i){return new g5(i).lex(t)}static lexInline(t,i){return new g5(i).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const r=this.inlineQueue[i];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,i=[],r=!1){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(a,c,l)=>c+"    ".repeat(l.length));let s,n,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(s=a.call({lexer:this},t,i))?(t=t.substring(s.raw.length),i.push(s),!0):!1))){if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length),s.raw.length===1&&i.length>0?i[i.length-1].raw+=`
`:i.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+s.raw,n.text+=`
`+s.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length),n=i[i.length-1],n&&(n.type==="paragraph"||n.type==="text")?(n.raw+=`
`+s.raw,n.text+=`
`+s.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),i.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),i.push(s);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const c=t.slice(1);let l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},c),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(s=this.tokenizer.paragraph(o))){n=i[i.length-1],r&&n?.type==="paragraph"?(n.raw+=`
`+s.raw,n.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(s),r=o.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length),n=i[i.length-1],n&&n.type==="text"?(n.raw+=`
`+s.raw,n.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):i.push(s);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,i}inline(t,i=[]){return this.inlineQueue.push({src:t,tokens:i}),i}inlineTokens(t,i=[]){let r,s,n,o=t,a,c,l;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(c||(l=""),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(r=u.call({lexer:this},t,i))?(t=t.substring(r.raw.length),i.push(r),!0):!1))){if(r=this.tokenizer.escape(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.tag(t)){t=t.substring(r.raw.length),s=i[i.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(r=this.tokenizer.link(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(r.raw.length),s=i[i.length-1],s&&r.type==="text"&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(r=this.tokenizer.emStrong(t,o,l)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.codespan(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.br(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.del(t)){t=t.substring(r.raw.length),i.push(r);continue}if(r=this.tokenizer.autolink(t)){t=t.substring(r.raw.length),i.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(t))){t=t.substring(r.raw.length),i.push(r);continue}if(n=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const h=t.slice(1);let f;this.options.extensions.startInline.forEach(p=>{f=p.call({lexer:this},h),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(n=t.substring(0,u+1))}if(r=this.tokenizer.inlineText(n)){t=t.substring(r.raw.length),r.raw.slice(-1)!=="_"&&(l=r.raw.slice(-1)),c=!0,s=i[i.length-1],s&&s.type==="text"?(s.raw+=r.raw,s.text+=r.text):i.push(r);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return i}},Pf=class{options;parser;constructor(e){this.options=e||Qo}space(e){return""}code({text:e,lang:t,escaped:i}){const r=(t||"").match(/^\S*/)?.[0],s=e.replace(/\n$/,"")+`
`;return r?'<pre><code class="language-'+pr(r)+'">'+(i?s:pr(s,!0))+`</code></pre>
`:"<pre><code>"+(i?s:pr(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,i=e.start;let r="";for(let o=0;o<e.items.length;o++){const a=e.items[o];r+=this.listitem(a)}const s=t?"ol":"ul",n=t&&i!==1?' start="'+i+'"':"";return"<"+s+n+`>
`+r+"</"+s+`>
`}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" "}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",i="";for(let s=0;s<e.header.length;s++)i+=this.tablecell(e.header[s]);t+=this.tablerow({text:i});let r="";for(let s=0;s<e.rows.length;s++){const n=e.rows[s];i="";for(let o=0;o<n.length;o++)i+=this.tablecell(n[o]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),s=OC(e);if(s===null)return r;e=s;let n='<a href="'+e+'"';return t&&(n+=' title="'+t+'"'),n+=">"+r+"</a>",n}image({href:e,title:t,text:i}){const r=OC(e);if(r===null)return i;e=r;let s=`<img src="${e}" alt="${i}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}},q0=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Xo=class m5{options;renderer;textRenderer;constructor(t){this.options=t||Qo,this.options.renderer=this.options.renderer||new Pf,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new q0}static parse(t,i){return new m5(i).parse(t)}static parseInline(t,i){return new m5(i).parseInline(t)}parse(t,i=!0){let r="";for(let s=0;s<t.length;s++){const n=t[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=n,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){r+=c||"";continue}}const o=n;switch(o.type){case"space":{r+=this.renderer.space(o);continue}case"hr":{r+=this.renderer.hr(o);continue}case"heading":{r+=this.renderer.heading(o);continue}case"code":{r+=this.renderer.code(o);continue}case"table":{r+=this.renderer.table(o);continue}case"blockquote":{r+=this.renderer.blockquote(o);continue}case"list":{r+=this.renderer.list(o);continue}case"html":{r+=this.renderer.html(o);continue}case"paragraph":{r+=this.renderer.paragraph(o);continue}case"text":{let a=o,c=this.renderer.text(a);for(;s+1<t.length&&t[s+1].type==="text";)a=t[++s],c+=`
`+this.renderer.text(a);i?r+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c}]}):r+=c;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}parseInline(t,i){i=i||this.renderer;let r="";for(let s=0;s<t.length;s++){const n=t[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]){const a=this.options.extensions.renderers[n.type].call({parser:this},n);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)){r+=a||"";continue}}const o=n;switch(o.type){case"escape":{r+=i.text(o);break}case"html":{r+=i.html(o);break}case"link":{r+=i.link(o);break}case"image":{r+=i.image(o);break}case"strong":{r+=i.strong(o);break}case"em":{r+=i.em(o);break}case"codespan":{r+=i.codespan(o);break}case"br":{r+=i.br(o);break}case"del":{r+=i.del(o);break}case"text":{r+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return r}},Tf=class{options;constructor(e){this.options=e||Qo}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}},az=class{defaults=j0();options=this.setOptions;parse=this.parseMarkdown(Yo.lex,Xo.parse);parseInline=this.parseMarkdown(Yo.lexInline,Xo.parseInline);Parser=Xo;Renderer=Pf;TextRenderer=q0;Lexer=Yo;Tokenizer=Cf;Hooks=Tf;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const r of e)switch(i=i.concat(t.call(this,r)),r.type){case"table":{const s=r;for(const n of s.header)i=i.concat(this.walkTokens(n.tokens,t));for(const n of s.rows)for(const o of n)i=i.concat(this.walkTokens(o.tokens,t));break}case"list":{const s=r;i=i.concat(this.walkTokens(s.items,t));break}default:{const s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(n=>{const o=s[n].flat(1/0);i=i.concat(this.walkTokens(o,t))}):s.tokens&&(i=i.concat(this.walkTokens(s.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const n=t.renderers[s.name];n?t.renderers[s.name]=function(...o){let a=s.renderer.apply(this,o);return a===!1&&(a=n.apply(this,o)),a}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const n=t[s.level];n?n.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),i.renderer){const s=this.defaults.renderer||new Pf(this.defaults);for(const n in i.renderer){if(!(n in s))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;const o=n,a=i.renderer[o],c=s[o];s[o]=(...l)=>{let u=a.apply(s,l);return u===!1&&(u=c.apply(s,l)),u||""}}r.renderer=s}if(i.tokenizer){const s=this.defaults.tokenizer||new Cf(this.defaults);for(const n in i.tokenizer){if(!(n in s))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;const o=n,a=i.tokenizer[o],c=s[o];s[o]=(...l)=>{let u=a.apply(s,l);return u===!1&&(u=c.apply(s,l)),u}}r.tokenizer=s}if(i.hooks){const s=this.defaults.hooks||new Tf;for(const n in i.hooks){if(!(n in s))throw new Error(`hook '${n}' does not exist`);if(n==="options")continue;const o=n,a=i.hooks[o],c=s[o];Tf.passThroughHooks.has(n)?s[o]=l=>{if(this.defaults.async)return Promise.resolve(a.call(s,l)).then(h=>c.call(s,h));const u=a.call(s,l);return c.call(s,u)}:s[o]=(...l)=>{let u=a.apply(s,l);return u===!1&&(u=c.apply(s,l)),u}}r.hooks=s}if(i.walkTokens){const s=this.defaults.walkTokens,n=i.walkTokens;r.walkTokens=function(o){let a=[];return a.push(n.call(this,o)),s&&(a=a.concat(s.call(this,o))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Yo.lex(e,t??this.defaults)}parser(e,t){return Xo.parse(e,t??this.defaults)}parseMarkdown(e,t){return(r,s)=>{const n={...s},o={...this.defaults,...n},a=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&n.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(r):r).then(c=>e(c,o)).then(c=>o.hooks?o.hooks.processAllTokens(c):c).then(c=>o.walkTokens?Promise.all(this.walkTokens(c,o.walkTokens)).then(()=>c):c).then(c=>t(c,o)).then(c=>o.hooks?o.hooks.postprocess(c):c).catch(a);try{o.hooks&&(r=o.hooks.preprocess(r));let c=e(r,o);o.hooks&&(c=o.hooks.processAllTokens(c)),o.walkTokens&&this.walkTokens(c,o.walkTokens);let l=t(c,o);return o.hooks&&(l=o.hooks.postprocess(l)),l}catch(c){return a(c)}}}onError(e,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+pr(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}}},Ko=new az;function ft(e,t){return Ko.parse(e,t)}ft.options=ft.setOptions=function(e){return Ko.setOptions(e),ft.defaults=Ko.defaults,MC(ft.defaults),ft},ft.getDefaults=j0,ft.defaults=Qo,ft.use=function(...e){return Ko.use(...e),ft.defaults=Ko.defaults,MC(ft.defaults),ft},ft.walkTokens=function(e,t){return Ko.walkTokens(e,t)},ft.parseInline=Ko.parseInline,ft.Parser=Xo,ft.parser=Xo.parse,ft.Renderer=Pf,ft.TextRenderer=q0,ft.Lexer=Yo,ft.lexer=Yo.lex,ft.Tokenizer=Cf,ft.Hooks=Tf,ft.parse=ft;var gte=ft.options,mte=ft.setOptions,vte=ft.use,wte=ft.walkTokens,bte=ft.parseInline,yte=Xo.parse,Ate=Yo.lex,Zr=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"}),cz=/^(.+)\/(.+?)(;.+)?$/;function GC(e,t){const i=cz.exec(e);return i?`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`:t?void 0:e}function ZC(e){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(e)}var Ii=Symbol("unset"),lz=class{constructor(){this.root=new G0,this.a=0}get size(){return this.a}get nodes(){return this.root.children?.values()||Wt.empty()}get entries(){return this.root.children?.entries()||Wt.empty()}insert(e,t,i){this.c(e,r=>r._value=t,i)}mutate(e,t){this.c(e,i=>i._value=t(i._value===Ii?void 0:i._value))}mutatePath(e,t){this.c(e,()=>{},i=>t(i))}delete(e){const t=this.b(e);if(!t)return;let i=t.length-1;const r=t[i].node._value;if(r!==Ii){for(this.a--,t[i].node._value=Ii;i>0;i--){const{node:s,part:n}=t[i];if(s.children?.size||s._value!==Ii)break;t[i-1].node.children.delete(n)}return r}}*deleteRecursive(e){const t=this.b(e);if(!t)return;const i=t[t.length-1].node;for(let r=t.length-1;r>0;r--){const s=t[r-1];if(s.node.children.delete(t[r].part),s.node.children.size>0||s.node._value!==Ii)break}for(const r of JC(i))r._value!==Ii&&(this.a--,yield r._value);i===this.root&&(this.root._value=Ii,this.root.children=void 0)}find(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return;t=r}return t._value===Ii?void 0:t._value}hasKeyOrParent(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;if(r._value!==Ii)return!0;t=r}return!1}hasKeyOrChildren(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;t=r}return!0}hasKey(e){let t=this.root;for(const i of e){const r=t.children?.get(i);if(!r)return!1;t=r}return t._value!==Ii}b(e){const t=[{part:"",node:this.root}];let i=0;for(const r of e){const s=t[i].node.children?.get(r);if(!s)return;t.push({part:r,node:s}),i++}return t}c(e,t,i){let r=this.root;for(const o of e){if(r.children)if(r.children.has(o))r=r.children.get(o);else{const a=new G0;r.children.set(o,a),r=a}else{const a=new G0;r.children=new Map([[o,a]]),r=a}i?.(r)}const s=r._value===Ii?0:1;t(r);const n=r._value===Ii?0:1;this.a+=n-s}*values(){for(const{_value:e}of JC(this.root))e!==Ii&&(yield e)}};function*JC(e){const t=[e];for(;t.length>0;){const i=t.pop();if(yield i,i.children)for(const r of i.children.values())t.push(r)}}var G0=class{constructor(){this._value=Ii}get value(){return this._value===Ii?void 0:this._value}set value(e){this._value=e===void 0?Ii:e}},gr=class _a{constructor(t,i){this.lineNumber=t,this.column=i}with(t=this.lineNumber,i=this.column){return t===this.lineNumber&&i===this.column?this:new _a(t,i)}delta(t=0,i=0){return this.with(Math.max(1,this.lineNumber+t),Math.max(1,this.column+i))}equals(t){return _a.equals(this,t)}static equals(t,i){return!t&&!i?!0:!!t&&!!i&&t.lineNumber===i.lineNumber&&t.column===i.column}isBefore(t){return _a.isBefore(this,t)}static isBefore(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<i.column}isBeforeOrEqual(t){return _a.isBeforeOrEqual(this,t)}static isBeforeOrEqual(t,i){return t.lineNumber<i.lineNumber?!0:i.lineNumber<t.lineNumber?!1:t.column<=i.column}static compare(t,i){const r=t.lineNumber|0,s=i.lineNumber|0;if(r===s){const n=t.column|0,o=i.column|0;return n-o}return r-s}clone(){return new _a(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(t){return new _a(t.lineNumber,t.column)}static isIPosition(t){return!!t&&typeof t.lineNumber=="number"&&typeof t.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},st=class ei{constructor(t,i,r,s){t>r||t===r&&i>s?(this.startLineNumber=r,this.startColumn=s,this.endLineNumber=t,this.endColumn=i):(this.startLineNumber=t,this.startColumn=i,this.endLineNumber=r,this.endColumn=s)}isEmpty(){return ei.isEmpty(this)}static isEmpty(t){return t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn}containsPosition(t){return ei.containsPosition(this,t)}static containsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<t.startColumn||i.lineNumber===t.endLineNumber&&i.column>t.endColumn)}static strictContainsPosition(t,i){return!(i.lineNumber<t.startLineNumber||i.lineNumber>t.endLineNumber||i.lineNumber===t.startLineNumber&&i.column<=t.startColumn||i.lineNumber===t.endLineNumber&&i.column>=t.endColumn)}containsRange(t){return ei.containsRange(this,t)}static containsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>t.endColumn)}strictContainsRange(t){return ei.strictContainsRange(this,t)}static strictContainsRange(t,i){return!(i.startLineNumber<t.startLineNumber||i.endLineNumber<t.startLineNumber||i.startLineNumber>t.endLineNumber||i.endLineNumber>t.endLineNumber||i.startLineNumber===t.startLineNumber&&i.startColumn<=t.startColumn||i.endLineNumber===t.endLineNumber&&i.endColumn>=t.endColumn)}plusRange(t){return ei.plusRange(this,t)}static plusRange(t,i){let r,s,n,o;return i.startLineNumber<t.startLineNumber?(r=i.startLineNumber,s=i.startColumn):i.startLineNumber===t.startLineNumber?(r=i.startLineNumber,s=Math.min(i.startColumn,t.startColumn)):(r=t.startLineNumber,s=t.startColumn),i.endLineNumber>t.endLineNumber?(n=i.endLineNumber,o=i.endColumn):i.endLineNumber===t.endLineNumber?(n=i.endLineNumber,o=Math.max(i.endColumn,t.endColumn)):(n=t.endLineNumber,o=t.endColumn),new ei(r,s,n,o)}intersectRanges(t){return ei.intersectRanges(this,t)}static intersectRanges(t,i){let r=t.startLineNumber,s=t.startColumn,n=t.endLineNumber,o=t.endColumn;const a=i.startLineNumber,c=i.startColumn,l=i.endLineNumber,u=i.endColumn;return r<a?(r=a,s=c):r===a&&(s=Math.max(s,c)),n>l?(n=l,o=u):n===l&&(o=Math.min(o,u)),r>n||r===n&&s>o?null:new ei(r,s,n,o)}equalsRange(t){return ei.equalsRange(this,t)}static equalsRange(t,i){return!t&&!i?!0:!!t&&!!i&&t.startLineNumber===i.startLineNumber&&t.startColumn===i.startColumn&&t.endLineNumber===i.endLineNumber&&t.endColumn===i.endColumn}getEndPosition(){return ei.getEndPosition(this)}static getEndPosition(t){return new gr(t.endLineNumber,t.endColumn)}getStartPosition(){return ei.getStartPosition(this)}static getStartPosition(t){return new gr(t.startLineNumber,t.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(t,i){return new ei(this.startLineNumber,this.startColumn,t,i)}setStartPosition(t,i){return new ei(t,i,this.endLineNumber,this.endColumn)}collapseToStart(){return ei.collapseToStart(this)}static collapseToStart(t){return new ei(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn)}collapseToEnd(){return ei.collapseToEnd(this)}static collapseToEnd(t){return new ei(t.endLineNumber,t.endColumn,t.endLineNumber,t.endColumn)}delta(t){return new ei(this.startLineNumber+t,this.startColumn,this.endLineNumber+t,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(t,i=t){return new ei(t.lineNumber,t.column,i.lineNumber,i.column)}static lift(t){return t?new ei(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):null}static isIRange(t){return!!t&&typeof t.startLineNumber=="number"&&typeof t.startColumn=="number"&&typeof t.endLineNumber=="number"&&typeof t.endColumn=="number"}static areIntersectingOrTouching(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn)}static areIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber||t.endLineNumber===i.startLineNumber&&t.endColumn<=i.startColumn||i.endLineNumber<t.startLineNumber||i.endLineNumber===t.startLineNumber&&i.endColumn<=t.startColumn)}static areOnlyIntersecting(t,i){return!(t.endLineNumber<i.startLineNumber-1||t.endLineNumber===i.startLineNumber&&t.endColumn<i.startColumn-1||i.endLineNumber<t.startLineNumber-1||i.endLineNumber===t.startLineNumber&&i.endColumn<t.startColumn-1)}static compareRangesUsingStarts(t,i){if(t&&i){const n=t.startLineNumber|0,o=i.startLineNumber|0;if(n===o){const a=t.startColumn|0,c=i.startColumn|0;if(a===c){const l=t.endLineNumber|0,u=i.endLineNumber|0;if(l===u){const h=t.endColumn|0,f=i.endColumn|0;return h-f}return l-u}return a-c}return n-o}return(t?1:0)-(i?1:0)}static compareRangesUsingEnds(t,i){return t.endLineNumber===i.endLineNumber?t.endColumn===i.endColumn?t.startLineNumber===i.startLineNumber?t.startColumn-i.startColumn:t.startLineNumber-i.startLineNumber:t.endColumn-i.endColumn:t.endLineNumber-i.endLineNumber}static spansMultipleLines(t){return t.endLineNumber>t.startLineNumber}toJSON(){return this}},uz=class{constructor(){this.a=new Map,this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=null}handleChange(e){this.c.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this.a.set(e,t),this.handleChange([e]),te(()=>{this.a.get(e)===t&&(this.a.delete(e),this.handleChange([e]))})}get(e){return this.a.get(e)||null}registerFactory(e,t){this.b.get(e)?.dispose();const i=new hz(this,e,t);return this.b.set(e,i),te(()=>{const r=this.b.get(e);!r||r!==i||(this.b.delete(e),r.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this.b.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this.b.get(e);return!!(!i||i.isResolved)}setColorMap(e){this.d=e,this.c.fire({changedLanguages:Array.from(this.a.keys()),changedColorMap:!0})}getColorMap(){return this.d}getDefaultBackground(){return this.d&&this.d.length>2?this.d[2]:null}},hz=class extends Q{get isResolved(){return this.c}constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=!1,this.b=null,this.c=!1}dispose(){this.a=!0,super.dispose()}async resolve(){return this.b||(this.b=this.j()),this.b}async j(){const e=await this.h.tokenizationSupport;this.c=!0,e&&!this.a&&this.D(this.f.register(this.g,e))}},QC;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(QC||(QC={}));var YC;(function(e){e[e.Method=0]="Method",e[e.Function=1]="Function",e[e.Constructor=2]="Constructor",e[e.Field=3]="Field",e[e.Variable=4]="Variable",e[e.Class=5]="Class",e[e.Struct=6]="Struct",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Event=10]="Event",e[e.Operator=11]="Operator",e[e.Unit=12]="Unit",e[e.Value=13]="Value",e[e.Constant=14]="Constant",e[e.Enum=15]="Enum",e[e.EnumMember=16]="EnumMember",e[e.Keyword=17]="Keyword",e[e.Text=18]="Text",e[e.Color=19]="Color",e[e.File=20]="File",e[e.Reference=21]="Reference",e[e.Customcolor=22]="Customcolor",e[e.Folder=23]="Folder",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue",e[e.Tool=27]="Tool",e[e.Snippet=28]="Snippet"})(YC||(YC={}));var XC;(function(e){const t=new Map;t.set(0,oe.symbolMethod),t.set(1,oe.symbolFunction),t.set(2,oe.symbolConstructor),t.set(3,oe.symbolField),t.set(4,oe.symbolVariable),t.set(5,oe.symbolClass),t.set(6,oe.symbolStruct),t.set(7,oe.symbolInterface),t.set(8,oe.symbolModule),t.set(9,oe.symbolProperty),t.set(10,oe.symbolEvent),t.set(11,oe.symbolOperator),t.set(12,oe.symbolUnit),t.set(13,oe.symbolValue),t.set(15,oe.symbolEnum),t.set(14,oe.symbolConstant),t.set(15,oe.symbolEnum),t.set(16,oe.symbolEnumMember),t.set(17,oe.symbolKeyword),t.set(28,oe.symbolSnippet),t.set(18,oe.symbolText),t.set(19,oe.symbolColor),t.set(20,oe.symbolFile),t.set(21,oe.symbolReference),t.set(22,oe.symbolCustomColor),t.set(23,oe.symbolFolder),t.set(24,oe.symbolTypeParameter),t.set(25,oe.account),t.set(26,oe.issues),t.set(27,oe.tools);function i(o){let a=t.get(o);return a||(console.info("No codicon found for CompletionItemKind "+o),a=oe.symbolProperty),a}e.toIcon=i;function r(o){switch(o){case 0:return d(847,null);case 1:return d(848,null);case 2:return d(849,null);case 3:return d(850,null);case 4:return d(851,null);case 5:return d(852,null);case 6:return d(853,null);case 7:return d(854,null);case 8:return d(855,null);case 9:return d(856,null);case 10:return d(857,null);case 11:return d(858,null);case 12:return d(859,null);case 13:return d(860,null);case 14:return d(861,null);case 15:return d(862,null);case 16:return d(863,null);case 17:return d(864,null);case 18:return d(865,null);case 19:return d(866,null);case 20:return d(867,null);case 21:return d(868,null);case 22:return d(869,null);case 23:return d(870,null);case 24:return d(871,null);case 25:return d(872,null);case 26:return d(873,null);case 27:return d(874,null);case 28:return d(875,null);default:return""}}e.toLabel=r;const s=new Map;s.set("method",0),s.set("function",1),s.set("constructor",2),s.set("field",3),s.set("variable",4),s.set("class",5),s.set("struct",6),s.set("interface",7),s.set("module",8),s.set("property",9),s.set("event",10),s.set("operator",11),s.set("unit",12),s.set("value",13),s.set("constant",14),s.set("enum",15),s.set("enum-member",16),s.set("enumMember",16),s.set("keyword",17),s.set("snippet",28),s.set("text",18),s.set("color",19),s.set("file",20),s.set("reference",21),s.set("customcolor",22),s.set("folder",23),s.set("type-parameter",24),s.set("typeParameter",24),s.set("account",25),s.set("issue",26),s.set("tool",27);function n(o,a){let c=s.get(o);return typeof c>"u"&&!a&&(c=9),c}e.fromString=n})(XC||(XC={}));var KC;(function(e){e[e.Deprecated=1]="Deprecated"})(KC||(KC={}));var e$;(function(e){e[e.None=0]="None",e[e.KeepWhitespace=1]="KeepWhitespace",e[e.InsertAsSnippet=4]="InsertAsSnippet"})(e$||(e$={}));var t$;(function(e){e[e.Word=0]="Word",e[e.Line=1]="Line",e[e.Suggest=2]="Suggest"})(t$||(t$={}));var i$;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(i$||(i$={}));var Mf;(function(e){e[e.Automatic=0]="Automatic",e[e.Explicit=1]="Explicit"})(Mf||(Mf={}));var mc;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(mc||(mc={}));var Nf;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Nf||(Nf={}));var r$;(function(e){e[e.Invoke=1]="Invoke",e[e.Auto=2]="Auto"})(r$||(r$={}));var s$;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(s$||(s$={}));var n$;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(n$||(n$={}));var o$;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(o$||(o$={}));function dz(e){return!!e&&y.isUri(e.uri)&&st.isIRange(e.range)&&(st.isIRange(e.originSelectionRange)||st.isIRange(e.targetSelectionRange))}function fz(e){return!!e&&y.isUri(e.uri)&&st.isIRange(e.range)}var a$;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(a$||(a$={}));var Ste={17:d(876,null),16:d(877,null),4:d(878,null),13:d(879,null),8:d(880,null),9:d(881,null),21:d(882,null),23:d(883,null),7:d(884,null),0:d(885,null),11:d(886,null),10:d(887,null),19:d(888,null),5:d(889,null),1:d(890,null),2:d(891,null),20:d(892,null),15:d(893,null),18:d(894,null),24:d(895,null),3:d(896,null),6:d(897,null),14:d(898,null),22:d(899,null),25:d(900,null),12:d(901,null)},c$;(function(e){e[e.Deprecated=1]="Deprecated"})(c$||(c$={}));var Z0;(function(e){const t=new Map;t.set(0,oe.symbolFile),t.set(1,oe.symbolModule),t.set(2,oe.symbolNamespace),t.set(3,oe.symbolPackage),t.set(4,oe.symbolClass),t.set(5,oe.symbolMethod),t.set(6,oe.symbolProperty),t.set(7,oe.symbolField),t.set(8,oe.symbolConstructor),t.set(9,oe.symbolEnum),t.set(10,oe.symbolInterface),t.set(11,oe.symbolFunction),t.set(12,oe.symbolVariable),t.set(13,oe.symbolConstant),t.set(14,oe.symbolString),t.set(15,oe.symbolNumber),t.set(16,oe.symbolBoolean),t.set(17,oe.symbolArray),t.set(18,oe.symbolObject),t.set(19,oe.symbolKey),t.set(20,oe.symbolNull),t.set(21,oe.symbolEnumMember),t.set(22,oe.symbolStruct),t.set(23,oe.symbolEvent),t.set(24,oe.symbolOperator),t.set(25,oe.symbolTypeParameter);function i(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=oe.symbolProperty),o}e.toIcon=i;const r=new Map;r.set(0,20),r.set(1,8),r.set(2,8),r.set(3,8),r.set(4,5),r.set(5,0),r.set(6,9),r.set(7,3),r.set(8,2),r.set(9,15),r.set(10,7),r.set(11,1),r.set(12,4),r.set(13,14),r.set(14,18),r.set(15,13),r.set(16,13),r.set(17,13),r.set(18,13),r.set(19,17),r.set(20,13),r.set(21,16),r.set(22,6),r.set(23,10),r.set(24,11),r.set(25,24);function s(n){let o=r.get(n);return o===void 0&&(console.info("No completion kind found for SymbolKind "+n),o=20),o}e.toCompletionKind=s})(Z0||(Z0={}));var vc=class ko{static{this.Comment=new ko("comment")}static{this.Imports=new ko("imports")}static{this.Region=new ko("region")}static fromValue(t){switch(t){case"comment":return ko.Comment;case"imports":return ko.Imports;case"region":return ko.Region}return new ko(t)}constructor(t){this.value=t}},l$;(function(e){e[e.AIGenerated=1]="AIGenerated"})(l$||(l$={}));var Rf;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(Rf||(Rf={}));var J0;(function(e){function t(i){return!i||typeof i!="object"?!1:typeof i.id=="string"&&typeof i.title=="string"}e.is=t})(J0||(J0={}));var wc;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(wc||(wc={}));var Cu;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(Cu||(Cu={}));var $u;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})($u||($u={}));var u$;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(u$||(u$={}));var h$;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(h$||(h$={}));var d$;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(d$||(d$={}));var Ete=new uz,f$;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(f$||(f$={}));var p$;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(p$||(p$={}));var Fi;(function(e){e[e.Hint=1]="Hint",e[e.Info=2]="Info",e[e.Warning=4]="Warning",e[e.Error=8]="Error"})(Fi||(Fi={})),function(e){function t(c,l){return l-c}e.compare=t;const i=Object.create(null);i[e.Error]=d(2175,null),i[e.Warning]=d(2176,null),i[e.Info]=d(2177,null);function r(c){return i[c]||""}e.toString=r;const s=Object.create(null);s[e.Error]=d(2178,null),s[e.Warning]=d(2179,null),s[e.Info]=d(2180,null);function n(c){return s[c]||""}e.toStringPlural=n;function o(c){switch(c){case Mt.Error:return e.Error;case Mt.Warning:return e.Warning;case Mt.Info:return e.Info;case Mt.Ignore:return e.Hint}}e.fromSeverity=o;function a(c){switch(c){case e.Error:return Mt.Error;case e.Warning:return Mt.Warning;case e.Info:return Mt.Info;case e.Hint:return Mt.Ignore}}e.toSeverity=a}(Fi||(Fi={}));var g$;(function(e){const t="";function i(s){return r(s,!0)}e.makeKey=i;function r(s,n){const o=[t];return s.source?o.push(s.source.replace("\xA6","\\\xA6")):o.push(t),s.code?typeof s.code=="string"?o.push(s.code.replace("\xA6","\\\xA6")):o.push(s.code.value.replace("\xA6","\\\xA6")):o.push(t),s.severity!==void 0&&s.severity!==null?o.push(Fi.toString(s.severity)):o.push(t),s.message&&n?o.push(s.message.replace("\xA6","\\\xA6")):o.push(t),s.startLineNumber!==void 0&&s.startLineNumber!==null?o.push(s.startLineNumber.toString()):o.push(t),s.startColumn!==void 0&&s.startColumn!==null?o.push(s.startColumn.toString()):o.push(t),s.endLineNumber!==void 0&&s.endLineNumber!==null?o.push(s.endLineNumber.toString()):o.push(t),s.endColumn!==void 0&&s.endColumn!==null?o.push(s.endColumn.toString()):o.push(t),o.push(t),o.join("\xA6")}e.makeKeyOptionalMessage=r})(g$||(g$={}));var xte=H("markerService"),pz=class{constructor(){this.a=new Map}add(e,t){ki(Oe(e)),ki(yt(t)),ki(!this.a.has(e),"There is already an extension with this id"),this.a.set(e,t)}knows(e){return this.a.has(e)}as(e){return this.a.get(e)||null}dispose(){this.a.forEach(e=>{eE(e.dispose)&&e.dispose()}),this.a.clear()}},Zt=new pz,m$=H("fileService");function bc(e){return e.create===!0}var tr;(function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"})(tr||(tr={}));var Zn;(function(e){e[e.Readonly=1]="Readonly",e[e.Locked=2]="Locked"})(Zn||(Zn={}));var v$;(function(e){e[e.UPDATED=2]="UPDATED",e[e.ADDED=4]="ADDED",e[e.DELETED=8]="DELETED"})(v$||(v$={}));var w$;(function(e){e[e.None=0]="None",e[e.FileReadWrite=2]="FileReadWrite",e[e.FileOpenReadWriteClose=4]="FileOpenReadWriteClose",e[e.FileReadStream=16]="FileReadStream",e[e.FileFolderCopy=8]="FileFolderCopy",e[e.PathCaseSensitive=1024]="PathCaseSensitive",e[e.Readonly=2048]="Readonly",e[e.Trash=4096]="Trash",e[e.FileWriteUnlock=8192]="FileWriteUnlock",e[e.FileAtomicRead=16384]="FileAtomicRead",e[e.FileAtomicWrite=32768]="FileAtomicWrite",e[e.FileAtomicDelete=65536]="FileAtomicDelete",e[e.FileClone=131072]="FileClone",e[e.FileRealpath=262144]="FileRealpath"})(w$||(w$={}));var he;(function(e){e.FileExists="EntryExists",e.FileNotFound="EntryNotFound",e.FileNotADirectory="EntryNotADirectory",e.FileIsADirectory="EntryIsADirectory",e.FileExceedsStorageQuota="EntryExceedsStorageQuota",e.FileTooLarge="EntryTooLarge",e.FileWriteLocked="EntryWriteLocked",e.NoPermissions="NoPermissions",e.Unavailable="Unavailable",e.Unknown="Unknown"})(he||(he={}));var Lf=class oN extends Error{static create(t,i){const r=new oN(t.toString(),i);return b$(r,i),r}constructor(t,i){super(t),this.code=i}};function en(e,t){return Lf.create(e,t)}function gz(e){return e||en(d(2085,null),he.Unknown)}function b$(e,t){return e.name=t?`${t} (FileSystemError)`:"FileSystemError",e}function Of(e){if(!e)return he.Unknown;if(e instanceof Lf)return e.code;const t=/^(.+) \(FileSystemError\)$/.exec(e.name);if(!t)return he.Unknown;switch(t[1]){case he.FileExists:return he.FileExists;case he.FileIsADirectory:return he.FileIsADirectory;case he.FileNotADirectory:return he.FileNotADirectory;case he.FileNotFound:return he.FileNotFound;case he.FileTooLarge:return he.FileTooLarge;case he.FileWriteLocked:return he.FileWriteLocked;case he.NoPermissions:return he.NoPermissions;case he.Unavailable:return he.Unavailable}return he.Unknown}function mz(e){if(e instanceof Ff)return e.fileOperationResult;switch(Of(e)){case he.FileNotFound:return 1;case he.FileIsADirectory:return 0;case he.FileNotADirectory:return 9;case he.FileWriteLocked:return 5;case he.NoPermissions:return 6;case he.FileExists:return 4;case he.FileTooLarge:return 7;default:return 10}}var y$;(function(e){e[e.CREATE=0]="CREATE",e[e.DELETE=1]="DELETE",e[e.MOVE=2]="MOVE",e[e.COPY=3]="COPY",e[e.WRITE=4]="WRITE"})(y$||(y$={}));var A$;(function(e){e[e.UPDATED=0]="UPDATED",e[e.ADDED=1]="ADDED",e[e.DELETED=2]="DELETED"})(A$||(A$={}));var kte=class q1{static{this.a=null}constructor(t,i){this.c=i,this.b=void 0,this.d=new Pt(()=>{const r=Vn.forUris(()=>this.c);return r.fill(this.rawAdded.map(s=>[s,!0])),r}),this.f=new Pt(()=>{const r=Vn.forUris(()=>this.c);return r.fill(this.rawUpdated.map(s=>[s,!0])),r}),this.g=new Pt(()=>{const r=Vn.forUris(()=>this.c);return r.fill(this.rawDeleted.map(s=>[s,!0])),r}),this.rawAdded=[],this.rawUpdated=[],this.rawDeleted=[];for(const r of t){switch(r.type){case 1:this.rawAdded.push(r.resource);break;case 0:this.rawUpdated.push(r.resource);break;case 2:this.rawDeleted.push(r.resource);break}this.b!==q1.a&&(typeof r.cId=="number"?this.b===void 0?this.b=r.cId:this.b!==r.cId&&(this.b=q1.a):this.b!==void 0&&(this.b=q1.a))}}contains(t,...i){return this.h(t,{includeChildren:!1},...i)}affects(t,...i){return this.h(t,{includeChildren:!0},...i)}h(t,i,...r){if(!t)return!1;const s=r.length>0;return!!((!s||r.includes(1))&&(this.d.value.get(t)||i.includeChildren&&this.d.value.findSuperstr(t))||(!s||r.includes(0))&&(this.f.value.get(t)||i.includeChildren&&this.f.value.findSuperstr(t))||(!s||r.includes(2))&&(this.g.value.findSubstr(t)||i.includeChildren&&this.g.value.findSuperstr(t)))}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(t){return this.b===t}hasCorrelation(){return typeof this.b=="number"}};function vz(e,t,i){return!e||!t||e===t||t.length>e.length?!1:(t.charAt(t.length-1)!==St&&(t+=St),i?Kd(e,t):e.indexOf(t)===0)}var Ff=class extends Error{constructor(e,t,i){super(e),this.fileOperationResult=t,this.options=i}},S$;(function(e){e[e.FILE_IS_DIRECTORY=0]="FILE_IS_DIRECTORY",e[e.FILE_NOT_FOUND=1]="FILE_NOT_FOUND",e[e.FILE_NOT_MODIFIED_SINCE=2]="FILE_NOT_MODIFIED_SINCE",e[e.FILE_MODIFIED_SINCE=3]="FILE_MODIFIED_SINCE",e[e.FILE_MOVE_CONFLICT=4]="FILE_MOVE_CONFLICT",e[e.FILE_WRITE_LOCKED=5]="FILE_WRITE_LOCKED",e[e.FILE_PERMISSION_DENIED=6]="FILE_PERMISSION_DENIED",e[e.FILE_TOO_LARGE=7]="FILE_TOO_LARGE",e[e.FILE_INVALID_PATH=8]="FILE_INVALID_PATH",e[e.FILE_NOT_DIRECTORY=9]="FILE_NOT_DIRECTORY",e[e.FILE_OTHER_ERROR=10]="FILE_OTHER_ERROR"})(S$||(S$={}));var E$;(function(e){e[e.FILE=0]="FILE",e[e.FOLDER=1]="FOLDER",e[e.ROOT_FOLDER=2]="ROOT_FOLDER"})(E$||(E$={}));var wz="";function x$(e){if(!(typeof e.size!="number"||typeof e.mtime!="number"))return e.mtime.toString(29)+e.size.toString(31)}var k$=class qi{static{this.KB=1024}static{this.MB=qi.KB*qi.KB}static{this.GB=qi.MB*qi.KB}static{this.TB=qi.GB*qi.KB}static formatSize(t){return Er(t)||(t=0),t<qi.KB?d(2086,null,t.toFixed(0)):t<qi.MB?d(2087,null,(t/qi.KB).toFixed(2)):t<qi.GB?d(2088,null,(t/qi.MB).toFixed(2)):t<qi.TB?d(2089,null,(t/qi.GB).toFixed(2)):d(2090,null,(t/qi.TB).toFixed(2))}},bz=class extends Q{get onDidChange(){return this.j.event}constructor(e,t="",i="",r=!0,s){super(),this.j=this.D(new I),this.z=!0,this.m=e,this.n=t,this.w=i,this.z=r,this.F=s}get id(){return this.m}get label(){return this.n}set label(e){this.G(e)}G(e){this.n!==e&&(this.n=e,this.j.fire({label:e}))}get tooltip(){return this.u||""}set tooltip(e){this.H(e)}H(e){this.u!==e&&(this.u=e,this.j.fire({tooltip:e}))}get class(){return this.w}set class(e){this.I(e)}I(e){this.w!==e&&(this.w=e,this.j.fire({class:e}))}get enabled(){return this.z}set enabled(e){this.J(e)}J(e){this.z!==e&&(this.z=e,this.j.fire({enabled:e}))}get checked(){return this.C}set checked(e){this.L(e)}L(e){this.C!==e&&(this.C=e,this.j.fire({checked:e}))}async run(e,t){this.F&&await this.F(e)}},Cte=class v5{constructor(){this.id=v5.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...t){let i=[];for(const r of t)r.length&&(i.length?i=[...i,new v5,...r]:i=r);return i}static{this.ID="vs.actions.separator"}async run(){}},$te=class aN extends bz{static{this.ID="vs.actions.empty"}constructor(){super(aN.ID,d(44,null),void 0,!1)}},yz={EditorPane:"workbench.contributions.editors",EditorFactory:"workbench.contributions.editor.inputFactories"},Az={id:"default",displayName:d(4460,null),providerDisplayName:d(4461,null)},Sz="workbench.editors.textDiffEditor",Ez="workbench.editors.binaryResourceDiffEditor",C$;(function(e){e[e.PROGRAMMATIC=1]="PROGRAMMATIC",e[e.USER=2]="USER",e[e.EDIT=3]="EDIT",e[e.NAVIGATION=4]="NAVIGATION",e[e.JUMP=5]="JUMP"})(C$||(C$={}));var $$;(function(e){e[e.IDENTICAL=1]="IDENTICAL",e[e.SIMILAR=2]="SIMILAR",e[e.DIFFERENT=3]="DIFFERENT"})($$||($$={}));function Q0(e,t,i){for(const r of i.visibleEditorPanes)if(r.group.id===t&&e.matches(r.input))return r.getViewState()}function xz(e){if(Jr(e))return!1;const t=e;return y.isUri(t?.resource)}function tn(e){if(Jr(e))return!1;const t=e;return t?.original!==void 0&&t.modified!==void 0}function Iu(e){if(Jr(e))return!1;const t=e;return!t||t.resources&&!Array.isArray(t.resources)?!1:!!t.resources||!!t.multiDiffSource}function ea(e){if(Jr(e)||tn(e))return!1;const t=e;return t?.primary!==void 0&&t.secondary!==void 0}function ta(e){if(Jr(e))return!1;const t=e;return y.isUri(t?.base?.resource)&&y.isUri(t?.input1?.resource)&&y.isUri(t?.input2?.resource)&&y.isUri(t?.result?.resource)}var I$;(function(e){e[e.SHORT=0]="SHORT",e[e.MEDIUM=1]="MEDIUM",e[e.LONG=2]="LONG"})(I$||(I$={}));var D$;(function(e){e[e.EXPLICIT=1]="EXPLICIT",e[e.AUTO=2]="AUTO",e[e.FOCUS_CHANGE=3]="FOCUS_CHANGE",e[e.WINDOW_CHANGE=4]="WINDOW_CHANGE"})(D$||(D$={}));var kz=class{constructor(){this.a=new Map}registerSource(e,t){let i=this.a.get(e);return i||(i={source:e,label:t},this.a.set(e,i)),i.source}getSourceLabel(e){return this.a.get(e)?.label??e}},Ite=new kz,P$;(function(e){e[e.None=0]="None",e[e.Readonly=2]="Readonly",e[e.Untitled=4]="Untitled",e[e.Singleton=8]="Singleton",e[e.RequiresTrust=16]="RequiresTrust",e[e.CanSplitInGroup=32]="CanSplitInGroup",e[e.ForceDescription=64]="ForceDescription",e[e.CanDropIntoEditor=128]="CanDropIntoEditor",e[e.MultipleEditors=256]="MultipleEditors",e[e.Scratchpad=512]="Scratchpad"})(P$||(P$={}));var T$=class extends Q{};function Jr(e){return e instanceof T$}function Cz(e){const t=e;return y.isUri(t?.preferredResource)}function $z(e){const t=e;return Jr(t?.primary)&&Jr(t?.secondary)}function M$(e){const t=e;return Jr(t?.modified)&&Jr(t?.original)}var N$;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.REPLACE=1]="REPLACE",e[e.MOVE=2]="MOVE",e[e.UNPIN=3]="UNPIN"})(N$||(N$={}));var R$;(function(e){e[e.GROUP_ACTIVE=0]="GROUP_ACTIVE",e[e.GROUP_INDEX=1]="GROUP_INDEX",e[e.GROUP_LABEL=2]="GROUP_LABEL",e[e.GROUP_LOCKED=3]="GROUP_LOCKED",e[e.EDITORS_SELECTION=4]="EDITORS_SELECTION",e[e.EDITOR_OPEN=5]="EDITOR_OPEN",e[e.EDITOR_CLOSE=6]="EDITOR_CLOSE",e[e.EDITOR_MOVE=7]="EDITOR_MOVE",e[e.EDITOR_ACTIVE=8]="EDITOR_ACTIVE",e[e.EDITOR_LABEL=9]="EDITOR_LABEL",e[e.EDITOR_CAPABILITIES=10]="EDITOR_CAPABILITIES",e[e.EDITOR_PIN=11]="EDITOR_PIN",e[e.EDITOR_TRANSIENT=12]="EDITOR_TRANSIENT",e[e.EDITOR_STICKY=13]="EDITOR_STICKY",e[e.EDITOR_DIRTY=14]="EDITOR_DIRTY",e[e.EDITOR_WILL_DISPOSE=15]="EDITOR_WILL_DISPOSE"})(R$||(R$={}));var Jn;(function(e){e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=2]="SECONDARY",e[e.BOTH=3]="BOTH",e[e.ANY=4]="ANY"})(Jn||(Jn={}));var Iz=class{getOriginalUri(e,t){if(!e)return;if(ta(e))return Y0.getOriginalUri(e.result,t);if(t?.supportSideBySide){const{primary:r,secondary:s}=this.a(e);if(r&&s){if(t?.supportSideBySide===Jn.BOTH)return{primary:this.getOriginalUri(r,{filterByScheme:t.filterByScheme}),secondary:this.getOriginalUri(s,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Jn.ANY)return this.getOriginalUri(r,{filterByScheme:t.filterByScheme})??this.getOriginalUri(s,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Jn.PRIMARY?r:s}}if(tn(e)||Iu(e)||ea(e)||ta(e))return;const i=Cz(e)?e.preferredResource:e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}a(e){return $z(e)||ea(e)?{primary:e.primary,secondary:e.secondary}:M$(e)||tn(e)?{primary:e.modified,secondary:e.original}:{primary:void 0,secondary:void 0}}getCanonicalUri(e,t){if(!e)return;if(ta(e))return Y0.getCanonicalUri(e.result,t);if(t?.supportSideBySide){const{primary:r,secondary:s}=this.a(e);if(r&&s){if(t?.supportSideBySide===Jn.BOTH)return{primary:this.getCanonicalUri(r,{filterByScheme:t.filterByScheme}),secondary:this.getCanonicalUri(s,{filterByScheme:t.filterByScheme})};if(t?.supportSideBySide===Jn.ANY)return this.getCanonicalUri(r,{filterByScheme:t.filterByScheme})??this.getCanonicalUri(s,{filterByScheme:t.filterByScheme});e=t.supportSideBySide===Jn.PRIMARY?r:s}}if(tn(e)||Iu(e)||ea(e)||ta(e))return;const i=e.resource;return!i||!t?.filterByScheme?i:this.b(i,t.filterByScheme)}b(e,t){if(Array.isArray(t)){if(t.some(i=>e.scheme===i))return e}else if(t===e.scheme)return e}},L$;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.KEYBOARD=1]="KEYBOARD",e[e.MOUSE=2]="MOUSE"})(L$||(L$={}));var Y0=new Iz,O$;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(O$||(O$={}));var Dz=class{constructor(){this.c=new Map,this.d=new Map}start(e){const t=this.a=e.get(dc);for(const[i,r]of this.c)this.e(i,r,t);this.c.clear()}e(e,t,i){const r=i.createInstance(t);this.d.set(e,r)}registerFileEditorFactory(e){if(this.b)throw new Error("Can only register one file editor factory.");this.b=e}getFileEditorFactory(){return Xa(this.b)}registerEditorSerializer(e,t){if(this.c.has(e)||this.d.has(e))throw new Error(`A editor serializer with type ID '${e}' was already registered.`);return this.a?this.e(e,t,this.a):this.c.set(e,t),te(()=>{this.c.delete(e),this.d.delete(e)})}getEditorSerializer(e){return this.d.get(typeof e=="string"?e:e.typeId)}};Zt.add(yz.EditorFactory,new Dz);var F$;(function(e){e[e.MOST_RECENTLY_ACTIVE=0]="MOST_RECENTLY_ACTIVE",e[e.SEQUENTIAL=1]="SEQUENTIAL"})(F$||(F$={}));var U$;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress",e[e.NeedsInput=3]="NeedsInput"})(U$||(U$={}));var j$="local",Dte=H("chatSessionsService"),Ss;(function(e){e.scheme=q.vscodeLocalChatSession;function t(s){const n=oc(W.wrap(new TextEncoder().encode(s)),!1,!0);return y.from({scheme:e.scheme,authority:j$,path:"/"+n})}e.forSession=t;function i(s){const n=r(s);return n?.chatSessionType===j$?n.sessionId:void 0}e.parseLocalSessionId=i;function r(s){if(s.scheme!==e.scheme||!s.authority)return;const n=s.path.split("/");if(n.length!==2)return;const o=s.authority,a=Ho(n[1]);return{chatSessionType:o,sessionId:new TextDecoder().decode(a.buffer)}}})(Ss||(Ss={}));function X0(e){const t=Ss.parseLocalSessionId(e);return t||e.toString()}var z$;(function(e){e[e.NotOmitted=0]="NotOmitted",e[e.Partial=1]="Partial",e[e.Full=2]="Full"})(z$||(z$={}));var K0;(function(e){e.icon=oe.error;function t(n){return{filterUri:n.resource,owner:n.owner,problemMessage:n.message,filterRange:{startLineNumber:n.startLineNumber,endLineNumber:n.endLineNumber,startColumn:n.startColumn,endColumn:n.endColumn}}}e.fromMarker=t;function i(n){return{id:r(n),name:s(n),icon:e.icon,value:n,kind:"diagnostic",...n}}e.toEntry=i;function r(n){return[n.filterUri,n.owner,n.filterSeverity,n.filterRange?.startLineNumber,n.filterRange?.startColumn].join(":")}e.id=r;function s(n){let o;if(function(c){c[c.MaxChars=30]="MaxChars",c[c.MaxSpaceLookback=10]="MaxSpaceLookback"}(o||(o={})),n.problemMessage){if(n.problemMessage.length<30)return n.problemMessage;const c=n.problemMessage.lastIndexOf(" ",30);return c===-1||c+10<30?n.problemMessage.substring(0,30)+"\u2026":n.problemMessage.substring(0,c)+"\u2026"}let a=d(6528,null);return n.filterUri&&(a=d(6529,null,dr(n.filterUri))),a}e.label=s})(K0||(K0={}));var H$;(function(e){function t(i){return y.isUri(i.value)?i.value:fz(i.value)?i.value.uri:void 0}e.toUri=t})(H$||(H$={}));function Pz(e){return e.kind==="image"}function Tz(e){return e.kind==="promptFile"}function Mz(e){return e.kind==="promptText"}var ew;(function(e){e.Instruction="vscode.prompt.instructions.root",e.InstructionReference="vscode.prompt.instructions",e.PromptFile="vscode.prompt.file"})(ew||(ew={}));var Qn;(function(e){e.AgentEnabled="chat.agent.enabled",e.Edits2Enabled="chat.edits2.enabled",e.ExtensionToolsEnabled="chat.extensionTools.enabled",e.EditRequests="chat.editRequests",e.GlobalAutoApprove="chat.tools.global.autoApprove",e.AutoApproveEdits="chat.tools.edits.autoApprove",e.AutoApprovedUrls="chat.tools.urls.autoApprove",e.EligibleForAutoApproval="chat.tools.eligibleForAutoApproval",e.EnableMath="chat.math.enabled",e.CheckpointsEnabled="chat.checkpoints.enabled",e.AgentSessionsViewLocation="chat.agentSessionsViewLocation",e.ThinkingStyle="chat.agent.thinkingStyle",e.ThinkingGenerateTitles="chat.agent.thinking.generateTitles",e.TodosShowWidget="chat.tools.todos.showWidget",e.ShowAgentSessionsViewDescription="chat.showAgentSessionsViewDescription",e.NotifyWindowOnResponseReceived="chat.notifyWindowOnResponseReceived",e.ChatViewSessionsEnabled="chat.viewSessions.enabled",e.ChatViewSessionsOrientation="chat.viewSessions.orientation",e.ChatViewTitleEnabled="chat.viewTitle.enabled",e.ChatViewWelcomeEnabled="chat.viewWelcome.enabled",e.SubagentToolCustomAgents="chat.customAgentInSubagent.enabled",e.ShowCodeBlockProgressAnimation="chat.agent.codeBlockProgress",e.RestoreLastPanelSession="chat.restoreLastPanelSession",e.ExitAfterDelegation="chat.exitAfterDelegation",e.SuspendThrottling="chat.suspendThrottling"})(Qn||(Qn={}));var Dr;(function(e){e.Ask="ask",e.Edit="edit",e.Agent="agent"})(Dr||(Dr={}));var W$;(function(e){e.Collapsed="collapsed",e.CollapsedPreview="collapsedPreview",e.FixedScrolling="fixedScrolling"})(W$||(W$={}));var B$;(function(e){e.Off="off",e.WithThinking="withThinking",e.Always="always"})(B$||(B$={}));var li;(function(e){e.Chat="panel",e.Terminal="terminal",e.Notebook="notebook",e.EditorInline="editor"})(li||(li={})),function(e){function t(i){switch(i){case"panel":return e.Chat;case"terminal":return e.Terminal;case"notebook":return e.Notebook;case"editor":return e.EditorInline}return e.Chat}e.fromRaw=t}(li||(li={}));var Pte=new Set([q.vscodeChatEditor,q.walkThrough,q.vscodeLocalChatSession,q.vscodeSettings,q.webviewPanel,q.vscodeUserData,q.extension,"ccreq","openai-codex"]),Tte=new k("inModelsEditor",!1),Mte=new k("inModelsSearch",!1),rn=class{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Nz(e,this)}},_$=new Map,tw=new WeakMap;function Nz(e,t){const i=tw.get(e);if(i)return i;const r=Rz(e,t);if(r){let s=_$.get(r)??0;s++,_$.set(r,s);const n=s===1?r:`${r}#${s}`;return tw.set(e,n),n}}function Rz(e,t){const i=tw.get(e);if(i)return i;const r=t.owner?Oz(t.owner)+".":"";let s;const n=t.debugNameSource;if(n!==void 0)if(typeof n=="function"){if(s=n(),s!==void 0)return r+s}else return r+n;const o=t.referenceFn;if(o!==void 0&&(s=iw(o),s!==void 0))return r+s;if(t.owner!==void 0){const a=Lz(t.owner,e);if(a!==void 0)return r+a}}function Lz(e,t){for(const i in e)if(e[i]===t)return i}var V$=new Map,q$=new WeakMap;function Oz(e){const t=q$.get(e);if(t)return t;const i=G$(e)??"Object";let r=V$.get(i)??0;r++,V$.set(i,r);const s=r===1?i:`${i}#${r}`;return q$.set(e,s),s}function G$(e){const t=e.constructor;if(t)return t.name==="Object"?void 0:t.name}function iw(e){const t=e.toString(),r=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(t);return(r?r[1]:void 0)?.trim()}var ia=(e,t)=>e===t;function rw(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!rw(e[i],t[i]))return!1;return!0}if(e&&typeof e=="object"&&t&&typeof t=="object"&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){const i=e,r=t,s=Object.keys(i),n=Object.keys(r),o=new Set(n);if(s.length!==n.length)return!1;for(const a of s)if(!o.has(a)||!rw(i[a],r[a]))return!1;return!0}return!1}function Z$(e){const t=new Error("BugIndicatingErrorRecovery: "+e);lt(t),console.error("recovered from an error that indicates a bug",t)}var ra;function sw(e){ra?ra instanceof J$?ra.loggers.push(e):ra=new J$([ra,e]):ra=e}function Qt(){return ra}var nw=void 0;function Fz(e){nw=e}function Uz(e){nw&&nw(e)}var J$=class{constructor(e){this.loggers=e}handleObservableCreated(e,t){for(const i of this.loggers)i.handleObservableCreated(e,t)}handleOnListenerCountChanged(e,t){for(const i of this.loggers)i.handleOnListenerCountChanged(e,t)}handleObservableUpdated(e,t){for(const i of this.loggers)i.handleObservableUpdated(e,t)}handleAutorunCreated(e,t){for(const i of this.loggers)i.handleAutorunCreated(e,t)}handleAutorunDisposed(e){for(const t of this.loggers)t.handleAutorunDisposed(e)}handleAutorunDependencyChanged(e,t,i){for(const r of this.loggers)r.handleAutorunDependencyChanged(e,t,i)}handleAutorunStarted(e){for(const t of this.loggers)t.handleAutorunStarted(e)}handleAutorunFinished(e){for(const t of this.loggers)t.handleAutorunFinished(e)}handleDerivedDependencyChanged(e,t,i){for(const r of this.loggers)r.handleDerivedDependencyChanged(e,t,i)}handleDerivedCleared(e){for(const t of this.loggers)t.handleDerivedCleared(e)}handleBeginTransaction(e){for(const t of this.loggers)t.handleBeginTransaction(e)}handleEndTransaction(e){for(const t of this.loggers)t.handleEndTransaction(e)}};function ow(e,t){const i=new aw(e,t);try{e(i)}finally{i.finish()}}function jz(e,t,i){e?t(e):ow(t,i)}var aw=class{constructor(e,t){this._fn=e,this.b=t,this.a=[],Qt()?.handleBeginTransaction(this)}getDebugName(){return this.b?this.b():iw(this._fn)}updateObserver(e,t){if(!this.a){Z$("Transaction already finished!"),ow(i=>{i.updateObserver(e,t)});return}this.a.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.a;if(!e){Z$("transaction.finish() has already been called!");return}for(let t=0;t<e.length;t++){const{observer:i,observable:r}=e[t];i.endUpdate(r)}this.a=null,Qt()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this.a}},Qr;(function(e){let t=!1;function i(){t=!0}e.enable=i;function r(){if(!t)return;const s=Error,n=s.stackTraceLimit;s.stackTraceLimit=3;const o=new Error().stack;return s.stackTraceLimit=n,zz.fromStack(o,2)}e.ofCaller=r})(Qr||(Qr={}));var zz=class cN{static fromStack(t,i){const r=t.split(`
`),s=Hz(r[i+1]);if(s)return new cN(s.fileName,s.line,s.column,s.id)}constructor(t,i,r,s){this.fileName=t,this.line=i,this.column=r,this.id=s}};function Hz(e){const t=e.match(/\((.*):(\d+):(\d+)\)/);if(t)return{fileName:t[1],line:parseInt(t[2]),column:parseInt(t[3]),id:e};const i=e.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i)return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:e}}var cw;function Wz(e){cw=e}var Q$;function Bz(e){Q$=e}var Y$;function _z(e){Y$=e}var lw;function Vz(e){lw=e}var X$=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t,i=Qr.ofCaller()){const r=t===void 0?void 0:e,s=t===void 0?e:t;return cw({owner:r,debugName:()=>{const n=iw(s);if(n!==void 0)return n;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(s.toString());if(a)return`${this.debugName}.${a[2]}`;if(!r)return`${this.debugName} (mapped)`},debugReferenceFn:s},n=>s(this.read(n),n),i)}flatten(){return cw({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(Q$(this,t)),this}keepObserved(e){return e.add(Y$(this)),this}get b(){return this.get()}get debug(){return new qz(this)}},qz=class{constructor(e){this.observable=e}getDependencyGraph(){return lw(this.observable,{type:"dependencies"})}getObserverGraph(){return lw(this.observable,{type:"observers"})}},Uf=class extends X${constructor(e){super(),this.f=new Set,Qt()?.handleObservableCreated(this,e)}addObserver(e){const t=this.f.size;this.f.add(e),t===0&&this.g(),t!==this.f.size&&Qt()?.handleOnListenerCountChanged(this,this.f.size)}removeObserver(e){const t=this.f.delete(e);t&&this.f.size===0&&this.h(),t&&Qt()?.handleOnListenerCountChanged(this,this.f.size)}g(){}h(){}log(){const e=!!Qt();return Uz(this),e||Qt()?.handleObservableCreated(this,Qr.ofCaller()),this}debugGetObservers(){return this.f}};function ir(e,t,i=Qr.ofCaller()){let r;return typeof e=="string"?r=new rn(void 0,e,void 0):r=new rn(e,void 0,void 0),new Du(r,t,ia,i)}var Du=class extends Uf{get debugName(){return this.c.getDebugName(this)??"ObservableValue"}constructor(e,t,i,r){super(r),this.c=e,this.d=i,this.a=t,Qt()?.handleObservableUpdated(this,{hadValue:!1,newValue:t,change:void 0,didChange:!0,oldValue:void 0})}get(){return this.a}set(e,t,i){if(i===void 0&&this.d(this.a,e))return;let r;t||(t=r=new aw(()=>{},()=>`Setting ${this.debugName}`));try{const s=this.a;this.i(e),Qt()?.handleObservableUpdated(this,{oldValue:s,newValue:e,change:i,didChange:!0,hadValue:!0});for(const n of this.f)t.updateObserver(n,this),n.handleChange(this,i)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this.a}`}i(e){this.a=e}debugGetState(){return{value:this.a}}debugSetValue(e){this.a=e}},Gz=class extends Uf{get debugName(){return this.e.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i,r){super(r),this.e=e,this.i=i,this.c=!0,this.d=[],this.k=0,this.a=t}get(){return this.j(),this.a}j(){if(!this.c)if(this.c=!0,this.d.length>0){for(const e of this.d){Qt()?.handleObservableUpdated(this,{change:e,didChange:!0,oldValue:"(unknown)",newValue:this.a,hadValue:!0});for(const t of this.f)t.handleChange(this,e)}this.d.length=0}else{Qt()?.handleObservableUpdated(this,{change:void 0,didChange:!0,oldValue:"(unknown)",newValue:this.a,hadValue:!0});for(const e of this.f)e.handleChange(this,void 0)}}l(){if(this.k++,this.k===1)for(const e of this.f)e.beginUpdate(this)}m(){if(this.k--,this.k===0){this.j();const e=[...this.f];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.f.has(e)&&this.k>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.f.has(e)&&this.k>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this.i(this.a,e))return;let r;t||(t=r=new aw(()=>{},()=>`Setting ${this.debugName}`));try{if(this.c=!1,this.n(e),i!==void 0&&this.d.push(i),t.updateObserver({beginUpdate:()=>this.l(),endUpdate:()=>this.m(),handleChange:(s,n)=>{},handlePossibleChange:s=>{}},this),this.k>1)for(const s of this.f)s.handlePossibleChange(this)}finally{r&&r.finish()}}toString(){return`${this.debugName}: ${this.a}`}n(e){this.a=e}};function Zz(e,t,i=Qr.ofCaller()){return e.lazy?new Gz(new rn(e.owner,e.debugName,void 0),t,e.equalsFn??ia,i):new Du(new rn(e.owner,e.debugName,void 0),t,e.equalsFn??ia,i)}var K$;(function(e){e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(K$||(K$={}));function Jz(e){switch(e){case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var jf=class{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,r){this._debugNameData=e,this._runFn=t,this.j=i,this.a=2,this.b=0,this.c=!1,this.f=new Set,this.g=new Set,this.i=!1,this.n=void 0,this.p=void 0,this.h=this.j?.createChangeSummary(void 0),Qt()?.handleAutorunCreated(this,r),this.k(),Ka(this)}dispose(){if(!this.c){this.c=!0;for(const e of this.f)e.removeObserver(this);this.f.clear(),this.n!==void 0&&this.n.dispose(),this.p!==void 0&&this.p.dispose(),Qt()?.handleAutorunDisposed(this),ec(this)}}k(){const e=this.g;this.g=this.f,this.f=e,this.a=3;try{if(!this.c){Qt()?.handleAutorunStarted(this);const t=this.h,i=this.p;i!==void 0&&(this.p=void 0);try{this.i=!0,this.j&&(this.j.beforeUpdate?.(this,t),this.h=this.j.createChangeSummary(t)),this.n!==void 0&&(this.n.dispose(),this.n=void 0),this._runFn(this,t)}catch(r){zd(r)}finally{this.i=!1,i!==void 0&&i.dispose()}}}finally{this.c||Qt()?.handleAutorunFinished(this);for(const t of this.g)t.removeObserver(this);this.g.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){this.a===3&&(this.a=1),this.b++}endUpdate(e){try{if(this.b===1)do{if(this.a===1){this.a=3;for(const t of this.f)if(t.reportChanges(),this.a===2)break}this.a!==3&&this.k()}while(this.a!==3)}finally{this.b--}X5(()=>this.b>=0)}handlePossibleChange(e){this.a===3&&this.l(e)&&(this.a=1)}handleChange(e,t){if(this.l(e)){Qt()?.handleAutorunDependencyChanged(this,e,t);try{(this.j?this.j.handleChange({changedObservable:e,change:t,didChange:r=>r===e},this.h):!0)&&(this.a=2)}catch(i){zd(i)}}}l(e){return this.f.has(e)&&!this.g.has(e)}m(){if(!this.i)throw new wi("The reader object cannot be used outside its compute function!")}readObservable(e){if(this.m(),this.c)return e.get();e.addObserver(this);const t=e.get();return this.f.add(e),this.g.delete(e),t}get store(){if(this.m(),this.c)throw new wi("Cannot access store after dispose");return this.n===void 0&&(this.n=new ie),this.n}get delayedStore(){if(this.m(),this.c)throw new wi("Cannot access store after dispose");return this.p===void 0&&(this.p=new ie),this.p}debugGetState(){return{isRunning:this.i,updateCount:this.b,dependencies:this.f,state:this.a,stateStr:Jz(this.a)}}debugRerun(){this.i?this.a=2:this.k()}};function zf(e,t=Qr.ofCaller()){return new jf(new rn(void 0,void 0,e),e,void 0,t)}var eI;(function(e){e[e.initial=0]="initial",e[e.dependenciesMightHaveChanged=1]="dependenciesMightHaveChanged",e[e.stale=2]="stale",e[e.upToDate=3]="upToDate"})(eI||(eI={}));function Qz(e){switch(e){case 0:return"initial";case 1:return"dependenciesMightHaveChanged";case 2:return"stale";case 3:return"upToDate";default:return"<unknown>"}}var mr=class extends Uf{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,r=void 0,s,n){super(n),this._debugNameData=e,this._computeFn=t,this.w=i,this.x=r,this.y=s,this.a=0,this.c=void 0,this.i=0,this.j=new Set,this.k=new Set,this.l=void 0,this.m=!1,this.n=!1,this.p=!1,this.q=!1,this.s=!1,this.t=void 0,this.u=void 0,this.v=null,this.l=this.w?.createChangeSummary(void 0)}h(){this.a=0,this.c=void 0,Qt()?.handleDerivedCleared(this);for(const e of this.j)e.removeObserver(this);this.j.clear(),this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.u!==void 0&&(this.u.dispose(),this.u=void 0),this.x?.()}get(){if(this.n,this.f.size===0){let t;try{this.s=!0;let i;this.w&&(i=this.w.createChangeSummary(void 0),this.w.beforeUpdate?.(this,i)),t=this._computeFn(this,i)}finally{this.s=!1}return this.h(),t}else{do{if(this.a===1){for(const t of this.j)if(t.reportChanges(),this.a===2)break}this.a===1&&(this.a=3),this.a!==3&&this.A()}while(this.a!==3);return this.c}}A(){let e=!1;this.n=!0,this.p=!1;const t=this.k;this.k=this.j,this.j=t;try{const i=this.l;this.s=!0,this.w&&(this.q=!0,this.w.beforeUpdate?.(this,i),this.q=!1,this.l=this.w?.createChangeSummary(i));const r=this.a!==0,s=this.c;this.a=3;const n=this.u;n!==void 0&&(this.u=void 0);try{this.t!==void 0&&(this.t.dispose(),this.t=void 0),this.c=this._computeFn(this,i)}finally{this.s=!1;for(const o of this.k)o.removeObserver(this);this.k.clear(),n!==void 0&&n.dispose()}e=this.p||r&&!this.y(s,this.c),Qt()?.handleObservableUpdated(this,{oldValue:s,newValue:this.c,change:void 0,didChange:e,hadValue:r})}catch(i){zd(i)}if(this.n=!1,!this.p&&e)for(const i of this.f)i.handleChange(this,void 0);else this.p=!1}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this.m)throw new wi("Cyclic deriveds are not supported yet!");this.i++,this.m=!0;try{const t=this.i===1;if(this.a===3&&(this.a=1,!t))for(const i of this.f)i.handlePossibleChange(this);if(t)for(const i of this.f)i.beginUpdate(this)}finally{this.m=!1}}endUpdate(e){if(this.i--,this.i===0){const t=[...this.f];for(const i of t)i.endUpdate(this);if(this.v){const i=[...this.v];this.v=null;for(const r of i)r.endUpdate(this)}}X5(()=>this.i>=0)}handlePossibleChange(e){if(this.a===3&&this.j.has(e)&&!this.k.has(e)){this.a=1;for(const t of this.f)t.handlePossibleChange(this)}}handleChange(e,t){if(this.j.has(e)&&!this.k.has(e)||this.q){Qt()?.handleDerivedDependencyChanged(this,e,t);let i=!1;try{i=this.w?this.w.handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.l):!0}catch(s){zd(s)}const r=this.a===3;if(i&&(this.a===1||r)&&(this.a=2,r))for(const s of this.f)s.handlePossibleChange(this)}}B(){if(!this.s)throw new wi("The reader object cannot be used outside its compute function!")}readObservable(e){this.B(),e.addObserver(this);const t=e.get();return this.j.add(e),this.k.delete(e),t}reportChange(e){this.B(),this.p=!0;for(const t of this.f)t.handleChange(this,e)}get store(){return this.B(),this.t===void 0&&(this.t=new ie),this.t}get delayedStore(){return this.B(),this.u===void 0&&(this.u=new ie),this.u}addObserver(e){const t=!this.f.has(e)&&this.i>0;super.addObserver(e),t&&(this.v?.delete(e)||e.beginUpdate(this))}removeObserver(e){this.f.has(e)&&this.i>0&&(this.v||(this.v=new Set),this.v.add(e)),super.removeObserver(e)}debugGetState(){return{state:this.a,stateStr:Qz(this.a),updateCount:this.i,isComputing:this.n,dependencies:this.j,value:this.c}}debugSetValue(e){this.c=e}debugRecompute(){this.n?this.a=2:this.A()}setValue(e,t,i){this.c=e;const r=this.f;t.updateObserver(this,this);for(const s of r)s.handleChange(this,i)}};function Yz(e,t,i=Qr.ofCaller()){return t!==void 0?new mr(new rn(e,void 0,t),t,void 0,void 0,ia,i):new mr(new rn(void 0,void 0,e),e,void 0,void 0,ia,i)}function tI(e,t,i=Qr.ofCaller()){return new mr(new rn(e.owner,e.debugName,e.debugReferenceFn),t,void 0,e.onLastObserverRemoved,e.equalsFn??ia,i)}Wz(tI);function Pu(...e){let t,i,r,s;return e.length===2?[i,r]=e:[t,i,r,s]=e,new Yn(new rn(t,void 0,r),i,r,()=>Yn.globalTransaction,ia,s??Qr.ofCaller())}var Yn=class extends Uf{constructor(e,t,i,r,s,n){super(n),this.e=e,this.i=t,this._getValue=i,this.j=r,this.k=s,this.c=!1,this.n=o=>{const a=this._getValue(o),c=this.a,l=!this.c||!this.k(c,a);let u=!1;l&&(this.a=a,this.c&&(u=!0,jz(this.j(),h=>{Qt()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c});for(const f of this.f)h.updateObserver(f,this),f.handleChange(this,void 0)},()=>{const h=this.l();return"Event fired"+(h?`: ${h}`:"")})),this.c=!0),u||Qt()?.handleObservableUpdated(this,{oldValue:c,newValue:a,change:void 0,didChange:l,hadValue:this.c})}}l(){return this.e.getDebugName(this)}get debugName(){const e=this.l();return"From Event"+(e?`: ${e}`:"")}g(){this.d=this.i(this.n)}h(){this.d.dispose(),this.d=void 0,this.c=!1,this.a=void 0}get(){return this.d?(this.c||this.n(void 0),this.a):this._getValue(void 0)}debugSetValue(e){this.a=e}debugGetState(){return{value:this.a,hasValue:this.c}}};(function(e){e.Observer=Yn;function t(i,r){let s=!1;Yn.globalTransaction===void 0&&(Yn.globalTransaction=i,s=!0);try{r()}finally{s&&(Yn.globalTransaction=void 0)}}e.batchEventsGlobally=t})(Pu||(Pu={}));function Xz(e){const t=new iI(!1,void 0);return e.addObserver(t),te(()=>{e.removeObserver(t)})}_z(Xz);function Kz(e,t){const i=new iI(!0,t);e.addObserver(i);try{i.beginUpdate(e)}finally{i.endUpdate(e)}return te(()=>{e.removeObserver(i)})}Bz(Kz);var iI=class{constructor(e,t){this.b=e,this.c=t,this.a=0}beginUpdate(e){this.a++}endUpdate(e){this.a===1&&this.b&&(this.c?this.c(e.get()):e.reportChanges()),this.a--}handlePossibleChange(e){}handleChange(e,t){}};function rI(e){return new eH(e)}var eH=class extends X${constructor(e){super(),this.a=e}get debugName(){return this.toString()}get(){return this.a}addObserver(e){}removeObserver(e){}log(){return this}toString(){return`Const: ${this.a}`}},sI=class{constructor(){this.a=new Set,this.b=Zz({equalsFn:()=>!1},this),this.observable=this.b}get size(){return this.a.size}has(e){return this.a.has(e)}add(e,t){return this.a.has(e)||(this.a.add(e),this.b.set(this,t)),this}delete(e,t){const i=this.a.delete(e);return i&&this.b.set(this,t),i}clear(e){this.a.size>0&&(this.a.clear(),this.b.set(this,e))}forEach(e,t){this.a.forEach((i,r,s)=>{e.call(t,i,r,this)})}*entries(){for(const e of this.a)yield[e,e]}*keys(){yield*this.a.keys()}*values(){yield*this.a.values()}[Symbol.iterator](){return this.values()}get[Symbol.toStringTag](){return"ObservableSet"}},Hf;function tH(e){Hf||(Hf=new nI,sw(Hf)),Hf.addFilteredObj(e)}var nI=class{constructor(){this.a=0,this.f=new WeakMap}addFilteredObj(e){this.b||(this.b=new Set),this.b.add(e)}c(e){return this.b?.has(e)??!0}d(e){return iH([yc(nH("|  ",this.a)),e])}e(e){return e.hadValue?e.didChange?[yc(" "),Pr(Yr(e.oldValue,70),{color:"red",strikeThrough:!0}),yc(" "),Pr(Yr(e.newValue,60),{color:"green"})]:[yc(" (unchanged)")]:[yc(" "),Pr(Yr(e.newValue,60),{color:"green"}),yc(" (initial)")]}handleObservableCreated(e){if(e instanceof mr){const t=e;if(this.f.set(t,new Set),!1){const r=[];t.__debugUpdating=r;const s=t.beginUpdate;t.beginUpdate=o=>(r.push(o),s.apply(t,[o]));const n=t.endUpdate;t.endUpdate=o=>{const a=r.indexOf(o);return a===-1&&console.error("endUpdate called without beginUpdate",t.debugName,o.debugName),r.splice(a,1),n.apply(t,[o])}}}}handleOnListenerCountChanged(e,t){}handleObservableUpdated(e,t){if(this.c(e)){if(e instanceof mr){this._handleDerivedRecomputed(e,t);return}console.log(...this.d([Ac("observable value changed"),Pr(e.debugName,{color:"BlueViolet"}),...this.e(t)]))}}formatChanges(e){if(e.size!==0)return Pr(" (changed deps: "+[...e].map(t=>t.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,t,i){this.c(e)&&this.f.get(e)?.add(t)}_handleDerivedRecomputed(e,t){if(!this.c(e))return;const i=this.f.get(e);i&&(console.log(...this.d([Ac("derived recomputed"),Pr(e.debugName,{color:"BlueViolet"}),...this.e(t),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}])),i.clear())}handleDerivedCleared(e){this.c(e)&&console.log(...this.d([Ac("derived cleared"),Pr(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,t){this.c(e)&&console.log(...this.d([Ac("observable from event triggered"),Pr(e.debugName,{color:"BlueViolet"}),...this.e(t),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){this.c(e)&&this.f.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,t,i){this.c(e)&&this.f.get(e).add(t)}handleAutorunStarted(e){const t=this.f.get(e);t&&(this.c(e)&&console.log(...this.d([Ac("autorun"),Pr(e.debugName,{color:"BlueViolet"}),this.formatChanges(t),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}])),t.clear(),this.a++)}handleAutorunFinished(e){this.a--}handleBeginTransaction(e){let t=e.getDebugName();t===void 0&&(t=""),this.c(e)&&console.log(...this.d([Ac("transaction"),Pr(t,{color:"BlueViolet"}),{data:[{fn:e._fn}]}])),this.a++}handleEndTransaction(){this.a--}};function iH(e){const t=new Array,i=[];let r="";function s(o){if("length"in o)for(const a of o)a&&s(a);else"text"in o?(r+=`%c${o.text}`,t.push(o.style),o.data&&i.push(...o.data)):"data"in o&&i.push(...o.data)}s(e);const n=[r,...t];return n.push(...i),n}function yc(e){return Pr(e,{color:"black"})}function Ac(e){return Pr(oH(`${e}: `,10),{color:"black",bold:!0})}function Pr(e,t={color:"black"}){function i(s){return Object.entries(s).reduce((n,[o,a])=>`${n}${o}:${a};`,"")}const r={color:t.color};return t.strikeThrough&&(r["text-decoration"]="line-through"),t.bold&&(r["font-weight"]="bold"),{text:e,style:i(r)}}function Yr(e,t){switch(typeof e){case"number":return""+e;case"string":return e.length+2<=t?`"${e}"`:`"${e.substr(0,t-7)}"+...`;case"boolean":return e?"true":"false";case"undefined":return"undefined";case"object":return e===null?"null":Array.isArray(e)?rH(e,t):sH(e,t);case"symbol":return e.toString();case"function":return`[[Function${e.name?" "+e.name:""}]]`;default:return""+e}}function rH(e,t){let i="[ ",r=!0;for(const s of e){if(r||(i+=", "),i.length-5>t){i+="...";break}r=!1,i+=`${Yr(s,t-i.length)}`}return i+=" ]",i}function sH(e,t){if(typeof e.toString=="function"&&e.toString!==Object.prototype.toString){const n=e.toString();return n.length<=t?n:n.substring(0,t-3)+"..."}const i=G$(e);let r=i?i+"(":"{ ",s=!0;for(const[n,o]of Object.entries(e)){if(s||(r+=", "),r.length-5>t){r+="...";break}s=!1,r+=`${n}: ${Yr(o,t-r.length)}`}return r+=i?")":" }",r}function nH(e,t){let i="";for(let r=1;r<=t;r++)i+=e;return i}function oH(e,t){for(;e.length<t;)e+=" ";return e}var aH=class w5{static createHost(t,i){return new w5(t,i)}static createClient(t,i){return new w5(t,i)}constructor(t,i){this.b=t,this.c=i,this.a=this.b({handleNotification:n=>{const o=n,a=this.c().notifications[o[0]];if(!a)throw new Error(`Unknown notification "${o[0]}"!`);a(...o[1])},handleRequest:n=>{const o=n;try{return{type:"result",value:this.c().requests[o[0]](...o[1])}}catch(a){return{type:"error",value:a}}}});const r=new Proxy({},{get:(n,o)=>async(...a)=>{const c=await this.a.sendRequest([o,a]);if(c.type==="error")throw c.value;return c.value}}),s=new Proxy({},{get:(n,o)=>(...a)=>{this.a.sendNotification([o,a])}});this.api={notifications:s,requests:r}}};function cH(e,t){const i=globalThis;let r=[],s;const{channel:n,handler:o}=lH({sendNotification:c=>{s?s.sendNotification(c):r.push(c)}});let a;return(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[e]=c=>{a=t(),s=c;for(const l of r)c.sendNotification(l);return r=[],o},aH.createClient(n,()=>{if(!a)throw new Error("Not supported");return a})}function lH(e){let t;return{channel:r=>(t=r,{sendNotification:s=>{e.sendNotification(s)},sendRequest:s=>{throw new Error("not supported")}}),handler:{handleRequest:r=>r.type==="notification"?t?.handleNotification(r.data):t?.handleRequest(r.data)}}}var uH=class{constructor(){this.a=void 0}throttle(e,t){this.a===void 0&&(this.a=setTimeout(()=>{this.a=void 0,e()},t))}dispose(){this.a!==void 0&&clearTimeout(this.a)}};function oI(e,t){for(const i in t)e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?oI(e[i],t[i]):e[i]=t[i]}function aI(e,t){for(const i in t)t[i]===null?delete e[i]:e[i]&&typeof e[i]=="object"&&t[i]&&typeof t[i]=="object"?aI(e[i],t[i]):e[i]=t[i]}var hH=class Rd{static{this.a=void 0}static getInstance(){return Rd.a===void 0&&(Rd.a=new Rd),Rd.a}j(){const t=[],i=[...this.h];if(i.length===0)return;const r=i.flatMap(n=>n.debugGetUpdatingObservers()??[]).map(n=>n.observer),s=new Set;for(;r.length>0;){const n=r.shift();if(s.has(n))continue;s.add(n);const o=this.m(n,a=>{s.has(a)||r.push(a)});o&&t.push(o)}return{names:i.map(n=>n.getDebugName()??"tx"),affected:t}}k(t){const i=this.f.get(t);if(!i){lt(new wi("No info found"));return}return i}l(t){const i=this.f.get(t);if(!i){lt(new wi("No info found"));return}return i}m(t,i){if(t instanceof mr){const r=[...t.debugGetObservers()];for(const c of r)i(c);const s=this.k(t);if(!s)return;const n=t.debugGetState(),o={name:t.debugName,instanceId:s.instanceId,updateCount:n.updateCount},a=[...s.changedObservables].map(c=>this.f.get(c)?.instanceId).filter(hr);if(n.isComputing)return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:!1};switch(n.state){case 0:return{...o,type:"observable/derived",state:"noValue"};case 3:return{...o,type:"observable/derived",state:"upToDate"};case 2:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case 1:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(t instanceof jf){const r=this.l(t);if(!r)return;const s={name:t.debugName,instanceId:r.instanceId,updateCount:r.updateCount},n=[...r.changedObservables].map(o=>this.f.get(o).instanceId);if(t.debugGetState().isRunning)return{...s,type:"autorun",state:"updating",changedDependencies:n};switch(t.debugGetState().state){case 3:return{...s,type:"autorun",state:"upToDate"};case 2:return{...s,type:"autorun",state:"stale",changedDependencies:n};case 1:return{...s,type:"autorun",state:"possiblyStale"}}}}n(t){const i=this.k(t);if(i)return{name:t.debugName,instanceId:i.instanceId}}p(t){if(t instanceof mr)return{name:t.toString(),instanceId:this.k(t)?.instanceId};const i=this.l(t);if(i)return{name:t.toString(),instanceId:i.instanceId}}constructor(){this.b=0,this.c=0,this.e=new Map,this.f=new WeakMap,this.g=new Map,this.h=new Set,this.i=cH("observableDevTools",()=>({notifications:{setDeclarationIdFilter:t=>{},logObservableValue:t=>{console.log("logObservableValue",t)},flushUpdates:()=>{this.v()},resetUpdates:()=>{this.q=null,this.i.api.notifications.handleChange(this.s,!0)}},requests:{getDeclarations:()=>{const t={};for(const i of this.e.values())t[i.id]=i;return{decls:t}},getSummarizedInstances:()=>null,getObservableValueInfo:t=>({observers:[...this.g.get(t).debugGetObservers()].map(r=>this.p(r)).filter(hr)}),getDerivedInfo:t=>{const i=this.g.get(t);return{dependencies:[...i.debugGetState().dependencies].map(r=>this.n(r)).filter(hr),observers:[...i.debugGetObservers()].map(r=>this.p(r)).filter(hr)}},getAutorunInfo:t=>({dependencies:[...this.g.get(t).debugGetState().dependencies].map(r=>this.n(r)).filter(hr)}),getTransactionState:()=>this.j(),setValue:(t,i)=>{const r=this.g.get(t);if(r instanceof mr)r.debugSetValue(i);else if(r instanceof Du)r.debugSetValue(i);else if(r instanceof Yn)r.debugSetValue(i);else throw new wi("Observable is not supported");const s=[...r.debugGetObservers()];for(const n of s)n.beginUpdate(r);for(const n of s)n.handleChange(r,void 0);for(const n of s)n.endUpdate(r)},getValue:t=>{const i=this.g.get(t);if(i instanceof mr)return Yr(i.debugGetState().value,200);if(i instanceof Du)return Yr(i.debugGetState().value,200)},logValue:t=>{const i=this.g.get(t);if(i&&"get"in i)console.log("Logged Value:",i.get());else throw new wi("Observable is not supported")},rerun:t=>{const i=this.g.get(t);if(i instanceof mr)i.debugRecompute();else if(i instanceof jf)i.debugRerun();else throw new wi("Observable is not supported")}}})),this.q=null,this.r=new uH,this.s={},this.v=()=>{this.q!==null&&(this.i.api.notifications.handleChange(this.q,!1),this.q=null)},Qr.enable()}u(t){aI(this.s,t),this.q===null?this.q=t:oI(this.q,t),this.r.throttle(this.v,10)}w(t,i){if(!i)return-1;let r=this.e.get(i.id);return r===void 0&&(r={id:this.b++,type:t,url:i.fileName,line:i.line,column:i.column},this.e.set(i.id,r),this.u({decls:{[r.id]:r}})),r.id}handleObservableCreated(t,i){const s={declarationId:this.w("observable/value",i),instanceId:this.c++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this.f.set(t,s)}handleOnListenerCountChanged(t,i){const r=this.k(t);if(r){if(r.listenerCount===0&&i>0){const s=t instanceof mr?"observable/derived":"observable/value";this.g.set(r.instanceId,t),this.u({instances:{[r.instanceId]:{instanceId:r.instanceId,declarationId:r.declarationId,formattedValue:r.lastValue,type:s,name:t.debugName}}})}else r.listenerCount>0&&i===0&&(this.u({instances:{[r.instanceId]:null}}),this.g.delete(r.instanceId));r.listenerCount=i}}handleObservableUpdated(t,i){if(t instanceof mr){this._handleDerivedRecomputed(t,i);return}const r=this.k(t);r&&i.didChange&&(r.lastValue=Yr(i.newValue,30),r.listenerCount>0&&this.u({instances:{[r.instanceId]:{formattedValue:r.lastValue}}}))}handleAutorunCreated(t,i){const s={declarationId:this.w("autorun",i),instanceId:this.c++,updateCount:0,changedObservables:new Set};this.f.set(t,s),this.g.set(s.instanceId,t),s&&this.u({instances:{[s.instanceId]:{instanceId:s.instanceId,declarationId:s.declarationId,runCount:0,type:"autorun",name:t.debugName}}})}handleAutorunDisposed(t){const i=this.l(t);i&&(this.u({instances:{[i.instanceId]:null}}),this.f.delete(t),this.g.delete(i.instanceId))}handleAutorunDependencyChanged(t,i,r){const s=this.l(t);s&&s.changedObservables.add(i)}handleAutorunStarted(t){}handleAutorunFinished(t){const i=this.l(t);i&&(i.changedObservables.clear(),i.updateCount++,this.u({instances:{[i.instanceId]:{runCount:i.updateCount}}}))}handleDerivedDependencyChanged(t,i,r){const s=this.k(t);s&&s.changedObservables.add(i)}_handleDerivedRecomputed(t,i){const r=this.k(t);if(!r)return;const s=Yr(i.newValue,30);r.updateCount++,r.changedObservables.clear(),r.lastValue=s,r.listenerCount>0&&this.u({instances:{[r.instanceId]:{formattedValue:s,recomputationCount:r.updateCount}}})}handleDerivedCleared(t){const i=this.k(t);i&&(i.lastValue=void 0,i.changedObservables.clear(),i.listenerCount>0&&this.u({instances:{[i.instanceId]:{formattedValue:void 0}}}))}handleBeginTransaction(t){this.h.add(t)}handleEndTransaction(t){this.h.delete(t)}};function dH(e,t){const i=t?.debugNamePostProcessor??(n=>n),r=Tu.from(e,i);if(!r)return"";const s=new Set;return t.type==="observers"?lI(r,0,s,t).trim():cI(r,0,s,t).trim()}function cI(e,t,i,r){const s="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${s}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${s}* ${e.type} ${e.name}:`),n.push(`${s}  value: ${Yr(e.value,50)}`),n.push(`${s}  state: ${e.state}`),e.dependencies.length>0){n.push(`${s}  dependencies:`);for(const a of e.dependencies){const c=Tu.from(a,r.debugNamePostProcessor??(l=>l))??Tu.unknown(a);n.push(cI(c,t+1,i,r))}}return n.join(`
`)}function lI(e,t,i,r){const s="		".repeat(t),n=[];if(i.has(e.sourceObj))return n.push(`${s}* ${e.type} ${e.name} (already listed)`),n.join(`
`);if(i.add(e.sourceObj),n.push(`${s}* ${e.type} ${e.name}:`),n.push(`${s}  value: ${Yr(e.value,50)}`),n.push(`${s}  state: ${e.state}`),e.observers.length>0){n.push(`${s}  observers:`);for(const a of e.observers){const c=Tu.from(a,r.debugNamePostProcessor??(l=>l))??Tu.unknown(a);n.push(lI(c,t+1,i,r))}}return n.join(`
`)}var Tu=class Wl{static from(t,i){if(t instanceof jf){const r=t.debugGetState();return new Wl(t,i(t.debugName),"autorun",void 0,r.stateStr,Array.from(r.dependencies),[])}else if(t instanceof mr){const r=t.debugGetState();return new Wl(t,i(t.debugName),"derived",r.value,r.stateStr,Array.from(r.dependencies),Array.from(t.debugGetObservers()))}else if(t instanceof Du){const r=t.debugGetState();return new Wl(t,i(t.debugName),"observableValue",r.value,"upToDate",[],Array.from(t.debugGetObservers()))}else if(t instanceof Yn){const r=t.debugGetState();return new Wl(t,i(t.debugName),"fromEvent",r.value,r.hasValue?"upToDate":"initial",[],Array.from(t.debugGetObservers()))}}static unknown(t){return new Wl(t,"(unknown)","unknown",void 0,"unknown",[],[])}constructor(t,i,r,s,n,o,a){this.sourceObj=t,this.name=i,this.type=r,this.value=s,this.state=n,this.dependencies=o,this.observers=a}};Vz(dH),Fz(tH);var fH=!1;fH&&sw(new nI),Mn&&Mn.VSCODE_DEV_DEBUG_OBSERVABLES&&sw(hH.getInstance());var Xr;(function(e){e.Internal={type:"internal",label:"Built-In"},e.External={type:"external",label:"External"};function t(s){switch(s.type){case"extension":return`extension:${s.extensionId.value}`;case"mcp":return`mcp:${s.collectionId}:${s.definitionId}`;case"user":return`user:${s.file.toString()}`;case"internal":return"internal";case"external":return"external"}}e.toKey=t;function i(s,n){return t(s)===t(n)}e.equals=i;function r(s){return s.type==="internal"?{ordinal:1,label:d(6541,null)}:s.type==="mcp"?{ordinal:2,label:s.label}:s.type==="user"?{ordinal:0,label:d(6542,null)}:{ordinal:3,label:s.label}}e.classify=r})(Xr||(Xr={}));function pH(e){return typeof e=="object"&&typeof e.sessionId=="string"&&y.isUri(e.sessionResource)}var Sc;(function(e){e.Hidden="hidden",e.HiddenAfterComplete="hiddenAfterComplete"})(Sc||(Sc={}));var gH=class{constructor(e,t,i,r,s,n){this.id=e,this.referenceName=t,this.icon=i,this.source=r,this.description=s,this.legacyFullNames=n,this.c=new sI,this.f=new sI,this.isHomogenous=Yz(o=>!Wt.some(this.c.observable.read(o),a=>!Xr.equals(a.source,this.source))&&!Wt.some(this.f.observable.read(o),a=>!Xr.equals(a.source,this.source)))}addTool(e,t){return this.c.add(e,t),te(()=>{this.c.delete(e)})}addToolSet(e,t){return e===this?Q.None:(this.f.add(e,t),te(()=>{this.f.delete(e)}))}getTools(e){return Wt.concat(this.c.observable.read(e),...Wt.map(this.f.observable.read(e),t=>t.getTools(e)))}},uw=H("ILanguageModelToolsService"),hw;(function(e){e.execute="execute",e.edit="edit",e.search="search",e.agent="agent",e.read="read",e.web="web",e.todo="todo"})(hw||(hw={}));var dw;(function(e){e.runSubagent="runSubagent",e.vscode="vscode"})(dw||(dw={}));var Wf;(function(e){e.LATEST_PROTOCOL_VERSION="2025-11-25",e.JSONRPC_VERSION="2.0",e.PARSE_ERROR=-32700,e.INVALID_REQUEST=-32600,e.METHOD_NOT_FOUND=-32601,e.INVALID_PARAMS=-32602,e.INTERNAL_ERROR=-32603,e.URL_ELICITATION_REQUIRED=-32042})(Wf||(Wf={}));function mH(e,t){return Ye.toKey(e)+"/"+t}var uI;(function(e){e[e.WorkspaceFolder=0]="WorkspaceFolder",e[e.Workspace=100]="Workspace",e[e.User=200]="User",e[e.Extension=300]="Extension",e[e.Filesystem=400]="Filesystem",e[e.RemoteBoost=-50]="RemoteBoost"})(uI||(uI={}));var hI;(function(e){function t(i,r){return i.id===r.id&&i.remoteAuthority===r.remoteAuthority&&i.label===r.label&&i.trustBehavior===r.trustBehavior}e.equals=t})(hI||(hI={}));var dI;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})(dI||(dI={}));var fI;(function(e){function t(s){return s}e.toSerialized=t;function i(s){return{id:s.id,label:s.label,cacheNonce:s.cacheNonce,staticMetadata:s.staticMetadata,launch:Mu.fromSerialized(s.launch),variableReplacement:s.variableReplacement?fw.fromSerialized(s.variableReplacement):void 0}}e.fromSerialized=i;function r(s,n){return s.id===n.id&&s.label===n.label&&s.cacheNonce===n.cacheNonce&&Gi(s.roots,n.roots,(o,a)=>o.toString()===a.toString())&&Li(s.launch,n.launch)&&Li(s.presentation,n.presentation)&&Li(s.variableReplacement,n.variableReplacement)&&Li(s.devMode,n.devMode)}e.equals=r})(fI||(fI={}));var fw;(function(e){function t(r){return r}e.toSerialized=t;function i(r){return{section:r.section,folder:r.folder?{...r.folder,uri:y.revive(r.folder.uri)}:void 0,target:r.target}}e.fromSerialized=i})(fw||(fw={}));var pI;(function(e){e.Empty={working:!1,starting:[],serversRequiringInteraction:[]}})(pI||(pI={}));var gI;(function(e){e[e.HasUnknown=0]="HasUnknown",e[e.LoadingUnknown=1]="LoadingUnknown",e[e.AllKnown=2]="AllKnown"})(gI||(gI={}));var Nte=H("IMcpService"),mI;(function(e){let t;(function(i){i[i.Trusted=0]="Trusted",i[i.TrustedOnNonce=1]="TrustedOnNonce",i[i.Untrusted=2]="Untrusted",i[i.Unknown=3]="Unknown"})(t=e.Kind||(e.Kind={}))})(mI||(mI={}));var vI;(function(e){e[e.Unknown=0]="Unknown",e[e.Cached=1]="Cached",e[e.Outdated=2]="Outdated",e[e.RefreshingFromUnknown=3]="RefreshingFromUnknown",e[e.RefreshingFromCached=4]="RefreshingFromCached",e[e.Live=5]="Live"})(vI||(vI={}));var wI;(function(e){e[e.Stdio=1]="Stdio",e[e.HTTP=2]="HTTP"})(wI||(wI={}));var Mu;(function(e){function t(s){return s}e.toSerialized=t;function i(s){switch(s.type){case 2:return{type:s.type,uri:y.revive(s.uri),headers:s.headers,authentication:s.authentication};case 1:return{type:s.type,cwd:s.cwd,command:s.command,args:s.args,env:s.env,envFile:s.envFile}}}e.fromSerialized=i;async function r(s){const n=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(JSON.stringify(s)));return qv(W.wrap(new Uint8Array(n)))}e.hash=r})(Mu||(Mu={}));var bI;(function(e){let t;(function(i){i[i.Stopped=0]="Stopped",i[i.Starting=1]="Starting",i[i.Running=2]="Running",i[i.Error=3]="Error"})(t=e.Kind||(e.Kind={})),e.toString=i=>{switch(i.state){case 0:return d(10005,null);case 1:return d(10006,null);case 2:return d(10007,null);case 3:return d(10008,null,i.message);default:vv(i)}},e.toKindString=i=>{switch(i){case 0:return"stopped";case 1:return"starting";case 2:return"running";case 3:return"error";default:vv(i)}},e.canBeStarted=i=>i===3||i===0,e.isRunning=i=>!e.canBeStarted(i.state)})(bI||(bI={}));var yI=class lN extends Error{static{this.d="User interaction required: "}static is(t){return t.message.startsWith(this.d)}constructor(t){super(`${lN.d}${t}`),this.reason=t}},AI;(function(e){e[e.Disabled=0]="Disabled",e[e.DisabledByAccess=1]="DisabledByAccess",e[e.Enabled=2]="Enabled"})(AI||(AI={}));var SI;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(SI||(SI={}));var EI;(function(e){e.Readme="readme",e.Manifest="manifest",e.Configuration="configuration"})(EI||(EI={}));var vH=H("IMcpWorkbenchService"),xI=class extends Q{constructor(t,i){super(),this.f=t,this.D(i.onChange(this.update,this))}set mcpServer(t){this.f.forEach(i=>i.mcpServer=t)}update(t){for(const i of this.f)t&&i.mcpServer?t.id===i.mcpServer.id&&(i.mcpServer=t):i.update()}};xI=__decorate([__param(1,vH)],xI);var Lte=new k("mcpServersGalleryStatus","unavailable"),Ote=new k("hasInstalledMcpServers",!0),kI;(function(e){e.scheme="mcp-resource";const t="dylo78gyp";function i(s,n){return typeof n=="string"&&(n=y.parse(n)),n.with({scheme:e.scheme,authority:qv(W.fromString(s.id)),path:["",n.scheme,n.authority||t].join("/")+n.path})}e.fromServer=i;function r(s){if(typeof s=="string"&&(s=y.parse(s)),s.scheme!==e.scheme)throw new Error(`Invalid MCP resource URI: ${s.toString()}`);const n=s.path.split("/");if(n.length<3)throw new Error(`Invalid MCP resource URI: ${s.toString()}`);const[,o,a,...c]=n,l=new URL(`${o}://${a.toLowerCase()===t?"":a}`);return l.pathname=c.length?"/"+c.join("/"):"",l.search=s.query,l.hash=s.fragment,{definitionId:bO(s.authority).toString(),resourceURL:l}}e.toServer=r})(kI||(kI={}));var CI;(function(e){e[e.Logging=1]="Logging",e[e.Completions=2]="Completions",e[e.Prompts=4]="Prompts",e[e.PromptsListChanged=8]="PromptsListChanged",e[e.Resources=16]="Resources",e[e.ResourcesSubscribe=32]="ResourcesSubscribe",e[e.ResourcesListChanged=64]="ResourcesListChanged",e[e.Tools=128]="Tools",e[e.ToolsListChanged=256]="ToolsListChanged"})(CI||(CI={}));var Fte=H("IMcpServerSampling"),$I;(function(e){e.Prefix="mcp_",e[e.MaxPrefixLen=18]="MaxPrefixLen",e[e.MaxLength=64]="MaxLength"})($I||($I={}));var II;(function(e){e[e.Form=0]="Form",e[e.URL=1]="URL"})(II||(II={}));var Ute=H("IMcpElicitationService");function DI(){return Object.create(null)}var sa="**",pw="/",Bf="[/\\\\]",_f="[^/\\\\]",wH=/\//g;function PI(e,t){switch(e){case 0:return"";case 1:return`${_f}*?`;default:return`(?:${Bf}|${_f}+${Bf}${t?`|${Bf}${_f}+`:""})*?`}}function Nu(e,t){if(!e)return[];const i=[];let r=!1,s=!1,n="";for(const o of e){switch(o){case t:if(!r&&!s){i.push(n),n="";continue}break;case"{":r=!0;break;case"}":r=!1;break;case"[":s=!0;break;case"]":s=!1;break}n+=o}return n&&i.push(n),i}function TI(e){if(!e)return"";let t="";const i=Nu(e,pw);if(i.every(r=>r===sa))t=".*";else{let r=!1;i.forEach((s,n)=>{if(s===sa){if(r)return;t+=PI(2,n===i.length-1)}else{let o=!1,a="",c=!1,l="";for(const u of s){if(u!=="}"&&o){a+=u;continue}if(c&&(u!=="]"||!l)){let h;u==="-"?h=u:(u==="^"||u==="!")&&!l?h="^":u===pw?h="":h=Rn(u),l+=h;continue}switch(u){case"{":o=!0;continue;case"[":c=!0;continue;case"}":{const f=`(?:${Nu(a,",").map(p=>TI(p)).join("|")})`;t+=f,o=!1,a="";break}case"]":{t+="["+l+"]",c=!1,l="";break}case"?":t+=_f;continue;case"*":t+=PI(1);continue;default:t+=Rn(u)}}n<i.length-1&&(i[n+1]!==sa||n+2<i.length)&&(t+=Bf)}r=s===sa})}return t}var bH=/^\*\*\/\*\.[\w\.-]+$/,yH=/^\*\*\/([\w\.-]+)\/?$/,AH=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,SH=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,EH=/^\*\*((\/[\w\.-]+)+)\/?$/,xH=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,MI=new Ya(1e4),NI=function(){return!1},Es=function(){return null};function gw(e,t){if(!e)return Es;let i;typeof e!="string"?i=e.pattern:i=e,i=i.trim();const r=t.ignoreCase??!1,s={...t,equals:r?kr:(c,l)=>c===l,endsWith:r?XL:(c,l)=>c.endsWith(l),isEqualOrParent:(c,l)=>zo(c,l,!$t||r)},n=`${r?i.toLowerCase():i}_${!!t.trimForExclusions}_${r}`;let o=MI.get(n);if(o)return RI(o,e,s);let a;return bH.test(i)?o=kH(i.substring(4),i,s):(a=yH.exec(mw(i,s)))?o=CH(a[1],i,s):(t.trimForExclusions?SH:AH).test(i)?o=$H(i,s):(a=EH.exec(mw(i,s)))?o=LI(a[1].substring(1),i,!0,s):(a=xH.exec(mw(i,s)))?o=LI(a[1],i,!1,s):o=IH(i,s),MI.set(n,o),RI(o,e,s)}function RI(e,t,i){if(typeof t=="string")return e;const r=function(s,n){return i.isEqualOrParent(s,t.base)?e(QL(s.substring(t.base.length),St),n):null};return r.allBasenames=e.allBasenames,r.allPaths=e.allPaths,r.basenames=e.basenames,r.patterns=e.patterns,r}function mw(e,t){return t.trimForExclusions&&e.endsWith("/**")?e.substring(0,e.length-2):e}function kH(e,t,i){return function(r,s){return typeof r=="string"&&i.endsWith(r,e)?t:null}}function CH(e,t,i){const r=`/${e}`,s=`\\${e}`,n=function(a,c){return typeof a!="string"?null:c?i.equals(c,e)?t:null:i.equals(a,e)||i.endsWith(a,r)||i.endsWith(a,s)?t:null},o=[e];return n.basenames=o,n.patterns=[t],n.allBasenames=o,n}function $H(e,t){const i=UI(e.slice(1,-1).split(",").map(a=>gw(a,t)).filter(a=>a!==Es),e),r=i.length;if(!r)return Es;if(r===1)return i[0];const s=function(a,c){for(let l=0,u=i.length;l<u;l++)if(i[l](a,c))return e;return null},n=i.find(a=>!!a.allBasenames);n&&(s.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function LI(e,t,i,r){const s=St===Be.sep,n=s?e:e.replace(wH,St),o=St+n,a=Be.sep+e;let c;return i?c=function(l,u){return typeof l=="string"&&(r.equals(l,n)||r.endsWith(l,o)||!s&&(r.equals(l,e)||r.endsWith(l,a)))?t:null}:c=function(l,u){return typeof l=="string"&&(r.equals(l,n)||!s&&r.equals(l,e))?t:null},c.allPaths=[(i?"*/":"./")+e],c}function IH(e,t){try{const i=new RegExp(`^${TI(e)}$`,t.ignoreCase?"i":void 0);return function(r){return i.lastIndex=0,typeof r=="string"&&i.test(r)?e:null}}catch{return Es}}function Ec(e,t,i){return!e||typeof t!="string"?!1:Kr(e,i)(t)}function Kr(e,t={}){if(!e)return NI;if(typeof e=="string"||DH(e)){const i=gw(e,t);if(i===Es)return NI;const r=function(s,n){return!!i(s,n)};return i.allBasenames&&(r.allBasenames=i.allBasenames),i.allPaths&&(r.allPaths=i.allPaths),r}return PH(e,t)}function DH(e){const t=e;return t?typeof t.base=="string"&&typeof t.pattern=="string":!1}function OI(e){return e.allBasenames||[]}function FI(e){return e.allPaths||[]}function PH(e,t){const i=UI(Object.getOwnPropertyNames(e).map(a=>TH(a,e[a],t)).filter(a=>a!==Es)),r=i.length;if(!r)return Es;if(!i.some(a=>!!a.requiresSiblings)){if(r===1)return i[0];const a=function(u,h){let f;for(let p=0,g=i.length;p<g;p++){const v=i[p](u,h);if(typeof v=="string")return v;Fn(v)&&(f||(f=[]),f.push(v))}return f?(async()=>{for(const p of f){const g=await p;if(typeof g=="string")return g}return null})():null},c=i.find(u=>!!u.allBasenames);c&&(a.allBasenames=c.allBasenames);const l=i.reduce((u,h)=>h.allPaths?u.concat(h.allPaths):u,[]);return l.length&&(a.allPaths=l),a}const s=function(a,c,l){let u,h;for(let f=0,p=i.length;f<p;f++){const g=i[f];g.requiresSiblings&&l&&(c||(c=At(a)),u||(u=c.substring(0,c.length-Xd(a).length)));const v=g(a,c,u,l);if(typeof v=="string")return v;Fn(v)&&(h||(h=[]),h.push(v))}return h?(async()=>{for(const f of h){const p=await f;if(typeof p=="string")return p}return null})():null},n=i.find(a=>!!a.allBasenames);n&&(s.allBasenames=n.allBasenames);const o=i.reduce((a,c)=>c.allPaths?a.concat(c.allPaths):a,[]);return o.length&&(s.allPaths=o),s}function TH(e,t,i){if(t===!1)return Es;const r=gw(e,i);if(r===Es)return Es;if(typeof t=="boolean")return r;if(t){const s=t.when;if(typeof s=="string"){const n=(o,a,c,l)=>{if(!l||!r(o,a))return null;const u=s.replace("$(basename)",()=>c),h=l(u);return Fn(h)?h.then(f=>f?e:null):h?e:null};return n.requiresSiblings=!0,n}}return r}function UI(e,t){const i=e.filter(a=>!!a.basenames);if(i.length<2)return e;const r=i.reduce((a,c)=>{const l=c.basenames;return l?a.concat(l):a},[]);let s;if(t){s=[];for(let a=0,c=r.length;a<c;a++)s.push(t)}else s=i.reduce((a,c)=>{const l=c.patterns;return l?a.concat(l):a},[]);const n=function(a,c){if(typeof a!="string")return null;if(!c){let u;for(u=a.length;u>0;u--){const h=a.charCodeAt(u-1);if(h===47||h===92)break}c=a.substring(u)}const l=r.indexOf(c);return l!==-1?s[l]:null};n.basenames=r,n.patterns=s,n.allBasenames=r;const o=e.filter(a=>!a.basenames);return o.push(n),o}function jI(e,t){return Gi(e,t,(i,r)=>typeof i=="string"&&typeof r=="string"?i===r:typeof i!="string"&&typeof r!="string"?i.base===r.base&&i.pattern===r.pattern:!1)}var MH=H("notebookDocumentService"),vw=["W","X","Y","Z","a","b","c","d","e","f"],NH=new RegExp(`^[${vw.join("")}]+`),zI=7;function ww(e){if(e.scheme!==q.vscodeNotebookCell)return;const t=e.fragment.indexOf("s");if(t<0)return;const i=parseInt(e.fragment.substring(0,t).replace(NH,""),zI),r=Ho(e.fragment.substring(t+1)).toString();if(!isNaN(i))return{handle:i,notebook:e.with({scheme:r,fragment:null})}}function RH(e,t){const i=t.toString(zI),s=`${i.length<vw.length?vw[i.length-1]:"z"}${i}s${oc(W.fromString(e.scheme),!0,!0)}`;return e.with({scheme:q.vscodeNotebookCell,fragment:s})}function LH(e){if(e.scheme!==q.vscodeNotebookMetadata)return;const t=Ho(e.fragment).toString();return e.with({scheme:t,fragment:null})}function OH(e){const t=`${oc(W.fromString(e.scheme),!0,!0)}`;return e.with({scheme:q.vscodeNotebookMetadata,fragment:t})}function HI(e){if(e.scheme!==q.vscodeNotebookCellOutput)return;const t=new URLSearchParams(e.query),i=t.get("openIn");if(!i)return;const r=t.get("outputId")??void 0,s=ww(e.with({scheme:q.vscodeNotebookCell,query:null})),n=t.get("outputIndex")?parseInt(t.get("outputIndex")||"",10):void 0,o=s?s.notebook:e.with({scheme:t.get("notebookScheme")||q.file,fragment:null,query:null}),a=t.get("cellIndex")?parseInt(t.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:r,outputIndex:n,cellHandle:s?.handle,cellFragment:e.fragment,cellIndex:a}}var FH=class{constructor(){this.a=new zt}getNotebook(e){if(e.scheme===q.vscodeNotebookCell){const t=ww(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}if(e.scheme===q.vscodeNotebookCellOutput){const t=HI(e);if(t){const i=this.a.get(t.notebook);if(i)return i}}return this.a.get(e)}addNotebookDocument(e){this.a.set(e.uri,e)}removeNotebookDocument(e){this.a.delete(e.uri)}};De(MH,FH,1);var xc;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(xc||(xc={}));var jte=["application/json","application/javascript","text/html","image/svg+xml",Zr.latex,Zr.markdown,"image/png","image/jpeg",Zr.text],zte=[Zr.latex,Zr.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Zr.text],WI;(function(e){e[e.Running=1]="Running",e[e.Idle=2]="Idle"})(WI||(WI={}));var BI;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(BI||(BI={}));var _I;(function(e){e[e.Unconfirmed=1]="Unconfirmed",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(_I||(_I={}));var VI;(function(e){e[e.WithHardKernelDependency=0]="WithHardKernelDependency",e[e.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",e[e.Pure=2]="Pure",e[e.Never=3]="Never"})(VI||(VI={}));var qI;(function(e){e.Always="always",e.Never="never",e.Optional="optional"})(qI||(qI={}));var es;(function(e){e[e.ModelChange=1]="ModelChange",e[e.Move=2]="Move",e[e.ChangeCellLanguage=5]="ChangeCellLanguage",e[e.Initialize=6]="Initialize",e[e.ChangeCellMetadata=7]="ChangeCellMetadata",e[e.Output=8]="Output",e[e.OutputItem=9]="OutputItem",e[e.ChangeCellContent=10]="ChangeCellContent",e[e.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",e[e.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",e[e.ChangeCellMime=13]="ChangeCellMime",e[e.Unknown=100]="Unknown"})(es||(es={}));var GI;(function(e){e[e.Handle=0]="Handle",e[e.Index=1]="Index"})(GI||(GI={}));var ZI;(function(e){e[e.Replace=1]="Replace",e[e.Output=2]="Output",e[e.Metadata=3]="Metadata",e[e.CellLanguage=4]="CellLanguage",e[e.DocumentMetadata=5]="DocumentMetadata",e[e.Move=6]="Move",e[e.OutputItems=7]="OutputItems",e[e.PartialMetadata=8]="PartialMetadata",e[e.PartialInternalMetadata=9]="PartialInternalMetadata"})(ZI||(ZI={}));var JI;(function(e){e.scheme=q.vscodeNotebookMetadata;function t(r){return OH(r)}e.generate=t;function i(r){return LH(r)}e.parse=i})(JI||(JI={}));var bw;(function(e){e.scheme=q.vscodeNotebookCell;function t(l,u){return RH(l,u)}e.generate=t;function i(l){return ww(l)}e.parse=i;function r(l,u){return l.with({scheme:q.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:l.scheme!==q.file?l.scheme:""}).toString()})}e.generateCellOutputUriWithId=r;function s(l,u,h){return l.with({scheme:q.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(h)}).toString()})}e.generateCellOutputUriWithIndex=s;function n(l,u,h,f,p){return l.with({scheme:q.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:l.toString(),cellIndex:String(h),outputId:f,outputIndex:String(p)}).toString()})}e.generateOutputEditorUri=n;function o(l){return HI(l)}e.parseCellOutputUri=o;function a(l,u,h){return e.generate(l,u).with({scheme:h})}e.generateCellPropertyUri=a;function c(l,u){if(l.scheme===u)return e.parse(l.with({scheme:e.scheme}))}e.parseCellPropertyUri=c})(bw||(bw={}));var Hte=new k("notebookEditorCursorAtBoundary","none"),Wte=new k("notebookEditorCursorAtLineBoundary","none"),QI;(function(e){e.default="default",e.option="option"})(QI||(QI={}));var YI;(function(e){e.Cells="cells",e.Text="text",e.None="none"})(YI||(YI={}));var XI;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(XI||(XI={}));var Bte=class G1{static{this.d="notebook/"}static create(t,i){return`${G1.d}${t}/${i??t}`}static parse(t){if(t.startsWith(G1.d)){const i=t.substring(G1.d.length).split("/");if(i.length===2)return{notebookType:i[0],viewType:i[1]}}}},UH=new TextDecoder;function jH(e){const t=[];let i=!1;for(const o of e)(t.length===0||i)&&(t.push(o),i=!0);let r=HH(t);const s=W.concat(t.map(o=>W.wrap(o))),n=qH(s);return r=r||n.byteLength!==s.byteLength,{data:n,didCompression:r}}var Vf="\x1B[A",yw=Vf.split("").map(e=>e.charCodeAt(0)),zH=10;function HH(e){let t=!1;return e.forEach((i,r)=>{if(r===0||i.length<Vf.length)return;const s=e[r-1],n=i.subarray(0,Vf.length);if(n[0]===yw[0]&&n[1]===yw[1]&&n[2]===yw[2]){const o=s.lastIndexOf(zH);if(o===-1)return;t=!0,e[r-1]=s.subarray(0,o),e[r]=i.subarray(Vf.length)}}),t}function WH(e){let t=e;do e=t,t=e.replace(/[^\n]\x08/gm,"");while(t.length<e.length);return e}function BH(e){for(e=e.replace(/\r+\n/gm,`
`);e.search(/\r[^$]/g)>-1;){const t=e.match(/^(.*)\r+/m)[1];let i=e.match(/\r+(.*)$/m)[1];i=i+t.slice(i.length,t.length),e=e.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return e}var _H=8,VH=13;function qH(e){return!e.buffer.includes(_H)&&!e.buffer.includes(VH)?e:W.fromString(BH(WH(UH.decode(e.buffer))))}var KI;(function(e){e.Delimiter="\0"})(KI||(KI={}));var e6;(function(e){e[e.IsSame=0]="IsSame",e[e.Disconnected=1]="Disconnected",e[e.IsChild=2]="IsChild",e[e.IsParent=3]="IsParent"})(e6||(e6={}));var Ve=class Ur{static fromExtHostTestItem(t,i,r=t.parent){if(t._isRoot)return new Ur([i]);const s=[t.id];for(let n=r;n&&n.id!==i;n=n.parent)s.push(n.id);return s.push(i),new Ur(s.reverse())}static isRoot(t){return!t.includes("\0")}static root(t){const i=t.indexOf("\0");return i===-1?t:t.slice(0,i)}static fromString(t){return new Ur(t.split("\0"))}static join(t,i){return new Ur([...t.path,i])}static split(t){return t.split("\0")}static joinToString(t,i){return t.toString()+"\0"+i}static parentId(t){const i=t.lastIndexOf("\0");return i===-1?void 0:t.slice(0,i)}static localId(t){const i=t.lastIndexOf("\0");return i===-1?t:t.slice(i+1)}static isChild(t,i){return i[t.length]==="\0"&&i.startsWith(t)}static compare(t,i){return t===i?0:Ur.isChild(t,i)?2:Ur.isChild(i,t)?3:1}static getLengthOfCommonPrefix(t,i){if(t===0)return 0;let r=0;for(;r<t-1;){for(let s=1;s<t;s++){const n=i(s-1),o=i(s);if(n.path[r]!==o.path[r])return r}r++}return r}constructor(t,i=t.length){if(this.path=t,this.d=i,t.length===0||i<1)throw new Error("cannot create test with empty path")}get rootId(){return new Ur(this.path,1)}get parentId(){return this.d>1?new Ur(this.path,this.d-1):void 0}get localId(){return this.path[this.d-1]}get controllerId(){return this.path[0]}get isRoot(){return this.d===1}*idsFromRoot(){for(let t=1;t<=this.d;t++)yield new Ur(this.path,t)}*idsToRoot(){for(let t=this.d;t>0;t--)yield new Ur(this.path,t)}compare(t){if(typeof t=="string")return Ur.compare(this.toString(),t);for(let i=0;i<t.d&&i<this.d;i++)if(t.path[i]!==this.path[i])return 1;return t.d>this.d?2:t.d<this.d?3:0}toJSON(){return this.toString()}toString(){if(!this.c){this.c=this.path[0];for(let t=1;t<this.d;t++)this.c+="\0",this.c+=this.path[t]}return this.c}},t6;(function(e){e[e.Unset=0]="Unset",e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(t6||(t6={}));var i6;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(i6||(i6={}));var r6;(function(e){e[e.Refresh=2]="Refresh",e[e.CodeRelatedToTest=4]="CodeRelatedToTest",e[e.TestRelatedToCode=8]="TestRelatedToCode"})(r6||(r6={}));var s6;(function(e){e[e.Run=2]="Run",e[e.Debug=4]="Debug",e[e.Coverage=8]="Coverage",e[e.HasNonDefaultProfile=16]="HasNonDefaultProfile",e[e.HasConfigurable=32]="HasConfigurable",e[e.SupportsContinuousRun=64]="SupportsContinuousRun"})(s6||(s6={}));var _te={2:d(13963,null),4:d(13964,null),8:d(13965,null)},GH=e=>"runId"in e,kc;(function(e){e.serialize=t=>({range:t.range.toJSON(),uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({range:st.lift(i.range),uri:t.asCanonicalUri(y.revive(i.uri))})})(kc||(kc={}));var n6;(function(e){e[e.Error=0]="Error",e[e.Output=1]="Output"})(n6||(n6={}));var qf;(function(e){e.serialize=t=>({label:t.label,uri:t.uri?.toJSON(),position:t.position?.toJSON()}),e.deserialize=(t,i)=>({label:i.label,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,position:i.position?gr.lift(i.position):void 0})})(qf||(qf={}));var Gf;(function(e){e.serialize=t=>({message:t.message,type:0,expected:t.expected,actual:t.actual,contextValue:t.contextValue,location:t.location&&kc.serialize(t.location),stackTrace:t.stackTrace?.map(qf.serialize)}),e.deserialize=(t,i)=>({message:i.message,type:0,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&kc.deserialize(t,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(r=>qf.deserialize(t,r))})})(Gf||(Gf={}));var Zf;(function(e){e.serialize=t=>({message:t.message,type:1,offset:t.offset,length:t.length,location:t.location&&kc.serialize(t.location)}),e.deserialize=(t,i)=>({message:i.message,type:1,offset:i.offset,length:i.length,location:i.location&&kc.deserialize(t,i.location)})})(Zf||(Zf={}));var Jf;(function(e){e.serialize=t=>t.type===0?Gf.serialize(t):Zf.serialize(t),e.deserialize=(t,i)=>i.type===0?Gf.deserialize(t,i):Zf.deserialize(t,i),e.isDiffable=t=>t.type===0&&t.actual!==void 0&&t.expected!==void 0})(Jf||(Jf={}));var Ru;(function(e){e.serializeWithoutMessages=t=>({state:t.state,duration:t.duration,messages:[]}),e.serialize=t=>({state:t.state,duration:t.duration,messages:t.messages.map(Jf.serialize)}),e.deserialize=(t,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(r=>Jf.deserialize(t,r))})})(Ru||(Ru={}));var o6="\0",Qf=(e,t)=>e+o6+t,a6=e=>{const t=e.indexOf(o6);return{ctrlId:e.slice(0,t),tagId:e.slice(t+1)}},Yf;(function(e){e.serialize=t=>({extId:t.extId,label:t.label,tags:t.tags,busy:t.busy,children:void 0,uri:t.uri?.toJSON(),range:t.range?.toJSON()||null,description:t.description,error:t.error,sortText:t.sortText}),e.deserialize=(t,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?t.asCanonicalUri(y.revive(i.uri)):void 0,range:i.range?st.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(Yf||(Yf={}));var c6;(function(e){e[e.NotExpandable=0]="NotExpandable",e[e.Expandable=1]="Expandable",e[e.BusyExpanding=2]="BusyExpanding",e[e.Expanded=3]="Expanded"})(c6||(c6={}));var Xn;(function(e){e.serialize=t=>({expand:t.expand,item:Yf.serialize(t.item)}),e.deserialize=(t,i)=>({controllerId:Ve.root(i.item.extId),expand:i.expand,item:Yf.deserialize(t,i.item)})})(Xn||(Xn={}));var Lu;(function(e){e.serialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.uri!==void 0&&(i.uri=t.item.uri?.toJSON()),t.item.range!==void 0&&(i.range=t.item.range?.toJSON()),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}},e.deserialize=t=>{let i;return t.item&&(i={},t.item.label!==void 0&&(i.label=t.item.label),t.item.tags!==void 0&&(i.tags=t.item.tags),t.item.busy!==void 0&&(i.busy=t.item.busy),t.item.range!==void 0&&(i.range=t.item.range?st.lift(t.item.range):null),t.item.description!==void 0&&(i.description=t.item.description),t.item.error!==void 0&&(i.error=t.item.error),t.item.sortText!==void 0&&(i.sortText=t.item.sortText)),{extId:t.extId,expand:t.expand,item:i}}})(Lu||(Lu={}));var Aw=(e,t)=>{t.expand!==void 0&&(e.expand=t.expand),t.item!==void 0&&(e.item=e.item?Object.assign(e.item,t.item):t.item)},l6;(function(e){e.serializeWithoutMessages=t=>({...Xn.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Ru.serializeWithoutMessages)}),e.serialize=t=>({...Xn.serialize(t),ownComputedState:t.ownComputedState,computedState:t.computedState,tasks:t.tasks.map(Ru.serialize)}),e.deserialize=(t,i)=>({...Xn.deserialize(t,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(r=>Ru.deserialize(t,r)),retired:!0})})(l6||(l6={}));var Sw;(function(e){e.empty=()=>({covered:0,total:0}),e.sum=(t,i)=>{t.covered+=i.covered,t.total+=i.total}})(Sw||(Sw={}));var u6;(function(e){e.serialize=t=>({id:t.id,statement:t.statement,branch:t.branch,declaration:t.declaration,testIds:t.testIds,uri:t.uri.toJSON()}),e.deserialize=(t,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:t.asCanonicalUri(y.revive(i.uri))}),e.empty=(t,i)=>({id:t,uri:i,statement:Sw.empty()})})(u6||(u6={}));function Ew(e){return{...e,location:e.location?.toJSON()}}function xw(e){return e.location=e.location?gr.isIPosition(e.location)?gr.lift(e.location):st.lift(e.location):void 0,e}var h6;(function(e){e[e.Declaration=0]="Declaration",e[e.Statement=1]="Statement",e[e.Branch=2]="Branch"})(h6||(h6={}));var d6;(function(e){e.serialize=t=>t.type===0?Kf.serialize(t):ep.serialize(t),e.deserialize=t=>t.type===0?Kf.deserialize(t):ep.deserialize(t)})(d6||(d6={}));var Xf;(function(e){e.serialize=Ew,e.deserialize=xw})(Xf||(Xf={}));var Kf;(function(e){e.serialize=Ew,e.deserialize=xw})(Kf||(Kf={}));var ep;(function(e){e.serialize=t=>({...Ew(t),branches:t.branches?.map(Xf.serialize)}),e.deserialize=t=>({...xw(t),branches:t.branches?.map(Xf.deserialize)})})(ep||(ep={}));var f6;(function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.DocumentSynced=2]="DocumentSynced",e[e.Remove=3]="Remove",e[e.IncrementPendingExtHosts=4]="IncrementPendingExtHosts",e[e.Retire=5]="Retire",e[e.AddTag=6]="AddTag",e[e.RemoveTag=7]="RemoveTag"})(f6||(f6={}));var tp;(function(e){e.deserialize=(t,i)=>i.op===0?{op:i.op,item:Xn.deserialize(t,i.item)}:i.op===1?{op:i.op,item:Lu.deserialize(i.item)}:i.op===2?{op:i.op,uri:t.asCanonicalUri(y.revive(i.uri)),docv:i.docv}:i,e.serialize=t=>t.op===0?{op:t.op,item:Xn.serialize(t.item)}:t.op===1?{op:t.op,item:Lu.serialize(t.item)}:t})(tp||(tp={}));var ZH=class{constructor(e){this.l=e,this.f=new Map,this.g=new Map,this.h=new Set,this.j=0,this.k=0,this.tags=this.f}apply(e){const t=this.x();for(const i of e)switch(i.op){case 0:this.p(Xn.deserialize(this.l,i.item),t);break;case 1:this.q(Lu.deserialize(i.item),t);break;case 3:this.v(i.itemId,t);break;case 5:this.w(i.itemId);break;case 4:this.updatePendingRoots(i.amount);break;case 6:this.f.set(i.tag.id,i.tag);break;case 7:this.f.delete(i.id);break}t.complete?.()}p(e,t){const i=Ve.parentId(e.item.extId)?.toString();let r;if(!i)r=this.y(e),this.h.add(r),this.g.set(e.item.extId,r);else if(this.g.has(i)){const s=this.g.get(i);s.children.add(e.item.extId),r=this.y(e,s),this.g.set(e.item.extId,r)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}return t.add?.(r),e.expand===2&&this.j++,r}q(e,t){const i=this.g.get(e.extId);if(i)return e.expand!==void 0&&(i.expand===2&&this.j--,e.expand===2&&this.j++),Aw(i,e),t.update?.(i),i}v(e,t){const i=this.g.get(e);if(!i)return;const r=Ve.parentId(i.item.extId)?.toString();r?this.g.get(r).children.delete(i.item.extId):this.h.delete(i);const s=[[e]];for(;s.length;)for(const n of s.pop()){const o=this.g.get(n);o&&(s.push(o.children),this.g.delete(n),t.remove?.(o,o!==i),o.expand===2&&this.j--)}}w(e){}updatePendingRoots(e){this.k+=e}x(){return{}}},Vte=H("IAiSettingsSearchService"),Kn;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(Kn||(Kn={}));var JH=H("editorGroupsService"),p6;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(p6||(p6={}));var g6;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(g6||(g6={}));var m6;(function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST",e[e.NEXT=2]="NEXT",e[e.PREVIOUS=3]="PREVIOUS"})(m6||(m6={}));var v6;(function(e){e[e.MAXIMIZE=0]="MAXIMIZE",e[e.EXPAND=1]="EXPAND",e[e.EVEN=2]="EVEN"})(v6||(v6={}));var w6;(function(e){e[e.COPY_EDITORS=0]="COPY_EDITORS",e[e.MOVE_EDITORS=1]="MOVE_EDITORS"})(w6||(w6={}));var b6;(function(e){e[e.CREATION_TIME=0]="CREATION_TIME",e[e.MOST_RECENTLY_ACTIVE=1]="MOST_RECENTLY_ACTIVE",e[e.GRID_APPEARANCE=2]="GRID_APPEARANCE"})(b6||(b6={}));var y6;(function(e){e[e.NEW_EDITOR=1]="NEW_EDITOR",e[e.MOVE_EDITOR=2]="MOVE_EDITOR",e[e.COPY_EDITOR=3]="COPY_EDITOR"})(y6||(y6={}));var A6=H("editorService"),QH=-1,YH=-2,eo;(function(e){e.Extensions="Extensions",e.IntegratedTerminal="IntegratedTerminal",e.InteractiveSession="InteractiveSession",e.Telemetry="Telemetry",e.Update="Update"})(eo||(eo={}));var qte={[eo.Extensions]:{name:{key:"extensionsConfigurationTitle",value:d(145,null)}},[eo.IntegratedTerminal]:{name:{key:"terminalIntegratedConfigurationTitle",value:d(146,null)}},[eo.InteractiveSession]:{name:{key:"interactiveSessionConfigurationTitle",value:d(147,null)}},[eo.Telemetry]:{name:{key:"telemetryConfigurationTitle",value:d(148,null)}},[eo.Update]:{name:{key:"updateConfigurationTitle",value:d(149,null)}}},yi=H("configurationService"),S6;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.USER=2]="USER",e[e.USER_LOCAL=3]="USER_LOCAL",e[e.USER_REMOTE=4]="USER_REMOTE",e[e.WORKSPACE=5]="WORKSPACE",e[e.WORKSPACE_FOLDER=6]="WORKSPACE_FOLDER",e[e.DEFAULT=7]="DEFAULT",e[e.MEMORY=8]="MEMORY"})(S6||(S6={}));function kw(e,t){const i=Object.create(null);for(const r in e)E6(i,r,e[r],t);return i}function E6(e,t,i,r){const s=t.split("."),n=s.pop();let o=e;for(let a=0;a<s.length;a++){const c=s[a];let l=o[c];switch(typeof l){case"undefined":l=o[c]=Object.create(null);break;case"object":if(l===null){r(`Ignoring ${t} as ${s.slice(0,a+1).join(".")} is null`);return}break;default:r(`Ignoring ${t} as ${s.slice(0,a+1).join(".")} is ${JSON.stringify(l)}`);return}o=l}if(typeof o=="object"&&o!==null)try{o[n]=i}catch{r(`Ignoring ${t} as ${s.join(".")} is ${JSON.stringify(o)}`)}else r(`Ignoring ${t} as ${s.join(".")} is ${JSON.stringify(o)}`)}function XH(e,t){const i=t.split(".");x6(e,i)}function x6(e,t){if(!e)return;const i=e,r=t.shift();if(t.length===0){delete i[r];return}if(Object.keys(i).indexOf(r)!==-1){const s=i[r];typeof s=="object"&&!Array.isArray(s)&&(x6(s,t),Object.keys(s).length===0&&delete i[r])}}function ip(e,t,i){function r(o,a){let c=o;for(const l of a){if(typeof c!="object"||c===null)return;c=c[l]}return c}const s=t.split("."),n=r(e,s);return typeof n>"u"?i:n}function KH(e){return e.replace(/^\[/,"").replace(/]$/g,"").replace(/\]\[/g,", ")}function eW(e){let t=!1;const i=new Map,r=new Map;if(tW(e,u=>{if(e===u)return!0;const h=JSON.stringify(u);if(h.length<30)return!0;const f=i.get(h);if(!f){const p={schemas:[u]};return i.set(h,p),r.set(u,p),!0}return f.schemas.push(u),r.set(u,f),t=!0,!1}),i.clear(),!t)return JSON.stringify(e);let n="$defs";for(;e.hasOwnProperty(n);)n+="_";const o=[];function a(u){return JSON.stringify(u,(h,f)=>{if(f!==u){const p=r.get(f);if(p&&p.schemas.length>1)return p.id||(p.id=`_${o.length}`,o.push(p.schemas[0])),{$ref:`#/${n}/${p.id}`}}return f})}const c=a(e),l=[];for(let u=0;u<o.length;u++)l.push(`"_${u}":${a(o[u])}`);return l.length?`${c.substring(0,c.length-1)},"${n}":{${l.join(",")}}}`:c}function Cc(e){return typeof e=="object"&&e!==null}function tW(e,t){if(!e||typeof e!="object")return;const i=(...c)=>{for(const l of c)Cc(l)&&o.push(l)},r=(...c)=>{for(const l of c)if(Cc(l))for(const u in l){const h=l[u];Cc(h)&&o.push(h)}},s=(...c)=>{for(const l of c)if(Array.isArray(l))for(const u of l)Cc(u)&&o.push(u)},n=c=>{if(Array.isArray(c))for(const l of c)Cc(l)&&o.push(l);else Cc(c)&&o.push(c)},o=[e];let a=o.pop();for(;a;)t(a)&&(i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties),r(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas),s(a.anyOf,a.allOf,a.oneOf,a.prefixItems),n(a.items)),a=o.pop()}var rp={JSONContribution:"base.contributions.json"};function k6(e){return e.length>0&&e.charAt(e.length-1)==="#"?e.substring(0,e.length-1):e}var iW=class extends Q{constructor(){super(...arguments),this.a={},this.b={},this.c=this.D(new I),this.onDidChangeSchema=this.c.event,this.f=this.D(new I),this.onDidChangeSchemaAssociations=this.f.event}registerSchema(e,t,i){const r=k6(e);this.a[r]=t,this.c.fire(e),i&&i.add(te(()=>{delete this.a[r],this.c.fire(e)}))}registerSchemaAssociation(e,t){const i=k6(e);return this.b[i]||(this.b[i]=[]),this.b[i].includes(t)||(this.b[i].push(t),this.f.fire()),te(()=>{const r=this.b[i];if(r){const s=r.indexOf(t);s!==-1&&(r.splice(s,1),r.length===0&&delete this.b[i],this.f.fire())}})}notifySchemaChanged(e){this.c.fire(e)}getSchemaContributions(){return{schemas:this.a}}getSchemaContent(e){const t=this.a[e];return t?eW(t):void 0}hasSchemaContent(e){return!!this.a[e]}getSchemaAssociations(){return this.b}},rW=new iW;Zt.add(rp.JSONContribution,rW);var C6;(function(e){e.Multiline="multilineText",e.Singleline="singlelineText"})(C6||(C6={}));var to={Configuration:"base.contributions.configuration"},$6;(function(e){e[e.APPLICATION=1]="APPLICATION",e[e.MACHINE=2]="MACHINE",e[e.APPLICATION_MACHINE=3]="APPLICATION_MACHINE",e[e.WINDOW=4]="WINDOW",e[e.RESOURCE=5]="RESOURCE",e[e.LANGUAGE_OVERRIDABLE=6]="LANGUAGE_OVERRIDABLE",e[e.MACHINE_OVERRIDABLE=7]="MACHINE_OVERRIDABLE"})($6||($6={}));var sp={properties:{},patternProperties:{}},np={properties:{},patternProperties:{}},op={properties:{},patternProperties:{}},ap={properties:{},patternProperties:{}},cp={properties:{},patternProperties:{}},lp={properties:{},patternProperties:{}},Ou={properties:{},patternProperties:{}},na="vscode://schemas/settings/resourceLanguage",up=Zt.as(rp.JSONContribution),sW=class extends Q{constructor(){super(),this.a=[],this.n=new Set,this.q=this.D(new I),this.onDidSchemaChange=this.q.event,this.r=this.D(new I),this.onDidUpdateConfiguration=this.r.event,this.b=new Map,this.c={id:"defaultOverrides",title:d(1839,null),properties:{}},this.f=[this.c],this.m={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.g={},this.h=new Map,this.j={},up.registerSchema(na,this.m),this.N()}registerConfiguration(e,t=!0){return this.registerConfigurations([e],t),e}registerConfigurations(e,t=!0){const i=new Set;this.F(e,t,i),up.registerSchema(na,this.m),this.q.fire(),this.r.fire({properties:i})}deregisterConfigurations(e){const t=new Set;this.G(e,t),up.registerSchema(na,this.m),this.q.fire(),this.r.fire({properties:t})}updateConfigurations({add:e,remove:t}){const i=new Set;this.G(t,i),this.F(e,!1,i),up.registerSchema(na,this.m),this.q.fire(),this.r.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.s(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}s(e,t){this.a.push(...e);const i=[];for(const{overrides:r,source:s}of e)for(const n in r){t.add(n);const o=this.b.get(n)??this.b.set(n,{configurationDefaultOverrides:[]}).get(n),a=r[n];if(o.configurationDefaultOverrides.push({value:a,source:s}),xs.test(n)){const c=this.y(n,a,s,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c,this.w(n,c,s),i.push(...Fu(n))}else{const c=this.z(n,a,s,o.configurationDefaultOverrideValue);if(!c)continue;o.configurationDefaultOverrideValue=c;const l=this.g[n];l&&(this.O(n,l),this.J(n,l))}}this.C(i)}deregisterDefaultConfigurations(e){const t=new Set;this.u(e,t),this.q.fire(),this.r.fire({properties:t,defaultsOverrides:!0})}u(e,t){for(const i of e){const r=this.a.indexOf(i);r!==-1&&this.a.splice(r,1)}for(const{overrides:i,source:r}of e)for(const s in i){const n=this.b.get(s);if(!n)continue;const o=n.configurationDefaultOverrides.findIndex(a=>r?a.source?.id===r.id:a.value===i[s]);if(o!==-1){if(n.configurationDefaultOverrides.splice(o,1),n.configurationDefaultOverrides.length===0&&this.b.delete(s),xs.test(s)){let a;for(const c of n.configurationDefaultOverrides)a=this.y(s,c.value,c.source,a);a&&!yv(a.value)?(n.configurationDefaultOverrideValue=a,this.w(s,a,r)):(this.b.delete(s),delete this.g[s],delete this.c.properties[s])}else{let a;for(const l of n.configurationDefaultOverrides)a=this.z(s,l.value,l.source,a);n.configurationDefaultOverrideValue=a;const c=this.g[s];c&&(this.O(s,c),this.J(s,c))}t.add(s)}}this.M()}w(e,t,i){const r={section:{id:this.c.id,title:this.c.title,order:this.c.order,extensionInfo:this.c.extensionInfo},type:"object",default:t.value,description:d(1840,null,KH(e)),$ref:na,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.g[e]=r,this.c.properties[e]=r}y(e,t,i,r){const s=r?.value||{},n=r?.source??new Map;if(!(n instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const o of Object.keys(t)){const a=t[o];if(yt(a)&&(Kl(s[o])||yt(s[o]))){if(s[o]={...s[o]??{},...a},i)for(const l in a)n.set(`${o}.${l}`,i)}else s[o]=a,i?n.set(o,i):n.delete(o)}return{value:s,source:n}}z(e,t,i,r){const s=this.g[e],n=r?.value??s?.defaultDefaultValue;let o=i;if(yt(t)&&(s!==void 0&&s.type==="object"||s===void 0&&(Kl(n)||yt(n)))){if(o=r?.source??new Map,!(o instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&o.set(`${e}.${c}`,i);t={...yt(n)?n:{},...t}}return{value:t,source:o}}deltaConfiguration(e){let t=!1;const i=new Set;e.removedDefaults&&(this.u(e.removedDefaults,i),t=!0),e.addedDefaults&&(this.s(e.addedDefaults,i),t=!0),e.removedConfigurations&&this.G(e.removedConfigurations,i),e.addedConfigurations&&this.F(e.addedConfigurations,!1,i),this.q.fire(),this.r.fire({properties:i,defaultsOverrides:t})}notifyConfigurationSchemaUpdated(...e){this.q.fire()}registerOverrideIdentifiers(e){this.C(e),this.q.fire()}C(e){for(const t of e)this.n.add(t);this.M()}F(e,t,i){e.forEach(r=>{this.H(r,t,r.extensionInfo,r.restrictedProperties,void 0,i),this.f.push(r),this.I(r)})}G(e,t){const i=r=>{if(r.properties)for(const s in r.properties){t.add(s);const n=this.g[s];n?.policy?.name&&this.h.delete(n.policy.name),delete this.g[s],this.L(s,r.properties[s])}r.allOf?.forEach(s=>i(s))};for(const r of e){i(r);const s=this.f.indexOf(r);s!==-1&&this.f.splice(s,1)}}H(e,t=!0,i,r,s=4,n){s=Ht(e.scope)?s:e.scope;const o=e.properties;if(o)for(const c in o){const l=o[c];if(l.section={id:e.id,title:e.title,order:e.order,extensionInfo:e.extensionInfo},t&&oW(c,l,i?.id)){delete o[c];continue}l.source=i,l.defaultDefaultValue=o[c].default,this.O(c,l),xs.test(c)?l.scope=void 0:(l.scope=Ht(l.scope)?s:l.scope,l.restricted=Ht(l.restricted)?!!r?.includes(c):l.restricted),l.experiment?l.tags?.some(f=>f.toLowerCase()==="onexp")||(l.tags=l.tags??[],l.tags.push("onExP")):l.tags?.some(f=>f.toLowerCase()==="onexp")&&(console.error(`Invalid tag 'onExP' found for property '${c}'. Please use 'experiment' property instead.`),l.experiment={mode:"startup"});const u=o[c].hasOwnProperty("included")&&!o[c].included,h=o[c].policy?.name;u?(this.j[c]=o[c],h&&(this.h.set(h,c),n.add(c)),delete o[c]):(n.add(c),h&&this.h.set(h,c),this.g[c]=o[c],!o[c].deprecationMessage&&o[c].markdownDeprecationMessage&&(o[c].deprecationMessage=o[c].markdownDeprecationMessage))}const a=e.allOf;if(a)for(const c of a)this.H(c,t,i,r,s,n)}getConfigurations(){return this.f}getConfigurationProperties(){return this.g}getPolicyConfigurations(){return this.h}getExcludedConfigurationProperties(){return this.j}getRegisteredDefaultConfigurations(){return[...this.a]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[t,i]of this.b)i.configurationDefaultOverrideValue&&e.set(t,i.configurationDefaultOverrideValue);return e}I(e){const t=i=>{const r=i.properties;if(r)for(const n in r)this.J(n,r[n]);i.allOf?.forEach(t)};t(e)}J(e,t){switch(sp.properties[e]=t,t.scope){case 1:np.properties[e]=t;break;case 2:ap.properties[e]=t;break;case 3:op.properties[e]=t;break;case 7:cp.properties[e]=t;break;case 4:lp.properties[e]=t;break;case 5:Ou.properties[e]=t;break;case 6:Ou.properties[e]=t,this.m.properties[e]=t;break}}L(e,t){switch(delete sp.properties[e],t.scope){case 1:delete np.properties[e];break;case 2:delete ap.properties[e];break;case 3:delete op.properties[e];break;case 7:delete cp.properties[e];break;case 4:delete lp.properties[e];break;case 5:case 6:delete Ou.properties[e],delete this.m.properties[e];break}}M(){for(const e of this.n.values()){const t=`[${e}]`,i={type:"object",description:d(1841,null),errorMessage:d(1842,null),$ref:na};this.O(t,i),sp.properties[t]=i,np.properties[t]=i,op.properties[t]=i,ap.properties[t]=i,cp.properties[t]=i,lp.properties[t]=i,Ou.properties[t]=i}}N(){const e={type:"object",description:d(1843,null),errorMessage:d(1844,null),$ref:na};sp.patternProperties[io]=e,np.patternProperties[io]=e,op.patternProperties[io]=e,ap.patternProperties[io]=e,cp.patternProperties[io]=e,lp.patternProperties[io]=e,Ou.patternProperties[io]=e,this.q.fire()}O(e,t){const i=this.b.get(e)?.configurationDefaultOverrideValue;let r,s;i&&(!t.disallowConfigurationDefault||!i.source)&&(r=i.value,s=i.source),Kl(r)&&(r=t.defaultDefaultValue,s=void 0),Kl(r)&&(r=nW(t.type)),t.default=r,t.defaultValueSource=s}},I6="\\[([^\\]]+)\\]",D6=new RegExp(I6,"g"),io=`^(${I6})+$`,xs=new RegExp(io);function Fu(e){const t=[];if(xs.test(e)){let i=D6.exec(e);for(;i?.length;){const r=i[1].trim();r&&t.push(r),i=D6.exec(e)}}return $n(t)}function nW(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}var hp=new sW;Zt.add(to.Configuration,hp);function oW(e,t,i){return e.trim()?xs.test(e)?d(1846,null,e):hp.getConfigurationProperties()[e]!==void 0&&(!i||!aW.has(i.toLowerCase()))?d(1847,null,e):t.policy?.name&&hp.getPolicyConfigurations().get(t.policy?.name)!==void 0?d(1848,null,e,t.policy?.name,hp.getPolicyConfigurations().get(t.policy?.name)):null:d(1845,null)}var aW=new Set(bi.defaultChatAgent?[bi.defaultChatAgent.extensionId,bi.defaultChatAgent.chatExtensionId].map(e=>e.toLowerCase()):[]),Cw="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",Gte=new RegExp(Cw),P6;(function(e){e.COMMAND="command",e.SETTINGS_SYNC="settingsSync"})(P6||(P6={}));var T6;(function(e){e.NoneOrRelevance="NoneOrRelevance",e.LastUpdatedDate="LastUpdatedDate",e.Title="Title",e.PublisherName="PublisherName",e.InstallCount="InstallCount",e.PublishedDate="PublishedDate",e.AverageRating="AverageRating",e.WeightedRating="WeightedRating"})(T6||(T6={}));var M6;(function(e){e[e.Default=0]="Default",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"})(M6||(M6={}));var N6;(function(e){e.Category="Category",e.ExtensionId="ExtensionId",e.ExtensionName="ExtensionName",e.ExcludeWithFlags="ExcludeWithFlags",e.Featured="Featured",e.SearchText="SearchText",e.Tag="Tag",e.Target="Target"})(N6||(N6={}));var R6;(function(e){e.Install="install",e.Uninstall="uninstall"})(R6||(R6={}));var L6;(function(e){e[e.None=1]="None",e[e.Install=2]="Install",e[e.Update=3]="Update",e[e.Migrate=4]="Migrate"})(L6||(L6={}));var Zte=H("extensionGalleryService"),O6;(function(e){e.Timeout="Timeout",e.Cancelled="Cancelled",e.ClientError="ClientError",e.ServerError="ServerError",e.Failed="Failed",e.DownloadFailedWriting="DownloadFailedWriting",e.Offline="Offline"})(O6||(O6={}));var F6;(function(e){e.NotFound="NotFound",e.Unsupported="Unsupported",e.Deprecated="Deprecated",e.Malicious="Malicious",e.Incompatible="Incompatible",e.IncompatibleApi="IncompatibleApi",e.IncompatibleTargetPlatform="IncompatibleTargetPlatform",e.ReleaseVersionNotFound="ReleaseVersionNotFound",e.Invalid="Invalid",e.Download="Download",e.DownloadSignature="DownloadSignature",e.DownloadFailedWriting="DownloadFailedWriting",e.UpdateMetadata="UpdateMetadata",e.Extract="Extract",e.Scanning="Scanning",e.ScanningExtension="ScanningExtension",e.ReadRemoved="ReadRemoved",e.UnsetRemoved="UnsetRemoved",e.Delete="Delete",e.Rename="Rename",e.IntializeDefaultProfile="IntializeDefaultProfile",e.AddToProfile="AddToProfile",e.InstalledExtensionNotFound="InstalledExtensionNotFound",e.PostInstall="PostInstall",e.CorruptZip="CorruptZip",e.IncompleteZip="IncompleteZip",e.PackageNotSigned="PackageNotSigned",e.SignatureVerificationInternal="SignatureVerificationInternal",e.SignatureVerificationFailed="SignatureVerificationFailed",e.NotAllowed="NotAllowed",e.Gallery="Gallery",e.Cancelled="Cancelled",e.Unknown="Unknown",e.Internal="Internal"})(F6||(F6={}));var U6;(function(e){e.NotSigned="NotSigned",e.Success="Success",e.RequiredArgumentMissing="RequiredArgumentMissing",e.InvalidArgument="InvalidArgument",e.PackageIsUnreadable="PackageIsUnreadable",e.UnhandledException="UnhandledException",e.SignatureManifestIsMissing="SignatureManifestIsMissing",e.SignatureManifestIsUnreadable="SignatureManifestIsUnreadable",e.SignatureIsMissing="SignatureIsMissing",e.SignatureIsUnreadable="SignatureIsUnreadable",e.CertificateIsUnreadable="CertificateIsUnreadable",e.SignatureArchiveIsUnreadable="SignatureArchiveIsUnreadable",e.FileAlreadyExists="FileAlreadyExists",e.SignatureArchiveIsInvalidZip="SignatureArchiveIsInvalidZip",e.SignatureArchiveHasSameSignatureFile="SignatureArchiveHasSameSignatureFile",e.PackageIntegrityCheckFailed="PackageIntegrityCheckFailed",e.SignatureIsInvalid="SignatureIsInvalid",e.SignatureManifestIsInvalid="SignatureManifestIsInvalid",e.SignatureIntegrityCheckFailed="SignatureIntegrityCheckFailed",e.EntryIsMissing="EntryIsMissing",e.EntryIsTampered="EntryIsTampered",e.Untrusted="Untrusted",e.CertificateRevoked="CertificateRevoked",e.SignatureIsNotValid="SignatureIsNotValid",e.UnknownError="UnknownError",e.PackageIsInvalidZip="PackageIsInvalidZip",e.SignatureArchiveHasTooManyEntries="SignatureArchiveHasTooManyEntries"})(U6||(U6={}));var Jte=H("extensionManagementService"),Qte=H("IGlobalExtensionEnablementService"),Yte=H("IExtensionTipsService"),Xte=H("IAllowedExtensionsService"),Kte=Gd(1998,"Extensions"),eie=Gd(1999,"Preferences"),cW="extensions.allowed";Zt.as(to.Configuration).registerConfiguration({id:"extensions",order:30,title:d(1981,null),type:"object",properties:{[cW]:{type:"object",markdownDescription:d(1982,null),default:"*",defaultSnippets:[{body:{},description:d(1983,null)},{body:{"*":!0},description:d(1984,null)}],scope:1,policy:{name:"AllowedExtensions",category:eo.Extensions,minimumVersion:"1.96",localization:{description:{key:"extensions.allowed.policy",value:d(1985,null)}}},additionalProperties:!1,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1986,null),enumDescriptions:[d(1987,null),d(1988,null),d(1989,null)]},{type:"array",items:{type:"string"},description:d(1990,null)}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[!0,!1,"stable"],description:d(1991,null),enumDescriptions:[d(1992,null),d(1993,null),d(1994,null)]},"\\*":{type:"boolean",enum:[!0,!1],description:d(1995,null),enumDescriptions:[d(1996,null),d(1997,null)]}}}}});var dp=H("telemetryService"),tie=H("customEndpointTelemetryService"),j6;(function(e){e[e.NONE=0]="NONE",e[e.CRASH=1]="CRASH",e[e.ERROR=2]="ERROR",e[e.USAGE=3]="USAGE"})(j6||(j6={}));var z6;(function(e){e.OFF="off",e.CRASH="crash",e.ERROR="error",e.ON="all"})(z6||(z6={}));var $w=class{constructor(e){this.value=e,this.isTrustedTelemetryValue=!0}},lW=class{constructor(){this.telemetryLevel=0,this.sessionId="someValue.sessionId",this.machineId="someValue.machineId",this.sqmId="someValue.sqmId",this.devDeviceId="someValue.devDeviceId",this.firstSessionDate="someValue.firstSessionDate",this.sendErrorTelemetry=!1}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}},iie=new lW,uW="telemetry",hW={id:uW,name:d(2338,null)},dW=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function fW(e){if(!e)return"none";const t=h0(e);return dW.has(t)?t:"other"}function pW(e,t){if(!e||!e.includes("/")&&!e.includes("\\"))return e;let i=e;const r=[];for(const a of t)for(;;){const c=a.exec(e);if(!c)break;r.push([c.index,a.lastIndex])}const s=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,n=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;for(i="";;){const a=n.exec(e);if(!a)break;const c=r.some(([l,u])=>a.index<u&&l<n.lastIndex);!s.test(a[0])&&!c&&(i+=e.substring(o,a.index)+"<REDACTED: user-file-path>",o=n.lastIndex)}return o<e.length&&(i+=e.substr(o)),i}function gW(e){if(!e)return e;const t=[{label:"URL",regex:/[a-zA-Z][a-zA-Z0-9+.-]*:\/\/[^\s]*/},{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"JWT",regex:/eyJ[0eXAiOiJKV1Qi|hbGci|a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of t)if(i.regex.test(e))return`<REDACTED: ${i.label}>`;return e}function H6(e,t){return e?lc(e,i=>{if(i instanceof $w||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue"))return i.value;if(typeof i=="string"){let r=i.replaceAll("%20"," ");r=pW(r,t);for(const s of t)r=r.replace(s,"");return r=gW(r),r}}):{}}function mW(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id?!0:Mv(e.id,t.id)===0}var rie=new Ye("pprice.better-merge"),vW=class{constructor(){this.a=new Map,this.b=new WeakMap}register(e,t){this.a.set(e,t)}readActivationEvents(e){return this.b.has(e)||this.b.set(e,this.c(e)),this.b.get(e)}createActivationEventsMap(e){const t=Object.create(null);for(const i of e){const r=this.readActivationEvents(i);r.length>0&&(t[Ye.toKey(i.identifier)]=r)}return t}c(e){if(typeof e.main>"u"&&typeof e.browser>"u")return[];const t=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let i=0;i<t.length;i++)t[i]==="onUri"&&(t[i]=`onUri:${Ye.toKey(e.identifier)}`);if(!e.contributes)return t;for(const i in e.contributes){const r=this.a.get(i);if(!r)continue;const s=e.contributes[i],n=Array.isArray(s)?s:[s];try{t.push(...r(n))}catch(o){lt(o)}}return t}},wW=new vW,bW=Object.freeze({identifier:new Ye("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:y.parse("void:location"),isBuiltin:!1,targetPlatform:"undefined",isUserBuiltin:!1,isUnderDevelopment:!1,preRelease:!1}),W6=H("extensionService"),B6=class{constructor(e){this.dependency=e}},_6;(function(e){e[e.EagerAutoStart=1]="EagerAutoStart",e[e.EagerManualStart=2]="EagerManualStart",e[e.LazyAutoStart=3]="LazyAutoStart"})(_6||(_6={}));function et(e,t){return e.enabledApiProposals?e.enabledApiProposals.includes(t):!1}function T(e,t){if(!et(e,t))throw new Error(`Extension '${e.identifier.value}' CANNOT use API proposal: ${t}.
Its package.json#enabledApiProposals-property declares: ${e.enabledApiProposals?.join(", ")??"[]"} but NOT ${t}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${e.identifier.value}`)}var V6;(function(e){e[e.Normal=0]="Normal",e[e.Immediate=1]="Immediate"})(V6||(V6={}));var q6;(function(e){e[e.Upsert=0]="Upsert",e[e.SetTags=1]="SetTags",e[e.UpdateCanResolveChildren=2]="UpdateCanResolveChildren",e[e.RemoveChild=3]="RemoveChild",e[e.SetProp=4]="SetProp",e[e.Bulk=5]="Bulk",e[e.DocumentSynced=6]="DocumentSynced"})(q6||(q6={}));var Uu=(e,t)=>e===t,yW={range:(e,t)=>e===t?!0:!e||!t?!1:e.equalsRange(t),busy:Uu,label:Uu,description:Uu,error:Uu,sortText:Uu,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.includes(i)))},AW=Object.entries(yW),SW=(e,t)=>{let i;for(const[r,s]of AW)s(e[r],t[r])||(i?i[r]=t[r]:i={[r]:t[r]});return i},EW=class extends Q{get root(){return this.q.root}constructor(e){super(),this.q=e,this.f=this.D(new vs(()=>this.flushDiff(),200)),this.g=this.D(new I),this.tree=new Map,this.j=new Map,this.m=[],this.onDidGenerateDiff=this.g.event,this.root.canResolveChildren=!0,this.y(this.root,void 0)}set resolveHandler(e){this.h=e;for(const t of this.tree.values())this.J(t)}get resolveHandler(){return this.h}collectDiff(){const e=this.m;return this.m=[],e}pushDiff(e){switch(e.op){case 2:{for(const t of this.m)if(t.op===2&&t.uri===e.uri){t.docv=e.docv;return}break}case 1:{const t=this.m[this.m.length-1];if(t){if(t.op===1&&t.item.extId===e.item.extId){Aw(t.item,e.item);return}if(t.op===0&&t.item.item.extId===e.item.extId){Aw(t.item,e.item);return}}break}}this.m.push(e),this.f.isScheduled()||this.f.schedule()}expand(e,t){const i=this.tree.get(e);if(i){if((i.expandLevels===void 0||t>i.expandLevels)&&(i.expandLevels=t),i.expand===1){const r=this.M(i);return r.isOpen()?this.L(i,t-1):r.wait().then(()=>this.L(i,t-1))}else if(i.expand===3)return i.resolveBarrier?.isOpen()===!1?i.resolveBarrier.wait().then(()=>this.L(i,t-1)):this.L(i,t-1)}}dispose(){for(const e of this.tree.values())this.q.getApiFor(e.actual).listener=void 0;this.tree.clear(),this.m=[],super.dispose()}s(e,t){switch(t.op){case 3:this.O(Ve.joinToString(e.fullId,t.id));break;case 0:this.y(t.item,e);break;case 5:for(const i of t.ops)this.s(e,i);break;case 1:this.z(t.new,t.old,e.fullId.toString());break;case 2:this.J(e);break;case 4:this.pushDiff({op:1,item:{extId:e.fullId.toString(),item:t.update}});break;case 6:this.w(e.actual.uri);break;default:vv(t)}}w(e){e&&this.pushDiff({op:2,uri:e,docv:this.q.getDocumentVersion(e)})}y(e,t){const i=Ve.fromExtHostTestItem(e,this.root.id,t?.actual),r=this.q.getApiFor(e);r.parent&&r.parent!==t?.actual&&this.q.getChildren(r.parent).delete(e.id);let s=this.tree.get(i.toString());if(!s){s={fullId:i,actual:e,expandLevels:t?.expandLevels?t.expandLevels-1:void 0,expand:0},e.tags.forEach(this.C,this),this.tree.set(s.fullId.toString(),s),this.G(e,t),this.pushDiff({op:0,item:{controllerId:this.q.controllerId,expand:s.expand,item:this.q.toITestItem(e)}}),this.I(e,s,t);return}if(s.actual===e){this.H(e,s,t);return}if(s.actual.uri?.toString()!==e.uri?.toString())return this.O(i.toString()),this.y(e,t);const n=this.q.getChildren(s.actual),o=s.actual,a=SW(this.q.toITestItem(o),this.q.toITestItem(e));this.q.getApiFor(o).listener=void 0,s.actual=e,s.resolveBarrier=void 0,s.expand=0,a&&(a.hasOwnProperty("tags")&&(this.z(e.tags,o.tags,i.toString()),delete a.tags),this.s(s,{op:4,update:a})),this.I(e,s,t);for(const[l,u]of n)this.q.getChildren(e).get(u.id)||this.O(Ve.joinToString(i,u.id));const c=s.expandLevels;c!==void 0&&queueMicrotask(()=>{s.expand===1&&(s.expandLevels=void 0,this.expand(i.toString(),c))}),this.w(s.actual.uri)}z(e,t,i){const r=new Set(t.map(s=>s.id));for(const s of e)r.delete(s.id)||this.C(s);this.pushDiff({op:1,item:{extId:i,item:{tags:e.map(s=>Qf(this.q.controllerId,s.id))}}}),r.forEach(this.F,this)}C(e){const t=this.j.get(e.id);t?t.refCount++:(this.j.set(e.id,{refCount:1}),this.pushDiff({op:6,tag:{id:Qf(this.q.controllerId,e.id)}}))}F(e){const t=this.j.get(e);t&&!--t.refCount&&(this.j.delete(e),this.pushDiff({op:7,id:Qf(this.q.controllerId,e)}))}G(e,t){this.q.getApiFor(e).parent=t&&t.actual!==this.root?t.actual:void 0}H(e,t,i){this.G(e,i);const r=this.q.getApiFor(e);r.parent=i?.actual,r.listener=s=>this.s(t,s),this.J(t)}I(e,t,i){this.H(e,t,i);for(const[r,s]of this.q.getChildren(e))this.y(s,t)}J(e){let t;this.h?e.resolveBarrier?t=e.resolveBarrier.isOpen()?3:2:t=e.actual.canResolveChildren?1:0:t=0,t!==e.expand&&(e.expand=t,this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:t}}),t===1&&e.expandLevels!==void 0&&this.M(e))}L(e,t){if(t<0)return;const i=[];for(const[r,s]of this.q.getChildren(e.actual)){const n=this.expand(Ve.joinToString(e.fullId,s.id),t);Fn(n)&&i.push(n)}if(i.length)return Promise.all(i).then(()=>{})}M(e){if(e.resolveBarrier)return e.resolveBarrier;if(!this.h){const s=new fr;return s.open(),s}e.expand=2,this.N(e);const t=e.resolveBarrier=new fr,i=s=>{console.error(`Unhandled error in resolveHandler of test controller "${this.q.controllerId}"`,s)};let r;try{r=this.h(e.actual===this.root?void 0:e.actual)}catch(s){i(s)}return Fn(r)?r.catch(i).then(()=>{t.open(),this.J(e)}):(t.open(),this.J(e)),e.resolveBarrier}N(e){this.pushDiff({op:1,item:{extId:e.fullId.toString(),expand:e.expand}})}O(e){const t=this.tree.get(e);if(!t)throw new Error("attempting to remove non-existent child");this.pushDiff({op:3,itemId:e});const i=[t];for(;i.length;){const r=i.pop();if(r){this.q.getApiFor(r.actual).listener=void 0;for(const s of r.actual.tags)this.F(s.id);this.tree.delete(r.fullId.toString());for(const[s,n]of this.q.getChildren(r.actual))i.push(this.tree.get(Ve.joinToString(r.fullId,n.id)))}}}flushDiff(){const e=this.collectDiff();e.length&&this.g.fire(e)}},xW=class extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}},fp=class extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}},kW=class extends Error{constructor(e,t,i){super(`TestItem with ID "${e}" is from controller "${t}" and cannot be added as a child of an item from controller "${i}".`)}},CW=(e,t,i)=>{let r=new Map;return{get size(){return r.size},forEach(s,n){for(const o of r.values())s.call(n,o,this)},[Symbol.iterator](){return r.entries()},replace(s){const n=new Map,o=new Set(r.keys()),a={op:5,ops:[]};for(const c of s){if(!(c instanceof i))throw new fp(c.id);const l=t(c).controllerId;if(l!==e.controllerId)throw new kW(c.id,l,e.controllerId);if(n.has(c.id))throw new xW(c.id);n.set(c.id,c),o.delete(c.id),a.ops.push({op:0,item:c})}for(const c of o.keys())a.ops.push({op:3,id:c});e.listener?.(a),r=n},add(s){if(!(s instanceof i))throw new fp(s.id);r.set(s.id,s),e.listener?.({op:0,item:s})},delete(s){r.delete(s)&&e.listener?.({op:3,id:s})},get(s){return r.get(s)},toJSON(){return Array.from(r.values())}}},G6=new WeakMap,$W=(e,t)=>{const i={controllerId:t};return G6.set(e,i),i},pp=e=>{const t=G6.get(e);if(!t)throw new fp(e?.id||"<unknown>");return t},IW=H("remoteAuthorityResolverService"),Z6;(function(e){e[e.WebSocket=0]="WebSocket",e[e.Managed=1]="Managed"})(Z6||(Z6={}));var J6=class{constructor(e){this.id=e,this.type=1}toString(){return`Managed(${this.id})`}},DW=class{constructor(e,t){this.host=e,this.port=t,this.type=0}toString(){return`WebSocket(${this.host}:${this.port})`}},Ui;(function(e){e.Unknown="Unknown",e.NotAvailable="NotAvailable",e.TemporarilyNotAvailable="TemporarilyNotAvailable",e.NoResolverFound="NoResolverFound",e.InvalidAuthority="InvalidAuthority"})(Ui||(Ui={}));var Iw=class Va extends Wr{static isNotAvailable(t){return t instanceof Va&&t._code===Ui.NotAvailable}static isTemporarilyNotAvailable(t){return t instanceof Va&&t._code===Ui.TemporarilyNotAvailable}static isNoResolverFound(t){return t instanceof Va&&t._code===Ui.NoResolverFound}static isInvalidAuthority(t){return t instanceof Va&&t._code===Ui.InvalidAuthority}static isHandled(t){return t instanceof Va&&t.isHandled}constructor(t,i=Ui.Unknown,r){super(t),this._message=t,this._code=i,this._detail=r,this.isHandled=i===Ui.NotAvailable&&r===!0,Object.setPrototypeOf(this,Va.prototype)}};function Q6(e){const t=e.indexOf("+");return t===-1?e:e.substring(0,t)}function le(e){return Object.assign(e,{apply:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const r=i.length===1?[]:i[1];return Reflect.construct(e,r,i[0].constructor)}},call:function(...i){if(i.length===0)return Reflect.construct(e,[]);{const[r,...s]=i;return Reflect.construct(e,s,r.constructor)}}})}var Dw,ji=Dw=class{#e;static isMarkdownString(t){return t instanceof Dw?!0:!t||typeof t!="object"?!1:t.appendCodeblock&&t.appendMarkdown&&t.appendText&&t.value!==void 0}constructor(t,i=!1){this.#e=new qn(t,{supportThemeIcons:i})}get value(){return this.#e.value}set value(t){this.#e.value=t}get isTrusted(){return this.#e.isTrusted}set isTrusted(t){this.#e.isTrusted=t}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(t){this.#e.supportThemeIcons=t}get supportHtml(){return this.#e.supportHtml}set supportHtml(t){this.#e.supportHtml=t}get supportAlertSyntax(){return this.#e.supportAlertSyntax}set supportAlertSyntax(t){this.#e.supportAlertSyntax=t}get baseUri(){return this.#e.baseUri}set baseUri(t){this.#e.baseUri=t}appendText(t){return this.#e.appendText(t),this}appendMarkdown(t){return this.#e.appendMarkdown(t),this}appendCodeblock(t,i){return this.#e.appendCodeblock(i??"",t),this}};ji=Dw=__decorate([le],ji);var oa,Pe=oa=class{static Min(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let r=1;r<t.length;r++){const s=t[r];s.isBefore(i)&&(i=s)}return i}static Max(...t){if(t.length===0)throw new TypeError;let i=t[0];for(let r=1;r<t.length;r++){const s=t[r];s.isAfter(i)&&(i=s)}return i}static isPosition(t){if(!t)return!1;if(t instanceof oa)return!0;const{line:i,character:r}=t;return typeof i=="number"&&typeof r=="number"}static of(t){if(t instanceof oa)return t;if(this.isPosition(t))return new oa(t.line,t.character);throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this.a}get character(){return this.b}constructor(t,i){if(t<0)throw $e("line must be non-negative");if(i<0)throw $e("character must be non-negative");this.a=t,this.b=i}isBefore(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<t.b}isBeforeOrEqual(t){return this.a<t.a?!0:t.a<this.a?!1:this.b<=t.b}isAfter(t){return!this.isBeforeOrEqual(t)}isAfterOrEqual(t){return!this.isBefore(t)}isEqual(t){return this.a===t.a&&this.b===t.b}compareTo(t){return this.a<t.a?-1:this.a>t.line?1:this.b<t.b?-1:this.b>t.b?1:0}translate(t,i=0){if(t===null||i===null)throw $e();let r;return typeof t>"u"?r=0:typeof t=="number"?r=t:(r=typeof t.lineDelta=="number"?t.lineDelta:0,i=typeof t.characterDelta=="number"?t.characterDelta:0),r===0&&i===0?this:new oa(this.line+r,this.character+i)}with(t,i=this.character){if(t===null||i===null)throw $e();let r;return typeof t>"u"?r=this.line:typeof t=="number"?r=t:(r=typeof t.line=="number"?t.line:this.line,i=typeof t.character=="number"?t.character:this.character),r===this.line&&i===this.character?this:new oa(r,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};Pe=oa=__decorate([le],Pe);var sn,xe=sn=class{static isRange(t){return t instanceof sn?!0:!t||typeof t!="object"?!1:Pe.isPosition(t.start)&&Pe.isPosition(t.end)}static of(t){if(t instanceof sn)return t;if(this.isRange(t))return new sn(t.start,t.end);throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this.a}get end(){return this.b}constructor(t,i,r,s){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof s=="number"?(n=new Pe(t,i),o=new Pe(r,s)):Pe.isPosition(t)&&Pe.isPosition(i)&&(n=Pe.of(t),o=Pe.of(i)),!n||!o)throw new Error("Invalid arguments");n.isBefore(o)?(this.a=n,this.b=o):(this.a=o,this.b=n)}contains(t){return sn.isRange(t)?this.contains(t.start)&&this.contains(t.end):Pe.isPosition(t)?!(Pe.of(t).isBefore(this.a)||this.b.isBefore(t)):!1}isEqual(t){return this.a.isEqual(t.a)&&this.b.isEqual(t.b)}intersection(t){const i=Pe.Max(t.start,this.a),r=Pe.Min(t.end,this.b);if(!i.isAfter(r))return new sn(i,r)}union(t){if(this.contains(t))return this;if(t.contains(this))return t;const i=Pe.Min(t.start,this.a),r=Pe.Max(t.end,this.end);return new sn(i,r)}get isEmpty(){return this.a.isEqual(this.b)}get isSingleLine(){return this.a.line===this.b.line}with(t,i=this.end){if(t===null||i===null)throw $e();let r;return t?Pe.isPosition(t)?r=t:(r=t.start||this.start,i=t.end||this.end):r=this.start,r.isEqual(this.a)&&i.isEqual(this.end)?this:new sn(r,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return Y6(this)}};xe=sn=__decorate([le],xe);function Y6(e){return e.isEmpty?`[${e.start.line}:${e.start.character})`:`[${e.start.line}:${e.start.character} -> ${e.end.line}:${e.end.character})`}var ju,kt=class{static{ju=this}static{this.a="."}constructor(t){this.value=t}append(t){return new ju(this.value?this.value+ju.a+t:t)}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+ju.a)}};kt=ju=__decorate([le],kt),kt.Empty=new kt(""),kt.QuickFix=kt.Empty.append("quickfix"),kt.Refactor=kt.Empty.append("refactor"),kt.RefactorExtract=kt.Refactor.append("extract"),kt.RefactorInline=kt.Refactor.append("inline"),kt.RefactorMove=kt.Refactor.append("move"),kt.RefactorRewrite=kt.Refactor.append("rewrite"),kt.Source=kt.Empty.append("source"),kt.SourceOrganizeImports=kt.Source.append("organizeImports"),kt.SourceFixAll=kt.Source.append("fixAll"),kt.Notebook=kt.Empty.append("notebook");var aa;(function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"})(aa||(aa={}));var pi;(function(e){e[e.Hint=3]="Hint",e[e.Information=2]="Information",e[e.Warning=1]="Warning",e[e.Error=0]="Error"})(pi||(pi={}));var zu=class{static is(t){return t?typeof t.message=="string"&&t.location&&xe.isRange(t.location.range)&&y.isUri(t.location.uri):!1}constructor(t,i){this.location=t,this.message=i}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.location.range.isEqual(i.location.range)&&t.location.uri.toString()===i.location.uri.toString()}};zu=__decorate([le],zu);var gp=class{constructor(t,i,r=pi.Error){if(!xe.isRange(t))throw new TypeError("range must be set");if(!i)throw new TypeError("message must be set");this.range=t,this.message=i,this.severity=r}toJSON(){return{severity:pi[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(t,i){return t===i?!0:!t||!i?!1:t.message===i.message&&t.severity===i.severity&&t.code===i.code&&t.severity===i.severity&&t.source===i.source&&t.range.isEqual(i.range)&&Gi(t.tags,i.tags)&&Gi(t.relatedInformation,i.relatedInformation,zu.isEqual)}};gp=__decorate([le],gp);var Pw,rr=Pw=class{static isLocation(t){return t instanceof Pw?!0:t?xe.isRange(t.range)&&y.isUri(t.uri):!1}constructor(t,i){if(this.uri=t,i)if(xe.isRange(i))this.range=xe.of(i);else if(Pe.isPosition(i))this.range=new xe(i,i);else throw new Error("Illegal argument")}toJSON(){return{uri:this.uri,range:this.range}}};rr=Pw=__decorate([le],rr);var ro,ca;(function(e){e[e.Markup=1]="Markup",e[e.Code=2]="Code"})(ca||(ca={}));var ks=class b5{static isNotebookRange(t){return t instanceof b5?!0:t?typeof t.start=="number"&&typeof t.end=="number":!1}get start(){return this.a}get end(){return this.b}get isEmpty(){return this.a===this.b}constructor(t,i){if(t<0)throw $e("start must be positive");if(i<0)throw $e("end must be positive");t<=i?(this.a=t,this.b=i):(this.a=i,this.b=t)}with(t){let i=this.a,r=this.b;return t.start!==void 0&&(i=t.start),t.end!==void 0&&(r=t.end),i===this.a&&r===this.b?this:new b5(i,r)}},mp=class y5{static validate(t){if(typeof t.kind!="number")throw new Error("NotebookCellData MUST have 'kind' property");if(typeof t.value!="string")throw new Error("NotebookCellData MUST have 'value' property");if(typeof t.languageId!="string")throw new Error("NotebookCellData MUST have 'languageId' property")}static isNotebookCellDataArray(t){return Array.isArray(t)&&t.every(i=>y5.isNotebookCellData(i))}static isNotebookCellData(t){return!0}constructor(t,i,r,s,n,o,a){this.kind=t,this.value=i,this.languageId=r,this.mime=s,this.outputs=n??[],this.metadata=o,this.executionSummary=a,y5.validate(this)}},X6=class{constructor(e){this.cells=e}},vp=ro=class{static isNotebookCellEdit(t){return t instanceof ro?!0:t?ks.isNotebookRange(t)&&Array.isArray(t.newCells):!1}static replaceCells(t,i){return new ro(t,i)}static insertCells(t,i){return new ro(new ks(t,t),i)}static deleteCells(t){return new ro(t,[])}static updateCellMetadata(t,i){const r=new ro(new ks(t,t),[]);return r.newCellMetadata=i,r}static updateNotebookMetadata(t){const i=new ro(new ks(0,0),[]);return i.newNotebookMetadata=t,i}constructor(t,i){this.range=t,this.newCells=i}};vp=ro=__decorate([le],vp);var K6=class Sn{static isNotebookCellOutputItem(t){return t instanceof Sn?!0:t?typeof t.mime=="string"&&t.data instanceof Uint8Array:!1}static error(t){const i={name:t.name,message:t.message,stack:t.stack};return Sn.json(i,"application/vnd.code.notebook.error")}static stdout(t){return Sn.text(t,"application/vnd.code.notebook.stdout")}static stderr(t){return Sn.text(t,"application/vnd.code.notebook.stderr")}static bytes(t,i="application/octet-stream"){return new Sn(t,i)}static#e=new TextEncoder;static text(t,i=Zr.text){const r=Sn.#e.encode(String(t));return new Sn(r,i)}static json(t,i="text/x-json"){const r=JSON.stringify(t,void 0,"	");return Sn.text(r,i)}constructor(t,i){this.data=t,this.mime=i;const r=GC(i,!0);if(!r)throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`);this.mime=r}},wp=class A5{static isNotebookCellOutput(t){return t instanceof A5?!0:!t||typeof t!="object"?!1:typeof t.id=="string"&&Array.isArray(t.items)}static ensureUniqueMimeTypes(t,i=!1){const r=new Set,s=new Set;for(let n=0;n<t.length;n++){const o=t[n],a=GC(o.mime);if(!r.has(a)||ZC(a)){r.add(a);continue}s.add(n),i&&console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}return s.size===0?t:t.filter((n,o)=>!s.has(o))}constructor(t,i,r){this.items=A5.ensureUniqueMimeTypes(t,!0),typeof i=="string"?(this.id=i,this.metadata=r):(this.id=Tt(),this.metadata=i??r)}},Tw,Cs=Tw=class extends xe{static isSelection(t){return t instanceof Tw?!0:!t||typeof t!="object"?!1:xe.isRange(t)&&Pe.isPosition(t.anchor)&&Pe.isPosition(t.active)&&typeof t.isReversed=="boolean"}get anchor(){return this.c}get active(){return this.d}constructor(t,i,r,s){let n,o;if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof s=="number"?(n=new Pe(t,i),o=new Pe(r,s)):Pe.isPosition(t)&&Pe.isPosition(i)&&(n=Pe.of(t),o=Pe.of(i)),!n||!o)throw new Error("Invalid arguments");super(n,o),this.c=n,this.d=o}get isReversed(){return this.c===this.b}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return PW(this)}};Cs=Tw=__decorate([le],Cs);function PW(e){let t=Y6(e);return e.isEmpty||(e.active.isEqual(e.start)?t=`|${t}`:t=`${t}|`),t}var la,ua=la=class{static isSnippetString(t){return t instanceof la?!0:!t||typeof t!="object"?!1:typeof t.value=="string"}static a(t){return t.replace(/\$|}|\\/g,"\\$&")}constructor(t){this.b=1,this.value=t||""}appendText(t){return this.value+=la.a(t),this}appendTabstop(t=this.b++){return this.value+="$",this.value+=t,this}appendPlaceholder(t,i=this.b++){if(typeof t=="function"){const r=new la;r.b=this.b,t(r),this.b=r.b,t=r.value}else t=la.a(t);return this.value+="${",this.value+=i,this.value+=":",this.value+=t,this.value+="}",this}appendChoice(t,i=this.b++){const r=t.map(s=>s.replaceAll(/[|\\,]/g,"\\$&")).join(",");return this.value+="${",this.value+=i,this.value+="|",this.value+=r,this.value+="|}",this}appendVariable(t,i){if(typeof i=="function"){const r=new la;r.b=this.b,i(r),this.b=r.b,i=r.value}else typeof i=="string"&&(i=i.replace(/\$|}/g,"\\$&"));return this.value+="${",this.value+=t,i&&(this.value+=":",this.value+=i),this.value+="}",this}};ua=la=__decorate([le],ua);var Mw=class Z1{static isSnippetTextEdit(t){return t instanceof Z1?!0:t?xe.isRange(t.range)&&ua.isSnippetString(t.snippet):!1}static replace(t,i){return new Z1(t,i)}static insert(t,i){return Z1.replace(new xe(t,t),i)}constructor(t,i){this.range=t,this.snippet=i}},Nw,ut;(function(e){e[e.File=0]="File",e[e.Module=1]="Module",e[e.Namespace=2]="Namespace",e[e.Package=3]="Package",e[e.Class=4]="Class",e[e.Method=5]="Method",e[e.Property=6]="Property",e[e.Field=7]="Field",e[e.Constructor=8]="Constructor",e[e.Enum=9]="Enum",e[e.Interface=10]="Interface",e[e.Function=11]="Function",e[e.Variable=12]="Variable",e[e.Constant=13]="Constant",e[e.String=14]="String",e[e.Number=15]="Number",e[e.Boolean=16]="Boolean",e[e.Array=17]="Array",e[e.Object=18]="Object",e[e.Key=19]="Key",e[e.Null=20]="Null",e[e.EnumMember=21]="EnumMember",e[e.Struct=22]="Struct",e[e.Event=23]="Event",e[e.Operator=24]="Operator",e[e.TypeParameter=25]="TypeParameter"})(ut||(ut={}));var Hu;(function(e){e[e.Deprecated=1]="Deprecated"})(Hu||(Hu={}));var Wu=Nw=class{static validate(t){if(!t.name)throw new Error("name must not be falsy")}constructor(t,i,r,s,n){this.name=t,this.kind=i,this.containerName=n,typeof r=="string"&&(this.containerName=r),s instanceof rr?this.location=s:r instanceof xe&&(this.location=new rr(s,r)),Nw.validate(this)}toJSON(){return{name:this.name,kind:ut[this.kind],location:this.location,containerName:this.containerName}}};Wu=Nw=__decorate([le],Wu);var ha,ts;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(ts||(ts={}));var so=ha=class{static isTextEdit(t){return t instanceof ha?!0:!t||typeof t!="object"?!1:xe.isRange(t)&&typeof t.newText=="string"}static replace(t,i){return new ha(t,i)}static insert(t,i){return ha.replace(new xe(t,t),i)}static delete(t){return ha.replace(t,"")}static setEndOfLine(t){const i=new ha(new xe(new Pe(0,0),new Pe(0,0)),"");return i.newEol=t,i}get range(){return this.a}set range(t){if(t&&!xe.isRange(t))throw $e("range");this.a=t}get newText(){return this.b||""}set newText(t){if(t&&typeof t!="string")throw $e("newText");this.b=t}get newEol(){return this.c}set newEol(t){if(t&&typeof t!="number")throw $e("newEol");this.c=t}constructor(t,i){this.a=t,this.b=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this.c}}};so=ha=__decorate([le],so);var e7;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.Cell=3]="Cell",e[e.CellReplace=5]="CellReplace",e[e.Snippet=6]="Snippet"})(e7||(e7={}));var da=class{constructor(){this.a=[]}_allEntries(){return this.a}renameFile(t,i,r,s){this.a.push({_type:1,from:t,to:i,options:r,metadata:s})}createFile(t,i,r){this.a.push({_type:1,from:void 0,to:t,options:i,metadata:r})}deleteFile(t,i,r){this.a.push({_type:1,from:t,to:void 0,options:i,metadata:r})}b(t,i,r){this.a.push({_type:3,metadata:r,uri:t,edit:{editType:5,metadata:i}})}c(t,i,r,s){const n=i.start,o=i.end;(n!==o||r.length>0)&&this.a.push({_type:5,uri:t,index:n,count:o-n,cells:r,metadata:s})}d(t,i,r,s){this.a.push({_type:3,metadata:s,uri:t,edit:{editType:3,index:i,metadata:r}})}replace(t,i,r,s){this.a.push({_type:2,uri:t,edit:new so(i,r),metadata:s})}insert(t,i,r,s){this.replace(t,new xe(i,i),r,s)}delete(t,i,r){this.replace(t,i,"",r)}has(t){return this.a.some(i=>i._type===2&&i.uri.toString()===t.toString())}set(t,i){if(i)for(const r of i){if(!r)continue;let s,n;Array.isArray(r)?(s=r[0],n=r[1]):s=r,vp.isNotebookCellEdit(s)?s.newCellMetadata?this.d(t,s.range.start,s.newCellMetadata,n):s.newNotebookMetadata?this.b(t,s.newNotebookMetadata,n):this.c(t,s.range,s.newCells,n):Mw.isSnippetTextEdit(s)?this.a.push({_type:6,uri:t,range:s.range,edit:s.snippet,metadata:n,keepWhitespace:s.keepWhitespace}):this.a.push({_type:2,uri:t,edit:s,metadata:n})}else{for(let r=0;r<this.a.length;r++){const s=this.a[r];switch(s._type){case 2:case 6:case 3:case 5:s.uri.toString()===t.toString()&&(this.a[r]=void 0);break}}HR(this.a)}}get(t){const i=[];for(const r of this.a)r._type===2&&r.uri.toString()===t.toString()&&i.push(r.edit);return i}entries(){const t=new zt;for(const i of this.a)if(i._type===2){let r=t.get(i.uri);r||(r=[i.uri,[]],t.set(i.uri,r)),r[1].push(i.edit)}return[...t.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};da=__decorate([le],da);var Rw,bp,$s,Is,Lw,zi,Ow,Fw;(function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"})(Fw||(Fw={}));var t7;(function(e){e[e.TerminalCommand=0]="TerminalCommand",e[e.Opener=1]="Opener",e[e.Command=3]="Command"})(t7||(t7={}));var ke=Rw=class{static from(...t){let i=t;return new Rw(function(){if(i){for(const r of i)r&&typeof r.dispose=="function"&&r.dispose();i=void 0}})}#e;constructor(t){this.#e=t}dispose(){typeof this.#e=="function"&&(this.#e(),this.#e=void 0)}};ke=Rw=__decorate([le],ke);var i7=e=>{if(typeof e!="string"||e.length===0||!/^[0-9A-Za-z_\-]+$/.test(e))throw $e("connectionToken")},TW=class{static isResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.host=="string"&&typeof e.port=="number"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t,i){if(typeof e!="string"||e.length===0)throw $e("host");if(typeof t!="number"||t===0||Math.round(t)!==t)throw $e("port");typeof i<"u"&&i7(i),this.host=e,this.port=Math.round(t),this.connectionToken=i}},yp=class{static isManagedResolvedAuthority(e){return e&&typeof e=="object"&&typeof e.makeConnection=="function"&&(e.connectionToken===void 0||typeof e.connectionToken=="string")}constructor(e,t){this.makeConnection=e,this.connectionToken=t,typeof t<"u"&&i7(t)}},$c=class J1 extends Error{static NotAvailable(t,i){return new J1(t,Ui.NotAvailable,i)}static TemporarilyNotAvailable(t){return new J1(t,Ui.TemporarilyNotAvailable)}constructor(t,i=Ui.Unknown,r){super(t),this._message=t,this._code=i,this._detail=r,Object.setPrototypeOf(this,J1.prototype)}},Ic;(function(e){e[e.Replace=1]="Replace",e[e.Append=2]="Append",e[e.Prepend=3]="Prepend"})(Ic||(Ic={}));var Ap=class{constructor(t,i){if(!t)throw new Error("Illegal argument, contents must be defined");Array.isArray(t)?this.contents=t:this.contents=[t],this.range=i}};Ap=__decorate([le],Ap);var Sp=class extends Ap{constructor(t,i,r,s){super(t,i),this.canIncreaseVerbosity=r,this.canDecreaseVerbosity=s}};Sp=__decorate([le],Sp);var Uw;(function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"})(Uw||(Uw={}));var Bu;(function(e){e[e.Text=0]="Text",e[e.Read=1]="Read",e[e.Write=2]="Write"})(Bu||(Bu={}));var Ep=class{constructor(t,i=Bu.Text){this.range=t,this.kind=i}toJSON(){return{range:this.range,kind:Bu[this.kind]}}};Ep=__decorate([le],Ep);var xp=class{constructor(t,i){this.uri=t,this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(t=>t.toJSON())}}};xp=__decorate([le],xp);var _u=bp=class{static validate(t){if(!t.name)throw new Error("name must not be falsy");if(!t.range.contains(t.selectionRange))throw new Error("selectionRange must be contained in fullRange");t.children?.forEach(bp.validate)}constructor(t,i,r,s,n){this.name=t,this.detail=i,this.kind=r,this.range=s,this.selectionRange=n,this.children=[],bp.validate(this)}};_u=bp=__decorate([le],_u);var Vu;(function(e){e[e.Invoke=1]="Invoke",e[e.Automatic=2]="Automatic"})(Vu||(Vu={}));var qu=class{constructor(t,i){this.title=t,this.kind=i}};qu=__decorate([le],qu);var Gu=class{constructor(t,i){if(this.range=t,this.parent=i,i&&!i.range.contains(this.range))throw new Error("Invalid argument: parent must contain this range")}};Gu=__decorate([le],Gu);var jw=class{constructor(e,t,i,r,s,n){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=s,this.selectionRange=n}},r7=class{constructor(e,t){this.fromRanges=t,this.from=e}},s7=class{constructor(e,t){this.fromRanges=t,this.to=e}},Dc;(function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(Dc||(Dc={}));var kp=class{constructor(t,i){this.range=t,this.command=i}get isResolved(){return!!this.command}};kp=__decorate([le],kp);var zw=class{constructor(t,i){this.label=t,this.documentation=i}};zw=__decorate([le],zw);var Hw=class{constructor(t,i){this.label=t,this.documentation=i,this.parameters=[]}};Hw=__decorate([le],Hw);var Ww=class{constructor(){this.activeSignature=0,this.activeParameter=0,this.signatures=[]}};Ww=__decorate([le],Ww);var Bw;(function(e){e[e.Invoke=1]="Invoke",e[e.TriggerCharacter=2]="TriggerCharacter",e[e.ContentChange=3]="ContentChange"})(Bw||(Bw={}));var _w;(function(e){e[e.Type=1]="Type",e[e.Parameter=2]="Parameter"})(_w||(_w={}));var Cp=class{constructor(t){this.value=t}};Cp=__decorate([le],Cp);var $p=class{constructor(t,i,r){this.position=t,this.label=i,this.kind=r}};$p=__decorate([le],$p);var Pc;(function(e){e[e.Invoke=0]="Invoke",e[e.TriggerCharacter=1]="TriggerCharacter",e[e.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(Pc||(Pc={}));var ve;(function(e){e[e.Text=0]="Text",e[e.Method=1]="Method",e[e.Function=2]="Function",e[e.Constructor=3]="Constructor",e[e.Field=4]="Field",e[e.Variable=5]="Variable",e[e.Class=6]="Class",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Unit=10]="Unit",e[e.Value=11]="Value",e[e.Enum=12]="Enum",e[e.Keyword=13]="Keyword",e[e.Snippet=14]="Snippet",e[e.Color=15]="Color",e[e.File=16]="File",e[e.Reference=17]="Reference",e[e.Folder=18]="Folder",e[e.EnumMember=19]="EnumMember",e[e.Constant=20]="Constant",e[e.Struct=21]="Struct",e[e.Event=22]="Event",e[e.Operator=23]="Operator",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue"})(ve||(ve={}));var Zu;(function(e){e[e.Deprecated=1]="Deprecated"})(Zu||(Zu={}));var Ip=class{constructor(t,i){this.label=t,this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&ve[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};Ip=__decorate([le],Ip);var Tc=class{constructor(t=[],i=!1){this.items=t,this.isIncomplete=i}};Tc=__decorate([le],Tc);var Vw=class{constructor(t,i,r){this.insertText=t,this.range=i,this.command=r}};Vw=__decorate([le],Vw);var qw=class{constructor(t){this.commands=void 0,this.suppressSuggestions=void 0,this.items=t}};qw=__decorate([le],qw);var fa;(function(e){e[e.Unknown=0]="Unknown",e[e.Word=1]="Word",e[e.Line=2]="Line",e[e.Suggest=3]="Suggest"})(fa||(fa={}));var Mc;(function(e){e[e.Accepted=0]="Accepted",e[e.Rejected=1]="Rejected",e[e.Ignored=2]="Ignored"})(Mc||(Mc={}));var Nc;(function(e){e[e.Code=1]="Code",e[e.Label=2]="Label"})(Nc||(Nc={}));var Ju;(function(e){e[e.Active=-1]="Active",e[e.Beside=-2]="Beside",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e[e.Six=6]="Six",e[e.Seven=7]="Seven",e[e.Eight=8]="Eight",e[e.Nine=9]="Nine"})(Ju||(Ju={}));var no;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(no||(no={}));function MW(e,t){return`${Ye.toKey(e)}.${t}`}var is;(function(e){e[e.Off=0]="Off",e[e.On=1]="On",e[e.Relative=2]="Relative",e[e.Interval=3]="Interval"})(is||(is={}));var Rc;(function(e){e[e.Manual=1]="Manual",e[e.AfterDelay=2]="AfterDelay",e[e.FocusOut=3]="FocusOut"})(Rc||(Rc={}));var Dp;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Dp||(Dp={}));var Lc;(function(e){e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Command=3]="Command"})(Lc||(Lc={}));var Oc;(function(e){e[e.Addition=1]="Addition",e[e.Deletion=2]="Deletion",e[e.Modification=3]="Modification"})(Oc||(Oc={}));var Qu;(function(e){e[e.Undo=1]="Undo",e[e.Redo=2]="Redo"})(Qu||(Qu={}));var pa;(function(e){e[e.OpenOpen=0]="OpenOpen",e[e.ClosedClosed=1]="ClosedClosed",e[e.OpenClosed=2]="OpenClosed",e[e.ClosedOpen=3]="ClosedOpen"})(pa||(pa={})),function(e){function t(i){switch(i){case"keyboard":return e.Keyboard;case"mouse":return e.Mouse;case"api":case"code.jump":case"code.navigation":return e.Command}}e.fromValue=t}(Lc||(Lc={}));var Fc;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(Fc||(Fc={})),function(e){function t(i){switch(i){case e.Other:return"other";case e.Comment:return"comment";case e.String:return"string";case e.RegEx:return"regex"}return"other"}e.toString=t}(Fc||(Fc={}));var Pp=class{constructor(t,i){if(i&&!y.isUri(i))throw $e("target");if(!xe.isRange(t)||t.isEmpty)throw $e("range");this.range=t,this.target=i}};Pp=__decorate([le],Pp);var Uc=class{constructor(t,i,r,s){this.red=t,this.green=i,this.blue=r,this.alpha=s}};Uc=__decorate([le],Uc);var Tp=class{constructor(t,i){if(i&&!(i instanceof Uc))throw $e("color");if(!xe.isRange(t)||t.isEmpty)throw $e("range");this.range=t,this.color=i}};Tp=__decorate([le],Tp);var Mp=class{constructor(t){if(!t||typeof t!="string")throw $e("label");this.label=t}};Mp=__decorate([le],Mp);var n7;(function(e){e[e.RGB=0]="RGB",e[e.HEX=1]="HEX",e[e.HSL=2]="HSL"})(n7||(n7={}));var jc;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information"})(jc||(jc={}));var Gw;(function(e){e[e.Unknown=0]="Unknown",e[e.Shutdown=1]="Shutdown",e[e.Process=2]="Process",e[e.User=3]="User",e[e.Extension=4]="Extension"})(Gw||(Gw={}));var Yu;(function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"})(Yu||(Yu={}));var Zw;(function(e){e[e.Sh=1]="Sh",e[e.Bash=2]="Bash",e[e.Fish=3]="Fish",e[e.Csh=4]="Csh",e[e.Ksh=5]="Ksh",e[e.Zsh=6]="Zsh",e[e.CommandPrompt=7]="CommandPrompt",e[e.GitBash=8]="GitBash",e[e.PowerShell=9]="PowerShell",e[e.Python=10]="Python",e[e.Julia=11]="Julia",e[e.NuShell=12]="NuShell",e[e.Node=13]="Node"})(Zw||(Zw={}));var NW=class{constructor(e,t,i){if(this.startIndex=e,this.length=t,this.tooltip=i,typeof e!="number"||e<0)throw $e("startIndex");if(typeof t!="number"||t<1)throw $e("length");if(i!==void 0&&typeof i!="string")throw $e("tooltip")}},RW=class{constructor(e){this.uri=e}},LW=class{constructor(e){this.terminalCommand=e}},Jw;(function(e){e[e.Panel=1]="Panel",e[e.Editor=2]="Editor"})(Jw||(Jw={}));var OW=class{constructor(e){if(this.options=e,typeof e!="object")throw $e("options")}},Qw;(function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Method=2]="Method",e[e.Alias=3]="Alias",e[e.Argument=4]="Argument",e[e.Option=5]="Option",e[e.OptionValue=6]="OptionValue",e[e.Flag=7]="Flag",e[e.SymbolicLinkFile=8]="SymbolicLinkFile",e[e.SymbolicLinkFolder=9]="SymbolicLinkFolder",e[e.ScmCommit=10]="ScmCommit",e[e.ScmBranch=11]="ScmBranch",e[e.ScmTag=12]="ScmTag",e[e.ScmStash=13]="ScmStash",e[e.ScmRemote=14]="ScmRemote",e[e.PullRequest=15]="PullRequest",e[e.PullRequestDone=16]="PullRequestDone"})(Qw||(Qw={}));var FW=class{constructor(e,t,i,r,s,n,o,a){this.label=e,this.replacementRange=t,this.kind=i,this.detail=r,this.documentation=s,this.isFile=n,this.isDirectory=o,this.isKeyword=a}},UW=class{constructor(e,t){this.items=e??[],this.resourceOptions=t}},Yw;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(Yw||(Yw={}));var Xw;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(Xw||(Xw={}));var Kw;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(Kw||(Kw={}));var Xu=class{static{$s=this}static{this.Clean=new $s("clean","Clean")}static{this.Build=new $s("build","Build")}static{this.Rebuild=new $s("rebuild","Rebuild")}static{this.Test=new $s("test","Test")}static from(t){switch(t){case"clean":return $s.Clean;case"build":return $s.Build;case"rebuild":return $s.Rebuild;case"test":return $s.Test;default:return}}constructor(t,i){if(this.label=i,typeof t!="string"||typeof i!="string")throw $e("name");this.c=t}get id(){return this.c}};Xu=$s=__decorate([le],Xu);function o7(e){let t="";for(let i=0;i<e.length;i++)t+=e[i].replace(/,/g,",,")+",";return t}var zc=class{constructor(t,i,r){if(typeof t!="string")throw $e("process");this.e=[],this.c=t,i!==void 0&&(Array.isArray(i)?(this.e=i,this.f=r):this.f=i)}get process(){return this.c}set process(t){if(typeof t!="string")throw $e("process");this.c=t}get args(){return this.e}set args(t){Array.isArray(t)||(t=[]),this.e=t}get options(){return this.f}set options(t){this.f=t}computeId(){const t=[];if(t.push("process"),this.c!==void 0&&t.push(this.c),this.e&&this.e.length>0)for(const i of this.e)t.push(i);return o7(t)}};zc=__decorate([le],zc);var ga=class{constructor(t,i,r){if(this.f=[],Array.isArray(i)){if(!t)throw $e("command can't be undefined or null");if(typeof t!="string"&&typeof t.value!="string")throw $e("command");this.e=t,i&&(this.f=i),this.g=r}else{if(typeof t!="string")throw $e("commandLine");this.c=t,this.g=i}}get commandLine(){return this.c}set commandLine(t){if(typeof t!="string")throw $e("commandLine");this.c=t}get command(){return this.e?this.e:""}set command(t){if(typeof t!="string"&&typeof t.value!="string")throw $e("command");this.e=t}get args(){return this.f}set args(t){this.f=t||[]}get options(){return this.g}set options(t){this.g=t}computeId(){const t=[];if(t.push("shell"),this.c!==void 0&&t.push(this.c),this.e!==void 0&&t.push(typeof this.e=="string"?this.e:this.e.value),this.f&&this.f.length>0)for(const i of this.f)t.push(typeof i=="string"?i:i.value);return o7(t)}};ga=__decorate([le],ga);var eb;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})(eb||(eb={}));var oo;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace"})(oo||(oo={}));var tb=class{constructor(e){this.c=e}computeId(){return"customExecution"+Tt()}set callback(e){this.c=e}get callback(){return this.c}},Np=class{static{Is=this}static{this.c="customExecution"}static{this.e="process"}static{this.f="shell"}static{this.g="$empty"}constructor(t,i,r,s,n,o){this.k=!1,this.l=this.definition=t;let a;typeof i=="string"?(this.o=this.name=i,this.u=this.source=r,this.execution=s,a=n,this.k=!0):i===oo.Global||i===oo.Workspace?(this.target=i,this.o=this.name=r,this.u=this.source=s,this.execution=n,a=o):(this.target=i,this.o=this.name=r,this.u=this.source=s,this.execution=n,a=o),typeof a=="string"?(this.q=[a],this.r=!0):Array.isArray(a)?(this.q=a,this.r=!0):(this.q=[],this.r=!1),this.t=!1,this.x=Object.create(null),this.y=Object.create(null)}get _id(){return this.j}set _id(t){this.j=t}get _deprecated(){return this.k}A(){this.j!==void 0&&(this.j=void 0,this.m=void 0,this.B())}B(){this.p instanceof zc?this.l={type:Is.e,id:this.p.computeId()}:this.p instanceof ga?this.l={type:Is.f,id:this.p.computeId()}:this.p instanceof tb?this.l={type:Is.c,id:this.p.computeId()}:this.l={type:Is.g,id:Tt()}}get definition(){return this.l}set definition(t){if(t==null)throw $e("Kind can't be undefined or null");this.A(),this.l=t}get scope(){return this.m}set target(t){this.A(),this.m=t}get name(){return this.o}set name(t){if(typeof t!="string")throw $e("name");this.A(),this.o=t}get execution(){return this.p}set execution(t){t===null&&(t=void 0),this.A(),this.p=t;const i=this.l.type;(Is.g===i||Is.e===i||Is.f===i||Is.c===i)&&this.B()}get problemMatchers(){return this.q}set problemMatchers(t){if(Array.isArray(t))this.A(),this.q=t,this.r=!0;else{this.A(),this.q=[],this.r=!1;return}}get hasDefinedMatchers(){return this.r}get isBackground(){return this.t}set isBackground(t){t!==!0&&t!==!1&&(t=!1),this.A(),this.t=t}get source(){return this.u}set source(t){if(typeof t!="string"||t.length===0)throw $e("source must be a string of length > 0");this.A(),this.u=t}get group(){return this.w}set group(t){t===null&&(t=void 0),this.A(),this.w=t}get detail(){return this.z}set detail(t){t===null&&(t=void 0),this.z=t}get presentationOptions(){return this.x}set presentationOptions(t){t==null&&(t=Object.create(null)),this.A(),this.x=t}get runOptions(){return this.y}set runOptions(t){t==null&&(t=Object.create(null)),this.A(),this.y=t}};Np=Is=__decorate([le],Np);var ao;(function(e){e[e.SourceControl=1]="SourceControl",e[e.Window=10]="Window",e[e.Notification=15]="Notification"})(ao||(ao={}));var ib;(function(e){function t(i){const r=i;return Er(r.value)?r.tooltip&&!Oe(r.tooltip)?(console.log("INVALID view badge, invalid tooltip",r.tooltip),!1):!0:(console.log("INVALID view badge, invalid value",r.value),!1)}e.isViewBadge=t})(ib||(ib={}));var Rp=Lw=class{static isTreeItem(t,i){const r=t;if(r.checkboxState!==void 0){const s=Er(r.checkboxState)?r.checkboxState:yt(r.checkboxState)&&Er(r.checkboxState.state)?r.checkboxState.state:void 0,n=!Er(r.checkboxState)&&yt(r.checkboxState)?r.checkboxState.tooltip:void 0;if(s===void 0||s!==Ds.Checked&&s!==Ds.Unchecked||n!==void 0&&!Oe(n))return console.log("INVALID tree item, invalid checkboxState",r.checkboxState),!1}if(t instanceof Lw)return!0;if(r.label!==void 0&&!Oe(r.label)&&!r.label?.label)return console.log("INVALID tree item, invalid label",r.label),!1;if(r.id!==void 0&&!Oe(r.id))return console.log("INVALID tree item, invalid id",r.id),!1;if(r.iconPath!==void 0&&!Oe(r.iconPath)&&!y.isUri(r.iconPath)&&(!r.iconPath||!Oe(r.iconPath.id))){const s=r.iconPath;if(!s||!Oe(s.light)&&!y.isUri(s.light)&&!Oe(s.dark)&&!y.isUri(s.dark))return console.log("INVALID tree item, invalid iconPath",r.iconPath),!1}return r.description!==void 0&&!Oe(r.description)&&typeof r.description!="boolean"?(console.log("INVALID tree item, invalid description",r.description),!1):r.resourceUri!==void 0&&!y.isUri(r.resourceUri)?(console.log("INVALID tree item, invalid resourceUri",r.resourceUri),!1):r.tooltip!==void 0&&!Oe(r.tooltip)&&!(r.tooltip instanceof ji)?(console.log("INVALID tree item, invalid tooltip",r.tooltip),!1):r.command!==void 0&&!r.command.command?(console.log("INVALID tree item, invalid command",r.command),!1):r.collapsibleState!==void 0&&r.collapsibleState<ma.None&&r.collapsibleState>ma.Expanded?(console.log("INVALID tree item, invalid collapsibleState",r.collapsibleState),!1):r.contextValue!==void 0&&!Oe(r.contextValue)?(console.log("INVALID tree item, invalid contextValue",r.contextValue),!1):r.accessibilityInformation!==void 0&&!r.accessibilityInformation?.label?(console.log("INVALID tree item, invalid accessibilityInformation",r.accessibilityInformation),!1):!0}constructor(t,i=ma.None){this.collapsibleState=i,y.isUri(t)?this.resourceUri=t:this.label=t}};Rp=Lw=__decorate([le],Rp);var ma;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(ma||(ma={}));var Ds;(function(e){e[e.Unchecked=0]="Unchecked",e[e.Checked=1]="Checked"})(Ds||(Ds={}));var Lp=class{async asString(){return typeof this.value=="string"?this.value:JSON.stringify(this.value)}asFile(){}constructor(t){this.value=t}};Lp=__decorate([le],Lp);var Op=class extends Lp{},jW=class extends Op{#e;constructor(e){super(""),this.#e=e}asFile(){return this.#e}},zW=class{constructor(e,t,i,r){this.name=e,this.uri=t,this._itemId=i,this.c=r}data(){return this.c()}},Hc=class{#e=new Map;constructor(t){for(const[i,r]of t??[]){const s=this.#e.get(this.#t(i));s?s.push(r):this.#e.set(this.#t(i),[r])}}get(t){return this.#e.get(this.#t(t))?.[0]}set(t,i){this.#e.set(this.#t(t),[i])}forEach(t,i){for(const[r,s]of this.#e)for(const n of s)t.call(i,n,r,this)}*[Symbol.iterator](){for(const[t,i]of this.#e)for(const r of i)yield[t,r]}#t(t){return t.toLowerCase()}};Hc=__decorate([le],Hc);var rb=class{constructor(t,i,r){this.insertText=t,this.title=i,this.kind=r}};rb=__decorate([le],rb);var sb;(function(e){e[e.Automatic=0]="Automatic",e[e.PasteAs=1]="PasteAs"})(sb||(sb={}));var co=class Q1{static{this.c="."}constructor(t){this.value=t}append(...t){return new Q1((this.value?[this.value,...t]:t).join(Q1.c))}intersects(t){return this.contains(t)||t.contains(this)}contains(t){return this.value===t.value||t.value.startsWith(this.value+Q1.c)}};co.Empty=new co(""),co.Text=new co("text"),co.TextUpdateImports=co.Text.append("updateImports");var HW=class{constructor(e,t,i){this.title=t,this.insertText=e,this.kind=i}},Di=class{constructor(t,i){this.id=t,this.color=i}static isThemeIcon(t){return typeof t.id!="string"?(console.log("INVALID ThemeIcon, invalid id",t.id),!1):!0}};Di=__decorate([le],Di),Di.File=new Di("file"),Di.Folder=new Di("folder");var Ku=class{constructor(t){this.id=t}};Ku=__decorate([le],Ku);var Wc;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.WorkspaceFolder=3]="WorkspaceFolder"})(Wc||(Wc={}));var Bc=class{get base(){return this.c}set base(t){this.c=t,this.e=y.file(t)}get baseUri(){return this.e}set baseUri(t){this.e=t,this.c=t.fsPath}constructor(t,i){if(typeof t!="string"&&(!t||!y.isUri(t)&&!y.isUri(t.uri)))throw $e("base");if(typeof i!="string")throw $e("pattern");typeof t=="string"?this.baseUri=y.file(t):y.isUri(t)?this.baseUri=t:this.baseUri=t.uri,this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Bc=__decorate([le],Bc);var a7=new WeakMap;function WW(e,t){a7.set(e,t)}var _c=class{constructor(t,i,r,s,n){this.enabled=typeof t=="boolean"?t:!0,typeof i=="string"&&(this.condition=i),typeof r=="string"&&(this.hitCondition=r),typeof s=="string"&&(this.logMessage=s),typeof n=="string"&&(this.mode=n)}get id(){return this.c||(this.c=a7.get(this)??Tt()),this.c}};_c=__decorate([le],_c);var va=class extends _c{constructor(t,i,r,s,n,o){if(super(i,r,s,n,o),t===null)throw $e("location");this.location=t}};va=__decorate([le],va);var wa=class extends _c{constructor(t,i,r,s,n,o){super(i,r,s,n,o),this.functionName=t}};wa=__decorate([le],wa);var Fp=class extends _c{constructor(t,i,r,s,n,o,a,c){if(super(s,n,o,a,c),!i)throw $e("dataId");this.label=t,this.dataId=i,this.canPersist=r}};Fp=__decorate([le],Fp);var Vc=class{constructor(t,i,r){this.command=t,this.args=i||[],this.options=r}};Vc=__decorate([le],Vc);var qc=class{constructor(t,i){this.port=t,this.host=i}};qc=__decorate([le],qc);var eh=class{constructor(t){this.path=t}};eh=__decorate([le],eh);var th=class{constructor(t){this.implementation=t}};th=__decorate([le],th);var c7=class{constructor(e,t,i){this.session=e,this.threadId=t,this.frameId=i}},l7=class{constructor(e,t){this.session=e,this.threadId=t}},Up=class{constructor(t,i){this.range=t,this.expression=i}};Up=__decorate([le],Up);var ih;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(ih||(ih={}));var nn;(function(e){e[e.Other=0]="Other",e[e.Empty=1]="Empty",e[e.TokenCancellation=2]="TokenCancellation",e[e.LostRace=3]="LostRace",e[e.NotTaken=4]="NotTaken"})(nn||(nn={}));var jp=class{constructor(t,i){this.range=t,this.text=i}};jp=__decorate([le],jp);var zp=class{constructor(t,i,r=!0){this.range=t,this.variableName=i,this.caseSensitiveLookup=r}};zp=__decorate([le],zp);var Hp=class{constructor(t,i){this.range=t,this.expression=i}};Hp=__decorate([le],Hp);var nb=class{constructor(t,i){this.frameId=t,this.stoppedLocation=i}};nb=__decorate([le],nb);var ob;(function(e){e[e.AIGenerated=1]="AIGenerated"})(ob||(ob={}));var rh;(function(e){e[e.Invoke=0]="Invoke",e[e.Automatic=1]="Automatic"})(rh||(rh={}));var BW=class{constructor(e,t){this.newSymbolName=e,this.tags=t}},Gc;(function(e){e[e.Changed=1]="Changed",e[e.Created=2]="Created",e[e.Deleted=3]="Deleted"})(Gc||(Gc={}));var Yt=zi=class extends Error{static FileExists(t){return new zi(t,he.FileExists,zi.FileExists)}static FileNotFound(t){return new zi(t,he.FileNotFound,zi.FileNotFound)}static FileNotADirectory(t){return new zi(t,he.FileNotADirectory,zi.FileNotADirectory)}static FileIsADirectory(t){return new zi(t,he.FileIsADirectory,zi.FileIsADirectory)}static NoPermissions(t){return new zi(t,he.NoPermissions,zi.NoPermissions)}static Unavailable(t){return new zi(t,he.Unavailable,zi.Unavailable)}constructor(t,i=he.Unknown,r){super(y.isUri(t)?t.toString(!0):t),this.code=r?.name??"Unknown",b$(this,i),Object.setPrototypeOf(this,zi.prototype),typeof Error.captureStackTrace=="function"&&typeof r=="function"&&Error.captureStackTrace(this,r)}};Yt=zi=__decorate([le],Yt);var ab=class{constructor(t,i,r){this.start=t,this.end=i,this.kind=r}};ab=__decorate([le],ab);var on;(function(e){e[e.Comment=1]="Comment",e[e.Imports=2]="Imports",e[e.Region=3]="Region"})(on||(on={}));var sh;(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(sh||(sh={}));var cb;(function(e){e[e.Editing=0]="Editing",e[e.Preview=1]="Preview"})(cb||(cb={}));var lb;(function(e){e[e.Published=0]="Published",e[e.Draft=1]="Draft"})(lb||(lb={}));var nh;(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(nh||(nh={}));var oh;(function(e){e[e.Current=0]="Current",e[e.Outdated=1]="Outdated"})(oh||(oh={}));var ah;(function(e){e[e.Reply=1]="Reply",e[e.Comment=2]="Comment"})(ah||(ah={}));var ub=class{constructor(e,t=[]){this.tokenTypes=e,this.tokenModifiers=t}};function _W(e){return typeof e>"u"||YR(e)}var VW=class uN{constructor(t){if(this.c=0,this.e=0,this.f=!0,this.g=[],this.j=0,this.k=new Map,this.l=new Map,this.m=!1,t){this.m=!0;for(let i=0,r=t.tokenTypes.length;i<r;i++)this.k.set(t.tokenTypes[i],i);for(let i=0,r=t.tokenModifiers.length;i<r;i++)this.l.set(t.tokenModifiers[i],i)}}push(t,i,r,s,n){if(typeof t=="number"&&typeof i=="number"&&typeof r=="number"&&typeof s=="number"&&(typeof n=="number"||typeof n>"u"))return typeof n>"u"&&(n=0),this.p(t,i,r,s,n);if(xe.isRange(t)&&typeof i=="string"&&_W(r))return this.o(t,i,r);throw $e()}o(t,i,r){if(!this.m)throw new Error("Legend must be provided in constructor");if(t.start.line!==t.end.line)throw new Error("`range` cannot span multiple lines");if(!this.k.has(i))throw new Error("`tokenType` is not in the provided legend");const s=t.start.line,n=t.start.character,o=t.end.character-t.start.character,a=this.k.get(i);let c=0;if(r)for(const l of r){if(!this.l.has(l))throw new Error("`tokenModifier` is not in the provided legend");const u=this.l.get(l);c|=1<<u>>>0}this.p(s,n,o,a,c)}p(t,i,r,s,n){if(this.f&&(t<this.c||t===this.c&&i<this.e)){this.f=!1;const c=this.g.length/5|0;let l=0,u=0;for(let h=0;h<c;h++){let f=this.g[5*h],p=this.g[5*h+1];f===0?(f=l,p+=u):f+=l,this.g[5*h]=f,this.g[5*h+1]=p,l=f,u=p}}let o=t,a=i;this.f&&this.j>0&&(o-=this.c,o===0&&(a-=this.e)),this.g[this.j++]=o,this.g[this.j++]=a,this.g[this.j++]=r,this.g[this.j++]=s,this.g[this.j++]=n,this.c=t,this.e=i}static q(t){const i=[],r=t.length/5|0;for(let a=0;a<r;a++)i[a]=a;i.sort((a,c)=>{const l=t[5*a],u=t[5*c];if(l===u){const h=t[5*a+1],f=t[5*c+1];return h-f}return l-u});const s=new Uint32Array(t.length);let n=0,o=0;for(let a=0;a<r;a++){const c=5*i[a],l=t[c+0],u=t[c+1],h=t[c+2],f=t[c+3],p=t[c+4],g=l-n,v=g===0?u-o:u,b=5*a;s[b+0]=g,s[b+1]=v,s[b+2]=h,s[b+3]=f,s[b+4]=p,n=l,o=u}return s}build(t){return this.f?new Zc(new Uint32Array(this.g),t):new Zc(uN.q(this.g),t)}},Zc=class{constructor(e,t){this.resultId=t,this.data=e}},u7=class{constructor(e,t,i){this.start=e,this.deleteCount=t,this.data=i}},Wp=class{constructor(e,t){this.resultId=t,this.edits=e}},Bp;(function(e){e[e.Separate=0]="Separate",e[e.MergeWithParent=1]="MergeWithParent"})(Bp||(Bp={}));var qW=class{constructor(e){this.name=e}},_p;(function(e){e[e.Title=1]="Title",e[e.Inline=2]="Inline",e[e.Input=3]="Input"})(_p||(_p={}));var ch=class{static{this.Back={iconPath:new Di("arrow-left")}}constructor(){}};ch=__decorate([le],ch);var lh;(function(e){e[e.Separator=-1]="Separator",e[e.Default=0]="Default"})(lh||(lh={}));var Jc;(function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"})(Jc||(Jc={}));var ba;(function(e){e[e.UI=1]="UI",e[e.Workspace=2]="Workspace"})(ba||(ba={}));var hb=class{static validate(e){if(typeof e.badge=="string"){let t=RE(e.badge,0);if(t<e.badge.length&&(t+=RE(e.badge,t)),e.badge.length>t)throw new Error("The 'badge'-property must be undefined or a short character")}else if(e.badge&&!Di.isThemeIcon(e.badge))throw new Error("The 'badge'-property is not a valid ThemeIcon");if(!e.color&&!e.badge&&!e.tooltip)throw new Error("The decoration is empty");return!0}constructor(e,t,i){this.badge=e,this.tooltip=t,this.color=i}},Vp=class{constructor(t){this.kind=t}};Vp=__decorate([le],Vp);var lo;(function(e){e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.HighContrast=3]="HighContrast",e[e.HighContrastLight=4]="HighContrastLight"})(lo||(lo={}));var GW=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},db;(function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Executing=3]="Executing"})(db||(db={}));var qp;(function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"})(qp||(qp={}));var Gp;(function(e){e[e.Default=0]="Default",e[e.InCenter=1]="InCenter",e[e.InCenterIfOutsideViewport=2]="InCenterIfOutsideViewport",e[e.AtTop=3]="AtTop"})(Gp||(Gp={}));var ZW=class{constructor(e,t){this.text=e,this.alignment=t}},fb;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred"})(fb||(fb={}));var Zp;(function(e){e[e.Default=1]="Default",e[e.Preferred=2]="Preferred",e[e.Hidden=-1]="Hidden"})(Zp||(Zp={}));var h7=class{constructor(e,t=[]){this.uri=e,this.provides=Sr(t)}},JW=class{constructor(e){this.label=e}},uh;(function(e){e[e.Named=1]="Named",e[e.Indexed=2]="Indexed"})(uh||(uh={}));var pb=class{constructor(t,i){this.label=t,this.timestamp=i}};pb=__decorate([le],pb);var Qc;(function(e){e[e.Production=1]="Production",e[e.Development=2]="Development",e[e.Test=3]="Test"})(Qc||(Qc={}));var Jp;(function(e){e[e.Node=1]="Node",e[e.Webworker=2]="Webworker"})(Jp||(Jp={}));var uo;(function(e){e[e.Other=0]="Other",e[e.Comment=1]="Comment",e[e.String=2]="String",e[e.RegEx=3]="RegEx"})(uo||(uo={}));var QW=class{constructor(e,t){this.ranges=e,this.wordPattern=t}},YW=class{constructor(e){this.c=e}get autoForwardAction(){return this.c}},gb;(function(e){e[e.Queued=1]="Queued",e[e.Running=2]="Running",e[e.Passed=3]="Passed",e[e.Failed=4]="Failed",e[e.Skipped=5]="Skipped",e[e.Errored=6]="Errored"})(gb||(gb={}));var Yc;(function(e){e[e.Run=1]="Run",e[e.Debug=2]="Debug",e[e.Coverage=3]="Coverage"})(Yc||(Yc={}));var d7=class{constructor(e,t,i){this.controllerId=e,this.profileId=t,this.kind=i}},Qp=class{constructor(t=void 0,i=void 0,r=void 0,s=!1,n=!0){this.include=t,this.exclude=i,this.profile=r,this.continuous=s,this.preserveFocus=n}};Qp=__decorate([le],Qp);var Yp=Ow=class{static diff(t,i,r){const s=new Ow(t);return s.expectedOutput=i,s.actualOutput=r,s}constructor(t){this.message=t}};Yp=Ow=__decorate([le],Yp);var hh=class{constructor(t){this.id=t}};hh=__decorate([le],hh);var XW=class{constructor(e,t,i){this.label=e,this.uri=t,this.position=i}},Xp=class{constructor(e,t){this.covered=e,this.total=t,Kp(this)}};function Kp(e){if(e){if(e.covered>e.total)throw new Error(`The total number of covered items (${e.covered}) cannot be greater than the total (${e.total})`);if(e.total<0)throw new Error(`The number of covered items (${e.total}) cannot be negative`)}}var eg=class hN{static fromDetails(t,i){const r=new Xp(0,0),s=new Xp(0,0),n=new Xp(0,0);for(const a of i)if("branches"in a){r.total+=1,r.covered+=a.executed?1:0;for(const c of a.branches)s.total+=1,s.covered+=c.executed?1:0}else n.total+=1,n.covered+=a.executed?1:0;const o=new hN(t,r,s.total>0?s:void 0,n.total>0?n:void 0);return o.detailedCoverage=i,o}constructor(t,i,r,s,n=[]){this.uri=t,this.statementCoverage=i,this.branchCoverage=r,this.declarationCoverage=s,this.includesTests=n}},f7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i=[]){this.executed=e,this.location=t,this.branches=i}},p7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.executed=e,this.location=t,this.label=i}},g7=class{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,t,i){this.name=e,this.executed=t,this.location=i}},mb;(function(e){e[e.None=0]="None",e[e.Option=1]="Option",e[e.Default=2]="Default",e[e.Preferred=3]="Preferred"})(mb||(mb={}));var vb;(function(e){e[e.Untrusted=0]="Untrusted",e[e.Trusted=1]="Trusted",e[e.Unspecified=2]="Unspecified"})(vb||(vb={}));var wb;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(wb||(wb={}));var bb=class{constructor(e,t,i,r,s,n){this.kind=e,this.name=t,this.detail=i,this.uri=r,this.range=s,this.selectionRange=n}},yb=class{constructor(e){this.uri=e}},tg=class{constructor(e,t){this.original=e,this.modified=t}},m7=class{constructor(e,t,i,r){this.base=e,this.input1=t,this.input2=i,this.result=r}},Ab=class{constructor(e,t){this.uri=e,this.viewType=t}},v7=class{constructor(e){this.viewType=e}},Sb=class{constructor(e,t){this.uri=e,this.notebookType=t}},Eb=class{constructor(e,t,i){this.original=e,this.modified=t,this.notebookType=i}},w7=class{constructor(){}},b7=class{constructor(e,t){this.uri=e,this.inputBoxUri=t}},y7=class{constructor(){}},A7=class{constructor(e){this.textDiffs=e}},xb;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(xb||(xb={}));var kb;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(kb||(kb={}));var Cb;(function(e){e[e.Short=1]="Short",e[e.Medium=2]="Medium",e[e.Full=3]="Full"})(Cb||(Cb={}));var KW=class{constructor(e,t,i){this.id=e,this.label=t,this.values=i}},Ps;(function(e){e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.Saved=3]="Saved"})(Ps||(Ps={}));var $b;(function(e){e[e.Keep=1]="Keep",e[e.Undo=2]="Undo",e[e.UserModification=3]="UserModification"})($b||($b={}));var Ib;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful",e[e.Undone=2]="Undone",e[e.Accepted=3]="Accepted",e[e.Bug=4]="Bug"})(Ib||(Ib={}));var dh;(function(e){e[e.Unhelpful=0]="Unhelpful",e[e.Helpful=1]="Helpful"})(dh||(dh={}));var ig=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new ji(e):e}},fh=class{constructor(e,t){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new ji(e):e,this.vulnerabilities=t}},rg=class{constructor(e,t,i,r){this.title=e,this.message=t,this.data=i,this.buttons=r}},sg=class{constructor(e,t){this.value=e,this.baseUri=t}},Db=class{constructor(e,t,i){this.value=e,this.title=t,this.readOnly=i}},Pb=class{constructor(e,t){this.uris=e,this.callback=t,this.applied=new Promise(i=>{this.didGetApplied=i})}},ph=class{constructor(e,t){this.value=e,this.value2=e,this.title=t}},Tb=class{constructor(e){this.value=e}},ng=class{constructor(e,t){this.value=e,this.task=t}},Xc=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}},gh=class{constructor(e){if(typeof e!="string"&&e.isTrusted===!0)throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.");this.value=typeof e=="string"?new ji(e):e}},og=class{constructor(e){this.value=e}},ya=class{constructor(e,t,i){this.value=e,this.iconPath=t,this.options=i}},ag=class{constructor(e,t,i){this.value=e,this.isEdit=t,this.undoStopId=i}},cg=class{constructor(e,t,i){this.value=e,this.license=t,this.snippet=i}},lg=class{constructor(e,t){this.uri=e,this.range=t}},Mb=class{constructor(e){this.extensions=e}},Nb=class{constructor(e,t,i,r,s){this.uri=e,this.title=t,this.description=i,this.author=r,this.linkTag=s}toJSON(){return{$mid:26,uri:this.uri,title:this.title,description:this.description,author:this.author}}},mh=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},ug=class{constructor(e,t){this.uri=e,t===!0?(this.isDone=!0,this.edits=[]):this.edits=Array.isArray(t)?t:[t]}},vh=class{constructor(e){this.toolName=e}},Rb=class{constructor(e,t,i){this.toolName=e,this.toolCallId=t,this.isError=i}},hg=class{constructor(e,t,i,r,s,n,o){this.prompt=e,this.command=t,this.references=i,this.participant=r,this.toolReferences=s,this.editedFileEvents=n,this.id=o}},S7=class{constructor(e,t,i,r){this.response=e,this.result=t,this.participant=i,this.command=r}},eB=class{constructor(e,t,i,r){this.response=e,this.result=t,this.participant=i,this.command=r}},rs;(function(e){e[e.Panel=1]="Panel",e[e.Terminal=2]="Terminal",e[e.Notebook=3]="Notebook",e[e.Editor=4]="Editor"})(rs||(rs={}));var Lb;(function(e){e[e.Failed=0]="Failed",e[e.Completed=1]="Completed",e[e.InProgress=2]="InProgress"})(Lb||(Lb={}));var tB=class{constructor(e,t,i,r){this.modifiedUri=e,this.insertions=t,this.deletions=i,this.originalUri=r}},Ob;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(Ob||(Ob={}));var Fb;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(Fb||(Fb={}));var E7=class{constructor(e,t,i,r){this.editor=e,this.document=t,this.selection=i,this.wholeRange=r}},x7=class{constructor(e){this.cell=e}},k7=class{constructor(e,t,i){this.mimeType=e,this.data=t,this.reference=i}},Ub=class{constructor(e){this.diagnostics=e}},sr;(function(e){e[e.User=1]="User",e[e.Assistant=2]="Assistant",e[e.System=3]="System"})(sr||(sr={}));var Kc=class{constructor(e,t,i){this.callId=e,this.content=t,this.isError=i??!1}},jb;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(jb||(jb={}));var C7=class S5{static User(t,i){return new S5(sr.User,t,i)}static Assistant(t,i){return new S5(sr.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new Ut(t)]:this.c=t}get content(){return this.c}constructor(t,i,r){this.c=[],this.role=t,this.content=i,this.name=r}},$7=class E5{static User(t,i){return new E5(sr.User,t,i)}static Assistant(t,i){return new E5(sr.Assistant,t,i)}set content(t){typeof t=="string"?this.c=[new Ut(t)]:this.c=t}get content(){return this.c}set content2(t){t&&(this.content=t.map(i=>typeof i=="string"?new Ut(i):i))}get content2(){return this.content.map(t=>t instanceof Ut?t.value:t)}constructor(t,i,r){this.c=[],this.role=t,this.content=i,this.name=r}},Aa=class{constructor(e,t,i){this.callId=e,this.name=t,this.input=i}},dg;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})(dg||(dg={}));var Ut=class{constructor(e,t){this.value=e,t=t}toJSON(){return{$mid:21,value:this.value,audience:this.audience}}},gi=class Y1{constructor(t,i,r){this.mimeType=i,this.data=t,this.audience=r}static image(t,i){return new Y1(t,i)}static json(t,i="text/x-json"){const r=JSON.stringify(t,void 0,"	");return new Y1(W.fromString(r).buffer,i)}static text(t,i=Zr.text){return new Y1(W.fromString(t).buffer,i)}toJSON(){return{$mid:24,mimeType:this.mimeType,data:this.data,audience:this.audience}}},zb;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(zb||(zb={}));var el=class{constructor(e,t,i){this.value=e,this.id=t,this.metadata=i}toJSON(){return{$mid:22,value:this.value,id:this.id,metadata:this.metadata}}},Ts=class{constructor(e){this.value=e}toJSON(){return{$mid:23,value:this.value}}},an=class Hs extends Error{static#e="LanguageModelError";static NotFound(t){return new Hs(t,Hs.NotFound.name)}static NoPermissions(t){return new Hs(t,Hs.NoPermissions.name)}static Blocked(t){return new Hs(t,Hs.Blocked.name)}static tryDeserialize(t){if(t.name===Hs.#e)return new Hs(t.message,t.code,t.cause)}constructor(t,i,r){super(t,{cause:r}),this.name=Hs.#e,this.code=i??""}},fg=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},I7=class{constructor(e){this.content=e}toJSON(){return{$mid:20,content:this.content}}},iB=class extends fg{},pg;(function(e){e[e.Auto=1]="Auto",e[e.Required=2]="Required"})(pg||(pg={}));var D7=class{constructor(e,t){this.id=e,this.label=t}},P7=class{constructor(e,t,i){this.label=e,this.name=t,this.instructions=i}},Hb;(function(e){e[e.SymbolInformation=1]="SymbolInformation",e[e.CommandInformation=2]="CommandInformation",e[e.SearchInformation=3]="SearchInformation",e[e.SettingInformation=4]="SettingInformation"})(Hb||(Hb={}));var Wb;(function(e){e[e.EMBEDDED=1]="EMBEDDED",e[e.LLM_RANKED=2]="LLM_RANKED",e[e.CANCELED=3]="CANCELED"})(Wb||(Wb={}));var Bb;(function(e){e[e.Started=1]="Started",e[e.Recognizing=2]="Recognizing",e[e.Recognized=3]="Recognized",e[e.Stopped=4]="Stopped",e[e.Error=5]="Error"})(Bb||(Bb={}));var _b;(function(e){e[e.Started=1]="Started",e[e.Stopped=2]="Stopped",e[e.Error=3]="Error"})(_b||(_b={}));var Vb;(function(e){e[e.Recognized=1]="Recognized",e[e.Stopped=2]="Stopped"})(Vb||(Vb={}));var gg;(function(e){e[e.Initial=0]="Initial",e[e.Dynamic=1]="Dynamic"})(gg||(gg={}));var T7=class{constructor(e,t,i,r={},s,n){this.label=e,this.command=t,this.args=i,this.env=r,this.version=s,this.metadata=n}},M7=class{constructor(e,t,i={},r,s,n){this.label=e,this.uri=t,this.headers=i,this.version=r,this.metadata=s,this.authentication=n}},ss;(function(e){function t(r){const{selectionStartLineNumber:s,selectionStartColumn:n,positionLineNumber:o,positionColumn:a}=r,c=new Pe(s-1,n-1),l=new Pe(o-1,a-1);return new Cs(c,l)}e.to=t;function i(r){const{anchor:s,active:n}=r;return{selectionStartLineNumber:s.line+1,selectionStartColumn:s.character+1,positionLineNumber:n.line+1,positionColumn:n.character+1}}e.from=i})(ss||(ss={}));var j;(function(e){function t(r){if(!r)return;const{start:s,end:n}=r;return{startLineNumber:s.line+1,startColumn:s.character+1,endLineNumber:n.line+1,endColumn:n.character+1}}e.from=t;function i(r){if(!r)return;const{startLineNumber:s,startColumn:n,endLineNumber:o,endColumn:a}=r;return new xe(s-1,n-1,o-1,a-1)}e.to=i})(j||(j={}));var Tr;(function(e){function t(r){return{uri:r.uri,range:j.from(r.range)}}e.from=t;function i(r){return new rr(y.revive(r.uri),j.to(r.range))}e.to=i})(Tr||(Tr={}));var qb;(function(e){function t(i){switch(i){case 1:return uo.Comment;case 0:return uo.Other;case 3:return uo.RegEx;case 2:return uo.String}}e.to=t})(qb||(qb={}));var Xe;(function(e){function t(r){return new Pe(r.lineNumber-1,r.column-1)}e.to=t;function i(r){return{lineNumber:r.line+1,column:r.character+1}}e.from=i})(Xe||(Xe={}));var Sa;(function(e){function t(s,n,o){return gt(Sr(s).map(a=>i(a,n,o)))}e.from=t;function i(s,n,o){if(typeof s=="string")return{$serialized:!0,language:s,isBuiltin:o?.isBuiltin};if(s)return{$serialized:!0,language:s.language,scheme:r(s.scheme,n),pattern:Wi.from(s.pattern)??void 0,exclusive:s.exclusive,notebookType:s.notebookType,isBuiltin:o?.isBuiltin}}function r(s,n){return n&&typeof s=="string"?n.transformOutgoingScheme(s):s}})(Sa||(Sa={}));var mg;(function(e){function t(r){switch(r){case aa.Unnecessary:return 1;case aa.Deprecated:return 2}}e.from=t;function i(r){switch(r){case 1:return aa.Unnecessary;case 2:return aa.Deprecated;default:return}}e.to=i})(mg||(mg={}));var Ea;(function(e){function t(r){let s;return r.code&&(Oe(r.code)||Er(r.code)?s=String(r.code):s={value:String(r.code.value),target:r.code.target}),{...j.from(r.range),message:r.message,source:r.source,code:s,severity:wh.from(r.severity),relatedInformation:r.relatedInformation&&r.relatedInformation.map(vg.from),tags:Array.isArray(r.tags)?gt(r.tags.map(mg.from)):void 0}}e.from=t;function i(r){const s=new gp(j.to(r),r.message,wh.to(r.severity));return s.source=r.source,s.code=Oe(r.code)?r.code:r.code?.value,s.relatedInformation=r.relatedInformation&&r.relatedInformation.map(vg.to),s.tags=r.tags&&gt(r.tags.map(mg.to)),s}e.to=i})(Ea||(Ea={}));var vg;(function(e){function t(r){return{...j.from(r.location.range),message:r.message,resource:r.location.uri}}e.from=t;function i(r){return new zu(new rr(r.resource,j.to(r)),r.message)}e.to=i})(vg||(vg={}));var wh;(function(e){function t(r){switch(r){case pi.Error:return Fi.Error;case pi.Warning:return Fi.Warning;case pi.Information:return Fi.Info;case pi.Hint:return Fi.Hint}return Fi.Error}e.from=t;function i(r){switch(r){case Fi.Info:return pi.Information;case Fi.Warning:return pi.Warning;case Fi.Error:return pi.Error;case Fi.Hint:return pi.Hint;default:return pi.Error}}e.to=i})(wh||(wh={}));var Xt;(function(e){function t(r){return typeof r=="number"&&r>=Ju.One?r-1:r===Ju.Beside?YH:QH}e.from=t;function i(r){if(typeof r=="number"&&r>=0)return r+1;throw new Error("invalid 'EditorGroupColumn'")}e.to=i})(Xt||(Xt={}));function rB(e){return typeof e.range<"u"}function N7(e){return e.length===0?!0:!!rB(e[0])}var ge;(function(e){function t(a){return a.map(e.from)}e.fromMany=t;function i(a){return a&&typeof a=="object"&&typeof a.language=="string"&&typeof a.value=="string"}function r(a){let c;if(i(a)){const{language:h,value:f}=a;c={value:"```"+h+`
`+f+"\n```\n"}}else ji.isMarkdownString(a)?c={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,supportAlertSyntax:a.supportAlertSyntax,baseUri:a.baseUri}:typeof a=="string"?c={value:a}:c={value:""};const l=Object.create(null);c.uris=l;const u=({href:h})=>{try{let f=y.parse(h,!0);f=f.with({query:s(f.query,l)}),l[h]=f}catch{}return""};return ft.walkTokens(ft.lexer(c.value),h=>{h.type==="link"?u({href:h.href}):h.type==="image"&&typeof h.href=="string"&&u(Ij(h.href))}),c}e.from=r;function s(a,c){if(!a)return a;let l;try{l=Lx(a)}catch{}if(!l)return a;let u=!1;return l=lc(l,h=>{if(y.isUri(h)){const f=`__uri_${Math.random().toString(16).slice(2,8)}`;return c[f]=h,u=!0,f}else return}),u?JSON.stringify(l):a}function n(a){const c=new ji(a.value,a.supportThemeIcons);return c.isTrusted=a.isTrusted,c.supportHtml=a.supportHtml,c.supportAlertSyntax=a.supportAlertSyntax,c.baseUri=a.baseUri?y.from(a.baseUri):void 0,c}e.to=n;function o(a){if(a)return typeof a=="string"?a:e.from(a)}e.fromStrict=o})(ge||(ge={}));function sB(e){return N7(e)?e.map(t=>({range:j.from(t.range),hoverMessage:Array.isArray(t.hoverMessage)?ge.fromMany(t.hoverMessage):t.hoverMessage?ge.from(t.hoverMessage):void 0,renderOptions:t.renderOptions})):e.map(t=>({range:j.from(t)}))}function wg(e){return typeof e>"u"?e:typeof e=="string"?y.file(e):e}var tl;(function(e){function t(i){return typeof i>"u"?i:{contentText:i.contentText,contentIconPath:i.contentIconPath?wg(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}e.from=t})(tl||(tl={}));var bg;(function(e){function t(i){return typeof i>"u"?i:{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?wg(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?tl.from(i.before):void 0,after:i.after?tl.from(i.after):void 0}}e.from=t})(bg||(bg={}));var Gb;(function(e){function t(i){if(typeof i>"u")return i;switch(i){case pa.OpenOpen:return 0;case pa.ClosedClosed:return 1;case pa.OpenClosed:return 2;case pa.ClosedOpen:return 3}}e.from=t})(Gb||(Gb={}));var Zb;(function(e){function t(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?Gb.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?bg.from(i.light):void 0,dark:i.dark?bg.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?wg(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?tl.from(i.before):void 0,after:i.after?tl.from(i.after):void 0}}e.from=t})(Zb||(Zb={}));var Kt;(function(e){function t(r){return{text:r.newText,eol:r.newEol&&nl.from(r.newEol),range:j.from(r.range)}}e.from=t;function i(r){const s=new so(j.to(r.range),r.text);return s.newEol=typeof r.eol>"u"?void 0:nl.to(r.eol),s}e.to=i})(Kt||(Kt={}));var nr;(function(e){function t(r,s){const n={edits:[]};if(r instanceof da){const o=new J5;for(const a of r._allEntries())a._type===1&&y.isUri(a.to)&&a.from===void 0&&o.add(a.to);for(const a of r._allEntries())if(a._type===1){let c;a.options?.contents&&(ArrayBuffer.isView(a.options.contents)?c={type:"base64",value:oc(W.wrap(a.options.contents))}:c={type:"dataTransferItem",id:a.options.contents._itemId}),n.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:c},metadata:a.metadata})}else a._type===2?n.edits.push({resource:a.uri,textEdit:Kt.from(a.edit),versionId:o.has(a.uri)?void 0:s?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===6?n.edits.push({resource:a.uri,textEdit:{range:j.from(a.range),text:a.edit.value,insertAsSnippet:!0,keepWhitespace:a.keepWhitespace},versionId:o.has(a.uri)?void 0:s?.getTextDocumentVersion(a.uri),metadata:a.metadata}):a._type===3?n.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:s?.getNotebookDocumentVersion(a.uri)}):a._type===5&&n.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:s?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:1,index:a.index,count:a.count,cells:a.cells.map(al.from)}})}return n}e.from=t;function i(r){const s=new da,n=new zt;for(const o of r.edits)if(o.textEdit){const a=o,c=y.revive(a.resource),l=j.to(a.textEdit.range),u=a.textEdit.text,h=a.textEdit.insertAsSnippet;let f;h?f=Mw.replace(l,new ua(u)):f=so.replace(l,u);const p=n.get(c);p?p.push(f):n.set(c,[f])}else s.renameFile(y.revive(o.oldResource),y.revive(o.newResource),o.options);for(const[o,a]of n)s.set(o,a);return s}e.to=i})(nr||(nr={}));var Mr;(function(e){const t=Object.create(null);t[ut.File]=0,t[ut.Module]=1,t[ut.Namespace]=2,t[ut.Package]=3,t[ut.Class]=4,t[ut.Method]=5,t[ut.Property]=6,t[ut.Field]=7,t[ut.Constructor]=8,t[ut.Enum]=9,t[ut.Interface]=10,t[ut.Function]=11,t[ut.Variable]=12,t[ut.Constant]=13,t[ut.String]=14,t[ut.Number]=15,t[ut.Boolean]=16,t[ut.Array]=17,t[ut.Object]=18,t[ut.Key]=19,t[ut.Null]=20,t[ut.EnumMember]=21,t[ut.Struct]=22,t[ut.Event]=23,t[ut.Operator]=24,t[ut.TypeParameter]=25;function i(s){return typeof t[s]=="number"?t[s]:6}e.from=i;function r(s){for(const n in t)if(t[n]===s)return Number(n);return ut.Property}e.to=r})(Mr||(Mr={}));var cn;(function(e){function t(r){switch(r){case Hu.Deprecated:return 1}}e.from=t;function i(r){switch(r){case 1:return Hu.Deprecated}}e.to=i})(cn||(cn={}));var xa;(function(e){function t(r){return{name:r.name,kind:Mr.from(r.kind),tags:r.tags&&r.tags.map(cn.from),containerName:r.containerName,location:Hi.from(r.location)}}e.from=t;function i(r){const s=new Wu(r.name,Mr.to(r.kind),r.containerName,Hi.to(r.location));return s.tags=r.tags&&r.tags.map(cn.to),s}e.to=i})(xa||(xa={}));var Jb;(function(e){function t(r){const s={name:r.name||"!!MISSING: name!!",detail:r.detail,range:j.from(r.range),selectionRange:j.from(r.selectionRange),kind:Mr.from(r.kind),tags:r.tags?.map(cn.from)??[]};return r.children&&(s.children=r.children.map(t)),s}e.from=t;function i(r){const s=new _u(r.name,r.detail,Mr.to(r.kind),j.to(r.range),j.to(r.selectionRange));return Xl(r.tags)&&(s.tags=r.tags.map(cn.to)),r.children&&(s.children=r.children.map(i)),s}e.to=i})(Jb||(Jb={}));var ka;(function(e){function t(r){const s=new jw(Mr.to(r.kind),r.name,r.detail||"",y.revive(r.uri),j.to(r.range),j.to(r.selectionRange));return s._sessionId=r._sessionId,s._itemId=r._itemId,s}e.to=t;function i(r,s,n){if(s=s??r._sessionId,n=n??r._itemId,s===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:s,_itemId:n,name:r.name,detail:r.detail,kind:Mr.from(r.kind),uri:r.uri,range:j.from(r.range),selectionRange:j.from(r.selectionRange),tags:r.tags?.map(cn.from)}}e.from=i})(ka||(ka={}));var Qb;(function(e){function t(i){return new r7(ka.to(i.from),i.fromRanges.map(r=>j.to(r)))}e.to=t})(Qb||(Qb={}));var Yb;(function(e){function t(i){return new s7(ka.to(i.to),i.fromRanges.map(r=>j.to(r)))}e.to=t})(Yb||(Yb={}));var Hi;(function(e){function t(r){return{range:r.range&&j.from(r.range),uri:r.uri}}e.from=t;function i(r){return new rr(y.revive(r.uri),j.to(r.range))}e.to=i})(Hi||(Hi={}));var bh;(function(e){function t(r){const s=r,n=r;return{originSelectionRange:s.originSelectionRange?j.from(s.originSelectionRange):void 0,uri:s.targetUri?s.targetUri:n.uri,range:j.from(s.targetRange?s.targetRange:n.range),targetSelectionRange:s.targetSelectionRange?j.from(s.targetSelectionRange):void 0}}e.from=t;function i(r){return{targetUri:y.revive(r.uri),targetRange:j.to(r.range),targetSelectionRange:r.targetSelectionRange?j.to(r.targetSelectionRange):void 0,originSelectionRange:r.originSelectionRange?j.to(r.originSelectionRange):void 0}}e.to=i})(bh||(bh={}));var yh;(function(e){function t(r){return{range:j.from(r.range),contents:ge.fromMany(r.contents),canIncreaseVerbosity:r.canIncreaseVerbosity,canDecreaseVerbosity:r.canDecreaseVerbosity}}e.from=t;function i(r){const s=r.contents.map(ge.to),n=j.to(r.range),o=r.canIncreaseVerbosity,a=r.canDecreaseVerbosity;return new Sp(s,n,o,a)}e.to=i})(yh||(yh={}));var Xb;(function(e){function t(r){return{range:j.from(r.range),expression:r.expression}}e.from=t;function i(r){return new Up(j.to(r.range),r.expression)}e.to=i})(Xb||(Xb={}));var yg;(function(e){function t(r){if(r instanceof jp)return{type:"text",range:j.from(r.range),text:r.text};if(r instanceof zp)return{type:"variable",range:j.from(r.range),variableName:r.variableName,caseSensitiveLookup:r.caseSensitiveLookup};if(r instanceof Hp)return{type:"expression",range:j.from(r.range),expression:r.expression};throw new Error("Unknown 'InlineValue' type")}e.from=t;function i(r){switch(r.type){case"text":return{range:j.to(r.range),text:r.text};case"variable":return{range:j.to(r.range),variableName:r.variableName,caseSensitiveLookup:r.caseSensitiveLookup};case"expression":return{range:j.to(r.range),expression:r.expression}}}e.to=i})(yg||(yg={}));var Ag;(function(e){function t(r){return{frameId:r.frameId,stoppedLocation:j.from(r.stoppedLocation)}}e.from=t;function i(r){return new nb(r.frameId,j.to(r.stoppedLocation))}e.to=i})(Ag||(Ag={}));var il;(function(e){function t(r){return{range:j.from(r.range),kind:r.kind}}e.from=t;function i(r){return new Ep(j.to(r.range),r.kind)}e.to=i})(il||(il={}));var Kb;(function(e){function t(r){return{uri:r.uri,highlights:r.highlights.map(il.from)}}e.from=t;function i(r){return new xp(y.revive(r.uri),r.highlights.map(il.to))}e.to=i})(Kb||(Kb={}));var ey;(function(e){function t(i){switch(i){case 1:return Pc.TriggerCharacter;case 2:return Pc.TriggerForIncompleteCompletions;case 0:default:return Pc.Invoke}}e.to=t})(ey||(ey={}));var ty;(function(e){function t(i){return{triggerKind:ey.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}e.to=t})(ty||(ty={}));var Sg;(function(e){function t(r){switch(r){case Zu.Deprecated:return 1}}e.from=t;function i(r){switch(r){case 1:return Zu.Deprecated}}e.to=i})(Sg||(Sg={}));var iy;(function(e){function t(i,r,s){return"icon"in i&&"command"in i?{command:r.toInternal(i.command,s),icon:go.fromThemeIcon(i.icon)}:{command:r.toInternal(i,s)}}e.from=t})(iy||(iy={}));var Eg;(function(e){const t=new Map([[ve.Method,0],[ve.Function,1],[ve.Constructor,2],[ve.Field,3],[ve.Variable,4],[ve.Class,5],[ve.Interface,7],[ve.Struct,6],[ve.Module,8],[ve.Property,9],[ve.Unit,12],[ve.Value,13],[ve.Constant,14],[ve.Enum,15],[ve.EnumMember,16],[ve.Keyword,17],[ve.Snippet,28],[ve.Text,18],[ve.Color,19],[ve.File,20],[ve.Reference,21],[ve.Folder,23],[ve.Event,10],[ve.Operator,11],[ve.TypeParameter,24],[ve.Issue,26],[ve.User,25]]);function i(n){return t.get(n)??9}e.from=i;const r=new Map([[0,ve.Method],[1,ve.Function],[2,ve.Constructor],[3,ve.Field],[4,ve.Variable],[5,ve.Class],[7,ve.Interface],[6,ve.Struct],[8,ve.Module],[9,ve.Property],[12,ve.Unit],[13,ve.Value],[14,ve.Constant],[15,ve.Enum],[16,ve.EnumMember],[17,ve.Keyword],[28,ve.Snippet],[18,ve.Text],[19,ve.Color],[20,ve.File],[21,ve.Reference],[23,ve.Folder],[10,ve.Event],[11,ve.Operator],[24,ve.TypeParameter],[25,ve.User],[26,ve.Issue]]);function s(n){return r.get(n)??ve.Property}e.to=s})(Eg||(Eg={}));var ry;(function(e){function t(i,r){const s=new Ip(i.label);return s.insertText=i.insertText,s.kind=Eg.to(i.kind),s.tags=i.tags?.map(Sg.to),s.detail=i.detail,s.documentation=Gn(i.documentation)?ge.to(i.documentation):i.documentation,s.sortText=i.sortText,s.filterText=i.filterText,s.preselect=i.preselect,s.commitCharacters=i.commitCharacters,st.isIRange(i.range)?s.range=j.to(i.range):typeof i.range=="object"&&(s.range={inserting:j.to(i.range.insert),replacing:j.to(i.range.replace)}),s.keepWhitespace=typeof i.insertTextRules>"u"?!1:!!(i.insertTextRules&1),typeof i.insertTextRules<"u"&&i.insertTextRules&4?s.insertText=new ua(i.insertText):(s.insertText=i.insertText,s.textEdit=s.range instanceof xe?new so(s.range,s.insertText):void 0),i.additionalTextEdits&&i.additionalTextEdits.length>0&&(s.additionalTextEdits=i.additionalTextEdits.map(n=>Kt.to(n))),s.command=r&&i.command?r.fromInternal(i.command):void 0,s}e.to=t})(ry||(ry={}));var xg;(function(e){function t(r){if(typeof r.label!="string"&&!Array.isArray(r.label))throw new TypeError("Invalid label");return{label:r.label,documentation:ge.fromStrict(r.documentation)}}e.from=t;function i(r){return{label:r.label,documentation:Gn(r.documentation)?ge.to(r.documentation):r.documentation}}e.to=i})(xg||(xg={}));var kg;(function(e){function t(r){return{label:r.label,documentation:ge.fromStrict(r.documentation),parameters:Array.isArray(r.parameters)?r.parameters.map(xg.from):[],activeParameter:r.activeParameter}}e.from=t;function i(r){return{label:r.label,documentation:Gn(r.documentation)?ge.to(r.documentation):r.documentation,parameters:Array.isArray(r.parameters)?r.parameters.map(xg.to):[],activeParameter:r.activeParameter}}e.to=i})(kg||(kg={}));var Ah;(function(e){function t(r){return{activeSignature:r.activeSignature,activeParameter:r.activeParameter,signatures:Array.isArray(r.signatures)?r.signatures.map(kg.from):[]}}e.from=t;function i(r){return{activeSignature:r.activeSignature,activeParameter:r.activeParameter,signatures:Array.isArray(r.signatures)?r.signatures.map(kg.to):[]}}e.to=i})(Ah||(Ah={}));var sy;(function(e){function t(i,r){const s=new $p(Xe.to(r.position),typeof r.label=="string"?r.label:r.label.map(ny.to.bind(void 0,i)),r.kind&&Cg.to(r.kind));return s.textEdits=r.textEdits&&r.textEdits.map(Kt.to),s.tooltip=Gn(r.tooltip)?ge.to(r.tooltip):r.tooltip,s.paddingLeft=r.paddingLeft,s.paddingRight=r.paddingRight,s}e.to=t})(sy||(sy={}));var ny;(function(e){function t(i,r){const s=new Cp(r.label);return s.tooltip=Gn(r.tooltip)?ge.to(r.tooltip):r.tooltip,J0.is(r.command)&&(s.command=i.fromInternal(r.command)),r.location&&(s.location=Hi.to(r.location)),s}e.to=t})(ny||(ny={}));var Cg;(function(e){function t(r){return r}e.from=t;function i(r){return r}e.to=i})(Cg||(Cg={}));var Ca;(function(e){function t(r){return{range:j.from(r.range),url:r.target,tooltip:r.tooltip}}e.from=t;function i(r){let s;if(r.url)try{s=typeof r.url=="string"?y.parse(r.url,!0):y.revive(r.url)}catch{}const n=new Pp(j.to(r.range),s);return n.tooltip=r.tooltip,n}e.to=i})(Ca||(Ca={}));var $g;(function(e){function t(r){const s=new Mp(r.label);return r.textEdit&&(s.textEdit=Kt.to(r.textEdit)),r.additionalTextEdits&&(s.additionalTextEdits=r.additionalTextEdits.map(n=>Kt.to(n))),s}e.to=t;function i(r){return{label:r.label,textEdit:r.textEdit?Kt.from(r.textEdit):void 0,additionalTextEdits:r.additionalTextEdits?r.additionalTextEdits.map(s=>Kt.from(s)):void 0}}e.from=i})($g||($g={}));var rl;(function(e){function t(r){return new Uc(r[0],r[1],r[2],r[3])}e.to=t;function i(r){return[r.red,r.green,r.blue,r.alpha]}e.from=i})(rl||(rl={}));var oy;(function(e){function t(r){return{range:j.from(r.range)}}e.from=t;function i(r){return new Gu(j.to(r.range))}e.to=i})(oy||(oy={}));var Ig;(function(e){function t(i){switch(i){case 2:return Rc.AfterDelay;case 1:return Rc.Manual;case 3:case 4:return Rc.FocusOut}}e.to=t})(Ig||(Ig={}));var sl;(function(e){function t(r){switch(r){case is.Off:return 0;case is.Relative:return 2;case is.Interval:return 3;case is.On:default:return 1}}e.from=t;function i(r){switch(r){case 0:return is.Off;case 2:return is.Relative;case 3:return is.Interval;case 1:default:return is.On}}e.to=i})(sl||(sl={}));var nl;(function(e){function t(r){if(r===ts.CRLF)return 1;if(r===ts.LF)return 0}e.from=t;function i(r){if(r===1)return ts.CRLF;if(r===0)return ts.LF}e.to=i})(nl||(nl={}));var Dg;(function(e){function t(i){if(typeof i=="object")return i.viewId;switch(i){case ao.SourceControl:return 3;case ao.Window:return 10;case ao.Notification:return 15}throw new Error("Unknown 'ProgressLocation'")}e.from=t})(Dg||(Dg={}));var Pg;(function(e){function t(r){const s={start:r.start+1,end:r.end+1};return r.kind&&(s.kind=Tg.from(r.kind)),s}e.from=t;function i(r){const s={start:r.start-1,end:r.end-1};return r.kind&&(s.kind=Tg.to(r.kind)),s}e.to=i})(Pg||(Pg={}));var Tg;(function(e){function t(r){if(r)switch(r){case on.Comment:return vc.Comment;case on.Imports:return vc.Imports;case on.Region:return vc.Region}}e.from=t;function i(r){if(r)switch(r.value){case vc.Comment.value:return on.Comment;case vc.Imports.value:return on.Imports;case vc.Region.value:return on.Region}}e.to=i})(Tg||(Tg={}));var Sh;(function(e){function t(i){if(i)return{pinned:typeof i.preview=="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection=="object"?j.from(i.selection):void 0,override:typeof i.override=="boolean"?Az.id:void 0}}e.from=t})(Sh||(Sh={}));var Wi;(function(e){function t(n){return n instanceof Bc?n.toJSON():typeof n=="string"?n:i(n)||r(n)?new Bc(n.baseUri??n.base,n.pattern).toJSON():n}e.from=t;function i(n){const o=n;return o?y.isUri(o.baseUri)&&typeof o.pattern=="string":!1}function r(n){const o=n;return o?typeof o.base=="string"&&typeof o.pattern=="string":!1}function s(n){return typeof n=="string"?n:new Bc(y.revive(n.baseUri),n.pattern)}e.to=s})(Wi||(Wi={}));var ay;(function(e){function t(i){if(i){if(Array.isArray(i))return i.map(t);if(typeof i=="string")return i;{const r=i;return{language:r.language,scheme:r.scheme,pattern:Wi.from(r.pattern)??void 0,exclusive:r.exclusive,notebookType:r.notebookType}}}else return}e.from=t})(ay||(ay={}));var Ms;(function(e){function t(r){return{start:r.start,end:r.end}}e.from=t;function i(r){return new ks(r.start,r.end)}e.to=i})(Ms||(Ms={}));var ol;(function(e){function t(r){return{timing:typeof r.runStartTime=="number"&&typeof r.runEndTime=="number"?{startTime:r.runStartTime,endTime:r.runEndTime}:void 0,executionOrder:r.executionOrder,success:r.lastRunSuccess}}e.to=t;function i(r){return{lastRunSuccess:r.success,runStartTime:r.timing?.startTime,runEndTime:r.timing?.endTime,executionOrder:r.executionOrder}}e.from=i})(ol||(ol={}));var Eh;(function(e){function t(r){switch(r){case ca.Markup:return xc.Markup;case ca.Code:default:return xc.Code}}e.from=t;function i(r){switch(r){case xc.Markup:return ca.Markup;case xc.Code:default:return ca.Code}}e.to=i})(Eh||(Eh={}));var ho;(function(e){function t(r){const s={metadata:r.metadata??Object.create(null),cells:[]};for(const n of r.cells)mp.validate(n),s.cells.push(al.from(n));return s}e.from=t;function i(r){const s=new X6(r.cells.map(al.to));return yv(r.metadata)||(s.metadata=r.metadata),s}e.to=i})(ho||(ho={}));var al;(function(e){function t(r){return{cellKind:Eh.from(r.kind),language:r.languageId,mime:r.mime,source:r.value,metadata:r.metadata,internalMetadata:ol.from(r.executionSummary??{}),outputs:r.outputs?r.outputs.map(fo.from):[]}}e.from=t;function i(r){return new mp(Eh.to(r.cellKind),r.source,r.language,r.mime,r.outputs?r.outputs.map(fo.to):void 0,r.metadata,r.internalMetadata?ol.to(r.internalMetadata):void 0)}e.to=i})(al||(al={}));var cl;(function(e){function t(r){return{mime:r.mime,valueBytes:W.wrap(r.data)}}e.from=t;function i(r){return new K6(r.valueBytes.buffer,r.mime)}e.to=i})(cl||(cl={}));var fo;(function(e){function t(r){return{outputId:r.id,items:r.items.map(cl.from),metadata:r.metadata}}e.from=t;function i(r){const s=r.items.map(cl.to);return new wp(s,r.outputId,r.metadata)}e.to=i})(fo||(fo={}));var Mg;(function(e){function t(s){return r(s)?{include:Wi.from(s.include)??void 0,exclude:Wi.from(s.exclude)??void 0}:Wi.from(s)??void 0}e.from=t;function i(s){return r(s)?{include:Wi.to(s.include),exclude:Wi.to(s.exclude)}:Wi.to(s)}e.to=i;function r(s){const n=s;return n?!Ht(n.include)&&!Ht(n.exclude):!1}})(Mg||(Mg={}));var cy;(function(e){function t(i,r,s){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===qp.Left?1:2,command:r.toInternal(n,s),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}e.from=t})(cy||(cy={}));var ly;(function(e){function t(i,r,s){const n=typeof i.command=="string"?{title:"",command:i.command}:i.command;return{command:r.toInternal(n,s),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}e.from=t})(ly||(ly={}));var uy;(function(e){function t(i){return{transientOutputs:i?.transientOutputs??!1,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}e.from=t})(uy||(uy={}));var Ng;(function(e){function t(r){return{uri:r.uri,provides:r.provides}}e.from=t;function i(r){return new h7(y.revive(r.uri),r.provides)}e.to=i})(Ng||(Ng={}));var ll;(function(e){function t(r){return{message:ge.fromStrict(r.message)||"",type:0,expected:r.expectedOutput,actual:r.actualOutput,contextValue:r.contextValue,location:r.location&&{range:j.from(r.location.range),uri:r.location.uri},stackTrace:r.stackTrace?.map(s=>({label:s.label,position:s.position&&Xe.from(s.position),uri:s.uri&&y.revive(s.uri).toJSON()}))}}e.from=t;function i(r){const s=new Yp(typeof r.message=="string"?r.message:ge.to(r.message));return s.actualOutput=r.actual,s.expectedOutput=r.expected,s.contextValue=r.contextValue,s.location=r.location?Hi.to(r.location):void 0,s}e.to=i})(ll||(ll={}));var ns;(function(e){e.namespace=Qf,e.denamespace=a6})(ns||(ns={}));var hy;(function(e){function t(i){return{controllerId:i.controllerId,profileId:i.profileId,group:ul.from(i.kind)}}e.from=t})(hy||(hy={}));var ul;(function(e){const t={[Yc.Coverage]:8,[Yc.Debug]:4,[Yc.Run]:2};function i(r){return t.hasOwnProperty(r)?t[r]:2}e.from=i})(ul||(ul={}));var po;(function(e){function t(r){const s=pp(r).controllerId;return{extId:Ve.fromExtHostTestItem(r,s).toString(),label:r.label,uri:y.revive(r.uri),busy:r.busy,tags:r.tags.map(n=>ns.namespace(s,n.id)),range:st.lift(j.from(r.range)),description:r.description||null,sortText:r.sortText||null,error:r.error&&ge.fromStrict(r.error)||null}}e.from=t;function i(r){return{parent:void 0,error:void 0,id:Ve.fromString(r.extId).localId,label:r.label,uri:y.revive(r.uri),tags:(r.tags||[]).map(s=>{const{tagId:n}=ns.denamespace(s);return new hh(n)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>{},replace:()=>{},size:0},range:j.to(r.range||void 0),canResolveChildren:!1,busy:r.busy,description:r.description||void 0,sortText:r.sortText||void 0}}e.toPlain=i})(po||(po={})),function(e){function t(r){return{id:r.id}}e.from=t;function i(r){return new hh(r.id)}e.to=i}(ns||(ns={}));var dy;(function(e){const t=(r,s)=>{const n=r.value;if(!n)return;const o={...po.toPlain(n.item),parent:s,taskStates:n.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(c=>c.type===0).map(ll.to)})),children:[]};if(r.children)for(const a of r.children.values()){const c=t(a,o);c&&o.children.push(c)}return o};function i(r){const s=new lz;for(const a of r.items)s.insert(Ve.fromString(a.item.extId).path,a);const n=[s.nodes],o=[];for(;n.length;)for(const a of n.pop())a.value?o.push(a):a.children&&n.push(a.children.values());return{completedAt:r.completedAt,results:o.map(a=>t(a)).filter(hr)}}e.to=i})(dy||(dy={}));var xh;(function(e){function t(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?Xe.from(a):j.from(a)}function r(a){if(a)return"endLineNumber"in a?j.to(a):Xe.to(a)}function s(a){if(a.type===1){const c=[];if(a.branches)for(const l of a.branches)c.push({executed:l.count,location:r(l.location),label:l.label});return new f7(a.count,r(a.location),a.branches?.map(l=>new p7(l.count,r(l.location),l.label)))}else return new g7(a.name,a.count,r(a.location))}e.to=s;function n(a){if(typeof a.executed=="number"&&a.executed<0)throw new Error(`Invalid coverage count ${a.executed}`);return"branches"in a?{count:a.executed,location:i(a.location),type:1,branches:a.branches.length?a.branches.map(c=>({count:c.executed,location:c.location&&i(c.location),label:c.label})):void 0}:{type:0,name:a.name,count:a.executed,location:i(a.location)}}e.fromDetails=n;function o(a,c,l){return Kp(l.statementCoverage),Kp(l.branchCoverage),Kp(l.declarationCoverage),{id:c,uri:l.uri,statement:t(l.statementCoverage),branch:l.branchCoverage&&t(l.branchCoverage),declaration:l.declarationCoverage&&t(l.declarationCoverage),testIds:l instanceof eg&&l.includesTests.length?l.includesTests.map(u=>Ve.fromExtHostTestItem(u,a).toString()):void 0}}e.fromFile=o})(xh||(xh={}));var fy;(function(e){function t(i){switch(i){case 1:return Vu.Invoke;case 2:return Vu.Automatic}}e.to=t})(fy||(fy={}));var $a;(function(e){function t(r){const s=new bb(Mr.to(r.kind),r.name,r.detail||"",y.revive(r.uri),j.to(r.range),j.to(r.selectionRange));return s._sessionId=r._sessionId,s._itemId=r._itemId,s}e.to=t;function i(r,s,n){if(s=s??r._sessionId,n=n??r._itemId,s===void 0||n===void 0)throw new Error("invalid item");return{_sessionId:s,_itemId:n,kind:Mr.from(r.kind),name:r.name,detail:r.detail??"",uri:r.uri,range:j.from(r.range),selectionRange:j.from(r.selectionRange),tags:r.tags?.map(cn.from)}}e.from=i})($a||($a={}));var Rg;(function(e){function t(i){if(i)return{value:i.value,tooltip:i.tooltip}}e.from=t})(Rg||(Rg={}));var Ia;(function(e){function t(n,o,a){const c=o.fileData;return c?new jW(new zW(c.name,y.revive(c.uri),c.id,pv(()=>a(c.id)))):n===Zr.uriList&&o.uriListData?new Op(s(o.uriListData)):new Op(o.asString)}e.to=t;async function i(n,o,a=Tt()){const c=await o.asString();if(n===Zr.uriList)return{id:a,asString:c,fileData:void 0,uriListData:r(c)};const l=o.asFile();return{id:a,asString:c,fileData:l?{name:l.name,uri:l.uri,id:l._itemId??l.id}:void 0}}e.from=i;function r(n){return P0.split(n).map(o=>{if(o.startsWith("#"))return o;try{return y.parse(o)}catch{}return o})}function s(n){return P0.create(n.map(o=>typeof o=="string"?o:y.revive(o)))}})(Ia||(Ia={}));var hl;(function(e){function t(s,n){const o=s.items.map(([a,c])=>[a,Ia.to(a,c,n)]);return new Hc(o)}e.toDataTransfer=t;async function i(s){return{items:await Promise.all(Array.from(s,async([o,a])=>[o,await Ia.from(o,a)]))}}e.from=i;async function r(s){return{items:await Promise.all(Array.from(s,async([o,a])=>[o,await Ia.from(o,a,a.id)]))}}e.fromList=r})(hl||(hl={}));var Lg;(function(e){function t(r,s){return{kind:"reply",agentId:r.participant??s?.agentId??"",subCommand:r.command??s?.command,message:r.prompt,title:r.label}}e.from=t;function i(r){return{prompt:r.message,label:r.title,participant:r.agentId,command:r.subCommand}}e.to=i})(Lg||(Lg={}));var dl;(function(e){function t(r){switch(r){case 0:return sr.System;case 1:return sr.User;case 2:return sr.Assistant}}e.to=t;function i(r){switch(r){case sr.System:return 0;case sr.User:return 1;case sr.Assistant:return 2}return 1}e.from=i})(dl||(dl={}));var R7;(function(e){function t(r){const s=r.content.map(a=>{if(a.type==="text")return new Ut(a.value,a.audience);if(a.type==="tool_result"){const c=gt(a.value.map(l=>l.type==="text"?new Ut(l.value,l.audience):l.type==="data"?new gi(l.data.buffer,l.mimeType):l.type==="prompt_tsx"?new Ts(l.value):void 0));return new Kc(a.toolCallId,c,a.isError)}else{if(a.type==="image_url")return new gi(a.value.data.buffer,a.value.mimeType);if(a.type==="data")return new gi(a.data.buffer,a.mimeType);if(a.type==="tool_use")return new Aa(a.toolCallId,a.name,a.parameters)}}).filter(a=>a!==void 0),n=dl.to(r.role);return new C7(n,s,r.name)}e.to=t;function i(r){const s=dl.from(r.role),n=r.name;let o=r.content;typeof o=="string"&&(o=[new Ut(o)]);const a=o.map(c=>{if(c instanceof Kc)return{type:"tool_result",toolCallId:c.callId,value:gt(c.content.map(l=>l instanceof Ut?{type:"text",value:l.value,audience:l.audience}:l instanceof Ts?{type:"prompt_tsx",value:l.value}:l instanceof gi?{type:"data",mimeType:l.mimeType,data:W.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof gi)return L7(c)?{type:"image_url",value:{mimeType:c.mimeType,data:W.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:W.wrap(c.data),audience:c.audience};if(c instanceof Aa)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof Ut)return{type:"text",value:c.value};if(typeof c!="string")throw new Error("Unexpected chat message content type");return{type:"text",value:c}});return{role:s,name:n,content:a}}e.from=i})(R7||(R7={}));var Og;(function(e){function t(r){const s=r.content.map(a=>{if(a.type==="text")return new Ut(a.value,a.audience);if(a.type==="tool_result"){const c=a.value.map(l=>l.type==="text"?new Ut(l.value,l.audience):l.type==="data"?new gi(l.data.buffer,l.mimeType):new Ts(l.value));return new Kc(a.toolCallId,c,a.isError)}else return a.type==="image_url"?new gi(a.value.data.buffer,a.value.mimeType):a.type==="data"?new gi(a.data.buffer,a.mimeType):a.type==="thinking"?new el(a.value,a.id,a.metadata):new Aa(a.toolCallId,a.name,a.parameters)}),n=dl.to(r.role);return new $7(n,s,r.name)}e.to=t;function i(r){const s=dl.from(r.role),n=r.name;let o=r.content;typeof o=="string"&&(o=[new Ut(o)]);const a=o.map(c=>{if(c instanceof Kc)return{type:"tool_result",toolCallId:c.callId,value:gt(c.content.map(l=>l instanceof Ut?{type:"text",value:l.value,audience:l.audience}:l instanceof Ts?{type:"prompt_tsx",value:l.value}:l instanceof gi?{type:"data",mimeType:l.mimeType,data:W.wrap(l.data),audience:l.audience}:void 0)),isError:c.isError};if(c instanceof gi)return L7(c)?{type:"image_url",value:{mimeType:c.mimeType,data:W.wrap(c.data)}}:{type:"data",mimeType:c.mimeType,data:W.wrap(c.data),audience:c.audience};if(c instanceof Aa)return{type:"tool_use",toolCallId:c.callId,name:c.name,parameters:c.input};if(c instanceof Ut)return{type:"text",value:c.value};if(c instanceof el)return{type:"thinking",value:c.value,id:c.id,metadata:c.metadata};if(typeof c!="string")throw new Error("Unexpected chat message content type llm 2");return{type:"text",value:c}});return{role:s,name:n,content:a}}e.from=i})(Og||(Og={}));function L7(e){switch(typeof e.mimeType=="string"?e.mimeType.toLowerCase():""){case"image/png":case"image/jpeg":case"image/jpg":case"image/gif":case"image/webp":case"image/bmp":return!0;default:return!1}}var kh;(function(e){function t(r){return{kind:"markdownContent",content:ge.from(r.value)}}e.from=t;function i(r){return new ig(ge.to(r.content))}e.to=i})(kh||(kh={}));var Fg;(function(e){function t(r){return{kind:"codeblockUri",uri:r.value,isEdit:r.isEdit,undoStopId:r.undoStopId}}e.from=t;function i(r){return new ag(y.revive(r.uri),r.isEdit,r.undoStopId)}e.to=i})(Fg||(Fg={}));var Ug;(function(e){function t(r){return{kind:"markdownVuln",content:ge.from(r.value),vulnerabilities:r.vulnerabilities}}e.from=t;function i(r){return new fh(ge.to(r.content),r.vulnerabilities)}e.to=i})(Ug||(Ug={}));var jg;(function(e){function t(i){return{kind:"confirmation",title:i.title,message:ge.from(i.message),data:i.data,buttons:i.buttons}}e.from=t})(jg||(jg={}));var Ch;(function(e){function t(r){const{value:s,baseUri:n}=r;function o(a,c){return a.map(l=>{const u=y.joinPath(c,l.name);return{label:l.name,uri:u,children:l.children&&o(l.children,u)}})}return{kind:"treeData",treeData:{label:dr(n),uri:n,children:o(s,n)}}}e.from=t;function i(r){const s=Gt(r.treeData);function n(c){return c.map(l=>({name:l.label,children:l.children&&n(l.children)}))}const o=s.uri,a=s.children?n(s.children):[];return new sg(a,o)}e.to=i})(Ch||(Ch={}));var py;(function(e){function t(r){return{kind:"multiDiffData",multiDiffData:{title:r.title,resources:r.value.map(s=>({originalUri:s.originalUri,modifiedUri:s.modifiedUri,goToFileUri:s.goToFileUri,added:s.added,removed:s.removed}))},readOnly:r.readOnly}}e.from=t;function i(r){const s=r.multiDiffData.resources.map(n=>({originalUri:n.originalUri?y.revive(n.originalUri):void 0,modifiedUri:n.modifiedUri?y.revive(n.modifiedUri):void 0,goToFileUri:n.goToFileUri?y.revive(n.goToFileUri):void 0,added:n.added,removed:n.removed}));return new Db(s,r.multiDiffData.title,r.readOnly)}e.to=i})(py||(py={}));var fl;(function(e){function t(r){const s=o=>y.isUri(o),n=o=>"name"in o;return{kind:"inlineReference",name:r.title,inlineReference:s(r.value)?r.value:n(r.value)?xa.from(r.value):Tr.from(r.value)}}e.from=t;function i(r){const s=Gt(r);return new ph(y.isUri(s.inlineReference)?s.inlineReference:"location"in s.inlineReference?xa.to(s.inlineReference):Tr.to(s.inlineReference),r.name)}e.to=i})(fl||(fl={}));var $h;(function(e){function t(r){return{kind:"progressMessage",content:ge.from(r.value)}}e.from=t;function i(r){return new Tb(r.content.value)}e.to=i})($h||($h={}));var Ih;(function(e){function t(r){return{kind:"thinking",value:r.value,id:r.id,metadata:r.metadata}}e.from=t;function i(r){return new Xc(r.value??"",r.id,r.metadata)}e.to=i})(Ih||(Ih={}));var Dh;(function(e){function t(r){return{kind:"warning",content:ge.from(r.value)}}e.from=t;function i(r){return new gh(r.content.value)}e.to=i})(Dh||(Dh={}));var gy;(function(e){function t(i){return{kind:"extensions",extensions:i.extensions}}e.from=t})(gy||(gy={}));var my;(function(e){function t(i){return{kind:"pullRequest",author:i.author,title:i.title,description:i.description,uri:i.uri,linkTag:i.linkTag}}e.from=t})(my||(my={}));var vy;(function(e){function t(r){return{kind:"move",uri:r.uri,range:j.from(r.range)}}e.from=t;function i(r){return new lg(y.revive(r.uri),j.to(r.range))}e.to=i})(vy||(vy={}));var Ph;(function(e){function t(r){return{kind:"prepareToolInvocation",toolName:r.toolName}}e.from=t;function i(r){return new vh(r.toolName)}e.to=i})(Ph||(Ph={}));var wy;(function(e){function t(n){return{kind:"toolInvocationSerialized",toolCallId:n.toolCallId,toolId:n.toolName,invocationMessage:n.invocationMessage?ge.from(n.invocationMessage):n.toolName,originMessage:n.originMessage?ge.from(n.originMessage):void 0,pastTenseMessage:n.pastTenseMessage?ge.from(n.pastTenseMessage):void 0,isConfirmed:n.isConfirmed,isComplete:n.isComplete??!0,source:Xr.External,toolSpecificData:n.toolSpecificData?i(n.toolSpecificData):void 0,presentation:n.presentation==="hidden"?Sc.Hidden:n.presentation==="hiddenAfterComplete"?Sc.HiddenAfterComplete:void 0,fromSubAgent:n.fromSubAgent}}e.from=t;function i(n){return"command"in n&&"language"in n?{kind:"terminal",command:n.command,language:n.language}:"commandLine"in n&&"language"in n?{kind:"terminal",commandLine:n.commandLine,language:n.language}:n}function r(n){const o=new Rb(n.toolId||n.toolName,n.toolCallId,n.isError);return n.invocationMessage&&(o.invocationMessage=n.invocationMessage),n.originMessage&&(o.originMessage=n.originMessage),n.pastTenseMessage&&(o.pastTenseMessage=n.pastTenseMessage),n.isConfirmed!==void 0&&(o.isConfirmed=n.isConfirmed),n.isComplete!==void 0&&(o.isComplete=n.isComplete),n.toolSpecificData&&(o.toolSpecificData=s(n.toolSpecificData)),o.fromSubAgent=n.fromSubAgent,o}e.to=r;function s(n){return n.kind==="terminal"?{command:n.command,language:n.language}:n.kind==="terminal2"?{commandLine:n.commandLine,language:n.language}:n}})(wy||(wy={}));var zg;(function(e){function t(i){return{kind:"progressTask",content:ge.from(i.value)}}e.from=t})(zg||(zg={}));var by;(function(e){function t(i){return{kind:"progressTaskResult",content:typeof i=="string"?ge.from(i):void 0}}e.from=t})(by||(by={}));var Th;(function(e){function t(r,s,n){return{kind:"command",command:s.toInternal(r.value,n)??{command:r.value.command,title:r.value.title}}}e.from=t;function i(r,s){return new og(s.fromInternal(r.command)??{command:r.command.id,title:r.command.title})}e.to=i})(Th||(Th={}));var Hg;(function(e){function t(r){return{kind:"textEdit",uri:r.uri,edits:r.edits.map(s=>Kt.from(s)),done:r.isDone}}e.from=t;function i(r){const s=new mh(y.revive(r.uri),r.edits.map(n=>Kt.to(n)));return s.isDone=r.done,s}e.to=i})(Hg||(Hg={}));var Wg;(function(e){function t(i){return i.newCellMetadata?{editType:3,index:i.range.start,metadata:i.newCellMetadata}:i.newNotebookMetadata?{editType:5,metadata:i.newNotebookMetadata}:{editType:1,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(al.from)}}e.from=t})(Wg||(Wg={}));var Bg;(function(e){function t(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(Wg.from),done:i.isDone}}e.from=t})(Bg||(Bg={}));var Da;(function(e){function t(r){const s=Nt.isThemeIcon(r.iconPath)?r.iconPath:y.isUri(r.iconPath)?{light:y.revive(r.iconPath)}:r.iconPath&&"light"in r.iconPath&&"dark"in r.iconPath&&y.isUri(r.iconPath.light)&&y.isUri(r.iconPath.dark)?{light:y.revive(r.iconPath.light),dark:y.revive(r.iconPath.dark)}:void 0;return typeof r.value=="object"&&"variableName"in r.value?{kind:"reference",reference:{variableName:r.value.variableName,value:y.isUri(r.value.value)||!r.value.value?r.value.value:Tr.from(r.value.value)},iconPath:s,options:r.options}:{kind:"reference",reference:y.isUri(r.value)||typeof r.value=="string"?r.value:Tr.from(r.value),iconPath:s,options:r.options}}e.from=t;function i(r){const s=Gt(r),n=o=>y.isUri(o)?o:Tr.to(o);return new ya(typeof s.reference=="string"?s.reference:"variableName"in s.reference?{variableName:s.reference.variableName,value:s.reference.value&&n(s.reference.value)}:n(s.reference))}e.to=i})(Da||(Da={}));var _g;(function(e){function t(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}e.from=t})(_g||(_g={}));var Mh;(function(e){function t(s,n,o){return s instanceof ig?kh.from(s):s instanceof ph?fl.from(s):s instanceof ya?Da.from(s):s instanceof Tb?$h.from(s):s instanceof Xc?Ih.from(s):s instanceof sg?Ch.from(s):s instanceof Db?py.from(s):s instanceof og?Th.from(s,n,o):s instanceof mh?Hg.from(s):s instanceof ug?Bg.from(s):s instanceof fh?Ug.from(s):s instanceof ag?Fg.from(s):s instanceof gh?Dh.from(s):s instanceof rg?jg.from(s):s instanceof cg?_g.from(s):s instanceof lg?vy.from(s):s instanceof Mb?gy.from(s):s instanceof vh?Ph.from(s):s instanceof Nb?my.from(s):s instanceof Rb?wy.from(s):{kind:"markdownContent",content:ge.from("")}}e.from=t;function i(s,n){switch(s.kind){case"reference":return Da.to(s);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return r(s,n)}}e.to=i;function r(s,n){switch(s.kind){case"markdownContent":return kh.to(s);case"inlineReference":return fl.to(s);case"progressMessage":return;case"treeData":return Ch.to(s);case"command":return Th.to(s,n)}}e.toContent=r})(Mh||(Mh={}));var pl;(function(e){function t(i,r,s,n,o,a,c){const l=[],u=[];for(const p of i.variables.variables)p.kind==="tool"?l.push(p):p.kind==="toolset"?l.push(...p.value):u.push(p);const h=Ss.parseLocalSessionId(i.sessionResource)??i.sessionResource.toString(),f={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??!0,isParticipantDetected:i.isParticipantDetected??!1,sessionId:h,references:u.map(p=>qg.to(p,n,c)).filter(hr),toolReferences:l.map(Pa.to),location:Vg.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:r,toolInvocationToken:Object.freeze({sessionId:h,sessionResource:i.sessionResource}),tools:o,model:s,editedFileEvents:i.editedFileEvents,modeInstructions:i.modeInstructions?.content,modeInstructions2:Ay.to(i.modeInstructions),isSubagent:i.isSubagent};return et(a,"chatParticipantPrivate")||(delete f.id,delete f.attempt,delete f.enableCommandDetection,delete f.isParticipantDetected,delete f.location,delete f.location2,delete f.editedFileEvents,delete f.sessionId,delete f.isSubagent),et(a,"chatParticipantAdditions")||(delete f.acceptedConfirmationData,delete f.rejectedConfirmationData,delete f.tools),f}e.to=t})(pl||(pl={}));var yy;(function(e){function t(i){return{prompt:i.prompt,files:i.files.map(r=>y.revive(r))}}e.to=t})(yy||(yy={}));var Vg;(function(e){function t(r){switch(r){case li.Notebook:return rs.Notebook;case li.Terminal:return rs.Terminal;case li.Chat:return rs.Panel;case li.EditorInline:return rs.Editor}}e.to=t;function i(r){switch(r){case rs.Notebook:return li.Notebook;case rs.Terminal:return li.Terminal;case rs.Panel:return li.Chat;case rs.Editor:return li.EditorInline}}e.from=i})(Vg||(Vg={}));var qg;(function(e){function t(i,r,s){let n=i.value;if(!n){let a;try{a=JSON.stringify(i)}catch{a=`kind=${i.kind}, id=${i.id}, name=${i.name}`}s.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${a}`);return}if(sf(n))n=y.revive(n);else if(n&&typeof n=="object"&&"uri"in n&&"range"in n&&sf(n.uri))n=Tr.to(Gt(n));else if(Pz(i)){const a=i.references?.[0]?.reference;n=new k7(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),a&&y.isUri(a)?a:void 0)}else if(i.kind==="diagnostic"){const a=i.filterSeverity&&wh.to(i.filterSeverity),c=i.filterUri&&y.revive(i.filterUri).toString();n=new Ub(r.map(([l,u])=>i.filterUri&&l.toString()!==c?[l,[]]:[l,u.filter(h=>!(a&&h.severity>a||i.filterRange&&!st.areIntersectingOrTouching(i.filterRange,j.from(h.range))))]).filter(([,l])=>l.length>0))}let o;return(Tz(i)||Mz(i))&&i.toolReferences&&(o=Gg.to(i.toolReferences)),{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],toolReferences:o,value:n,modelDescription:i.modelDescription}}e.to=t})(qg||(qg={}));var Pa;(function(e){function t(i){if(i.value)throw new Error("Invalid tool reference");return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}e.to=t})(Pa||(Pa={}));var Gg;(function(e){function t(i){const r=[];for(const s of i)if(s.kind==="tool")r.push(Pa.to(s));else if(s.kind==="toolset")r.push(...s.value.map(Pa.to));else throw new Error("Invalid tool reference in prompt variables");return r}e.to=t})(Gg||(Gg={}));var Ay;(function(e){function t(i){if(i)return{name:i.name,content:i.content,toolReferences:Gg.to(i.toolReferences),metadata:i.metadata}}e.to=t})(Ay||(Ay={}));var Sy;(function(e){function t(i,r,s){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:r.toInternal(i.command,s)}}e.from=t})(Sy||(Sy={}));var gl;(function(e){function t(s){return{errorDetails:s.errorDetails,metadata:r(s.metadata),nextQuestion:s.nextQuestion,details:s.details}}e.to=t;function i(s){return{errorDetails:s.errorDetails,metadata:s.metadata,nextQuestion:s.nextQuestion,details:s.details}}e.from=i;function r(s){return lc(s,n=>{if(n.$mid===20)return new fg(lc(n.content,r));if(n.$mid===21)return new Ut(n.value);if(n.$mid===22)return new el(n.value,n.id,n.metadata);if(n.$mid===23)return new Ts(n.value)})}})(gl||(gl={}));var Ey;(function(e){function t(i,r,s){if(r.action.kind==="vote")return;const n=gl.to(i);if(r.action.kind==="command"){const o=r.action.commandButton.command;return{action:{kind:"command",commandButton:{command:s.fromInternal(o)??{command:o.id,title:o.title}}},result:n}}else return r.action.kind==="followUp"?{action:{kind:"followUp",followup:Lg.to(r.action.followup)},result:n}:r.action.kind==="inlineChat"?{action:{kind:"editor",accepted:r.action.action==="accepted"},result:n}:r.action.kind==="chatEditingSessionAction"?{action:{kind:"chatEditingSessionAction",outcome:new Map([["accepted",Ps.Accepted],["rejected",Ps.Rejected],["saved",Ps.Saved]]).get(r.action.outcome)??Ps.Rejected,uri:y.revive(r.action.uri),hasRemainingEdits:r.action.hasRemainingEdits},result:n}:r.action.kind==="chatEditingHunkAction"?{action:{kind:"chatEditingHunkAction",outcome:new Map([["accepted",Ps.Accepted],["rejected",Ps.Rejected]]).get(r.action.outcome)??Ps.Rejected,uri:y.revive(r.action.uri),hasRemainingEdits:r.action.hasRemainingEdits,lineCount:r.action.lineCount,linesAdded:r.action.linesAdded,linesRemoved:r.action.linesRemoved},result:n}:{action:r.action,result:n}}e.to=t})(Ey||(Ey={}));var Zg;(function(e){function t(i,r,s){return"terminalCommand"in i?{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}:"uri"in i?{uri:i.uri}:r.toInternal(i,s)}e.from=t})(Zg||(Zg={}));var Jg;(function(e){function t(i){return{...i,documentation:ge.fromStrict(i.documentation)}}e.from=t})(Jg||(Jg={}));var xy;(function(e){function t(i,r){return Array.isArray(i)?{items:i.map(s=>Jg.from(s))}:{items:i.items.map(s=>Jg.from(s)),resourceOptions:i.resourceOptions?ky.from(i.resourceOptions,r):void 0}}e.from=t})(xy||(xy={}));var ky;(function(e){function t(i,r){return{...i,pathSeparator:r,cwd:i.cwd,globPattern:Wi.from(i.globPattern)??void 0}}e.from=t})(ky||(ky={}));var Cy;(function(e){function t(i){return{kind:$y.to(i.kind),acceptedLength:i.acceptedLength}}e.to=t})(Cy||(Cy={}));var $y;(function(e){function t(i){switch(i){case 0:return fa.Word;case 1:return fa.Line;case 2:return fa.Suggest;default:return fa.Unknown}}e.to=t})($y||($y={}));var Iy;(function(e){function t(i,r){if(i.kind===Nf.Ignored){const s=i.supersededBy?r(i.supersededBy):void 0;return{kind:Mc.Ignored,supersededBy:s,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===Nf.Accepted)return{kind:Mc.Accepted};return{kind:Mc.Rejected}}e.to=t})(Iy||(Iy={}));var Dy;(function(e){function t(r){return r===Nc.Label?mc.Label:mc.Code}e.from=t;function i(r){switch(r){case mc.Label:return Nc.Label;default:return Nc.Code}}e.to=i})(Dy||(Dy={}));var Py;(function(e){function t(i,r){return{id:r,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||0,contextValue:i.contextValue}}e.from=t})(Py||(Py={}));var Ty;(function(e){function t(i){return i.type==="mcp"?new P7(i.label,i.serverLabel||i.label,i.instructions):i.type==="extension"?new D7(i.extensionId.value,i.label):void 0}e.to=t})(Ty||(Ty={}));var Qg;(function(e){function t(r){return new fg(r.content.map(s=>s.kind==="text"?new Ut(s.value,s.audience):s.kind==="data"?new gi(s.value.data.buffer,s.value.mimeType,s.audience):new Ts(s.value)))}e.to=t;function i(r,s){r.toolResultMessage&&T(s,"chatParticipantPrivate");const n=c=>{c.audience&&T(s,"languageModelToolResultAudience")};let o=!1;const a={content:r.content.map(c=>{if(c instanceof Ut)return n(c),{kind:"text",value:c.value,audience:c.audience};if(c instanceof Ts)return{kind:"promptTsx",value:c.value};if(c instanceof gi)return n(c),o=!0,{kind:"data",value:{mimeType:c.mimeType,data:W.wrap(c.data)},audience:c.audience};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:ge.fromStrict(r.toolResultMessage),toolResultDetails:r.toolResultDetails?.map(c=>y.isUri(c)?c:Tr.from(c))};return o?new fi(a):a}e.from=i})(Qg||(Qg={}));var O7;(function(e){function t(r){const s=new I7(r.content.map(n=>n.kind==="text"?new Ut(n.value,n.audience):n.kind==="data"?new gi(n.value.data.buffer,n.value.mimeType,n.audience):new Ts(n.value)));return r.toolMetadata&&(s.toolMetadata=r.toolMetadata),s}e.to=t;function i(r,s){r.toolResultMessage&&T(s,"chatParticipantPrivate");const n=l=>{l.audience&&T(s,"languageModelToolResultAudience")};let o=!1,a;Array.isArray(r.toolResultDetails)?a=r.toolResultDetails?.map(l=>y.isUri(l)?l:Tr.from(l)):r.toolResultDetails2&&(a={output:{type:"data",mimeType:r.toolResultDetails2.mime,value:W.wrap(r.toolResultDetails2.value)}},o=!0);const c={content:r.content.map(l=>{if(l instanceof Ut)return n(l),{kind:"text",value:l.value,audience:l.audience};if(l instanceof Ts)return{kind:"promptTsx",value:l.value};if(l instanceof gi)return n(l),o=!0,{kind:"data",value:{mimeType:l.mimeType,data:W.wrap(l.data)},audience:l.audience};throw new Error("Unknown LanguageModelToolResult part type")}),toolResultMessage:ge.fromStrict(r.toolResultMessage),toolResultDetails:a,toolMetadata:r.toolMetadata};return o?new fi(c):c}e.from=i})(O7||(O7={}));var go;(function(e){function t(s){return s}e.fromThemeIcon=t;function i(s){if(s){if(Nt.isThemeIcon(s))return s;if(y.isUri(s))return s;if(typeof s=="string")return y.file(s);if(typeof s=="object"&&s!==null&&"dark"in s){const n=typeof s.dark=="string"?y.file(s.dark):s.dark,o=typeof s.light=="string"?y.file(s.light):s.light;return n?{dark:n,light:o??n}:void 0}else return}else return}e.from=i;function r(s){if(s){if(Nt.isThemeIcon(s))return s;if(sf(s))return y.revive(s);{const n=s;return{light:y.revive(n.light),dark:y.revive(n.dark)}}}else return}e.to=r})(go||(go={}));var My;(function(e){function t(r){return{query:r.query,kind:i(r.kind),settings:r.settings}}e.fromSettingsSearchResult=t;function i(r){switch(r){case Kn.EMBEDDED:return Kn.EMBEDDED;case Kn.LLM_RANKED:return Kn.LLM_RANKED;case Kn.CANCELED:return Kn.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(My||(My={}));var Nh;(function(e){function t(r){return!!r.uri}function i(r){return Mu.toSerialized(t(r)?{type:2,uri:r.uri,headers:Object.entries(r.headers),authentication:r.authentication?{providerId:r.authentication.providerId,scopes:r.authentication.scopes}:void 0}:{type:1,cwd:r.cwd?.fsPath,args:r.args,command:r.command,env:r.env,envFile:void 0})}e.from=i})(Nh||(Nh={}));var Ny;(function(e){function t(i){switch(i){case jc.Error:return 0;case jc.Warning:return 1;case jc.Information:return 2;default:throw new Error("Unknown SourceControlInputBoxValidationType")}}e.from=t})(Ny||(Ny={}));var F7=class x5{constructor(t,i){this.line=t,this.character=i}isBefore(t){return!1}isBeforeOrEqual(t){return!1}isAfter(t){return!1}isAfterOrEqual(t){return!1}isEqual(t){return!1}compareTo(t){return 0}translate(t,i){return new x5(0,0)}with(t){return new x5(0,0)}},U7=class k5{constructor(t,i,r,s){this.isEmpty=!1,this.isSingleLine=!1,this.start=new F7(t,i),this.end=new F7(r,s)}contains(t){return!1}isEqual(t){return!1}intersection(t){}union(t){return new k5(0,0,0,0)}with(t){return new k5(0,0,0,0)}},ln=class{constructor(e,t,i){this.uri=e,this.ranges=t,this.previewText=i}},Yg=class{constructor(e,t,i){this.uri=e,this.text=t,this.lineNumber=i}},Ry=class{constructor(e){this.keyword=e}},un;(function(e){e[e.None=1]="None",e[e.FilesExclude=2]="FilesExclude",e[e.SearchAndFilesExclude=3]="SearchAndFilesExclude"})(un||(un={}));var Xg;(function(e){e[e.Information=1]="Information",e[e.Warning=2]="Warning"})(Xg||(Xg={}));var Kg=2e4,j7="\u27EA ",z7=" characters skipped \u27EB",nB=(j7.length+z7.length+5)*2,vre=H("searchService"),H7;(function(e){e[e.file=0]="file",e[e.text=1]="text",e[e.aiText=2]="aiText"})(H7||(H7={}));var W7;(function(e){e[e.File=1]="File",e[e.Text=2]="Text",e[e.aiText=3]="aiText"})(W7||(W7={}));function Ly(e){return!!e.rangeLocations&&!!e.previewText}var B7;(function(e){e[e.Normal=0]="Normal",e[e.NewSearchStarted=1]="NewSearchStarted"})(B7||(B7={}));var _7=class{constructor(e,t,i,r){this.rangeLocations=[],this.webviewIndex=r;const s=Array.isArray(t)?t:[t];if(i&&i.matchLines===1&&oB(s)){e=p2(e,i.matchLines);let n="",o=0,a=0;const c=Math.floor(i.charsPerLine/5);for(const l of s){const u=Math.max(l.startColumn-c,0),h=l.startColumn+i.charsPerLine;if(u>a+c+nB){const f=j7+(u-a)+z7;n+=f+e.slice(u,h),o+=u-(a+f.length)}else n+=e.slice(a,h);a=h,this.rangeLocations.push({source:l,preview:new aB(0,l.startColumn-o,l.endColumn-o)})}this.previewText=n}else{const n=Array.isArray(t)?t[0].startLineNumber:t.startLineNumber,o=Bd(t,a=>({preview:new Oy(a.startLineNumber-n,a.startColumn,a.endLineNumber-n,a.endColumn),source:a}));this.rangeLocations=Array.isArray(o)?o:[o],this.previewText=e}}};function oB(e){const t=e[0].startLineNumber;for(const i of e)if(i.startLineNumber!==t||i.endLineNumber!==t)return!1;return!0}var Oy=class{constructor(e,t,i,r){this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=r}},aB=class extends Oy{constructor(e,t,i){super(e,t,e,i)}},V7;(function(e){e.List="list",e.Tree="tree"})(V7||(V7={}));var q7;(function(e){e.Default="default",e.FileNames="fileNames",e.Type="type",e.Modified="modified",e.CountDescending="countDescending",e.CountAscending="countAscending"})(q7||(q7={}));var G7;(function(e){e.Auto="auto",e.Manual="manual",e.RunOnEmpty="runOnEmpty"})(G7||(G7={}));function cB(e,t=!0){const i=e&&e.files&&e.files.exclude,r=t&&e&&e.search&&e.search.exclude;if(!i&&!r)return;if(!i||!r)return i||r||void 0;let s=Object.create(null);return s=Qs(s,ot(i)),s=Qs(s,ot(r),!0),s}function Z7(e,t){return e.excludePattern&&Ec(e.excludePattern,t)?!1:e.includePattern||e.usingSearchPaths?e.includePattern&&Ec(e.includePattern,t)?!0:e.usingSearchPaths?!!e.folderQueries&&e.folderQueries.some(i=>{const r=i.folder.fsPath;if(zo(t,r)){const s=tc(r,t);return!i.includePattern||!!Ec(i.includePattern,s)}else return!1}):!1:!0}var mo;(function(e){e[e.unknownEncoding=1]="unknownEncoding",e[e.regexParseError=2]="regexParseError",e[e.globParseError=3]="globParseError",e[e.invalidLiteral=4]="invalidLiteral",e[e.rgProcessError=5]="rgProcessError",e[e.other=6]="other",e[e.canceled=7]="canceled"})(mo||(mo={}));var Ta=class extends Error{constructor(e,t){super(e),this.code=t}};function J7(e){const t={message:e.message,code:e.code};return new Error(JSON.stringify(t))}function lB(e){return!!e.path}function Fy(e,t,i=!0){const r=e.searchPath?e.searchPath:e.relativePath;return i?d2(r,t):Ec(t,r)}function ml(e,t){const i={...e||{},...t||{}};return Object.keys(i).filter(r=>{const s=i[r];return typeof s=="boolean"&&s})}var Q7=class{constructor(e,t){this.c=null,this.a=t.excludePattern?.map(r=>({...e.excludePattern||{},...r.pattern||{}}))??[],this.a.length===0&&(this.a=[e.excludePattern||{}]),this.b=this.a.map(r=>Kr(r));let i=e.includePattern;t.includePattern&&(i?i={...i,...t.includePattern}:i=t.includePattern),i&&(this.c=Kr(i))}d(e,t,i){let r=null;for(const s of this.b){const n=s(e,t,i);if(typeof n=="string"){r=n;break}}return r}matchesExcludesSync(e,t,i){return!!(this.b&&this.d(e,t,i))}includedInQuerySync(e,t,i){return!(this.b&&this.d(e,t,i)||this.c&&!this.c(e,t,i))}includedInQuery(e,t,i){const r=()=>this.c?!!this.c(e,t,i):!0;return Promise.all(this.b.map(s=>{const n=s(e,t,i);return Fn(n)?n.then(o=>o?!1:r()):r()})).then(s=>s.some(n=>!!n))}hasSiblingExcludeClauses(){return this.a.reduce((e,t)=>uB(t)||e,!1)}};function uB(e){for(const t in e)if(typeof e[t]!="boolean")return!0;return!1}function hB(e){if(!e)return;let t;return i=>(t||(t=(e()||Promise.resolve([])).then(r=>r?Y7(r):{})),t.then(r=>!!r[i]))}function Uy(e){if(!e)return;let t;return i=>{if(!t){const r=e();t=r?Y7(r):{}}return!!t[i]}}function Y7(e){const t={};for(const i of e)t[i]=!0;return t}function X7(e){return e.flatMap(t=>t.patterns.map(i=>t.baseUri?{baseUri:t.baseUri,pattern:i}:i))}var jy={matchLines:100,charsPerLine:1e4},dB=!1,fB=class{constructor(e,t,i){this.id=e,this.dependencies=t,this.callback=i}},Ma;(function(e){e[e.Uninitialized=1]="Uninitialized",e[e.InitializedInternal=2]="InitializedInternal",e[e.InitializedExternal=3]="InitializedExternal"})(Ma||(Ma={}));var pB=class dN{static{this.INSTANCE=new dN}constructor(){this.a=typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope",this.b=typeof document=="object",this.c=[],this.d=Ma.Uninitialized}g(){if(this.d===Ma.Uninitialized){if(globalThis.define){this.d=Ma.InitializedExternal;return}}else return;this.d=Ma.InitializedInternal,globalThis.define=(t,i,r)=>{typeof t!="string"&&(r=i,i=t,t=null),(typeof i!="object"||!Array.isArray(i))&&(r=i,i=null),this.c.push(new fB(t,i,r))},globalThis.define.amd=!0,this.b?this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??window.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){if(t.startsWith(window.location.origin)||t.startsWith(`${q.vscodeFileResource}://${XE}`))return t;throw new Error(`[trusted_script_src] Invalid script url: ${t}`)}}):this.a&&(this.f=globalThis._VSCODE_WEB_PACKAGE_TTP??globalThis.trustedTypes?.createPolicy("amdLoader",{createScriptURL(t){return t}}))}async load(t){if(this.g(),this.d===Ma.InitializedExternal)return new Promise(o=>{const a=Tt();globalThis.define(a,[t],function(c){o(c)})});const i=await(this.a?this.i(t):this.b?this.h(t):this.j(t));if(!i){console.warn(`Did not receive a define call from script ${t}`);return}const r={},s=[],n=[];if(Array.isArray(i.dependencies))for(const o of i.dependencies)o==="exports"?s.push(r):n.push(o);if(n.length>0)throw new Error(`Cannot resolve dependencies for script ${t}. The dependencies are: ${n.join(", ")}`);return typeof i.callback=="function"?i.callback(...s)??r:i.callback}h(t){return new Promise((i,r)=>{const s=document.createElement("script");s.setAttribute("async","async"),s.setAttribute("type","text/javascript");const n=()=>{s.removeEventListener("load",o),s.removeEventListener("error",a)},o=c=>{n(),i(this.c.pop())},a=c=>{n(),r(c)};s.addEventListener("load",o),s.addEventListener("error",a),this.f&&(t=this.f.createScriptURL(t)),s.setAttribute("src",t),window.document.getElementsByTagName("head")[0].appendChild(s)})}async i(t){return this.f&&(t=this.f.createScriptURL(t)),await import(t),this.c.pop()}async j(t){try{const i=(await import("fs")).default,r=(await import("vm")).default,s=(await import("module")).default,n=y.parse(t).fsPath,o=i.readFileSync(n).toString(),a=s.wrap(o.replace(/^#!.*/,""));return new r.Script(a).runInThisContext().apply(),this.c.pop()}catch(i){throw i}}},zy=new Map;async function Hy(e,t,i){i===void 0&&(i=!!(globalThis._VSCODE_PRODUCT_JSON??globalThis.vscode?.context?.configuration()?.product)?.commit);const r=t?`${e}/${t}`:e;if(zy.has(r))return zy.get(r);let s;if(/^\w[\w\d+.-]*:\/\//.test(r))s=r;else{const c=`${dB&&i&&!No?U2:F2}/${r}`;s=af.asBrowserUri(c).toString(!0)}const n=pB.INSTANCE.load(s);return zy.set(r,n),n}var em="utf8",Wy="utf8bom",tm="utf16be",im="utf16le",rm=[254,255],By=[255,254],Rh=[239,187,191],gB=512,mB=512,vB=512*8,wB=512*128,K7;(function(e){e[e.STREAM_IS_BINARY=1]="STREAM_IS_BINARY"})(K7||(K7={}));var bB=class extends Error{constructor(e,t){super(e),this.decodeStreamErrorKind=t}},yB=class fN{static async create(t){let i;if(t!==em)i=(await Hy("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getDecoder(e9(t));else{const r=new TextDecoder;i={write(s){return r.decode(s,{stream:!0})},end(){return r.decode()}}}return new fN(i)}constructor(t){this.a=t}write(t){return this.a.write(t)}end(){return this.a.end()}};function AB(e,t){const i=t.minBytesRequiredForDetection??(t.guessEncoding?vB:mB);return new Promise((r,s)=>{const n=uf(h=>h.join("")),o=[];let a=0,c;const l=new Qe,u=async()=>{try{const h=await TB({buffer:W.concat(o),bytesRead:a},t.guessEncoding,t.candidateGuessEncodings);if(h.seemsBinary&&t.acceptTextOnly)throw new bB("Stream is binary but only text is accepted for decoding",1);h.encoding=await t.overwriteEncoding(h.encoding),c=await yB.create(h.encoding);const f=c.write(W.concat(o).buffer);n.write(f),o.length=0,a=0,r({stream:n,detected:h})}catch(h){l.cancel(),n.destroy(),s(h)}};Bv(e,{onData:async h=>{c?n.write(c.write(h.buffer)):(o.push(h),a+=h.byteLength,a>=i&&(e.pause(),await u(),setTimeout(()=>e.resume())))},onError:h=>n.error(h),onEnd:async()=>{c||await u(),n.end(c?.end())}},l.token)})}async function SB(e,t,i){const s=(await Hy("@vscode/iconv-lite-umd","lib/iconv-lite-umd.js")).getEncoder(e9(t),i);let n=!1,o=!1;return{read(){if(o)return null;const a=e.read();if(typeof a!="string"){if(o=!0,!n&&i?.addBOM)switch(t){case em:case Wy:return W.wrap(Uint8Array.from(Rh));case tm:return W.wrap(Uint8Array.from(rm));case im:return W.wrap(Uint8Array.from(By))}const c=s.end();return c&&c.length>0?(n=!0,W.wrap(c)):null}return n=!0,W.wrap(s.write(a))}}}function e9(e){return e===Wy||e===null?em:e}function EB(e,t){if(!e||t<rm.length)return null;const i=e.readUInt8(0),r=e.readUInt8(1);if(i===rm[0]&&r===rm[1])return tm;if(i===By[0]&&r===By[1])return im;if(t<Rh.length)return null;const s=e.readUInt8(2);return i===Rh[0]&&r===Rh[1]&&s===Rh[2]?Wy:null}var xB=["ascii","utf-16","utf-32"];async function kB(e,t){const i=await Hy("jschardet","dist/jschardet.min.js"),r=e.slice(0,wB),s=DB(r.buffer);t&&(t=gt(t.map(a=>IB(a))),t.length===0&&(t=void 0));let n;try{n=i.detect(s,t?{detectEncodings:t}:void 0)}catch{return null}if(!n?.encoding)return null;const o=n.encoding.toLowerCase();return 0<=xB.indexOf(o)?null:$B(n.encoding)}var CB={ibm866:"cp866",big5:"cp950"};function t9(e){return e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function $B(e){const t=t9(e);return CB[t]||t}function IB(e){const t=t9(e),i=MB[t];return i?i.guessableName:void 0}function DB(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function PB(e){switch(e){case"shiftjis":return"shift-jis";case"utf16le":return"utf-16le";case"utf16be":return"utf-16be";case"big5hkscs":return"big5-hkscs";case"eucjp":return"euc-jp";case"euckr":return"euc-kr";case"koi8r":return"koi8-r";case"koi8u":return"koi8-u";case"macroman":return"x-mac-roman";case"utf8bom":return"utf8";default:{const t=e.match(/windows(\d+)/);return t?"windows-"+t[1]:e}}}function TB({buffer:e,bytesRead:t},i,r){let s=EB(e,t),n=!1;if(s!==tm&&s!==im&&e){let o=!0,a=!0,c=!1;for(let l=0;l<t&&l<gB;l++){const u=l%2===1,h=e.readUInt8(l)===0;if(h&&(c=!0),o&&(u&&!h||!u&&h)&&(o=!1),a&&(u&&h||!u&&!h)&&(a=!1),h&&!o&&!a)break}c&&(o?s=im:a?s=tm:n=!0)}return i&&!n&&!s&&e?kB(e.slice(0,t),r).then(o=>({seemsBinary:!1,encoding:o})):{seemsBinary:n,encoding:s}}var _y={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:!0,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}},MB=(()=>{const e={};for(const t in _y)_y[t].guessableName&&(e[t]=_y[t]);return e})(),wre=H("textFileService"),i9;(function(e){e[e.FILE_IS_BINARY=0]="FILE_IS_BINARY"})(i9||(i9={}));var r9;(function(e){e[e.SAVED=0]="SAVED",e[e.DIRTY=1]="DIRTY",e[e.PENDING_SAVE=2]="PENDING_SAVE",e[e.CONFLICT=3]="CONFLICT",e[e.ORPHAN=4]="ORPHAN",e[e.ERROR=5]="ERROR"})(r9||(r9={}));var s9;(function(e){e[e.EDITOR=1]="EDITOR",e[e.REFERENCE=2]="REFERENCE",e[e.OTHER=3]="OTHER"})(s9||(s9={}));var n9;(function(e){e[e.Encode=0]="Encode",e[e.Decode=1]="Decode"})(n9||(n9={}));function NB(e){let t=!1;return{read(){return t?null:(t=!0,e)}}}function Lh(e,t,i){return new sc(r=>sm(r,i)).isEqual(e,t)}function RB(e,t,i){return Lh(e.uri,t.uri,i)?0:jo(e.uri.toString(),t.uri.toString())}function LB(e,t,i){return e.index!==t.index?e.index<t.index?-1:1:Lh(e.uri,t.uri,i)?jo(e.name,t.name):jo(e.uri.toString(),t.uri.toString())}function o9(e,t,i,r){const s=e.slice(0).sort((o,a)=>i(o,a,r)),n=t.slice(0).sort((o,a)=>i(o,a,r));return UR(s,n,(o,a)=>i(o,a,r))}function sm(e,t){const i=t.getCapabilities(e.scheme);return!(i&&i&1024)}var Vy=class C5 extends lj{static toExtHostWorkspace(t,i,r,s){if(!t)return{workspace:null,added:[],removed:[]};const{id:n,name:o,folders:a,configuration:c,transient:l,isUntitled:u}=t,h=[],f=i;i?a.forEach((b,S)=>{const E=y.revive(b.uri),$=C5.o(r||i,E,s);$?($.name=b.name,$.index=b.index,h.push($)):h.push({uri:E,name:b.name,index:S})}):h.push(...a.map(({uri:b,name:S,index:E})=>({uri:y.revive(b),name:S,index:E}))),h.sort((b,S)=>b.index<S.index?-1:1);const p=new C5(n,o,h,!!l,c?y.revive(c):null,!!u,b=>sm(b,s)),{added:g,removed:v}=o9(f?f.workspaceFolders:[],p.workspaceFolders,RB,s);return{workspace:p,added:g,removed:v}}static o(t,i,r){for(let s=0;s<t.folders.length;s++){const n=t.workspaceFolders[s];if(Lh(n.uri,i,r))return n}}constructor(t,i,r,s,n,o,a){super(t,r.map(c=>new I0(c)),s,n,a),this.t=i,this.u=o,this.q=[],this.s=Vn.forUris(a,()=>!0),r.forEach(c=>{this.q.push(c),this.s.set(c.uri,c)})}get name(){return this.t}get isUntitled(){return this.u}get workspaceFolders(){return this.q.slice(0)}getWorkspaceFolder(t,i){return i&&this.s.get(t)&&(t=ou(t)),this.s.findSubstr(t)}resolveWorkspaceFolder(t){return this.s.get(t)}},qy=class{constructor(t,i,r,s,n){this.c=new I,this.onDidChangeWorkspace=this.c.event,this.g=new I,this.onDidGrantWorkspaceTrust=this.g.event,this.u=[],this.v=!1,this.w=new Map,this.B=0,this.C=new eu,this.D=new Map,this.h=s,this.s=r,this.t=n,this.j=new sj,this.k=new fr,this.o=t.getProxy(X.MainThreadWorkspace),this.q=t.getProxy(X.MainThreadMessageService);const o=i.workspace;this.l=o?new Vy(o.id,o.name,[],!!o.transient,o.configuration?y.revive(o.configuration):null,!!o.isUntitled,a=>sm(a,r)):void 0}$initializeWorkspace(t,i){this.v=i,this.$acceptWorkspaceData(t),this.k.open()}waitForInitializeCall(){return this.k.wait()}get workspace(){return this.x}get name(){return this.x?this.x.name:void 0}get workspaceFile(){if(this.x&&this.x.configuration)return this.x.isUntitled?y.from({scheme:q.untitled,path:dr(ou(this.x.configuration))}):this.x.configuration}get x(){return this.n||this.l}getWorkspaceFolders(){if(this.x)return this.x.workspaceFolders.slice(0)}async getWorkspaceFolders2(){if(await this.k.wait(),!!this.x)return this.x.workspaceFolders.slice(0)}updateWorkspaceFolders(t,i,r,...s){const n=[];if(Array.isArray(s)&&s.forEach(u=>{y.isUri(u.uri)&&!n.some(h=>Lh(h.uri,u.uri,this.s))&&n.push({uri:u.uri,name:u.name||zv(u.uri)})}),this.n||[i,r].some(u=>typeof u!="number"||u<0)||r===0&&n.length===0)return!1;const o=this.x?this.x.workspaceFolders:[];if(i+r>o.length)return!1;const a=o.slice(0);a.splice(i,r,...n.map(u=>({uri:u.uri,name:u.name||zv(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const h=a[u];if(a.some((f,p)=>p!==u&&Lh(h.uri,f.uri,this.s)))return!1}a.forEach((u,h)=>u.index=h);const{added:c,removed:l}=o9(o,a,LB,this.s);if(c.length===0&&l.length===0)return!1;if(this.o){const u=t.displayName||t.name;this.o.$updateWorkspaceFolders(u,i,r,n).then(void 0,h=>{this.n=void 0;const f={source:{identifier:t.identifier,label:t.displayName||t.name}};this.q.$showMessage(oj.Error,d(3035,null,u,h.toString()),f,[])})}return this.y(a),!0}getWorkspaceFolder(t,i){if(this.x)return this.x.getWorkspaceFolder(t,i)}async getWorkspaceFolder2(t,i){if(await this.k.wait(),!!this.x)return this.x.getWorkspaceFolder(t,i)}async resolveWorkspaceFolder(t){if(await this.k.wait(),!!this.x)return this.x.resolveWorkspaceFolder(t)}getPath(){if(!this.x)return;const{folders:t}=this.x;if(t.length!==0)return t[0].uri.fsPath}getRelativePath(t,i){let r,s="";if(typeof t=="string"?(r=y.file(t),s=t):typeof t<"u"&&(r=t,s=t.fsPath),!r)return s;const n=this.getWorkspaceFolder(r,!0);if(!n)return s;typeof i>"u"&&this.x&&(i=this.x.folders.length>1);let o=tx(n.uri,r);return i&&n.name&&(o=`${n.name}/${o}`),o}y(t){this.x&&(this.n=Vy.toExtHostWorkspace({id:this.x.id,name:this.x.name,configuration:this.x.configuration,folders:t,isUntitled:this.x.isUntitled},this.x,void 0,this.s).workspace||void 0)}$acceptWorkspaceData(t){const{workspace:i,added:r,removed:s}=Vy.toExtHostWorkspace(t,this.l,this.n,this.s);this.l=i||void 0,this.n=void 0,this.c.fire(Object.freeze({added:r,removed:s}))}findFiles(t,i,r,s,n=Fe.None){this.h.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${s.value}, entryPoint: findFiles`);let o="",a=!0;return i===null?a=!1:i!==void 0&&(typeof i=="string"?o=i:o=i.pattern),this.z({type:"include",value:t},{exclude:[o],maxResults:r,useExcludeSettings:a?un.FilesExclude:un.None,useIgnoreFiles:{local:!1}},n)}findFiles2(t,i={},r,s=Fe.None){return this.h.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${r.value}, entryPoint: findFiles2New`),this.z({type:"filePatterns",value:t},i,s)}async z(t,i,r){if(r.isCancellationRequested)return Promise.resolve([]);const s=t.type==="include"?[t.value]:t.value??[];if(!Array.isArray(s))throw console.error("Invalid file pattern provided",s),new Error(`Invalid file pattern provided ${JSON.stringify(s)}`);const n=s.map(o=>{const a=a9(i.exclude),c={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===un.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==un.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:t.type==="include"?void 0:!0},l=nm(Wi.from(o)),u=l?.folder;return t.type==="include"?c.includePattern=l?.pattern:c.filePattern=l?.pattern,{folder:u,options:c}});return this.A(n,r)}async A(t,i){const s=(await Promise.all(t?.map(a=>this.o.$startFileSearch(a.folder??null,a.options,i).then(c=>Array.isArray(c)?c.map(l=>y.revive(l)):[]))??[])).flat(),n=new sc(a=>sm(a,this.s)),o=new Map;for(const a of s){const c=n.getComparisonKey(a);o.has(c)||o.set(c,a)}return Array.from(o.values())}findTextInFiles2(t,i,r,s=Fe.None){this.h.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${r.value}, entryPoint: findTextInFiles2`);const n=f=>{if(!i)return{folder:void 0,options:{}};const p=f?nm(Wi.from(f)):void 0,g=i.exclude?a9(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local=="boolean"?!i.useIgnoreFiles?.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global=="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent=="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===un.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==un.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:p?.pattern,excludePattern:g},folder:p?.folder}},a=(i?.include?.map(f=>n(f))??[n(void 0)]).filter(f=>!!f),c=new ie,l=c.add(new I),u=this.findTextInFilesBase(t,a,(f,p)=>l.fire({result:f,uri:p}),s);return{results:new mx(async f=>{c.add(l.event(p=>{const g=p.result,v=p.uri;Ly(g)?f.emitOne(new ln(v,g.rangeLocations.map(b=>({previewRange:new xe(b.preview.startLineNumber,b.preview.startColumn,b.preview.endLineNumber,b.preview.endColumn),sourceRange:new xe(b.source.startLineNumber,b.source.startColumn,b.source.endLineNumber,b.source.endColumn)})),g.previewText)):f.emitOne(new Yg(v,g.text,g.lineNumber))})),await u}),complete:u.then(f=>(c.dispose(),{limitHit:f?.limitHit??!1}))}}async findTextInFilesBase(t,i,r,s=Fe.None){const n=this.j.getNext();let o=!1;if(s.onCancellationRequested(a=>{o=!0}),this.u[n]=a=>{if(o)return;const c=y.revive(a.resource);a.results.forEach(l=>{const u=Gt(l);r(u,c)})},s.isCancellationRequested)return{};try{const a=await Promise.all(i?.map(c=>this.o.$startTextSearch(t,c.folder??null,c.options,n,s)||{})??[]);return delete this.u[n],a.reduce((c,l)=>({limitHit:c?.limitHit||(l?.limitHit??!1),message:[c?.message??[],l?.message??[]].flat()}),{})??{limitHit:!1}}catch(a){throw delete this.u[n],a}}async findTextInFiles(t,i,r,s,n=Fe.None){this.h.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${s.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions>"u"?{matchLines:100,charsPerLine:1e4}:i.previewOptions,a=nm(Wi.from(i.include)),c=typeof i.exclude=="string"?i.exclude:i.exclude?i.exclude.pattern:void 0,l={ignoreSymlinks:typeof i.followSymlinks=="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles=="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles=="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles=="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes=="boolean"?!i.useDefaultExcludes:!0,disregardSearchExcludeSettings:typeof i.useSearchExclude=="boolean"?!i.useSearchExclude:!0,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:c?[{pattern:c}]:void 0},u=(h,f)=>{Ly(h)?r({uri:f,preview:{text:h.previewText,matches:Bd(h.rangeLocations,p=>new xe(p.preview.startLineNumber,p.preview.startColumn,p.preview.endLineNumber,p.preview.endColumn))},ranges:Bd(h.rangeLocations,p=>new xe(p.source.startLineNumber,p.source.startColumn,p.source.endLineNumber,p.source.endColumn))}):r({uri:f,text:h.text,lineNumber:h.lineNumber})};return this.findTextInFilesBase(t,[{options:l,folder:a?.folder}],u,n)}$handleTextSearchResult(t,i){this.u[i]?.(t)}async save(t){const i=await this.o.$save(t,{saveAs:!1});return y.revive(i)}async saveAs(t){const i=await this.o.$save(t,{saveAs:!0});return y.revive(i)}saveAll(t){return this.o.$saveAll(t)}resolveProxy(t){return this.o.$resolveProxy(t)}lookupAuthorization(t){return this.o.$lookupAuthorization(t)}lookupKerberosAuthorization(t){return this.o.$lookupKerberosAuthorization(t)}loadCertificates(){return this.o.$loadCertificates()}get trusted(){return this.v}requestWorkspaceTrust(t){return this.o.$requestWorkspaceTrust(t)}$onDidGrantWorkspaceTrust(){this.v||(this.v=!0,this.g.fire())}registerEditSessionIdentityProvider(t,i){if(this.w.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.w.set(t,i);const r=this.t.transformOutgoingScheme(t),s=this.B++;return this.o.$registerEditSessionIdentityProvider(s,r),te(()=>{this.w.delete(t),this.o.$unregisterEditSessionIdentityProvider(s)})}async $getEditSessionIdentifier(t,i){this.h.info("Getting edit session identifier for workspaceFolder",t);const r=await this.resolveWorkspaceFolder(y.revive(t));if(!r){this.h.warn("Unable to resolve workspace folder");return}this.h.info("Invoking #provideEditSessionIdentity for workspaceFolder",r);const s=this.w.get(r.uri.scheme);if(this.h.info(`Provider for scheme ${r.uri.scheme} is defined: `,!!s),!s)return;const n=await s.provideEditSessionIdentity(r,i);if(this.h.info("Provider returned edit session identifier: ",n),!!n)return n}async $provideEditSessionIdentityMatch(t,i,r,s){this.h.info("Getting edit session identifier for workspaceFolder",t);const n=await this.resolveWorkspaceFolder(y.revive(t));if(!n){this.h.warn("Unable to resolve workspace folder");return}this.h.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const o=this.w.get(n.uri.scheme);if(this.h.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!o),!o)return;const a=await o.provideEditSessionIdentityMatch?.(i,r,s);if(this.h.info("Provider returned edit session identifier match result: ",a),!!a)return a}getOnWillCreateEditSessionIdentityEvent(t){return(i,r,s)=>{const n=function(a){i.call(r,a)};return n.extension=t,this.C.event(n,void 0,s)}}async $onWillCreateEditSessionIdentity(t,i,r){const s=await this.resolveWorkspaceFolder(y.revive(t));if(s===void 0)throw new Error("Unable to resolve workspace folder");await this.C.fireAsync({workspaceFolder:s},i,async(n,o)=>{const a=Date.now();await Promise.resolve(n),Date.now()-a>r&&this.h.warn("SLOW edit session create-participant",o.extension.identifier)}),i.isCancellationRequested}registerCanonicalUriProvider(t,i){if(this.D.has(t))throw new Error(`A provider has already been registered for scheme ${t}`);this.D.set(t,i);const r=this.t.transformOutgoingScheme(t),s=this.B++;return this.o.$registerCanonicalUriProvider(s,r),te(()=>{this.D.delete(t),this.o.$unregisterCanonicalUriProvider(s)})}async provideCanonicalUri(t,i,r){const s=this.D.get(t.scheme);if(!s)return;const n=await s.provideCanonicalUri?.(y.revive(t),i,r);if(n)return n}async $provideCanonicalUri(t,i,r){return this.provideCanonicalUri(y.revive(t),{targetScheme:i},r)}async decode(t,i){const[r,s]=this.F(i),n=await this.o.$resolveDecoding(r,s),o=(await AB(gO(W.wrap(t)),{...n,acceptTextOnly:!0,overwriteEncoding:a=>a===null||a===n.preferredEncoding?Promise.resolve(n.preferredEncoding):this.o.$validateDetectedEncoding(r,a,s)})).stream;return vx(o,a=>a.join(""))}async encode(t,i){const[r,s]=this.F(i),{encoding:n,addBOM:o}=await this.o.$resolveEncoding(r,s);if(n===em&&!o)return W.fromString(t).buffer;const a=await SB(NB(t),n,{addBOM:o});return pO(a).buffer}F(t){const i=sf(t?.uri)?t.uri:void 0,r=typeof t?.encoding=="string"?t.encoding:void 0;return[i,r?{encoding:r}:void 0]}};qy=__decorate([__param(0,Ce),__param(1,Ft),__param(2,pc),__param(3,Se),__param(4,wu)],qy);var Nr=H("IExtHostWorkspace");function nm(e){let t,i;if(e)return typeof e=="string"?t=e:(t=e.pattern,i=y.revive(e.baseUri)),{pattern:t,folder:i}}function a9(e){return(e?.map(t=>{if(typeof t=="string")return t===""?void 0:{pattern:t,uri:void 0};{const i=nm(t);return i?{pattern:i.pattern,uri:i.folder}:void 0}})??[]).filter(t=>!!t)}var c9;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(c9||(c9={}));var l9;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(l9||(l9={}));var u9;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(u9||(u9={}));var Gy;(function(e){e.DEFAULT={allowTrailingComma:!0}})(Gy||(Gy={}));function OB(e,t=!1){let i=0;const r=e.length;let s="",n=0,o=16,a=0;function c(v){let b=0,S=0;for(;b<v;){const E=e.charCodeAt(i);if(E>=48&&E<=57)S=S*16+E-48;else if(E>=65&&E<=70)S=S*16+E-65+10;else if(E>=97&&E<=102)S=S*16+E-97+10;else break;i++,b++}return b<v&&(S=-1),S}function l(v){i=v,s="",n=0,o=16,a=0}function u(){const v=i;if(e.charCodeAt(i)===48)i++;else for(i++;i<e.length&&vl(e.charCodeAt(i));)i++;if(i<e.length&&e.charCodeAt(i)===46)if(i++,i<e.length&&vl(e.charCodeAt(i)))for(i++;i<e.length&&vl(e.charCodeAt(i));)i++;else return a=3,e.substring(v,i);let b=i;if(i<e.length&&(e.charCodeAt(i)===69||e.charCodeAt(i)===101))if(i++,(i<e.length&&e.charCodeAt(i)===43||e.charCodeAt(i)===45)&&i++,i<e.length&&vl(e.charCodeAt(i))){for(i++;i<e.length&&vl(e.charCodeAt(i));)i++;b=i}else a=3;return e.substring(v,b)}function h(){let v="",b=i;for(;;){if(i>=r){v+=e.substring(b,i),a=2;break}const S=e.charCodeAt(i);if(S===34){v+=e.substring(b,i),i++;break}if(S===92){if(v+=e.substring(b,i),i++,i>=r){a=2;break}switch(e.charCodeAt(i++)){case 34:v+='"';break;case 92:v+="\\";break;case 47:v+="/";break;case 98:v+="\b";break;case 102:v+="\f";break;case 110:v+=`
`;break;case 114:v+="\r";break;case 116:v+="	";break;case 117:{const $=c(4);$>=0?v+=String.fromCharCode($):a=4;break}default:a=5}b=i;continue}if(S>=0&&S<=31)if(om(S)){v+=e.substring(b,i),a=2;break}else a=6;i++}return v}function f(){if(s="",a=0,n=i,i>=r)return n=r,o=17;let v=e.charCodeAt(i);if(Zy(v)){do i++,s+=String.fromCharCode(v),v=e.charCodeAt(i);while(Zy(v));return o=15}if(om(v))return i++,s+=String.fromCharCode(v),v===13&&e.charCodeAt(i)===10&&(i++,s+=`
`),o=14;switch(v){case 123:return i++,o=1;case 125:return i++,o=2;case 91:return i++,o=3;case 93:return i++,o=4;case 58:return i++,o=6;case 44:return i++,o=5;case 34:return i++,s=h(),o=10;case 47:{const b=i-1;if(e.charCodeAt(i+1)===47){for(i+=2;i<r&&!om(e.charCodeAt(i));)i++;return s=e.substring(b,i),o=12}if(e.charCodeAt(i+1)===42){i+=2;const S=r-1;let E=!1;for(;i<S;){if(e.charCodeAt(i)===42&&e.charCodeAt(i+1)===47){i+=2,E=!0;break}i++}return E||(i++,a=1),s=e.substring(b,i),o=13}return s+=String.fromCharCode(v),i++,o=16}case 45:if(s+=String.fromCharCode(v),i++,i===r||!vl(e.charCodeAt(i)))return o=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return s+=u(),o=11;default:for(;i<r&&p(v);)i++,v=e.charCodeAt(i);if(n!==i){switch(s=e.substring(n,i),s){case"true":return o=8;case"false":return o=9;case"null":return o=7}return o=16}return s+=String.fromCharCode(v),i++,o=16}}function p(v){if(Zy(v)||om(v))return!1;switch(v){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function g(){let v;do v=f();while(v>=12&&v<=15);return v}return{setPosition:l,getPosition:()=>i,scan:t?g:f,getToken:()=>o,getTokenValue:()=>s,getTokenOffset:()=>n,getTokenLength:()=>i-n,getTokenError:()=>a}}function Zy(e){return e===32||e===9||e===11||e===12||e===160||e===5760||e>=8192&&e<=8203||e===8239||e===8287||e===12288||e===65279}function om(e){return e===10||e===13||e===8232||e===8233}function vl(e){return e>=48&&e<=57}var h9;(function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"})(h9||(h9={}));function FB(e,t,i=Gy.DEFAULT){const r=OB(e,!1);function s(z){return z?()=>z(r.getTokenOffset(),r.getTokenLength()):()=>!0}function n(z){return z?ue=>z(ue,r.getTokenOffset(),r.getTokenLength()):()=>!0}const o=s(t.onObjectBegin),a=n(t.onObjectProperty),c=s(t.onObjectEnd),l=s(t.onArrayBegin),u=s(t.onArrayEnd),h=n(t.onLiteralValue),f=n(t.onSeparator),p=s(t.onComment),g=n(t.onError),v=i&&i.disallowComments,b=i&&i.allowTrailingComma;function S(){for(;;){const z=r.scan();switch(r.getTokenError()){case 4:E(14);break;case 5:E(15);break;case 3:E(13);break;case 1:v||E(11);break;case 2:E(12);break;case 6:E(16);break}switch(z){case 12:case 13:v?E(10):p();break;case 16:E(1);break;case 15:case 14:break;default:return z}}}function E(z,ue=[],Re=[]){if(g(z),ue.length+Re.length>0){let ae=r.getToken();for(;ae!==17;){if(ue.indexOf(ae)!==-1){S();break}else if(Re.indexOf(ae)!==-1)break;ae=S()}}}function $(z){const ue=r.getTokenValue();return z?h(ue):a(ue),S(),!0}function U(){switch(r.getToken()){case 11:{let z=0;try{z=JSON.parse(r.getTokenValue()),typeof z!="number"&&(E(2),z=0)}catch{E(2)}h(z);break}case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function O(){return r.getToken()!==10?(E(3,[],[2,5]),!1):($(!1),r.getToken()===6?(f(":"),S(),V()||E(4,[],[2,5])):E(5,[],[2,5]),!0)}function J(){o(),S();let z=!1;for(;r.getToken()!==2&&r.getToken()!==17;){if(r.getToken()===5){if(z||E(4,[],[]),f(","),S(),r.getToken()===2&&b)break}else z&&E(6,[],[]);O()||E(4,[],[2,5]),z=!0}return c(),r.getToken()!==2?E(7,[2],[]):S(),!0}function F(){l(),S();let z=!1;for(;r.getToken()!==4&&r.getToken()!==17;){if(r.getToken()===5){if(z||E(4,[],[]),f(","),S(),r.getToken()===4&&b)break}else z&&E(6,[],[]);V()||E(4,[],[4,5]),z=!0}return u(),r.getToken()!==4?E(8,[4],[]):S(),!0}function V(){switch(r.getToken()){case 3:return F();case 1:return J();case 10:return $(!0);default:return U()}}return S(),r.getToken()===17?i.allowEmptyContent?!0:(E(4,[],[]),!1):V()?(r.getToken()!==17&&E(9,[],[]),!0):(E(4,[],[]),!1)}function Oh(e){return Object.isFrozen(e)?e:s0(e)}var wl=class Co{static createEmptyModel(t){return new Co({},[],[],void 0,t)}constructor(t,i,r,s,n){this.b=t,this.c=i,this.d=r,this.f=s,this.g=n,this.a=new Map}get rawConfiguration(){if(!this.h)if(this.f){const t=(Array.isArray(this.f)?this.f:[this.f]).map(i=>{if(i instanceof Co)return i;const r=new UB("",this.g);return r.parseRaw(i),r.configurationModel});this.h=t.reduce((i,r)=>r===i?r:i.merge(r),t[0])}else this.h=this;return this.h}get contents(){return this.b}get overrides(){return this.d}get keys(){return this.c}get raw(){if(this.f&&!(Array.isArray(this.f)&&this.f.every(t=>t instanceof Co)))return this.f}isEmpty(){return this.c.length===0&&Object.keys(this.b).length===0&&this.d.length===0}getValue(t){return t?ip(this.contents,t):this.contents}inspect(t,i){const r=this;return{get value(){return Oh(r.rawConfiguration.getValue(t))},get override(){return i?Oh(r.rawConfiguration.getOverrideValue(t,i)):void 0},get merged(){return Oh(i?r.rawConfiguration.override(i).getValue(t):r.rawConfiguration.getValue(t))},get overrides(){const s=[];for(const{contents:n,identifiers:o,keys:a}of r.rawConfiguration.overrides){const c=new Co(n,a,[],void 0,r.g).getValue(t);c!==void 0&&s.push({identifiers:o,value:c})}return s.length?Oh(s):void 0}}}getOverrideValue(t,i){const r=this.k(i);return r?t?ip(r,t):r:void 0}getKeysForOverrideIdentifier(t){const i=[];for(const r of this.overrides)r.identifiers.includes(t)&&i.push(...r.keys);return $n(i)}getAllOverrideIdentifiers(){const t=[];for(const i of this.overrides)t.push(...i.identifiers);return $n(t)}override(t){let i=this.a.get(t);return i||(i=this.i(t),this.a.set(t,i)),i}merge(...t){const i=ot(this.contents),r=ot(this.overrides),s=[...this.keys],n=this.f?Array.isArray(this.f)?[...this.f]:[this.f]:[this];for(const o of t)if(n.push(...o.f?Array.isArray(o.f)?o.f:[o.f]:[o]),!o.isEmpty()){this.j(i,o.contents);for(const a of o.overrides){const[c]=r.filter(l=>Gi(l.identifiers,a.identifiers));c?(this.j(c.contents,a.contents),c.keys.push(...a.keys),c.keys=$n(c.keys)):r.push(ot(a))}for(const a of o.keys)s.indexOf(a)===-1&&s.push(a)}return new Co(i,s,r,!n.length||n.every(o=>o instanceof Co)?void 0:n,this.g)}i(t){const i=this.k(t);if(!i||typeof i!="object"||!Object.keys(i).length)return this;const r={};for(const s of $n([...Object.keys(this.contents),...Object.keys(i)])){let n=this.contents[s];const o=i[s];o&&(typeof n=="object"&&typeof o=="object"?(n=ot(n),this.j(n,o)):n=o),r[s]=n}return new Co(r,this.keys,this.overrides,void 0,this.g)}j(t,i){for(const r of Object.keys(i)){if(r in t&&yt(t[r])&&yt(i[r])){this.j(t[r],i[r]);continue}t[r]=ot(i[r])}}k(t){let i=null,r=null;const s=n=>{n&&(r?this.j(r,n):r=ot(n))};for(const n of this.overrides)n.identifiers.length===1&&n.identifiers[0]===t?i=n.contents:n.identifiers.includes(t)&&s(n.contents);return s(i),r}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(t,i){this.l(t,i,!0)}setValue(t,i){this.l(t,i,!1)}removeValue(t){const i=this.keys.indexOf(t);i!==-1&&(this.keys.splice(i,1),XH(this.contents,t),xs.test(t)&&this.overrides.splice(this.overrides.findIndex(r=>Gi(r.identifiers,Fu(t))),1))}l(t,i,r){if(E6(this.contents,t,i,s=>this.g.error(s)),r=r||this.keys.indexOf(t)===-1,r&&this.keys.push(t),xs.test(t)){const s=this.contents[t],n=Fu(t),o={identifiers:n,keys:Object.keys(s),contents:kw(s,c=>this.g.error(c))},a=this.overrides.findIndex(c=>Gi(c.identifiers,n));a!==-1?this.overrides[a]=o:this.overrides.push(o)}}},UB=class{constructor(e,t){this.f=e,this.g=t,this.a=null,this.b=null,this.c=[],this.d=[]}get configurationModel(){return this.b||wl.createEmptyModel(this.g)}get restrictedConfigurations(){return this.c}get errors(){return this.d}parse(e,t){if(!Ht(e)){const i=this.h(e);this.parseRaw(i,t)}}reparse(e){this.a&&this.parseRaw(this.a,e)}parseRaw(e,t){this.a=e;const{contents:i,keys:r,overrides:s,restricted:n,hasExcludedProperties:o}=this.i(e,t);this.b=new wl(i,r,s,o?[e]:void 0,this.g),this.c=n||[]}h(e){let t={},i=null,r=[];const s=[],n=[];function o(c){Array.isArray(r)?r.push(c):i!==null&&(r[i]=c)}const a={onObjectBegin:()=>{const c={};o(c),s.push(r),r=c,i=null},onObjectProperty:c=>{i=c},onObjectEnd:()=>{r=s.pop()},onArrayBegin:()=>{const c=[];o(c),s.push(r),r=c,i=null},onArrayEnd:()=>{r=s.pop()},onLiteralValue:o,onError:(c,l,u)=>{n.push({error:c,offset:l,length:u})}};if(e)try{FB(e,a),t=r[0]||{}}catch(c){this.g.error(`Error while parsing settings file ${this.f}: ${c}`),this.d=[c]}return t}i(e,t){const i=Zt.as(to.Configuration),r=i.getConfigurationProperties(),s=i.getExcludedConfigurationProperties(),n=this.j(e,r,s,!0,t);e=n.raw;const o=kw(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`)),a=Object.keys(e),c=this.m(e,l=>this.g.error(`Conflict in settings file ${this.f}: ${l}`));return{contents:o,keys:a,overrides:c,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}j(e,t,i,r,s){let n=!1;if(!s?.scopes&&!s?.skipRestricted&&!s?.skipUnregistered&&!s?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:n};const o={},a=[];for(const c in e)if(xs.test(c)&&r){const l=this.j(e[c],t,i,!1,s);o[c]=l.raw,n=n||l.hasExcludedProperties,a.push(...l.restricted)}else{const l=t[c];l?.restricted&&a.push(c),this.l(c,l,i,s)?o[c]=e[c]:n=!0}return{raw:o,restricted:a,hasExcludedProperties:n}}l(e,t,i,r){if(r.exclude?.includes(e))return!1;if(r.include?.includes(e))return!0;if(r.skipRestricted&&t?.restricted||r.skipUnregistered&&!t)return!1;const s=t??i[e],n=s?typeof s.scope<"u"?s.scope:4:void 0;return n===void 0||r.scopes===void 0?!0:r.scopes.includes(n)}m(e,t){const i=[];for(const r of Object.keys(e))if(xs.test(r)){const s={},n=e[r];for(const o in n)s[o]=n[o];i.push({identifiers:Fu(r),keys:Object.keys(s),contents:kw(s,t)})}return i}},jB=class{constructor(e,t,i,r,s,n,o,a,c,l,u,h,f){this.a=e,this.b=t,this.c=i,this.overrideIdentifiers=r,this.d=s,this.f=n,this.g=o,this.h=a,this.i=c,this.j=l,this.k=u,this.l=h,this.m=f}get value(){return Oh(this.c)}n(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get q(){return this.p||(this.p=this.d.inspect(this.a,this.b.overrideIdentifier)),this.p}get defaultValue(){return this.q.merged}get default(){return this.n(this.q)}get s(){return this.r===void 0&&(this.r=this.f?this.f.inspect(this.a):null),this.r}get policyValue(){return this.s?.merged}get policy(){return this.s?.value!==void 0?{value:this.s.value}:void 0}get u(){return this.t===void 0&&(this.t=this.g?this.g.inspect(this.a):null),this.t}get applicationValue(){return this.u?.merged}get application(){return this.n(this.u)}get w(){return this.v||(this.v=this.h.inspect(this.a,this.b.overrideIdentifier)),this.v}get userValue(){return this.w.merged}get user(){return this.n(this.w)}get y(){return this.x||(this.x=this.i.inspect(this.a,this.b.overrideIdentifier)),this.x}get userLocalValue(){return this.y.merged}get userLocal(){return this.n(this.y)}get A(){return this.z||(this.z=this.j.inspect(this.a,this.b.overrideIdentifier)),this.z}get userRemoteValue(){return this.A.merged}get userRemote(){return this.n(this.A)}get D(){return this.B===void 0&&(this.B=this.k?this.k.inspect(this.a,this.b.overrideIdentifier):null),this.B}get workspaceValue(){return this.D?.merged}get workspace(){return this.n(this.D)}get F(){return this.E===void 0&&(this.E=this.l?this.l.inspect(this.a,this.b.overrideIdentifier):null),this.E}get workspaceFolderValue(){return this.F?.merged}get workspaceFolder(){return this.n(this.F)}get H(){return this.G===void 0&&(this.G=this.m.inspect(this.a,this.b.overrideIdentifier)),this.G}get memoryValue(){return this.H.merged}get memory(){return this.n(this.H)}},Jy=class pN{constructor(t,i,r,s,n,o,a,c,l,u){this.j=t,this.l=i,this.m=r,this.n=s,this.p=n,this.q=o,this.r=a,this.s=c,this.t=l,this.u=u,this.h=null,this.i=new zt,this.v=null}getValue(t,i,r){return this.w(t,i,r).getValue(t)}updateValue(t,i,r={}){let s;r.resource?(s=this.t.get(r.resource),s||(s=wl.createEmptyModel(this.u),this.t.set(r.resource,s))):s=this.s,i===void 0?s.removeValue(t):s.setValue(t,i),r.resource||(this.h=null)}inspect(t,i,r){const s=this.w(t,i,r),n=this.A(i.resource,r),o=i.resource?this.t.get(i.resource)||this.s:this.s,a=new Set;for(const c of s.overrides)for(const l of c.identifiers)s.getOverrideValue(t,l)!==void 0&&a.add(l);return new jB(t,i,s.getValue(t),a.size?[...a]:void 0,this.j,this.l.isEmpty()?void 0:this.l,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,r?this.q:void 0,n||void 0,o)}keys(t){const i=this.A(void 0,t);return{default:this.j.keys.slice(0),policy:this.l.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this.q.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(t){this.j=t,this.h=null,this.i.clear()}updatePolicyConfiguration(t){this.l=t}updateApplicationConfiguration(t){this.m=t,this.h=null,this.i.clear()}updateLocalUserConfiguration(t){this.n=t,this.v=null,this.h=null,this.i.clear()}updateRemoteUserConfiguration(t){this.p=t,this.v=null,this.h=null,this.i.clear()}updateWorkspaceConfiguration(t){this.q=t,this.h=null,this.i.clear()}updateFolderConfiguration(t,i){this.r.set(t,i),this.i.delete(t)}deleteFolderConfiguration(t){this.folderConfigurations.delete(t),this.i.delete(t)}compareAndUpdateDefaultConfiguration(t,i){const r=[];if(!i){const{added:s,updated:n,removed:o}=vo(this.j,t);i=[...s,...n,...o]}for(const s of i)for(const n of Fu(s)){const o=this.j.getKeysForOverrideIdentifier(n),a=t.getKeysForOverrideIdentifier(n),c=[...a.filter(l=>o.indexOf(l)===-1),...o.filter(l=>a.indexOf(l)===-1),...o.filter(l=>!Li(this.j.override(n).getValue(l),t.override(n).getValue(l)))];r.push([n,c])}return this.updateDefaultConfiguration(t),{keys:i,overrides:r}}compareAndUpdatePolicyConfiguration(t){const{added:i,updated:r,removed:s}=vo(this.l,t),n=[...i,...r,...s];return n.length&&this.updatePolicyConfiguration(t),{keys:n,overrides:[]}}compareAndUpdateApplicationConfiguration(t){const{added:i,updated:r,removed:s,overrides:n}=vo(this.applicationConfiguration,t),o=[...i,...r,...s];return o.length&&this.updateApplicationConfiguration(t),{keys:o,overrides:n}}compareAndUpdateLocalUserConfiguration(t){const{added:i,updated:r,removed:s,overrides:n}=vo(this.localUserConfiguration,t),o=[...i,...r,...s];return o.length&&this.updateLocalUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateRemoteUserConfiguration(t){const{added:i,updated:r,removed:s,overrides:n}=vo(this.remoteUserConfiguration,t),o=[...i,...r,...s];return o.length&&this.updateRemoteUserConfiguration(t),{keys:o,overrides:n}}compareAndUpdateWorkspaceConfiguration(t){const{added:i,updated:r,removed:s,overrides:n}=vo(this.workspaceConfiguration,t),o=[...i,...r,...s];return o.length&&this.updateWorkspaceConfiguration(t),{keys:o,overrides:n}}compareAndUpdateFolderConfiguration(t,i){const r=this.folderConfigurations.get(t),{added:s,updated:n,removed:o,overrides:a}=vo(r,i),c=[...s,...n,...o];return(c.length||!r)&&this.updateFolderConfiguration(t,i),{keys:c,overrides:a}}compareAndDeleteFolderConfiguration(t){const i=this.folderConfigurations.get(t);if(!i)throw new Error("Unknown folder");this.deleteFolderConfiguration(t);const{added:r,updated:s,removed:n,overrides:o}=vo(i,void 0);return{keys:[...r,...s,...n],overrides:o}}get defaults(){return this.j}get applicationConfiguration(){return this.m}get userConfiguration(){if(!this.v)if(this.p.isEmpty())this.v=this.n;else{const t=this.n.merge(this.p);this.v=new wl(t.contents,t.keys,t.overrides,void 0,this.u)}return this.v}get localUserConfiguration(){return this.n}get remoteUserConfiguration(){return this.p}get workspaceConfiguration(){return this.q}get folderConfigurations(){return this.r}w(t,i,r){let s=this.x(i,r);if(i.overrideIdentifier&&(s=s.override(i.overrideIdentifier)),!this.l.isEmpty()&&this.l.getValue(t)!==void 0){s=s.merge();for(const n of this.l.keys)s.setValue(n,this.l.getValue(n))}return s}x({resource:t},i){let r=this.y();if(i&&t){const s=i.getFolder(t);s&&(r=this.z(s.uri)||r);const n=this.t.get(t);n&&(r=r.merge(n))}return r}y(){return this.h||(this.h=this.j.merge(this.applicationConfiguration,this.userConfiguration,this.q,this.s)),this.h}z(t){let i=this.i.get(t);if(!i){const r=this.y(),s=this.r.get(t);s?(i=r.merge(s),this.i.set(t,i)):i=r}return i}A(t,i){if(i&&t){const r=i.getFolder(t);if(r)return this.r.get(r.uri)}}toData(){return{defaults:{contents:this.j.contents,overrides:this.j.overrides,keys:this.j.keys},policy:{contents:this.l.contents,overrides:this.l.overrides,keys:this.l.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this.q.contents,overrides:this.q.overrides,keys:this.q.keys},folders:[...this.r.keys()].reduce((t,i)=>{const{contents:r,overrides:s,keys:n}=this.r.get(i);return t.push([i,{contents:r,overrides:s,keys:n}]),t},[])}}allKeys(){const t=new Set;return this.j.keys.forEach(i=>t.add(i)),this.userConfiguration.keys.forEach(i=>t.add(i)),this.q.keys.forEach(i=>t.add(i)),this.r.forEach(i=>i.keys.forEach(r=>t.add(r))),[...t.values()]}B(){const t=new Set;return this.j.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.q.getAllOverrideIdentifiers().forEach(i=>t.add(i)),this.r.forEach(i=>i.getAllOverrideIdentifiers().forEach(r=>t.add(r))),[...t.values()]}D(t){const i=new Set;return this.j.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this.userConfiguration.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this.q.getKeysForOverrideIdentifier(t).forEach(r=>i.add(r)),this.r.forEach(r=>r.getKeysForOverrideIdentifier(t).forEach(s=>i.add(s))),[...i.values()]}static parse(t,i){const r=this.E(t.defaults,i),s=this.E(t.policy,i),n=this.E(t.application,i),o=this.E(t.userLocal,i),a=this.E(t.userRemote,i),c=this.E(t.workspace,i),l=t.folders.reduce((u,h)=>(u.set(y.revive(h[0]),this.E(h[1],i)),u),new zt);return new pN(r,s,n,o,a,c,l,wl.createEmptyModel(i),new zt,i)}static E(t,i){return new wl(t.contents,t.keys,t.overrides,t.raw,i)}},zB=class{constructor(e,t,i,r,s){this.change=e,this.f=t,this.g=i,this.h=r,this.i=s,this.a=`
`,this.b=this.a.charCodeAt(0),this.c=46,this.affectedKeys=new Set,this.j=void 0;for(const n of e.keys)this.affectedKeys.add(n);for(const[,n]of e.overrides)for(const o of n)this.affectedKeys.add(o);this.d=this.a;for(const n of this.affectedKeys)this.d+=n+this.a}get previousConfiguration(){return!this.j&&this.f&&(this.j=Jy.parse(this.f.data,this.i)),this.j}affectsConfiguration(e,t){const i=this.a+e,r=this.d.indexOf(i);if(r<0)return!1;const s=r+i.length;if(s>=this.d.length)return!1;const n=this.d.charCodeAt(s);if(n!==this.b&&n!==this.c)return!1;if(t){const o=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.f?.workspace):void 0,a=this.g.getValue(e,t,this.h);return!Li(o,a)}return!0}};function vo(e,t){const{added:i,removed:r,updated:s}=d9(t?.rawConfiguration,e?.rawConfiguration),n=[],o=e?.getAllOverrideIdentifiers()||[],a=t?.getAllOverrideIdentifiers()||[];if(t){const c=a.filter(l=>!o.includes(l));for(const l of c)n.push([l,t.getKeysForOverrideIdentifier(l)])}if(e){const c=o.filter(l=>!a.includes(l));for(const l of c)n.push([l,e.getKeysForOverrideIdentifier(l)])}if(t&&e){for(const c of o)if(a.includes(c)){const l=d9({contents:e.getOverrideValue(void 0,c)||{},keys:e.getKeysForOverrideIdentifier(c)},{contents:t.getOverrideValue(void 0,c)||{},keys:t.getKeysForOverrideIdentifier(c)});n.push([c,[...l.added,...l.removed,...l.updated]])}}return{added:i,removed:r,updated:s,overrides:n}}function d9(e,t){const i=e?t?e.keys.filter(n=>t.keys.indexOf(n)===-1):[...e.keys]:[],r=t?e?t.keys.filter(n=>e.keys.indexOf(n)===-1):[...t.keys]:[],s=[];if(e&&t){for(const n of t.keys)if(e.keys.indexOf(n)!==-1){const o=ip(t.contents,n),a=ip(e.contents,n);Li(o,a)||s.push(n)}}return{added:i,removed:r,updated:s}}function am(e,t){if(t){const i=t.split(".");let r=e;for(let s=0;r&&s<i.length;s++)r=r[i[s]];return r}}function HB(e){return e instanceof y}function WB(e){return yt(e)&&e.uri instanceof y&&!!e.languageId&&typeof e.languageId=="string"}function BB(e){return yt(e)&&!e.uri&&!!e.languageId&&typeof e.languageId=="string"}function _B(e){return yt(e)&&e.uri instanceof y&&(!e.name||typeof e.name=="string")&&(!e.index||typeof e.index=="number")}function f9(e){if(HB(e))return{resource:e};if(WB(e))return{resource:e.uri,overrideIdentifier:e.languageId};if(BB(e))return{overrideIdentifier:e.languageId};if(_B(e))return{resource:e.uri};if(e===null)return{resource:null}}var Qy=class{constructor(t,i,r){this.a=t.getProxy(X.MainThreadConfiguration),this.c=i,this.b=r,this.d=new fr,this.e=null}getConfigProvider(){return this.d.wait().then(t=>this.e)}$initializeConfiguration(t){this.e=new VB(this.a,this.c,t,this.b),this.d.open()}$acceptConfigurationChanged(t,i){this.getConfigProvider().then(r=>r.$acceptConfigurationChanged(t,i))}};Qy=__decorate([__param(0,Ce),__param(1,Nr),__param(2,Se)],Qy);var VB=class{constructor(e,t,i,r){this.a=new I,this.b=e,this.f=r,this.c=t,this.e=Jy.parse(i,r),this.d=this.k(i.configurationScopes)}get onDidChangeConfiguration(){return this.a&&this.a.event}$acceptConfigurationChanged(e,t){const i={data:this.e.toData(),workspace:this.c.workspace};this.e=Jy.parse(e,this.f),this.d=this.k(e.configurationScopes),this.a.fire(this.j(t,i))}getConfiguration(e,t,i){const r=f9(t)||{},s=this.g(this.e.getValue(e,r,this.c.workspace));e&&this.h(e,r,i?.identifier);function n(a){if(a==null)return null;if(typeof a=="boolean")return a?2:5;switch(a){case Wc.Global:return 2;case Wc.Workspace:return 5;case Wc.WorkspaceFolder:return 6}}const o={has(a){return typeof am(s,a)<"u"},get:(a,c)=>{this.h(e?`${e}.${a}`:a,r,i?.identifier);let l=am(s,a);if(typeof l>"u")l=c;else{let u;const h=(f,p)=>{if(yt(f)){let g;const v=()=>{u=u||ot(s),g=g||am(u,p)};return new Proxy(f,{get:(b,S)=>{if(typeof S=="string"&&S.toLowerCase()==="tojson")return v(),()=>g;if(u)return g=g||am(u,p),g[S];const E=b[S];return typeof S=="string"?h(E,`${p}.${S}`):E},set:(b,S,E)=>(v(),g&&(g[S]=E),!0),deleteProperty:(b,S)=>(v(),g&&delete g[S],!0),defineProperty:(b,S,E)=>(v(),g&&Object.defineProperty(g,S,E),!0)})}return Array.isArray(f)?ot(f):f};l=h(l,a)}return l},update:(a,c,l,u)=>{a=e?`${e}.${a}`:a;const h=n(l);return c!==void 0?this.b.$updateConfigurationOption(h,a,c,r,u):this.b.$removeConfigurationOption(h,a,r,u)},inspect:a=>{a=e?`${e}.${a}`:a;const c=this.e.inspect(a,r,this.c.workspace);if(c)return{key:a,defaultValue:ot(c.policy?.value??c.default?.value),globalLocalValue:ot(c.userLocal?.value),globalRemoteValue:ot(c.userRemote?.value),globalValue:ot(c.user?.value??c.application?.value),workspaceValue:ot(c.workspace?.value),workspaceFolderValue:ot(c.workspaceFolder?.value),defaultLanguageValue:ot(c.default?.override),globalLocalLanguageValue:ot(c.userLocal?.override),globalRemoteLanguageValue:ot(c.userRemote?.override),globalLanguageValue:ot(c.user?.override??c.application?.override),workspaceLanguageValue:ot(c.workspace?.override),workspaceFolderLanguageValue:ot(c.workspaceFolder?.override),languageIds:ot(c.overrideIdentifiers)}}};return typeof s=="object"&&Qs(o,s,!1),Object.freeze(o)}g(e){const t=i=>yt(i)?new Proxy(i,{get:(r,s)=>t(r[s]),set:(r,s,n)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(s)}' of object`)},deleteProperty:(r,s)=>{throw new Error(`TypeError: Cannot delete read only property '${String(s)}' of object`)},defineProperty:(r,s)=>{throw new Error(`TypeError: Cannot define property '${String(s)}' for a readonly object`)},setPrototypeOf:r=>{throw new Error("TypeError: Cannot set prototype for a readonly object")},isExtensible:()=>!1,preventExtensions:()=>!0}):i;return t(e)}h(e,t,i){const r=xs.test(e)?5:this.d.get(e),s=i?`[${i.value}] `:"";if(r===5){typeof t?.resource>"u"&&this.f.warn(`${s}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`);return}if(r===4){t?.resource&&this.f.warn(`${s}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);return}}j(e,t){const i=new zB(e,t,this.e,this.c.workspace,this.f);return Object.freeze({affectsConfiguration:(r,s)=>i.affectsConfiguration(r,f9(s))})}k(e){return e.reduce((t,i)=>(t.set(i[0],i[1]),t),new Map)}},vr=H("IExtHostConfiguration"),qB=class{constructor(e,t){this.versionId=e,this.removedDueToLooping=t}},Fh=class gN extends Q{static isHostExtension(t,i,r){if(i.getExtensionDescription(t))return!1;const s=r.getExtensionDescription(t);return s?!!((s.main||s.browser)&&s.api==="none"):!1}constructor(t,i){super(),this.n=t,this.c=this.D(new I),this.onDidChange=this.c.event,this.f=0,this.g=i,this.q()}q(){this.g.sort(ZB),this.h=new Wn,this.j=[],this.m=new Map;for(const t of this.g){if(this.h.has(t.identifier)){console.error("Extension `"+t.identifier.value+"` is already registered");continue}this.h.set(t.identifier,t),this.j.push(t);const i=this.n.readActivationEvents(t);for(const r of i)this.m.has(r)||this.m.set(r,[]),this.m.get(r).push(t)}}set(t){return this.g=t,this.q(),this.f++,this.c.fire(void 0),{versionId:this.f}}deltaExtensions(t,i){this.g=g9(this.g,i),this.g=this.g.concat(t);const r=gN.r(this.g);return this.g=g9(this.g,r.map(s=>s.identifier)),this.q(),this.f++,this.c.fire(void 0),new qB(this.f,r)}static r(t){const i=new class{constructor(){this.c=new Map,this.d=new Set,this.e=[]}addNode(a){this.d.has(a)||(this.d.add(a),this.e.push(a))}addArc(a,c){this.addNode(a),this.addNode(c),this.c.has(a)?this.c.get(a).push(c):this.c.set(a,[c])}getArcs(a){return this.c.has(a)?this.c.get(a):[]}hasOnlyGoodArcs(a,c){const l=i.getArcs(a);for(let u=0;u<l.length;u++)if(!c.has(l[u]))return!1;return!0}getNodes(){return this.e}},r=new Wn;for(const a of t)if(r.set(a.identifier,a),a.extensionDependencies)for(const c of a.extensionDependencies)i.addArc(Ye.toKey(a.identifier),Ye.toKey(c));const s=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>s.add(a));const n=i.getNodes().filter(a=>!s.has(a));let o;do{o=!1;for(let a=0;a<n.length;a++){const c=n[a];i.hasOnlyGoodArcs(c,s)&&(n.splice(a,1),a--,s.add(c),o=!0)}}while(o);return n.map(a=>r.get(a))}containsActivationEvent(t){return this.m.has(t)}containsExtension(t){return this.h.has(t)}getExtensionDescriptionsForActivationEvent(t){const i=this.m.get(t);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this.j.slice(0)}getSnapshot(){return new GB(this.f,this.getAllExtensionDescriptions())}getExtensionDescription(t){const i=this.h.get(t);return i||void 0}getExtensionDescriptionByUUID(t){for(const i of this.j)if(i.uuid===t)return i}getExtensionDescriptionByIdOrUUID(t,i){return this.getExtensionDescription(t)??(i?this.getExtensionDescriptionByUUID(i):void 0)}},GB=class{constructor(e,t){this.versionId=e,this.extensions=t}},p9;(function(e){e[e.Builtin=0]="Builtin",e[e.User=1]="User",e[e.Dev=2]="Dev"})(p9||(p9={}));function ZB(e,t){const i=e.isBuiltin?0:e.isUnderDevelopment?2:1,r=t.isBuiltin?0:t.isUnderDevelopment?2:1;if(i!==r)return i-r;const s=Be.basename(e.extensionLocation.path),n=Be.basename(t.extensionLocation.path);return s<n?-1:s>n?1:0}function g9(e,t){const i=new Go(t);return e.filter(r=>!i.has(r.identifier))}var cm=class mN{static{this.NONE=new mN(!1,-1,-1,-1)}constructor(t,i,r,s){this.startup=t,this.codeLoadingTime=i,this.activateCallTime=r,this.activateResolvedTime=s}},Yy=class{constructor(e){this.a=e,this.b=-1,this.c=-1,this.d=-1,this.f=-1,this.g=-1,this.h=-1}j(e,t){return e===-1||t===-1?-1:t-e}build(){return new cm(this.a,this.j(this.b,this.c),this.j(this.d,this.f),this.j(this.g,this.h))}codeLoadingStart(){this.b=Date.now()}codeLoadingStop(){this.c=Date.now()}activateCallStart(){this.d=Date.now()}activateCallStop(){this.f=Date.now()}activateResolveStart(){this.g=Date.now()}activateResolveStop(){this.h=Date.now()}},lm=class{constructor(e,t,i,r,s,n){this.activationFailed=e,this.activationFailedError=t,this.activationTimes=i,this.module=r,this.exports=s,this.disposable=n}},JB=class extends lm{constructor(e){super(!1,null,e,{activate:void 0,deactivate:void 0},void 0,Q.None)}},QB=class extends lm{constructor(){super(!1,null,cm.NONE,{activate:void 0,deactivate:void 0},void 0,Q.None)}},um=class extends lm{constructor(e){super(!0,e,cm.NONE,{activate:void 0,deactivate:void 0},void 0,Q.None)}},Xy=class{constructor(t,i,r,s){this.g=s,this.a=t,this.b=i,this.c=r,this.d=new Wn,this.f=Object.create(null)}dispose(){for(const[t,i]of this.d)i.dispose()}async waitForActivatingExtensions(){const t=[];for(const[i,r]of this.d)t.push(r.wait());await Promise.all(t)}isActivated(t){const i=this.d.get(t);return!!(i&&i.value)}getActivatedExtension(t){const i=this.d.get(t);if(!i||!i.value)throw new Error(`Extension '${t.value}' is not known or not activated`);return i.value}async activateByEvent(t,i){if(this.f[t])return;const r=this.a.getExtensionDescriptionsForActivationEvent(t);await this.h(r.map(s=>({id:s.identifier,reason:{startup:i,extensionId:s.identifier,activationEvent:t}}))),this.f[t]=!0}activateById(t,i){const r=this.a.getExtensionDescription(t);if(!r)throw new Error(`Extension '${t.value}' is not known`);return this.h([{id:r.identifier,reason:i}])}async h(t){const i=t.filter(r=>!this.isActivated(r.id)).map(r=>this.j(r));await Promise.all(i.map(r=>r.wait()))}j(t){if(this.d.has(t.id))return this.d.get(t.id);if(this.l(t.id))return this.k(t,null,[],null);const i=this.a.getExtensionDescription(t.id);if(!i){const n=new Error(`Cannot activate unknown extension '${t.id.value}'`),o=this.k(t,null,[],new um(n));return this.c.onExtensionActivationError(t.id,n,new B6(t.id.value)),o}const r=[],s=typeof i.extensionDependencies>"u"?[]:i.extensionDependencies;for(const n of s){if(this.m(n))continue;const o=this.d.get(n);if(o){r.push(o);continue}if(this.l(n)){r.push(this.j({id:this.b.getExtensionDescription(n).identifier,reason:t.reason}));continue}const a=this.a.getExtensionDescription(n);if(a){if(!a.main&&!a.browser)continue;r.push(this.j({id:a.identifier,reason:t.reason}));continue}const c=i.displayName||i.identifier.value,l=new Error(`Cannot activate the '${c}' extension because it depends on unknown extension '${n}'`),u=this.k(t,i.displayName,[],new um(l));return this.c.onExtensionActivationError(i.identifier,l,new B6(n)),u}return this.k(t,i.displayName,r,null)}k(t,i,r,s){const n=new Ky(t.id,i,t.reason,r,s,this.c,this.g);return this.d.set(t.id,n),n}l(t){return Fh.isHostExtension(t,this.a,this.b)}m(t){const i=this.b.getExtensionDescription(t);return i?!i.main&&!i.browser:!1}};Xy=__decorate([__param(3,Se)],Xy);var Ky=class{get value(){return this.h}get friendlyName(){return this.d||this.c.value}constructor(t,i,r,s,n,o,a){this.c=t,this.d=i,this.f=r,this.g=s,this.h=n,this.j=o,this.k=a,this.a=new fr,this.b=!1,this.l()}dispose(){this.b=!0}wait(){return this.a.wait()}async l(){await this.m(),this.a.open()}async m(){if(!this.h){for(;this.g.length>0;){for(let t=0;t<this.g.length;t++){const i=this.g[t];if(i.value&&!i.value.activationFailed){this.g.splice(t,1),t--;continue}if(i.value&&i.value.activationFailed){const r=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);r.detail=i.value.activationFailedError,this.h=new um(r),this.j.onExtensionActivationError(this.c,r,null);return}}this.g.length>0&&await Promise.race(this.g.map(t=>t.wait()))}await this.n()}}async n(){try{this.h=await this.j.actualActivateExtension(this.c,this.f)}catch(t){const i=new Error;if(t&&t.name&&(i.name=t.name),t&&t.message?i.message=`Activating extension '${this.c.value}' failed: ${t.message}.`:i.message=`Activating extension '${this.c.value}' failed: ${t}.`,t&&t.stack&&(i.stack=t.stack),this.h=new um(i),this.b&&Ti(t))return;this.j.onExtensionActivationError(this.c,i,null),this.k.error(`Activating extension ${this.c.value} failed due to an error:`),this.k.error(t)}}};Ky=__decorate([__param(6,Se)],Ky);var m9=class{constructor(e,t){this.c=t,this.b=new I,this.onDidChangeStorage=this.b.event,this.a=e.getProxy(X.MainThreadStorage)}registerExtensionStorageKeysToSync(e,t){this.a.$registerExtensionStorageKeysToSync(e,t)}async initializeExtensionStorage(e,t,i){const r=await this.a.$initializeExtensionStorage(e,t);let s;return r&&(s=this.d(e,t,r)),s||i}setValue(e,t,i){return this.a.$setValue(e,t,i)}$acceptValue(e,t,i){const r=this.d(e,t,i);r&&this.b.fire({shared:e,key:t,value:r})}d(e,t,i){try{return JSON.parse(i)}catch(r){this.c.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${t}, global: ${e}): ${r}`)}}},eA=H("IExtHostStorage"),v9=class{constructor(e,t,i){this.h=new Map,this.a=e,this.b=t,this.c=i,this.d=this.c.initializeExtensionStorage(this.b,this.a,Object.create(null)).then(r=>(this.f=r,this)),this.g=this.c.onDidChangeStorage(r=>{r.shared===this.b&&r.key===this.a&&(this.f=r.value)}),this.i=new vs(()=>{const r=this.h;this.h=new Map,(async()=>{try{await this.c.setValue(this.b,this.a,this.f);for(const s of r.values())s.complete()}catch(s){for(const n of r.values())n.error(s)}})()},0)}keys(){return Object.entries(this.f??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this.d}get(e,t){let i=this.f[e];return typeof i>"u"&&(i=t),i}update(e,t){t!==null&&typeof t=="object"?this.f[e]=JSON.parse(JSON.stringify(t)):this.f[e]=t;const i=this.h.get(e);if(i!==void 0)return i.p;const r=new Ni;return this.h.set(e,r),this.i.isScheduled()||this.i.schedule(),r.p}dispose(){this.g.dispose()}},YB=class extends v9{setKeysForSync(e){this.c.registerExtensionStorageKeysToSync({id:this.a,version:this.j.version},e)}constructor(e,t){super(e.identifier.value,!0,t),this.j=e}},Ns,tA=Ns=class{constructor(t,i){this.b=new Map,this.c=new cx,this.a=t.getProxy(X.MainThreadFileSystem);const r=this;this.value=Object.freeze({async stat(s){try{let n;const o=r.b.get(s.scheme);return o?(await r.a.$ensureActivation(s.scheme),n=await o.impl.stat(s)):n=await r.a.$stat(s),{type:n.type,ctime:n.ctime,mtime:n.mtime,size:n.size,permissions:n.permissions===Zn.Readonly?1:void 0}}catch(n){Ns.e(n)}},async readDirectory(s){try{const n=r.b.get(s.scheme);return n?(await r.a.$ensureActivation(s.scheme),(await n.impl.readDirectory(s)).slice()):await r.a.$readdir(s)}catch(n){return Ns.e(n)}},async createDirectory(s){try{const n=r.b.get(s.scheme);return n&&!n.isReadonly?(await r.a.$ensureActivation(s.scheme),await r.d(n.impl,n.extUri,s)):await r.a.$mkdir(s)}catch(n){return Ns.e(n)}},async readFile(s){try{const n=r.b.get(s.scheme);return n?(await r.a.$ensureActivation(s.scheme),(await n.impl.readFile(s)).slice()):(await r.a.$readFile(s)).buffer}catch(n){return Ns.e(n)}},async writeFile(s,n){try{const o=r.b.get(s.scheme);return o&&!o.isReadonly?(await r.a.$ensureActivation(s.scheme),await r.d(o.impl,o.extUri,o.extUri.dirname(s)),await r.c.queueFor(s,()=>Promise.resolve(o.impl.writeFile(s,n,{create:!0,overwrite:!0})))):await r.a.$writeFile(s,W.wrap(n))}catch(o){return Ns.e(o)}},async delete(s,n){try{const o=r.b.get(s.scheme);return o&&!o.isReadonly&&!n?.useTrash?(await r.a.$ensureActivation(s.scheme),await o.impl.delete(s,{recursive:!1,...n})):await r.a.$delete(s,{recursive:!1,useTrash:!1,atomic:!1,...n})}catch(o){return Ns.e(o)}},async rename(s,n,o){try{return await r.a.$rename(s,n,{overwrite:!1,...o})}catch(a){return Ns.e(a)}},async copy(s,n,o){try{return await r.a.$copy(s,n,{overwrite:!1,...o})}catch(a){return Ns.e(a)}},isWritableFileSystem(s){const n=i.getCapabilities(s);if(typeof n=="number")return!(n&2048)}})}async d(t,i,r){const s=[];for(;!i.isEqual(r,i.dirname(r));)try{if(((await t.stat(r)).type&tr.Directory)===0)throw Yt.FileExists(`Unable to create folder '${r.scheme===q.file?r.fsPath:r.toString(!0)}' that already exists but is not a directory`);break}catch(n){if(Of(n)!==he.FileNotFound)throw n;s.push(i.basename(r)),r=i.dirname(r)}for(let n=s.length-1;n>=0;n--){r=i.joinPath(r,s[n]);try{await t.createDirectory(r)}catch(o){if(Of(o)!==he.FileExists)throw o}}}static e(t){if(t instanceof Yt)throw t;if(t instanceof Lf)switch(t.code){case he.FileExists:throw Yt.FileExists(t.message);case he.FileNotFound:throw Yt.FileNotFound(t.message);case he.FileNotADirectory:throw Yt.FileNotADirectory(t.message);case he.FileIsADirectory:throw Yt.FileIsADirectory(t.message);case he.NoPermissions:throw Yt.NoPermissions(t.message);case he.Unavailable:throw Yt.Unavailable(t.message);default:throw new Yt(t.message,t.name)}if(!(t instanceof Error))throw new Yt(String(t));if(t.name==="ENOPRO"||t.message.includes("ENOPRO"))throw Yt.Unavailable(t.message);switch(t.name){case he.FileExists:throw Yt.FileExists(t.message);case he.FileNotFound:throw Yt.FileNotFound(t.message);case he.FileNotADirectory:throw Yt.FileNotADirectory(t.message);case he.FileIsADirectory:throw Yt.FileIsADirectory(t.message);case he.NoPermissions:throw Yt.NoPermissions(t.message);case he.Unavailable:throw Yt.Unavailable(t.message);default:throw new Yt(t.message,t.name)}}addFileSystemProvider(t,i,r){return this.b.set(t,{impl:i,extUri:r?.isCaseSensitive?Ke:z2,isReadonly:!!r?.isReadonly}),te(()=>this.b.delete(t))}getFileSystemProviderExtUri(t){return this.b.get(t)?.extUri??Ke}};tA=Ns=__decorate([__param(0,Ce),__param(1,pc)],tA);var Uh=H("IExtHostConsumerFileSystem"),iA=H("IExtensionStoragePaths"),rA=class{constructor(t,i,r){this.d=i,this.f=r,this.a=t.workspace??void 0,this.b=t.environment,this.whenReady=this.h().then(s=>this.c=s)}async g(t){return y.joinPath(this.b.workspaceStorageHome,t)}async h(){if(!this.a)return Promise.resolve(void 0);const t=this.a.id,i=await this.g(t);try{return await this.f.value.stat(i),this.d.trace("[ExtHostStorage] storage dir already exists",i),i}catch{}try{return this.d.trace("[ExtHostStorage] creating dir and metadata-file",i),await this.f.value.createDirectory(i),await this.f.value.writeFile(y.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this.a.id,configuration:y.revive(this.a.configuration)?.toString(),name:this.a.name},void 0,2))),i}catch(r){this.d.error("[ExtHostStorage]",r);return}}workspaceValue(t){if(this.c)return y.joinPath(this.c,t.identifier.value)}globalValue(t){return y.joinPath(this.b.globalStorageHome,t.identifier.value.toLowerCase())}onWillDeactivateAll(){}};rA=__decorate([__param(0,Ft),__param(1,Se),__param(2,Uh)],rA);var XB=H("tunnelService"),kre=H("sharedTunnelsService"),Rr;(function(e){e.Http="http",e.Https="https"})(Rr||(Rr={}));var Rs;(function(e){e.ConstantPrivate="constantPrivate",e.Private="private",e.Public="public"})(Rs||(Rs={}));function KB(e){return!!e.forwardPort}var wo;(function(e){e[e.Notify=1]="Notify",e[e.OpenBrowser=2]="OpenBrowser",e[e.OpenPreview=3]="OpenPreview",e[e.Silent=4]="Silent",e[e.Ignore=5]="Ignore",e[e.OpenBrowserOnce=6]="OpenBrowserOnce"})(wo||(wo={}));function e_(e){if(e.scheme!=="http"&&e.scheme!=="https")return;const t=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(e.authority);if(t)return{address:t[1],port:+t[2]}}var jh=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function Na(e){return jh.indexOf(e)>=0}var hm=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function hn(e){return hm.indexOf(e)>=0}function t_(e,t,i,r){if(i===1)return!1;if(i===2&&hn(t)){const s=/(\d+)\.(\d+)\.(\d+)/g.exec(r);if(s?.length===4&&parseInt(s[1])>=18)return!1}return e<1024}var i_=class{constructor(e,t,i){this.remoteAddress=e,this.localAddress=t,this.b=i,this.a=new I,this.onDidDispose=this.a.event}dispose(){return this.a.fire(),this.b()}},sA=class extends Q{constructor(t,i){super(),this.q=t,this.r=i,this.a=new I,this.onTunnelOpened=this.a.event,this.b=new I,this.onTunnelClosed=this.b.event,this.c=new I,this.onAddedTunnelProvider=this.c.event,this.f=new Map,this.h=!1,this.j=!0,this.m=[],this.n=new Set}get hasTunnelProvider(){return!!this.g}get s(){const t=this.r.getValue("remote.localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(t){return this.g=t,t?(this.c.fire(),{dispose:()=>{this.g=void 0,this.h=!1,this.m=[]}}):(this.h=!1,this.m=[],this.c.fire(),{dispose:()=>{}})}setTunnelFeatures(t){this.h=t.elevation,this.m=t.privacyOptions,this.j=t.protocol}get canChangeProtocol(){return this.j}get canElevate(){return this.h}get canChangePrivacy(){return this.m.length>0}get privacyOptions(){return this.m}get tunnels(){return this.t()}async t(){const t=[],i=Array.from(this.f.values());for(const r of i){const s=Array.from(r.values());for(const n of s){const o=await n.value;o&&typeof o!="string"&&t.push(o)}}return t}async dispose(){super.dispose();for(const t of this.f.values()){for(const{value:i}of t.values())await i.then(r=>typeof r!="string"?r?.dispose():void 0);t.clear()}this.f.clear()}setEnvironmentTunnel(t,i,r,s,n){this.y(t,i,Promise.resolve({tunnelRemoteHost:t,tunnelRemotePort:i,localAddress:r,privacy:s,protocol:n,dispose:()=>Promise.resolve()}))}async getExistingTunnel(t,i){(hn(t)||Na(t))&&(t=jh[0]);const r=this.C(t,i);if(r)return++r.refcount,r.value}openTunnel(t,i,r,s,n,o=!1,a,c){this.q.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${r} on local port ${n}.`);const l=this.g??t;if(!l)return;if(i||(i="localhost"),s||(s=this.s),this.g&&this.n.has(r)){this.q.debug("ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.");return}const u=this.F(l,i,r,s,n,o,a,c);return u?u.then(h=>{if(h){if(typeof h=="string")return this.q.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel."),this.z(i,r),h}else{this.q.trace("ForwardedPorts: (TunnelService) New tunnel is undefined."),this.z(i,r);return}this.q.trace("ForwardedPorts: (TunnelService) New tunnel established.");const f=this.u(h);return(h.tunnelRemoteHost!==i||h.tunnelRemotePort!==r)&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch."),a&&h.privacy!==a&&this.q.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch."),this.a.fire(f),f}):(this.q.trace("ForwardedPorts: (TunnelService) Tunnel was not created."),u)}u(t){return{tunnelRemotePort:t.tunnelRemotePort,tunnelRemoteHost:t.tunnelRemoteHost,tunnelLocalPort:t.tunnelLocalPort,localAddress:t.localAddress,privacy:t.privacy,protocol:t.protocol,dispose:async()=>{this.q.trace(`ForwardedPorts: (TunnelService) dispose request for ${t.tunnelRemoteHost}:${t.tunnelRemotePort} `);const i=this.f.get(t.tunnelRemoteHost);if(i){const r=i.get(t.tunnelRemotePort);r&&(r.refcount--,await this.w(t.tunnelRemoteHost,t.tunnelRemotePort,r))}}}}async w(t,i,r){if(r.refcount<=0){this.q.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${t}:${i}.`);const s=r.value.then(async n=>{n&&typeof n!="string"&&(await n.dispose(!0),this.b.fire({host:n.tunnelRemoteHost,port:n.tunnelRemotePort}))});return this.f.has(t)&&this.f.get(t).delete(i),s}}async closeTunnel(t,i){this.q.trace(`ForwardedPorts: (TunnelService) close request for ${t}:${i} `);const r=this.f.get(t);if(r&&r.has(i)){const s=r.get(i);s.refcount=0,await this.w(t,i,s)}}y(t,i,r){this.f.has(t)||this.f.set(t,new Map),this.f.get(t).set(i,{refcount:1,value:r})}async z(t,i){const r=this.f.get(t);if(r){const s=r.get(i),n=s?await s.value:void 0;(!n||typeof n=="string")&&r.delete(i),r.size===0&&this.f.delete(t)}}C(t,i){const r=[t];Na(t)?(r.push(...jh),r.push(...hm)):hn(t)&&r.push(...hm);const s=r.map(n=>this.f.get(n));for(const n of s){const o=n?.get(i);if(o)return o}}canTunnel(t){return!!e_(t)}G(t,i,r,s,n,o,a){this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${r} on local port ${s}.`);const c=r;this.n.add(c);const l=s===void 0?r:s,u={elevationRequired:n?this.isPortPrivileged(l):!1},h={remoteAddress:{host:i,port:r},localAddressPort:s,privacy:o,public:o?o!==Rs.Private:void 0,protocol:a},f=t.forwardPort(h,u);return f?(this.y(i,r,f),f.finally(()=>{this.q.trace("ForwardedPorts: (TunnelService) Tunnel created by provider."),this.n.delete(c)})):this.n.delete(c),f}};sA=__decorate([__param(0,Se),__param(1,yi)],sA);var r_=class extends i_{},nA;(function(e){function t(r){return{remoteAddress:r.remoteAddress,localAddress:r.localAddress,public:!!r.public,privacy:r.privacy??(r.public?Rs.Public:Rs.Private),protocol:r.protocol}}e.fromApiTunnel=t;function i(r){return{remoteAddress:{host:r.tunnelRemoteHost,port:r.tunnelRemotePort},localAddress:r.localAddress,public:r.privacy!==Rs.ConstantPrivate&&r.privacy!==Rs.ConstantPrivate,privacy:r.privacy,protocol:r.protocol}}e.fromServiceTunnel=i})(nA||(nA={}));var dm=H("IExtHostTunnelService"),fm=class extends Q{constructor(t,i,r){super(),this.r=r,this.f=()=>Promise.resolve(!0),this.g=new Map,this.h=new I,this.onDidChangeTunnels=this.h.event,this.n=0,this.q=new Map,this.a=t.getProxy(X.MainThreadTunnelService)}async openTunnel(t,i){this.r.trace(`ForwardedPorts: (ExtHostTunnelService) ${t.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const r=await this.a.$openTunnel(i,t.displayName);if(r){const s=new r_(r.remoteAddress,r.localAddress,()=>this.a.$closeTunnel(r.remoteAddress));return this.D(s),s}}async getTunnels(){return this.a.$getTunnels()}s(){return this.n++}registerPortsAttributesProvider(t,i){t.portRange===void 0&&t.commandPattern===void 0&&this.r.error("PortAttributesProvider must specify either a portRange or a commandPattern");const r=this.s();return this.q.set(r,{selector:t,provider:i}),this.a.$registerPortsAttributesProvider(t,r),new ke(()=>{this.q.delete(r),this.a.$unregisterPortsAttributesProvider(r)})}async $providePortAttributes(t,i,r,s,n){const o=[];for(const c of t){const l=this.q.get(c);if(!l)return[];o.push(...await Promise.all(i.map(async u=>{let h;try{h=await l.provider.providePortAttributes({port:u,pid:r,commandLine:s},n)}catch{h=await l.provider.providePortAttributes(u,r,s,n)}return{providedAttributes:h,port:u}})))}const a=o.filter(c=>!!c.providedAttributes);return a.length>0?a.map(c=>({autoForwardAction:c.providedAttributes.autoForwardAction,port:c.port})):[]}async $registerCandidateFinder(t){}registerTunnelProvider(t,i){if(this.b)throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.");this.b=async(s,n)=>await t.provideTunnel(s,n,Fe.None)??void 0;const r=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?!0:i.tunnelFeatures.protocol}:void 0;return this.a.$setTunnelProvider(r,!0),Promise.resolve(te(()=>{this.b=void 0,this.a.$setTunnelProvider(void 0,!1)}))}hasTunnelProvider(){return this.a.$hasTunnelProvider()}async setTunnelFactory(t,i){if(t){t.candidatePortSource!==void 0&&this.a.$setCandidatePortSource(t.candidatePortSource),t.showCandidatePort&&(this.f=t.showCandidatePort,this.a.$setCandidateFilter());const r=t.tunnelFactory??(i?this.u(i):void 0);if(r){this.b=r;let s=t.tunnelFeatures?.privacyOptions??[];t.tunnelFeatures?.public&&s.length===0&&(s=[{id:"private",label:d(3033,null),themeIcon:"lock"},{id:"public",label:d(3034,null),themeIcon:"eye"}]);const n=t.tunnelFeatures?{elevation:!!t.tunnelFeatures?.elevation,public:!!t.tunnelFeatures?.public,privacyOptions:s,protocol:!0}:void 0;this.a.$setTunnelProvider(n,!!t.tunnelFactory)}}else this.b=void 0;return te(()=>{this.b=void 0})}u(t){}async $closeTunnel(t,i){if(this.g.has(t.host)){const r=this.g.get(t.host);r.has(t.port)&&(i&&r.get(t.port).disposeListener.dispose(),await r.get(t.port).tunnel.dispose(),r.delete(t.port))}}async $onDidTunnelsChange(){this.h.fire()}async $forwardPort(t,i){if(this.b)try{this.r.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const r=this.b(t,i);if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider."),r!==void 0){const s=await r;if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider."),s===void 0){this.r.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return}this.g.has(t.remoteAddress.host)||this.g.set(t.remoteAddress.host,new Map);const n=this.D(s.onDidDispose(()=>(this.r.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose."),this.a.$closeTunnel(s.remoteAddress))));return this.g.get(t.remoteAddress.host).set(t.remoteAddress.port,{tunnel:s,disposeListener:n}),nA.fromApiTunnel(s)}else this.r.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}catch(r){if(this.r.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error"),r instanceof Error)return r.message}}async $applyCandidateFilter(t){const i=await Promise.all(t.map(s=>this.f(s.host,s.port,s.detail??""))),r=t.filter((s,n)=>i[n]);return this.r.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${t.map(s=>s.port).join(", ")} to ${r.map(s=>s.port).join(", ")}`),r}};fm=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Se)],fm);function s_(e){return[...e.entries()]}function n_(e){return e?[...e.entries()]:[]}var o_=class{constructor(e){this.b=e,this.a=new Map}dispose(){for(const e of this.a.values())e.dispose()}startBuffering(e,t,i=5){const r=t(s=>{const n=Oe(s)?s:s.data;let o=this.a.get(e);if(o){o.data.push(n);return}const a=setTimeout(()=>this.flushBuffer(e),i);o={data:[n],timeoutId:a,dispose:()=>{clearTimeout(a),this.flushBuffer(e),r.dispose()}},this.a.set(e,o)});return r}stopBuffering(e){this.a.get(e)?.dispose()}flushBuffer(e){const t=this.a.get(e);t&&(this.a.delete(e),this.b(e,t.data.join("")))}},Ra=(e,t,i,r)=>{let s=t;return{enumerable:!0,configurable:!1,get(){return s},set(n){if(!i(s,n)){const o=s;s=n,e.listener?.(r(n,o))}}}},bl=(e,t)=>e===t,bo={range:(e,t)=>e===t?!0:!e||!t?!1:e.isEqual(t),label:bl,description:bl,sortText:bl,busy:bl,error:bl,canResolveChildren:bl,tags:(e,t)=>!(e.length!==t.length||e.some(i=>!t.find(r=>i.id===r.id)))},yl=e=>t=>({op:4,update:e(t)}),a_=(e,t)=>({range:(()=>{let i;const r=yl(s=>({range:st.lift(j.from(s))}));return{enumerable:!0,configurable:!1,get(){return i},set(s){e.listener?.({op:6}),bo.range(i,s)||(i=s,e.listener?.(r(s)))}}})(),label:Ra(e,t,bo.label,yl(i=>({label:i}))),description:Ra(e,void 0,bo.description,yl(i=>({description:i}))),sortText:Ra(e,void 0,bo.sortText,yl(i=>({sortText:i}))),canResolveChildren:Ra(e,!1,bo.canResolveChildren,i=>({op:2,state:i})),busy:Ra(e,!1,bo.busy,yl(i=>({busy:i}))),error:Ra(e,void 0,bo.error,yl(i=>({error:ge.fromStrict(i)||null}))),tags:Ra(e,[],bo.tags,(i,r)=>({op:1,new:i.map(ns.from),old:r.map(ns.from)}))}),c_=e=>{const t=Ve.fromString(e.extId),i=new zh(t.controllerId,t.localId,e.label,y.revive(e.uri)||void 0);return i.range=j.to(e.range||void 0),i.description=e.description||void 0,i.sortText=e.sortText||void 0,i.tags=e.tags.map(r=>ns.to({id:a6(r).tagId})),i},w9=e=>{let t;for(const i of e.tests){const r=c_(i.item);pp(r).parent=t,t=r}return t},zh=class vN{constructor(t,i,r,s){if(i.includes("\0"))throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`);const n=$W(this,t);Object.defineProperties(this,{id:{value:i,enumerable:!0,writable:!1},uri:{value:s,enumerable:!0,writable:!1},parent:{enumerable:!1,get(){return n.parent instanceof oA?void 0:n.parent}},children:{value:CW(n,pp,vN),enumerable:!0,writable:!1},...a_(n,r)})}},oA=class extends zh{constructor(e,t){super(e,e,t,void 0),this._isRoot=!0}},l_=class extends EW{constructor(e,t,i){super({controllerId:e,getDocumentVersion:r=>r&&i.getDocument(r)?.version,getApiFor:pp,getChildren:r=>r.children,root:new oA(e,t),toITestItem:po.from})}},Hh;(function(e){e[e.Desktop=1]="Desktop",e[e.Web=2]="Web"})(Hh||(Hh={}));var b9;(function(e){e[e.VersionMismatch=55]="VersionMismatch",e[e.UnexpectedError=81]="UnexpectedError"})(b9||(b9={}));var y9;(function(e){e[e.Initialized=0]="Initialized",e[e.Ready=1]="Ready",e[e.Terminate=2]="Terminate"})(y9||(y9={}));function A9(e){const t=W.alloc(1);switch(e){case 0:t.writeUInt8(1,0);break;case 1:t.writeUInt8(2,0);break;case 2:t.writeUInt8(3,0);break}return t}function u_(e,t){if(e.byteLength!==1)return!1;switch(e.readUInt8(0)){case 1:return t===0;case 2:return t===1;case 3:return t===2;default:return!1}}var S9;(function(e){e.Start="START_NATIVE_LOG",e.End="END_NATIVE_LOG"})(S9||(S9={}));var aA=class extends Q{constructor(t,i,r){super(),this.n=i,this.a=this.D(new I),this.onDidChangeTelemetryEnabled=this.a.event,this.b=this.D(new I),this.onDidChangeTelemetryConfiguration=this.b.event,this.c={usage:!0,error:!0},this.f=0,this.h=!1,this.m=new Map,this.h=this.n.environment.isExtensionTelemetryLoggingOnly;const s=i.remote.isRemote?"remoteExtHostTelemetry":t?"workerExtHostTelemetry":"extHostTelemetry";this.j=this.D(r.createLogger(s,{name:d(3030,null,this.h?" (Not Sent)":""),hidden:!0,group:hW}))}getTelemetryConfiguration(){return this.f===3}getTelemetryDetails(){return{isCrashEnabled:this.f>=1,isErrorsEnabled:this.c.error?this.f>=2:!1,isUsageEnabled:this.c.usage?this.f>=3:!1}}instantiateLogger(t,i,r){const s=this.getTelemetryDetails(),n=new E9(i,r,t,this.j,this.h,this.getBuiltInCommonProperties(t),{isUsageEnabled:s.isUsageEnabled,isErrorsEnabled:s.isErrorsEnabled}),o=this.m.get(t.identifier.value)??[];return this.m.set(t.identifier.value,[...o,n]),n.apiTelemetryLogger}$initializeTelemetryLevel(t,i,r){this.f=t,this.c=r??{usage:!0,error:!0}}getBuiltInCommonProperties(t){const i=Object.create(null);switch(i["common.extname"]=`${t.publisher}.${t.name}`,i["common.extversion"]=t.version,i["common.vscodemachineid"]=this.n.telemetryInfo.machineId,i["common.vscodesessionid"]=this.n.telemetryInfo.sessionId,i["common.vscodecommithash"]=this.n.commit,i["common.sqmid"]=this.n.telemetryInfo.sqmId,i["common.devDeviceId"]=this.n.telemetryInfo.devDeviceId??this.n.telemetryInfo.machineId,i["common.vscodeversion"]=this.n.version,i["common.vscodereleasedate"]=this.n.date,i["common.isnewappinstall"]=x9(this.n.telemetryInfo.firstSessionDate),i["common.product"]=this.n.environment.appHost,this.n.uiKind){case Hh.Web:i["common.uikind"]="web";break;case Hh.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}return i["common.remotename"]=h0(fW(this.n.remote.authority)),i}$onDidChangeTelemetryLevel(t){this.g=this.getTelemetryConfiguration(),this.f=t;const i=this.getTelemetryDetails();this.m.forEach((r,s)=>{const n=r.filter(o=>!o.isDisposed);n.length===0?this.m.delete(s):this.m.set(s,n)}),this.m.forEach(r=>{for(const s of r)s.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}),this.g!==this.getTelemetryConfiguration()&&this.a.fire(this.getTelemetryConfiguration()),this.b.fire(this.getTelemetryDetails())}onExtensionError(t,i){const s=this.m.get(t.value)?.filter(o=>!o.isDisposed);if(!s)return this.m.delete(t.value),!1;let n=!1;for(const o of s)o.ignoreUnhandledExtHostErrors||(o.logError(i),n=!0);return n}};aA=__decorate([__param(1,Ft),__param(2,_n)],aA);var E9=class{static validateSender(e){if(typeof e!="object")throw new TypeError("TelemetrySender argument is invalid");if(typeof e.sendEventData!="function")throw new TypeError("TelemetrySender.sendEventData must be a function");if(typeof e.sendErrorData!="function")throw new TypeError("TelemetrySender.sendErrorData must be a function");if(typeof e.flush<"u"&&typeof e.flush!="function")throw new TypeError("TelemetrySender.flush must be a function or undefined")}constructor(e,t,i,r,s,n,o){this.g=i,this.h=r,this.i=s,this.j=n,this.a=new I,this.ignoreUnhandledExtHostErrors=t?.ignoreUnhandledErrors??!1,this.b=t?.ignoreBuiltInCommonProperties??!1,this.c=t?.additionalCommonProperties,this.f=e,this.d={isUsageEnabled:o.isUsageEnabled,isErrorsEnabled:o.isErrorsEnabled}}updateTelemetryEnablements(e,t){this.e&&(this.d={isUsageEnabled:e,isErrorsEnabled:t},this.a.fire(this.e))}mixInCommonPropsAndCleanData(e){let t=e.properties?e.properties??{}:e;return t=H6(t,[]),this.c&&(t=Qs(t,this.c)),this.b||(t=Qs(t,this.j)),e.properties?e.properties=t:e=t,e}k(e,t){this.f&&(this.g.publisher==="vscode"?e=this.g.name+"/"+e:e=this.g.identifier.value+"/"+e,t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f?.sendEventData(e,t),this.h.trace(e,t))}logUsage(e,t){this.d.isUsageEnabled&&this.k(e,t)}logError(e,t){if(!(!this.d.isErrorsEnabled||!this.f))if(typeof e=="string")this.k(e,t);else{const i={name:e.name,message:e.message,stack:e.stack,cause:e.cause},r=H6(i,[]),s=new Error(typeof r.message=="string"?r.message:void 0,{cause:r.cause});s.stack=typeof r.stack=="string"?r.stack:void 0,s.name=typeof r.name=="string"?r.name:"unknown",t=this.mixInCommonPropsAndCleanData(t||{}),this.i||this.f.sendErrorData(s,t),this.h.trace("exception",t)}}get apiTelemetryLogger(){if(!this.e){const e=this,t={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e.d.isUsageEnabled},get isErrorsEnabled(){return e.d.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e.a.event.bind(e)};this.e=Object.freeze(t)}return this.e}get isDisposed(){return!this.f}dispose(){if(this.f?.flush){let e=this.f;this.f=void 0,Promise.resolve(e.flush()).then(e=void 0),this.e=void 0}else this.f=void 0}};function x9(e){const t=Date.now()-new Date(e).getTime();return isNaN(t)?!1:t<1e3*60*60*24}var pm=H("IExtHostTelemetry"),cA=class{#e;#t;#i;constructor(t,i,r){this.b=new Map,this.c=new Map,this.#e=t.getProxy(X.MainThreadCommands),this.d=i,this.#i=r,this.#t=t.getProxy(X.MainThreadTelemetry),this.converter=new h_(this,s=>{const n=this.c.get(s);return n?.result===be.Void?n:void 0},i),this.f=[{processArgument(s){return Gt(s)}},{processArgument(s){return lc(s,function(n){if(st.isIRange(n))return j.to(n);if(gr.isIPosition(n))return Xe.to(n);if(st.isIRange(n.range)&&y.isUri(n.uri))return Hi.to(n);if(n instanceof W)return n.buffer.buffer;if(!Array.isArray(n))return n})}}]}registerArgumentProcessor(t){this.f.push(t)}registerApiCommand(t){const i=this.registerCommand(!1,t.id,async(...r)=>{const s=t.args.map((o,a)=>{if(!o.validate(r[a]))throw new Error(`Invalid argument '${o.name}' when running '${t.id}', received: ${typeof r[a]=="object"?JSON.stringify(r[a],null,"	"):r[a]} `);return o.convert(r[a])}),n=await this.executeCommand(t.internalId,...s);return t.result.convert(n,r,this.converter)},void 0,{description:t.description,args:t.args,returns:t.result.description});return this.c.set(t.id,t),new ke(()=>{i.dispose(),this.c.delete(t.id)})}registerCommand(t,i,r,s,n,o){if(this.d.trace("ExtHostCommands#registerCommand",i),!i.trim().length)throw new Error("invalid id");if(this.b.has(i))throw new Error(`command '${i}' already exists`);return this.b.set(i,{callback:r,thisArg:s,metadata:n,extension:o}),t&&this.#e.$registerCommand(i),new ke(()=>{this.b.delete(i)&&t&&this.#e.$unregisterCommand(i)})}executeCommand(t,...i){return this.d.trace("ExtHostCommands#executeCommand",t),this.g(t,i,!0)}async g(t,i,r){if(this.b.has(t))return this.#e.$fireCommandActivationEvent(t),this.h(t,i,!1);{let s=!1;const n=lc(i,function(o){if(o instanceof Pe)return Xe.from(o);if(o instanceof xe)return j.from(o);if(o instanceof rr)return Hi.from(o);if(ks.isNotebookRange(o))return Ms.from(o);if(o instanceof ArrayBuffer)return s=!0,W.wrap(new Uint8Array(o));if(o instanceof Uint8Array)return s=!0,W.wrap(o);if(o instanceof W)return s=!0,o;if(!Array.isArray(o))return o});try{const o=await this.#e.$executeCommand(t,s?new fi(n):n,r);return Gt(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry")return this.g(t,i,!1);throw o}}}async h(t,i,r){const s=this.b.get(t);if(!s)throw new Error("Unknown command");const{callback:n,thisArg:o,metadata:a}=s;if(a?.args)for(let l=0;l<a.args.length;l++)try{tE(i[l],a.args[l].constraint)}catch{throw new Error(`Running the contributed command: '${t}' failed. Illegal argument '${a.args[l].name}' - ${a.args[l].description}`)}const c=Ji.create();try{return await n.apply(o,i)}catch(l){if(t===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);u&&(t=u.command)}if(Ti(l)||this.d.error(l,t,s.extension?.identifier),!r)throw l;if(s.extension?.identifier){const u=this.#i.onExtensionError(s.extension.identifier,l);this.d.trace("forwarded error to extension?",u,s.extension?.identifier)}throw new class extends Error{constructor(){super(ys(l)),this.id=t,this.source=s.extension?.displayName??s.extension?.name}}}finally{this.j(s,t,c.elapsed())}}j(t,i,r){t.extension&&(i.startsWith("code.copilot.logStructured")||this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:t.extension.identifier.value,id:new $w(i),duration:r}))}$executeContributedCommand(t,...i){this.d.trace("ExtHostCommands#$executeContributedCommand",t);const r=this.b.get(t);return r?(i=i.map(s=>this.f.reduce((n,o)=>o.processArgument(n,r.extension),s)),this.h(t,i,!0)):Promise.reject(new Error(`Contributed command '${t}' does not exist.`))}getCommands(t=!1){return this.d.trace("ExtHostCommands#getCommands",t),this.#e.$getCommands().then(i=>(t&&(i=i.filter(r=>r[0]!=="_")),i))}$getContributedCommandMetadata(){const t=Object.create(null);for(const[i,r]of this.b){const{metadata:s}=r;s&&(t[i]=s)}return Promise.resolve(t)}};cA=__decorate([__param(0,Ce),__param(1,Se),__param(2,pm)],cA);var os=H("IExtHostCommands"),h_=class{constructor(e,t,i){this.d=e,this.f=t,this.g=i,this.delegatingCommandId=`__vsc${Tt()}`,this.b=new Map,this.c=0,this.d.registerCommand(!0,this.delegatingCommandId,this.h,this)}toInternal(e,t){if(!e)return;const i={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command)return i;const r=this.f(e.command);if(r)i.id=r.internalId,i.arguments=r.args.map((s,n)=>s.convert(e.arguments&&e.arguments[n]));else if(Xl(e.arguments)){const s=`${e.command} /${++this.c}`;this.b.set(s,e),t.add(te(()=>{this.b.delete(s),this.g.trace("CommandsConverter#DISPOSE",s)})),i.$ident=s,i.id=this.delegatingCommandId,i.arguments=[s],this.g.trace("CommandsConverter#CREATE",e.command,s)}return i}fromInternal(e){return typeof e.$ident=="string"?this.b.get(e.$ident):{command:e.id,title:e.title,arguments:e.arguments}}getActualCommand(...e){return this.b.get(e[0])}h(...e){const t=this.getActualCommand(...e);return this.g.trace("CommandsConverter#EXECUTE",e[0],t?t.command:"MISSING"),t?this.d.executeCommand(t.command,...t.arguments||[]):Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}},B=class cr{static{this.Uri=new cr("uri","Uri of a text document",t=>y.isUri(t),t=>t)}static{this.Position=new cr("position","A position in a text document",t=>Pe.isPosition(t),Xe.from)}static{this.Range=new cr("range","A range in a text document",t=>xe.isRange(t),j.from)}static{this.Selection=new cr("selection","A selection in a text document",t=>Cs.isSelection(t),ss.from)}static{this.Number=new cr("number","",t=>typeof t=="number",t=>t)}static{this.String=new cr("string","",t=>typeof t=="string",t=>t)}static Arr(t){return new cr(`${t.name}_array`,`Array of ${t.name}, ${t.description}`,i=>Array.isArray(i)&&i.every(r=>t.validate(r)),i=>i.map(r=>t.convert(r)))}static{this.CallHierarchyItem=new cr("item","A call hierarchy item",t=>t instanceof jw,ka.from)}static{this.TypeHierarchyItem=new cr("item","A type hierarchy item",t=>t instanceof bb,$a.from)}static{this.TestItem=new cr("testItem","A VS Code TestItem",t=>t instanceof zh,po.from)}static{this.TestProfile=new cr("testProfile","A VS Code test profile",t=>t instanceof d7,hy.from)}constructor(t,i,r,s){this.name=t,this.description=i,this.validate=r,this.convert=s}optional(){return new cr(this.name,`(optional) ${this.description}`,t=>t==null||this.validate(t),t=>t===void 0?void 0:t===null?null:this.convert(t))}with(t,i){return new cr(t??this.name,i??this.description,this.validate,this.convert)}},be=class wN{static{this.Void=new wN("no result",t=>t)}constructor(t,i){this.description=t,this.convert=i}},ye=class{constructor(e,t,i,r,s){this.id=e,this.internalId=t,this.description=i,this.args=r,this.result=s}},dn=H("IExtHostTerminalService"),lA=class extends Q{constructor(e,t,i,r){super(),this.s=e,this._id=t,this.u=i,this.w=r,this.a=!1,this.m={isInteractedWith:!1,shell:void 0},this.isOpen=!1,this.q=this.D(new I),this.onWillDispose=this.q.event,this.u=Object.freeze(this.u),this.b=new Promise(n=>this.g=n);const s=this;this.value={get name(){return s.w||""},get processId(){return s.b},get creationOptions(){return s.u},get exitStatus(){return s.j},get state(){return s.m},get selection(){return s.n},get shellIntegration(){return s.shellIntegration},sendText(n,o=!0){s.z(),s.s.$sendText(s._id,n,o)},show(n){s.z(),s.s.$show(s._id,n)},hide(){s.z(),s.s.$hide(s._id)},dispose(){s.a||(s.a=!0,s.s.$dispose(s._id))},get dimensions(){if(!(s.f===void 0||s.h===void 0))return{columns:s.f,rows:s.h}}}}dispose(){this.q.fire(),super.dispose()}async create(e,t){if(typeof this._id!="string")throw new Error("Terminal has already been created");await this.s.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??t?.cwd??void 0,env:e.env??void 0,icon:C9(e.iconPath)??void 0,color:gc.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:t?.forceShellIntegration??void 0,isFeatureTerminal:t?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:!0,useShellEnvironment:t?.useShellEnvironment??void 0,location:t?.location||this.y(e.location,t?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0,shellIntegrationNonce:e.shellIntegrationNonce??void 0})}async createExtensionTerminal(e,t,i,r,s,n){if(typeof this._id!="string")throw new Error("Terminal has already been created");if(await this.s.$createTerminal(this._id,{name:this.w,isExtensionCustomPtyTerminal:!0,icon:r,color:gc.isThemeColor(s)?s.id:void 0,location:t?.location||this.y(e,i),isTransient:!0,shellIntegrationNonce:n??void 0}),typeof this._id=="string")throw new Error("Terminal creation failed");return this._id}y(e,t){return typeof e=="object"?In(e,{parentTerminal:!0})&&e.parentTerminal&&t?{parentTerminal:t}:In(e,{viewColumn:!0})?{viewColumn:Xt.from(e.viewColumn),preserveFocus:e.preserveFocus}:void 0:e}z(){if(this.a)throw new Error("Terminal has already been disposed")}set name(e){this.w=e}setExitStatus(e,t){this.j=Object.freeze({code:e,reason:t})}setDimensions(e,t){return e===this.f&&t===this.h||e===0||t===0?!1:(this.f=e,this.h=t,!0)}setInteractedWith(){return this.m.isInteractedWith?!1:(this.m={...this.m,isInteractedWith:!0},!0)}setShellType(e){return this.m.shell!==e?(this.m={...this.m,shell:e},!0):!1}setSelection(e){this.n=e}_setProcessId(e){this.g?(this.g(e),this.g=void 0):this.b.then(t=>{t!==e&&(this.b=Promise.resolve(e))})}},uA=class{get onProcessReady(){return this.b.event}constructor(e){this.g=e,this.id=0,this.shouldPersist=!1,this.a=new I,this.onProcessData=this.a.event,this.b=new I,this.d=new I,this.onDidChangeProperty=this.d.event,this.f=new I,this.onProcessExit=this.f.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,t){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${t}`)}async start(){}shutdown(){this.g.close()}input(e){this.g.handleInput?.(e)}sendSignal(e){}resize(e,t){this.g.setDimensions?.({columns:e,rows:t})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this.g.onDidWrite(t=>this.a.fire(t)),this.g.onDidClose?.((t=void 0)=>{this.f.fire(t===void 0?void 0:t)}),this.g.onDidOverrideDimensions?.(t=>{t&&this.d.fire({type:"overrideDimensions",value:{cols:t.columns,rows:t.rows}})}),this.g.onDidChangeName?.(t=>{this.d.fire({type:"title",value:t})}),this.g.open(e||void 0),e&&this.g.setDimensions?.(e),this.b.fire({pid:-1,cwd:"",windowsPty:void 0})}},d_=1,gm=class extends Q{get activeTerminal(){return this.b?.value}get terminals(){return this.f.map(t=>t.value)}constructor(t,i,r){super(),this.R=i,this.f=[],this.g=new Map,this.h={},this.j={},this.m={},this.n=new Map,this.u=this.D(new Br),this.y=new Set,this.z=new Map,this.C=new Map,this.F=new Map,this.G=new Map,this.H=new Map,this.I=new I,this.onDidCloseTerminal=this.I.event,this.J=new I,this.onDidOpenTerminal=this.J.event,this.L=new I,this.onDidChangeActiveTerminal=this.L.event,this.M=new I,this.onDidChangeTerminalDimensions=this.M.event,this.N=new I,this.onDidChangeTerminalState=this.N.event,this.O=new I,this.onDidChangeShell=this.O.event,this.P=new I({onWillAddFirstListener:()=>this.a.$startSendingDataEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingDataEvents()}),this.onDidWriteTerminalData=this.P.event,this.Q=new I({onWillAddFirstListener:()=>this.a.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this.a.$stopSendingCommandEvents()}),this.onDidExecuteTerminalCommand=this.Q.event,this.a=r.getProxy(X.MainThreadTerminalService),this.w=new o_(this.a.$sendProcessData),this.a.$registerProcessSupport(t),this.R.registerArgumentProcessor({processArgument:s=>{const n=o=>this.getTerminalById(o.instanceId)?.value;switch(s?.$mid){case 15:return n(s);default:{if(Array.isArray(s))for(let o=0;o<s.length&&s[o].$mid===15;o++)s[o]=n(s[o]);return s}}}}),this.D({dispose:()=>{for(const[s,n]of this.g)n.shutdown(!0)}})}getDefaultShell(t){return(t?this.s:this.q)?.path||""}getDefaultShellArgs(t){return(t?this.s:this.q)?.args||[]}createExtensionTerminal(t,i){const r=new lA(this.a,Tt(),t,t.name),s=new uA(t.pty);return r.createExtensionTerminal(t.location,i,this.S(t,i).resolvedExtHostIdentifier,C9(t.iconPath),p_(t.color),t.shellIntegrationNonce).then(n=>{const o=this.U(n,s);this.h[n]=o}),this.f.push(r),r.value}S(t,i){if(i=i||{},t.location&&typeof t.location=="object"&&In(t.location,{parentTerminal:!0})){const r=t.location.parentTerminal;if(r){const s=this.f.find(n=>n.value===r);s&&(i.resolvedExtHostIdentifier=s._id)}}else t.location&&typeof t.location!="object"?i.location=t.location:i.location&&typeof i.location=="object"&&In(i.location,{splitActiveTerminal:!0})&&(i.location={splitActiveTerminal:!0});return i}attachPtyToTerminal(t,i){if(!this.getTerminalById(t))throw new Error(`Cannot resolve terminal with id ${t} for virtual process`);const s=new uA(i),n=this.U(t,s);this.h[t]=n}async $acceptActiveTerminalChanged(t){const i=this.b;if(t===null){this.b=void 0,i!==this.b&&this.L.fire(this.b);return}const r=this.getTerminalById(t);r&&(this.b=r,i!==this.b&&this.L.fire(this.b.value))}async $acceptTerminalProcessData(t,i){const r=this.getTerminalById(t);r&&this.P.fire({terminal:r.value,data:i})}async $acceptTerminalDimensions(t,i,r){const s=this.getTerminalById(t);s&&s.setDimensions(i,r)&&this.M.fire({terminal:s.value,dimensions:s.value.dimensions})}async $acceptDidExecuteCommand(t,i){const r=this.getTerminalById(t);r&&this.Q.fire({terminal:r.value,...i})}async $acceptTerminalMaximumDimensions(t,i,r){this.g.get(t)?.resize(i,r)}async $acceptTerminalTitleChange(t,i){const r=this.getTerminalById(t);r&&(r.name=i)}async $acceptTerminalClosed(t,i,r){const s=this.Y(this.f,t);if(s!==null){const n=this.f.splice(s,1)[0];n.setExitStatus(i,r),this.I.fire(n.value)}}$acceptTerminalOpened(t,i,r,s){if(i){const a=this.Y(this.f,i);if(a!==null){this.f[a]._id=t,this.J.fire(this.terminals[a]),this.f[a].isOpen=!0;return}}const n={name:s.name,shellPath:s.executable,shellArgs:s.args,cwd:typeof s.cwd=="string"?s.cwd:y.revive(s.cwd),env:s.env,hideFromUser:s.hideFromUser},o=new lA(this.a,t,n,r);this.f.push(o),this.J.fire(o.value),o.isOpen=!0}async $acceptTerminalProcessId(t,i){this.getTerminalById(t)?._setProcessId(i)}async $startExtensionTerminal(t,i){const r=this.getTerminalById(t);if(!r)return{message:d(3031,null,t)};r.isOpen||await new Promise(n=>{const o=this.onDidOpenTerminal(async a=>{a===r.value&&(o.dispose(),n())})});const s=this.g.get(t);s?s.startSendingEvents(i):this.j[t]={initialDimensions:i}}U(t,i){const r=new ie;r.add(i.onProcessReady(n=>this.a.$sendProcessReady(t,n.pid,n.cwd,n.windowsPty))),r.add(i.onDidChangeProperty(n=>this.a.$sendProcessProperty(t,n))),this.w.startBuffering(t,i.onProcessData),r.add(i.onProcessExit(n=>this.W(t,n))),this.g.set(t,i);const s=this.j[t];return s&&i instanceof uA&&(i.startSendingEvents(s.initialDimensions),delete this.j[t]),r}$acceptProcessAckDataEvent(t,i){this.g.get(t)?.acknowledgeDataEvent(i)}$acceptProcessInput(t,i){this.g.get(t)?.input(i)}$acceptTerminalInteraction(t){const i=this.getTerminalById(t);i?.setInteractedWith()&&this.N.fire(i.value)}$acceptTerminalSelection(t,i){this.getTerminalById(t)?.setSelection(i)}$acceptProcessResize(t,i,r){try{this.g.get(t)?.resize(i,r)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED")throw s}}$acceptProcessShutdown(t,i){this.g.get(t)?.shutdown(i)}$acceptProcessRequestInitialCwd(t){this.g.get(t)?.getInitialCwd().then(i=>this.a.$sendProcessProperty(t,{type:"initialCwd",value:i}))}$acceptProcessRequestCwd(t){this.g.get(t)?.getCwd().then(i=>this.a.$sendProcessProperty(t,{type:"cwd",value:i}))}$acceptProcessRequestLatency(t){return Promise.resolve(t)}registerProfileProvider(t,i,r){if(this.C.has(i))throw new Error(`Terminal profile provider "${i}" already registered`);return this.C.set(i,r),this.a.$registerProfileProvider(i,t.identifier.value),new ke(()=>{this.C.delete(i),this.a.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(t,i,...r){if(this.z.has(t.identifier.value))throw new Error(`Terminal completion provider "${t.identifier.value}" already registered`);return this.z.set(t.identifier.value,i),this.a.$registerCompletionProvider(t.identifier.value,t.identifier.value,...r),new ke(()=>{this.z.delete(t.identifier.value),this.a.$unregisterCompletionProvider(t.identifier.value)})}async $provideTerminalCompletions(t,i){const r=new Qe().token;if(r.isCancellationRequested||!this.activeTerminal)return;const s=this.z.get(t);if(!s)return;const n=await s.provideTerminalCompletions(this.activeTerminal,i,r);if(n==null)return;const o=!ze||this.activeTerminal.state?.shell==="gitbash"?"/":"\\";return xy.from(n,o)}$acceptTerminalShellType(t,i){const r=this.getTerminalById(t);r?.setShellType(i)&&this.N.fire(r.value)}registerTerminalQuickFixProvider(t,i,r){if(this.F.has(t))throw new Error(`Terminal quick fix provider "${t}" is already registered`);return this.F.set(t,r),this.a.$registerQuickFixProvider(t,i),new ke(()=>{this.F.delete(t),this.a.$unregisterQuickFixProvider(t)})}async $provideTerminalQuickFixes(t,i){const r=new Qe().token;if(r.isCancellationRequested)return;const s=this.F.get(t);if(!s)return;const n=await s.provideTerminalQuickFixes(i,r);if(n===null||Array.isArray(n)&&n.length===0)return;const o=new ie;if(this.u.value=o,!Array.isArray(n))return n?Zg.from(n,this.R.converter,o):void 0;const a=[];for(const c of n){const l=Zg.from(c,this.R.converter,o);l&&a.push(l)}return a}async $createContributedProfileTerminal(t,i){const r=new Qe().token;let s=await this.C.get(t)?.provideTerminalProfile(r);if(!r.isCancellationRequested){if(s&&!In(s,{options:!0})&&(s={options:s}),!s||!In(s,{options:!0}))throw new Error(`No terminal profile options provided for id "${t}"`);if(In(s.options,{pty:!0})){this.createExtensionTerminal(s.options,i);return}this.createTerminalFromOptions(s.options,i)}}registerLinkProvider(t){return this.y.add(t),this.y.size===1&&this.a.$startLinkProvider(),new ke(()=>{this.y.delete(t),this.y.size===0&&this.a.$stopLinkProvider()})}async $provideLinks(t,i){const r=this.getTerminalById(t);if(!r)return[];this.G.delete(t),this.H.get(t)?.dispose(!0);const n=new Qe;this.H.set(t,n);const o=[],a={terminal:r.value,line:i},c=[];for(const h of this.y)c.push(Un.withAsyncBody(async f=>{n.token.onCancellationRequested(()=>f({provider:h,links:[]}));const p=await h.provideTerminalLinks(a,n.token)||[];n.token.isCancellationRequested||f({provider:h,links:p})}));const l=await Promise.all(c);if(n.token.isCancellationRequested)return[];const u=new Map;for(const h of l)h&&h.links.length>0&&o.push(...h.links.map(f=>{const p={id:d_++,startIndex:f.startIndex,length:f.length,label:f.tooltip};return u.set(p.id,{provider:h.provider,link:f}),p}));return this.G.set(t,u),o}$activateLink(t,i){const r=this.G.get(t)?.get(i);r&&r.provider.handleTerminalLink(r.link)}W(t,i){this.w.stopBuffering(t),this.g.delete(t),delete this.j[t];const r=this.h[t];r&&(r.dispose(),delete this.h[t]),this.a.$sendProcessExit(t,i)}getTerminalById(t){return this.X(this.f,t)}getTerminalIdByApiObject(t){const i=this.f.findIndex(r=>r.value===t);return i>=0?i:null}X(t,i){const r=this.Y(t,i);return r!==null?t[r]:null}Y(t,i){const r=t.findIndex(s=>s._id===i);return r>=0?r:null}getEnvironmentVariableCollection(t){let i=this.n.get(t.identifier.value);return i||(i=this.D(new k9),this.$(t.identifier.value,i)),i.getScopedEnvironmentVariableCollection(void 0)}Z(t,i){const r=s_(i.map),s=n_(i.descriptionMap);this.a.$setEnvironmentVariableCollection(t,i.persistent,r.length===0?void 0:r,s)}$initEnvironmentVariableCollections(t){t.forEach(i=>{const r=i[0],s=this.D(new k9(i[1]));this.$(r,s)})}$acceptDefaultProfile(t,i){const r=this.q;this.q=t,this.s=i,r?.path!==t.path&&this.O.fire(t.path)}$(t,i){this.n.set(t,i),this.D(i.onDidChangeCollection(()=>{this.Z(t,i)}))}};gm=__decorate([__param(1,os),__param(2,Ce)],gm);var k9=class extends Q{get persistent(){return this.b}set persistent(e){this.b=e,this.f.fire()}get onDidChangeCollection(){return this.f&&this.f.event}constructor(e){super(),this.map=new Map,this.a=new Map,this.descriptionMap=new Map,this.b=!0,this.f=new I,this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const t=this.j(e);let i=this.a.get(t);return i||(i=new f_(this,e),this.a.set(t,i),this.D(i.onDidChangeCollection(()=>this.f.fire()))),i}replace(e,t,i,r){this.g(e,{value:t,type:Ic.Replace,options:i??{applyAtProcessCreation:!0},scope:r})}append(e,t,i,r){this.g(e,{value:t,type:Ic.Append,options:i??{applyAtProcessCreation:!0},scope:r})}prepend(e,t,i,r){this.g(e,{value:t,type:Ic.Prepend,options:i??{applyAtProcessCreation:!0},scope:r})}g(e,t){if(t.options&&t.options.applyAtProcessCreation===!1&&!t.options.applyAtShellIntegration)throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration");const i=this.h(e,t.scope),r=this.map.get(i),s=t.options?{applyAtProcessCreation:t.options.applyAtProcessCreation??!1,applyAtShellIntegration:t.options.applyAtShellIntegration??!1}:{applyAtProcessCreation:!0};if(!r||r.value!==t.value||r.type!==t.type||r.options?.applyAtProcessCreation!==s.applyAtProcessCreation||r.options?.applyAtShellIntegration!==s.applyAtShellIntegration||r.scope?.workspaceFolder?.index!==t.scope?.workspaceFolder?.index){const n=this.h(e,t.scope),o={variable:e,...t,options:s};this.map.set(n,o),this.f.fire()}}get(e,t){const i=this.h(e,t),r=this.map.get(i);return r?$9(r):void 0}h(e,t){const i=this.j(t);return i.length?`${e}:::${i}`:e}j(e){return this.m(e?.workspaceFolder)??""}m(e){return e?e.uri.toString():void 0}getVariableMap(e){const t=new Map;for(const[i,r]of this.map)this.j(r.scope)===this.j(e)&&t.set(r.variable,$9(r));return t}delete(e,t){const i=this.h(e,t);this.map.delete(i),this.f.fire()}clear(e){if(e?.workspaceFolder){for(const[t,i]of this.map)i.scope?.workspaceFolder?.index===e.workspaceFolder.index&&this.map.delete(t);this.n(e)}else this.map.clear(),this.descriptionMap.clear();this.f.fire()}setDescription(e,t){const i=this.j(t),r=this.descriptionMap.get(i);if(!r||r.description!==e){let s;typeof e=="string"?s=e:s=e?.value.split(`

`)[0];const n={description:s,scope:t};this.descriptionMap.set(i,n),this.f.fire()}}getDescription(e){const t=this.j(e);return this.descriptionMap.get(t)?.description}n(e){const t=this.j(e);this.descriptionMap.delete(t)}},f_=class{get persistent(){return this.b.persistent}set persistent(e){this.b.persistent=e}get onDidChangeCollection(){return this.a&&this.a.event}constructor(e,t){this.b=e,this.d=t,this.a=new I}getScoped(e){return this.b.getScopedEnvironmentVariableCollection(e)}replace(e,t,i){this.b.replace(e,t,i,this.d)}append(e,t,i){this.b.append(e,t,i,this.d)}prepend(e,t,i){this.b.prepend(e,t,i,this.d)}get(e){return this.b.get(e,this.d)}forEach(e,t){this.b.getVariableMap(this.d).forEach((i,r)=>e.call(t,r,i,this),this.d)}[Symbol.iterator](){return this.b.getVariableMap(this.d).entries()}delete(e){this.b.delete(e,this.d),this.a.fire(void 0)}clear(){this.b.clear(this.d)}set description(e){this.b.setDescription(e,this.d)}get description(){return this.b.getDescription(this.d)}},hA=class extends gm{constructor(t,i){super(!1,t,i)}createTerminal(t,i,r){throw new fv}createTerminalFromOptions(t,i){throw new fv}};hA=__decorate([__param(0,os),__param(1,Ce)],hA);function C9(e){if(!(!e||typeof e=="string"))return In(e,{id:!0})?{id:e.id,color:e.color}:e}function p_(e){return gc.isThemeColor(e)?e:void 0}function $9(e){const t={...e};return delete t.scope,t.options=t.options??void 0,t}var g_=H("progressService"),I9;(function(e){e[e.Explorer=1]="Explorer",e[e.Scm=3]="Scm",e[e.Extensions=5]="Extensions",e[e.Window=10]="Window",e[e.Notification=15]="Notification",e[e.Dialog=20]="Dialog"})(I9||(I9={}));var Nre=Object.freeze({total(){},worked(){},done(){}}),mm=class{static{this.None=Object.freeze({report(){}})}get value(){return this.a}constructor(e){this.b=e}report(e){this.a=e,this.b(this.a)}},D9=class extends Q{constructor(t,i){super(),this.a=new Ni,i.withProgress(t,r=>(this.b=r,this.c&&r.report(this.c),this.a.p)),this.D(te(()=>this.a.complete()))}report(t){this.b?this.b.report(t):this.c=t}};D9=__decorate([__param(1,g_)],D9);var Lre=H("editorProgressService"),m_={label:d(6544,null),order:Number.MAX_SAFE_INTEGER},P9="__";function v_(e){return typeof e=="object"&&e!==null&&"wwwAuthenticate"in e&&typeof e.wwwAuthenticate=="string"}var w_=H("IAuthenticationService"),b_=H("IAuthenticationExtensionsService"),dA="/.well-known",y_=`${dA}/oauth-protected-resource`,A_=`${dA}/oauth-authorization-server`,fA=`${dA}/openid-configuration`,pA=" ",T9;(function(e){e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidGrant="invalid_grant",e.UnauthorizedClient="unauthorized_client",e.UnsupportedGrantType="unsupported_grant_type",e.InvalidScope="invalid_scope"})(T9||(T9={}));var M9;(function(e){e.AuthorizationPending="authorization_pending",e.SlowDown="slow_down",e.AccessDenied="access_denied",e.ExpiredToken="expired_token"})(M9||(M9={}));var N9;(function(e){e.InvalidRedirectUri="invalid_redirect_uri",e.InvalidClientMetadata="invalid_client_metadata",e.InvalidSoftwareStatement="invalid_software_statement",e.UnapprovedSoftwareStatement="unapproved_software_statement"})(N9||(N9={}));function S_(e){if(typeof e!="object"||e===null)return!1;const t=e;return!(!t.resource||t.scopes_supported!==void 0&&!Array.isArray(t.scopes_supported))}var E_=["issuer","authorization_endpoint","token_endpoint","registration_endpoint","jwks_uri"];function x_(e){if(typeof e!="object"||e===null)return!1;const t=e;if(!t.issuer)throw new Error("Authorization server metadata must have an issuer");for(const i of E_)if(t[i]){if(typeof t[i]!="string")throw new Error(`Authorization server metadata '${i}' must be a string`);if(!t[i].startsWith("https://")&&!t[i].startsWith("http://"))throw new Error(`Authorization server metadata '${i}' must start with http:// or https://`)}return!0}function k_(e){return typeof e!="object"||e===null?!1:e.client_id!==void 0}function gA(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.access_token!==void 0&&t.token_type!==void 0}function C_(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.device_code!==void 0&&t.user_code!==void 0&&t.verification_uri!==void 0&&t.expires_in!==void 0}function R9(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function $_(e){return typeof e!="object"||e===null?!1:e.error!==void 0}function I_(e){return{issuer:e.toString(),authorization_endpoint:new URL("/authorize",e).toString(),token_endpoint:new URL("/token",e).toString(),registration_endpoint:new URL("/register",e).toString(),response_types_supported:["code","id_token","id_token token"]}}var L9=["authorization_code","refresh_token","urn:ietf:params:oauth:grant-type:device_code"],O9=33418;async function F9(e,t,i){if(!e.registration_endpoint)throw new Error("Server does not support dynamic registration");const r={client_name:t,client_uri:"https://code.visualstudio.com",grant_types:e.grant_types_supported?e.grant_types_supported.filter(o=>L9.includes(o)):L9,response_types:["code"],redirect_uris:["https://insiders.vscode.dev/redirect","https://vscode.dev/redirect","http://127.0.0.1/",`http://127.0.0.1:${O9}/`],scope:i?.join(pA),token_endpoint_auth_method:"none",application_type:"native"},s=await fetch(e.registration_endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const o=await s.text();let a=o;try{const c=JSON.parse(o);$_(c)&&(a=`${c.error}${c.error_description?`: ${c.error_description}`:""}`)}catch{}throw new Error(`Registration to ${e.registration_endpoint} failed: ${a}`)}const n=await s.json();if(k_(n))return n;throw new Error(`Invalid authorization dynamic client registration response: ${JSON.stringify(n)}`)}function U9(e){const t=[],i=[];let r="",s=!1;for(let o=0;o<e.length;o++){const a=e[o];a==='"'?(s=!s,r+=a):a===","&&!s?(r.trim()&&i.push(r.trim()),r=""):r+=a}r.trim()&&i.push(r.trim());let n;for(const o of i)if(!o.includes("="))n&&t.push(n),n={scheme:o.trim(),params:{}};else{const c=o.indexOf(" ");if(c>0){const l=o.substring(0,c),u=o.substring(c+1);if(!l.includes("=")&&u.includes("=")){n&&t.push(n),n={scheme:l.trim(),params:{}};const h=u.indexOf("=");if(h>0){const f=u.substring(0,h).trim(),p=u.substring(h+1).trim().replace(/^"|"$/g,"");f&&p!==void 0&&(n.params[f]=p)}continue}}if(n){const l=o.indexOf("=");if(l>0){const u=o.substring(0,l).trim(),h=o.substring(l+1).trim().replace(/^"|"$/g,"");u&&h!==void 0&&(n.params[u]=h)}}}return n&&t.push(n),t}function j9(e){const t=e.split(".");if(t.length!==3)throw new Error("Invalid JWT token format: token must have three parts separated by dots");const[i,r,s]=t;try{if(typeof JSON.parse(Ho(i).toString())!="object")throw new Error("Invalid JWT token format: header is not a JSON object");const o=JSON.parse(Ho(r).toString());if(typeof o!="object")throw new Error("Invalid JWT token format: payload is not a JSON object");return o}catch(n){throw n instanceof Error?new Error(`Failed to parse JWT token: ${n.message}`):new Error("Failed to parse JWT token")}}function D_(e,t){if(e===t)return!0;if(!e||!t||e.length!==t.length)return!1;const i=[...e].sort(),r=[...t].sort();return i.every((s,n)=>s===r[n])}async function P_(e,t,i={}){const{sameOriginHeaders:r={},fetch:s=fetch}=i,n=new URL(e);let o;if(t)o=[t];else{const c=n.pathname==="/"?void 0:n.pathname,l=`${n.origin}${y_}`;c?o=[`${l}${c}`,l]:o=[l]}const a=[];for(const c of o)try{let l={Accept:"application/json"};new URL(c).origin===n.origin&&(l={...l,...r});const h=await s(c,{method:"GET",headers:l});if(h.status!==200){let p;try{p=await h.text()}catch{p=h.statusText}a.push(new Error(`Failed to fetch resource metadata from ${c}: ${h.status} ${p}`));continue}const f=await h.json();if(S_(f)){const p=new URL(f.resource).toString(),g=n.toString();if(p!==g)throw new Error(`Protected Resource Metadata resource property value "${p}" (length: ${p.length}) does not match target server url "${g}" (length: ${g.length}). These MUST match to follow OAuth spec https://datatracker.ietf.org/doc/html/rfc9728#PRConfigurationValidation`);return f}else{a.push(new Error(`Invalid resource metadata from ${c}. Expected to follow shape of https://datatracker.ietf.org/doc/html/rfc9728#name-protected-resource-metadata (Hints: is scopes_supported an array? Is resource a string?). Current payload: ${JSON.stringify(f)}`));continue}}catch(l){a.push(l instanceof Error?l:new Error(String(l)));continue}throw a.length===1?a[0]:new AggregateError(a,"Failed to fetch resource metadata from all attempted URLs")}async function T_(e){if(e.status===200)try{const t=await e.json();if(x_(t))return t}catch{}}async function M_(e){try{return await e.text()}catch{return e.statusText}}async function N_(e,t={}){const{additionalHeaders:i={},fetch:r=fetch}=t,s=new URL(e),n=s.pathname==="/"?"":s.pathname,o=[],a=async f=>{try{const p=await r(f,{method:"GET",headers:{...i,Accept:"application/json"}}),g=await T_(p);if(g)return g;o.push(new Error(`Failed to fetch authorization server metadata from ${f}: ${p.status} ${await M_(p)}`));return}catch(p){o.push(p instanceof Error?p:new Error(String(p)));return}},c=new URL(A_,e).toString()+n;let l=await a(c);if(l)return l;const u=new URL(fA,e).toString()+n;if(l=await a(u),l)return l;const h=e.endsWith("/")?e+fA.substring(1):e+fA;if(l=await a(h),l)return l;throw o.length===1?o[0]:new AggregateError(o,"Failed to fetch authorization server metadata from all attempted URLs")}var mA,vA=class{static{mA=this}static{this.a={focused:!0,active:!0}}getState(){const t=this.f;return{get focused(){return t.focused},get active(){return t.active}}}constructor(t,i){this.c=new I,this.onDidChangeWindowState=this.c.event,this.f=mA.a,t.handle&&(this.d=Ho(t.handle).buffer),this.b=i.getProxy(X.MainThreadWindow),this.b.$getInitialState().then(({isFocused:r,isActive:s})=>{this.onDidChangeWindowProperty("focused",r),this.onDidChangeWindowProperty("active",s)})}get nativeHandle(){return this.d}$onDidChangeActiveNativeWindowHandle(t){this.d=t?Ho(t).buffer:void 0}$onDidChangeWindowFocus(t){this.onDidChangeWindowProperty("focused",t)}$onDidChangeWindowActive(t){this.onDidChangeWindowProperty("active",t)}onDidChangeWindowProperty(t,i){i!==this.f[t]&&(this.f={...this.f,[t]:i},this.c.fire(this.f))}openUri(t,i){let r;if(typeof t=="string"){r=t;try{t=y.parse(t)}catch{return Promise.reject(`Invalid uri - '${t}'`)}}return nu(t.scheme)?Promise.reject("Invalid scheme - cannot be empty"):t.scheme===q.command?Promise.reject(`Invalid scheme '${t.scheme}'`):this.b.$openUri(t,r,i)}async asExternalUri(t,i){if(nu(t.scheme))return Promise.reject("Invalid scheme - cannot be empty");const r=await this.b.$asExternalUri(t,i);return y.from(r)}};vA=mA=__decorate([__param(0,Ft),__param(1,Ce)],vA);var vm=H("IExtHostWindow"),wA,bA=class{static{wA=this}static{this.a=0}constructor(t){this.c=new Go,this.d=new Map,this.b=t.getProxy(X.MainThreadUrls)}registerUriHandler(t,i){const r=t.identifier;if(this.c.has(r))throw new Error(`Protocol handler already registered for extension ${r}`);const s=wA.a++;return this.c.add(r),this.d.set(s,i),this.b.$registerUriHandler(s,r,t.displayName||t.name),te(()=>{this.c.delete(r),this.d.delete(s),this.b.$unregisterUriHandler(s)})}$handleExternalUri(t,i){const r=this.d.get(t);if(!r)return Promise.resolve(void 0);try{r.handleUri(y.revive(i))}catch(s){lt(s)}return Promise.resolve(void 0)}async createAppUri(t){return y.revive(await this.b.$createAppUri(t))}};bA=wA=__decorate([__param(0,Ce)],bA);var wm=H("IExtHostUrlsService"),bm=H("IExtHostProgress"),yA=class{constructor(t){this.b=0,this.c=new Map,this.a=t.getProxy(X.MainThreadProgress)}async withProgress(t,i,r){const s=this.b++,{title:n,location:o,cancellable:a}=i,c={label:t.displayName||t.name,id:t.identifier.value};return this.a.$startProgress(s,{location:Dg.from(o),title:n,source:c,cancellable:a},t.isUnderDevelopment?void 0:t.identifier.value).catch(Hd),this.d(s,r,!!a)}async withProgressFromSource(t,i,r){const s=this.b++,{title:n,location:o,cancellable:a}=i;return this.a.$startProgress(s,{location:Dg.from(o),title:n,source:t,cancellable:a},void 0).catch(Hd),this.d(s,r,!!a)}d(t,i,r){let s;r&&(s=new Qe,this.c.set(t,s));const n=a=>{this.a.$progressEnd(a),this.c.delete(a),s?.dispose()};let o;try{o=i(new z9(this.a,t),r&&s?s.token:Fe.None)}catch(a){throw n(t),a}return o.then(a=>n(t),a=>n(t)),o}$acceptProgressCanceled(t){const i=this.c.get(t);i&&(i.cancel(),this.c.delete(t))}};yA=__decorate([__param(0,Ce)],yA);function R_(e,t){return e.message=t.message,typeof t.increment=="number"&&(typeof e.increment=="number"?e.increment+=t.increment:e.increment=t.increment),e}var z9=class extends mm{constructor(e,t){super(i=>this.throttledReport(i)),this.c=e,this.d=t}throttledReport(e){this.c.$progressReport(this.d,e)}};__decorate([HO(100,(e,t)=>R_(e,t),()=>Object.create(null))],z9.prototype,"throttledReport",null);var AA=H("IExtHostAuthentication"),SA=class{constructor(t,i,r,s,n,o,a){this.l=i,this.m=r,this.n=s,this.o=n,this.p=o,this.q=a,this.c=ym,this.f=new Map,this.g=new ox,this.h=new I,this.j=new L_,this.k=new I,this.d=t.getProxy(X.MainThreadAuthentication)}getExtensionScopedSessionsEvent(t){const i=t.toLowerCase();return Ie.chain(this.h.event,r=>r.filter(s=>!s.extensionIdFilter||s.extensionIdFilter.includes(i)).map(s=>({provider:s.provider})))}async getSession(t,i,r,s={}){const n=Ye.toKey(t.identifier),a=Object.keys(s).map(l=>{switch(l){case"account":return`${l}:${s.account?.id}`;case"createIfNone":case"forceNewSession":{const u=typeof s[l]=="boolean"?`${s[l]}`:`'${s[l]?.detail}/${s[l]?.learnMore?.toString()}'`;return`${l}:${u}`}case"authorizationServer":return`${l}:${s.authorizationServer?.toString(!0)}`;default:return`${l}:${!!s[l]}`}}).sort().join(", ");let c;if(v_(r)){const l=r,u=l.wwwAuthenticate,h=l.fallbackScopes?[...l.fallbackScopes].sort().join(" "):"";c=`${n} ${i} challenge:${u} ${h} ${a}`}else{const l=[...r].sort().join(" ");c=`${n} ${i} ${l} ${a}`}return await this.j.getOrCreate(c,async()=>{await this.d.$ensureProvider(i);const l=t.displayName||t.name;return this.d.$getSession(i,r,n,l,s)})}async getAccounts(t){return await this.d.$ensureProvider(t),await this.d.$getAccounts(t)}registerAuthenticationProvider(t,i,r,s){return this.g.queue(t,async()=>{if(this.f.get(t)){this.q.error(`An authentication provider with id '${t}' is already registered. The existing provider will not be replaced.`);return}const n=r.onDidChangeSessions(o=>this.d.$sendDidChangeSessions(t,o));this.f.set(t,{label:i,provider:r,disposable:n,options:s??{supportsMultipleAccounts:!1}}),await this.d.$registerAuthenticationProvider({id:t,label:i,supportsMultipleAccounts:s?.supportsMultipleAccounts??!1,supportedAuthorizationServers:s?.supportedAuthorizationServers,supportsChallenges:s?.supportsChallenges})}),new ke(()=>{this.g.queue(t,async()=>{const n=this.f.get(t);n&&(n.disposable?.dispose(),this.f.delete(t),await this.d.$unregisterAuthenticationProvider(t))})})}$createSession(t,i,r){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s)return r.authorizationServer=y.revive(r.authorizationServer),await s.provider.createSession(i,r);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$removeSession(t,i){return this.g.queue(t,async()=>{const r=this.f.get(t);if(r)return await r.provider.removeSession(i);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessions(t,i,r){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s)return r.authorizationServer=y.revive(r.authorizationServer),await s.provider.getSessions(i,r);throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$getSessionsFromChallenges(t,i,r){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s){const n=s.provider;if(typeof n.getSessionsFromChallenges=="function")return r.authorizationServer=y.revive(r.authorizationServer),await n.getSessionsFromChallenges(i,r);throw new Error(`Authentication provider with handle: ${t} does not support getSessionsFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$createSessionFromChallenges(t,i,r){return this.g.queue(t,async()=>{const s=this.f.get(t);if(s){const n=s.provider;if(typeof n.createSessionFromChallenges=="function")return r.authorizationServer=y.revive(r.authorizationServer),await n.createSessionFromChallenges(i,r);throw new Error(`Authentication provider with handle: ${t} does not support createSessionFromChallenges`)}throw new Error(`Unable to find authentication provider with handle: ${t}`)})}$onDidChangeAuthenticationSessions(t,i,r){return t.startsWith(P9)||this.h.fire({provider:{id:t,label:i},extensionIdFilter:r}),Promise.resolve()}$onDidUnregisterAuthenticationProvider(t){return this.g.queue(t,async()=>{const i=this.f.get(t);i&&(i.disposable?.dispose(),this.f.delete(t))})}async $registerDynamicAuthProvider(t,i,r,s,n,o){if(!s){const c=y.revive(t);if(i.registration_endpoint)try{const l=await F9(i,this.l.environment.appName,r?.scopes_supported);s=l.client_id,n=l.client_secret}catch(l){this.q.warn(`Dynamic registration failed for ${c.toString()}: ${l.message}. Prompting user for client ID and client secret...`)}if(!s){this.q.info(`Prompting user for client registration details for ${c.toString()}`);const l=await this.d.$promptForClientRegistration(c.toString());if(!l)throw new Error("User did not provide client details");s=l.clientId,n=l.clientSecret,this.q.info(`User provided client registration for ${c.toString()}`),n?this.q.trace(`User provided client secret for ${c.toString()}`):this.q.trace(`User did not provide client secret for ${c.toString()}`)}}const a=new this.c(this.m,this.n,this.l,this.o,this.p,this.d,y.revive(t),i,r,s,n,this.k,o||[]);return await this.g.queue(a.id,async()=>{this.f.set(a.id,{label:a.label,provider:a,disposable:ke.from(a,a.onDidChangeSessions(c=>this.d.$sendDidChangeSessions(a.id,c)),a.onDidChangeClientId(()=>this.d.$sendDidChangeDynamicProviderInfo({providerId:a.id,clientId:a.clientId,clientSecret:a.clientSecret}))),options:{supportsMultipleAccounts:!0}}),await this.d.$registerDynamicAuthenticationProvider({id:a.id,label:a.label,supportsMultipleAccounts:!0,authorizationServer:t,resourceServer:r?y.parse(r.resource):void 0,clientId:a.clientId,clientSecret:a.clientSecret})}),a.id}async $onDidChangeDynamicAuthProviderTokens(t,i,r){this.k.fire({authProviderId:t,clientId:i,tokens:r})}};SA=__decorate([__param(0,Ce),__param(1,Ft),__param(2,vm),__param(3,wm),__param(4,bm),__param(5,_n),__param(6,Se)],SA);var L_=class{constructor(){this.c=new Map}getOrCreate(e,t){const i=this.c.get(e);if(i)return i;const r=t().finally(()=>this.c.delete(e));return this.c.set(e,r),r}},ym=class{constructor(t,i,r,s,n,o,a,c,l,u,h,f,p){this.k=t,this.l=i,this.m=r,this.n=s,this.o=o,this.authorizationServer=a,this.p=c,this.q=l,this.r=u,this.s=h,this.c=new I,this.onDidChangeSessions=this.c.event,this.d=new I,this.onDidChangeClientId=this.d.event;const g=a.toString(!0);this.id=l?.resource?g+" "+l?.resource:g,this.label=l?.resource_name??this.authorizationServer.authority,this.h=n.createLogger(this.id,{name:`Auth: ${this.label}`}),this.j=new ie,this.j.add(this.c);const v=Ie.chain(f.event,b=>b.filter(S=>S.authProviderId===this.id&&S.clientId===u).map(S=>S.tokens));this.f=this.j.add(new O_({onDidChange:v,set:b=>o.$setSessionsForDynamicAuthProvider(this.id,this.clientId,b)},p,this.h)),this.j.add(this.f.onDidChangeSessions(b=>this.c.fire(b))),this.g=[],c.authorization_endpoint&&this.g.push({label:d(3012,null),handler:(b,S,E)=>this.u(b,S,E)})}get clientId(){return this.r}get clientSecret(){return this.s}async getSessions(t,i){if(this.h.info(`Getting sessions for scopes: ${t?.join(" ")??"all"}`),!t)return this.f.sessions;const r=[...t].sort(),s=t.join(" ");let n=this.f.sessions.filter(o=>Gi([...o.scopes].sort(),r));if(this.h.info(`Found ${n.length} sessions for scopes: ${s}`),n.length){const o=[],a=[],c=new Map(this.f.tokens.map(l=>[l.access_token,l]));for(const l of n){const u=c.get(l.accessToken);if(u&&u.expires_in){const h=Date.now(),f=u.expires_in*1e3;if(h>u.created_at+f-5*60*1e3){if(this.h.info(`Token for session ${l.id} is about to expire, refreshing...`),a.push(u),!u.refresh_token){this.h.warn(`No refresh token available for scopes ${l.scopes.join(" ")}. Throwing away token.`);continue}try{const p=await this.z(u.refresh_token);p.scope!==s&&(this.h.warn(`Token scopes '${p.scope}' do not match requested scopes '${s}'. Overwriting token with what was requested...`),p.scope=s),this.h.info(`Successfully created a new token for scopes ${l.scopes.join(" ")}.`),o.push(p)}catch(p){this.h.error(`Failed to refresh token: ${p}`)}}}}return(o.length||a.length)&&(this.f.update({added:o,removed:a}),n=this.f.sessions.filter(l=>Gi([...l.scopes].sort(),r))),this.h.info(`Found ${n.length} sessions for scopes: ${s}`),n}return[]}async createSession(t,i){this.h.info(`Creating session for scopes: ${t.join(" ")}`);let r;for(let n=0;n<this.g.length;n++){const{handler:o}=this.g[n];try{if(r=await this.n.withProgressFromSource({label:this.label,id:this.id},{location:ao.Notification,title:d(3013,null,this.label),cancellable:!0},(a,c)=>o(t,a,c)),r)break}catch(a){const c=this.g[n+1]?.label;if(!c)break;const l=Ti(a)?d(3014,null,this.label,c):d(3015,null,this.label,c);if(!await this.o.$showContinueNotification(l))throw new dt;this.h.error(`Failed to create token via flow '${c}': ${a}`)}}if(!r)throw new Error("Failed to create authentication token");r.scope!==t.join(" ")&&(this.h.warn(`Token scopes '${r.scope}' do not match requested scopes '${t.join(" ")}'. Overwriting token with what was requested...`),r.scope=t.join(" ")),this.f.update({added:[{...r,created_at:Date.now()}],removed:[]});const s=this.f.sessions.find(n=>n.accessToken===r.access_token);return this.h.info(`Created ${r.refresh_token?"refreshable":"non-refreshable"} session for scopes: ${r.scope}${r.expires_in?` that expires in ${r.expires_in} seconds`:""}`),s}async removeSession(t){this.h.info(`Removing session with id: ${t}`);const i=this.f.sessions.find(s=>s.id===t);if(!i){this.h.error(`Session with id ${t} not found`);return}const r=this.f.tokens.find(s=>s.access_token===i.accessToken);if(!r){this.h.error(`Failed to retrieve token for removed session: ${i.id}`);return}this.f.update({added:[],removed:[r]}),this.h.info(`Removed token for session: ${i.id} with scopes: ${i.scopes.join(" ")}`)}dispose(){this.j.dispose()}async u(t,i,r){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const s=this.v(64),n=await this.w(s),o=this.v(32),a=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/authorize?nonce=${o}`);let c;try{c=await this.l.createAppUri(a)}catch(b){throw new Error(`Failed to create external URI: ${b}`)}const l=new URL(this.p.authorization_endpoint);l.searchParams.append("client_id",this.r),l.searchParams.append("response_type","code"),l.searchParams.append("state",c.toString()),l.searchParams.append("code_challenge",n),l.searchParams.append("code_challenge_method","S256");const u=t.join(" ");u&&l.searchParams.append("scope",u),this.q?.resource&&l.searchParams.append("resource",this.q.resource);const h="https://vscode.dev/redirect";l.searchParams.append("redirect_uri",h);const f=this.x(a);if(this.h.info(`Opening authorization URL for scopes: ${u}`),this.h.trace(`Authorization URL: ${l.toString()}`),!await this.k.openUri(l.toString(),{}))throw new dt;i.report({message:d(3016,null)});let g;try{g=(await cf(f,r)).code}catch(b){throw Ti(b)?(this.h.info("Authorization code request was cancelled by the user."),b):(this.h.error(`Failed to receive authorization code: ${b}`),new Error(`Failed to receive authorization code: ${b}`))}return this.h.info(`Authorization code received for scopes: ${u}`),await this.y(g,s,h)}v(t){const i=new Uint8Array(t);return crypto.getRandomValues(i),Array.from(i).map(r=>r.toString(16).padStart(2,"0")).join("").substring(0,t)}async w(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r);return oc(W.wrap(new Uint8Array(s)),!1,!1).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async x(t){const i=await this.o.$waitForUriHandler(t),r=/[?&]code=([^&]+)/.exec(i.query||"");if(!r||r.length<2)throw new Error("Authentication failed: No authorization code received");return{code:r[1]}}async y(t,i,r){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const s=new URLSearchParams;s.append("client_id",this.r),s.append("grant_type","authorization_code"),s.append("code",t),s.append("redirect_uri",r),s.append("code_verifier",i),this.q?.resource&&s.append("resource",this.q.resource),this.s&&s.append("client_secret",this.s),this.h.info("Exchanging authorization code for token..."),this.h.trace(`Url: ${this.p.token_endpoint}`),this.h.trace(`Token request body: ${s.toString()}`);let n;try{n=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:s.toString()})}catch(a){throw this.h.error(`Failed to exchange authorization code for token: ${a}`),new Error(`Failed to exchange authorization code for token: ${a}`)}if(!n.ok){const a=await n.text();throw new Error(`Token exchange failed: ${n.status} ${n.statusText} - ${a}`)}const o=await n.json();if(gA(o))return this.h.info("Successfully exchanged authorization code for token."),o;throw R9(o)&&o.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(o)}`)}async z(t){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const i=new URLSearchParams;i.append("client_id",this.r),i.append("grant_type","refresh_token"),i.append("refresh_token",t),this.q?.resource&&i.append("resource",this.q.resource),this.s&&i.append("client_secret",this.s);const s=await(await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:i.toString()})).json();if(gA(s))return{...s,created_at:Date.now()};throw R9(s)&&s.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Invalid authorization token response: ${JSON.stringify(s)}`)}async A(){try{const t=await F9(this.p,this.m.environment.appName,this.q?.scopes_supported);this.r=t.client_id,this.s=t.client_secret,this.d.fire()}catch(t){this.h.info(`Dynamic registration failed for ${this.authorizationServer.toString()}: ${t}. Prompting user for client ID and client secret.`);try{const i=await this.o.$promptForClientRegistration(this.authorizationServer.toString());if(!i)throw new Error("User did not provide client details");this.r=i.clientId,this.s=i.clientSecret,this.h.info(`User provided client ID for ${this.authorizationServer.toString()}`),i.clientSecret?this.h.info(`User provided client secret for ${this.authorizationServer.toString()}`):this.h.info(`User did not provide client secret for ${this.authorizationServer.toString()} (optional)`),this.d.fire()}catch{throw this.h.error(`Failed to fetch new client ID and user did not provide one: ${t}`),new Error(`Failed to fetch new client ID and user did not provide one: ${t}`)}}}};ym=__decorate([__param(0,vm),__param(1,wm),__param(2,Ft),__param(3,bm),__param(4,_n)],ym);var O_=class{constructor(e,t,i){this.h=e,this.j=i,this.f=new I,this.onDidChangeSessions=this.f.event,this.g=new ie,this.c=ir("tokens",t),this.d=tI({equalsFn:(r,s)=>Gi(r,s,(n,o)=>n.accessToken===o.accessToken)},r=>this.c.read(r).map(s=>this.l(s))),this.g.add(this.k()),this.g.add(this.h.onDidChange(r=>this.c.set(r,void 0)))}get tokens(){return this.c.get()}get sessions(){return this.d.get()}dispose(){this.g.dispose()}update({added:e,removed:t}){this.j.trace(`Updating tokens: added ${e.length}, removed ${t.length}`);const i=[...this.c.get()];for(const r of t){const s=i.findIndex(n=>n.access_token===r.access_token);s!==-1&&i.splice(s,1)}for(const r of e){const s=i.findIndex(n=>n.access_token===r.access_token);s===-1?i.push(r):i[s]=r}(e.length||t.length)&&(this.c.set(i,void 0),this.h.set(i)),this.j.trace(`Tokens updated: ${i.length} tokens stored.`)}k(){let e=[];return zf(t=>{this.j.trace("Checking for session changes...");const i=this.d.read(t);if(e===i){this.j.trace("No session changes detected.");return}if(!i||i.length===0){this.j.trace("All sessions removed."),e.length>0&&(this.f.fire({added:[],removed:e,changed:[]}),e=[]);return}const r=[],s=[];for(const n of i)e.some(a=>a.accessToken===n.accessToken)||r.push(n);for(const n of e)i.some(a=>a.accessToken===n.accessToken)||s.push(n);(r.length>0||s.length>0)&&(this.j.trace(`Sessions changed: added ${r.length}, removed ${s.length}`),this.f.fire({added:r,removed:s,changed:[]})),e=i})}l(e){let t;if(e.id_token)try{t=j9(e.id_token)}catch{}if(!t)try{t=j9(e.access_token)}catch{}const i=e.scope?e.scope.split(" "):t?.scope?t.scope.split(" "):[];return{id:p0(e.access_token,0).toString(),accessToken:e.access_token,account:{id:t?.sub||"unknown",label:t?.preferred_username||t?.name||t?.email||"MCP"},scopes:i,idToken:e.id_token}}},EA,xA=H("IExtHostLanguageModels"),F_=class{constructor(){this.a=new tO,this.b=!1;const e=this,[t,i]=mx.tee(e.a.asyncIterable);this.apiObject={get stream(){return t},get text(){return i.map(r=>{if(r instanceof Ut)return r.value}).coalesce()}}}handleResponsePart(e){if(this.b)return;const t=[];for(const i of Wt.wrap(e)){let r;i.type==="text"?r=new Ut(i.value,i.audience):i.type==="thinking"?r=new el(i.value,i.id,i.metadata):i.type==="data"?r=new gi(i.data.buffer,i.mimeType,i.audience):r=new Aa(i.toolCallId,i.name,i.parameters),t.push(r)}this.a.emitMany(t)}reject(e){this.b=!0,this.a.reject(e)}resolve(){this.b=!0,this.a.resolve()}},kA=class{static{EA=this}static{this.a=1}constructor(t,i,r){this.o=i,this.p=r,this.c=new I,this.d=new I,this.onDidChangeProviders=this.d.event,this.f=new I,this.onDidChangeModelProxyAvailability=this.f.event,this.g=new Map,this.h=new Map,this.j=new Wn,this.k=new Map,this.l=new Map,this.x=new Set,this.b=t.getProxy(X.MainThreadLanguageModels)}dispose(){this.c.dispose(),this.d.dispose(),this.f.dispose()}registerLanguageModelChatProvider(t,i,r){this.g.set(i,{extension:t,provider:r}),this.b.$registerLanguageModelProvider(i);let s;return r.onDidChangeLanguageModelChatInformation&&(s=r.onDidChangeLanguageModelChatInformation(()=>{this.b.$onLMProviderChange(i)})),te(()=>{this.g.delete(i),this.q(i),s?.dispose(),this.b.$unregisterProvider(i)})}q(t){this.h.forEach((i,r)=>{i.metadata.vendor===t&&this.h.delete(r)})}async $provideLanguageModelChatInfo(t,i,r){const s=this.g.get(t);if(!s)return[];const n=await s.provider.provideLanguageModelChatInformation(i,r)??[],o=n.map(a=>{let c;return a.requiresAuthorization&&et(s.extension,"chatProvider")&&(c={providerLabel:s.extension.displayName||s.extension.name,accountLabel:typeof a.requiresAuthorization=="object"?a.requiresAuthorization.label:void 0}),a.capabilities.editTools&&T(s.extension,"chatProvider"),{metadata:{extension:s.extension.identifier,id:a.id,vendor:t,name:a.name??"",family:a.family??"",detail:a.detail,tooltip:a.tooltip,version:a.version,maxInputTokens:a.maxInputTokens,maxOutputTokens:a.maxOutputTokens,auth:c,isDefault:a.isDefault,isUserSelectable:a.isUserSelectable,statusIcon:a.statusIcon,modelPickerCategory:a.category??m_,capabilities:a.capabilities?{vision:a.capabilities.imageInput,editTools:a.capabilities.editTools,toolCalling:!!a.capabilities.toolCalling,agentMode:!!a.capabilities.toolCalling}:void 0},identifier:`${t}/${a.id}`}});this.q(t);for(let a=0;a<o.length;a++)this.h.set(o[a].identifier,{metadata:o[a].metadata,info:n[a]});return o}async $startChatRequest(t,i,r,s,n,o){const a=this.h.get(t);if(!a)throw new Error("Model not found");const c=this.g.get(a.metadata.vendor);if(!c)throw new Error(`Language model provider for '${a.metadata.id}' not found.`);const l=[],u=()=>{l.length>0&&(this.b.$reportResponsePart(i,new fi(l)),l.length=0)},h=new vs(u,30),f=v=>{l.push(v)>30?(u(),h.cancel()):h.schedule()},p=new mm(async v=>{if(o.isCancellationRequested){this.o.warn(`[CHAT](${c.extension.identifier.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let b;if(v instanceof Aa?b={type:"tool_use",name:v.name,parameters:v.input,toolCallId:v.callId}:v instanceof Ut?b={type:"text",value:v.value,audience:v.audience}:v instanceof gi?b={type:"data",mimeType:v.mimeType,data:W.wrap(v.data),audience:v.audience}:v instanceof el&&(b={type:"thinking",value:v.value,id:v.id,metadata:v.metadata}),!b){this.o.warn(`[CHAT](${c.extension.identifier.value}) UNKNOWN part ${JSON.stringify(v)}`);return}f(b)});let g;try{g=c.provider.provideLanguageModelChatResponse(a.info,s.value.map(Og.to),{...n,modelOptions:n.modelOptions??{},requestInitiator:Ye.toKey(r),toolMode:n.toolMode??pg.Auto},p,o)}catch(v){throw v}Promise.resolve(g).then(()=>{u(),this.b.$reportResponseDone(i,void 0)},v=>{u(),this.b.$reportResponseDone(i,Qa(v))})}$provideTokenLength(t,i,r){const s=this.h.get(t);if(!s)return Promise.resolve(0);const n=this.g.get(s.metadata.vendor);return n?Promise.resolve(n.provider.provideTokenCount(s.info,i,r)):Promise.resolve(0)}async getDefaultLanguageModel(t,i){let r;i&&await this.selectLanguageModels(t,{});for(const[s,n]of this.h)if(n.metadata.isDefault){r=s;break}return!r&&!i?this.getDefaultLanguageModel(t,!0):this.getLanguageModelByIdentifier(t,r)}async getLanguageModelByIdentifier(t,i){if(!i)return;const r=this.h.get(i);if(!r)return(await this.selectLanguageModels(t,{id:i}))[0];this.u(t.identifier,r.metadata)&&await this.v(r.metadata);let s;if(!s){const n=this;s={id:r.info.id,vendor:r.metadata.vendor,family:r.info.family,version:r.info.version,name:r.info.name,capabilities:{supportsImageToText:r.metadata.capabilities?.vision??!1,supportsToolCalling:!!r.metadata.capabilities?.toolCalling,editToolsHint:r.metadata.capabilities?.editTools},maxInputTokens:r.metadata.maxInputTokens,countTokens(o,a){if(!n.h.has(i))throw an.NotFound(i);return n.w(i,o,a??Fe.None)},sendRequest(o,a,c){if(!n.h.has(i))throw an.NotFound(i);return n.r(t,i,o,a??{},c??Fe.None)}},Object.freeze(s)}return s}async selectLanguageModels(t,i){const r=await this.b.$selectChatModels({...i,extension:t.identifier}),s=[],n=r.map(a=>this.getLanguageModelByIdentifier(t,a)),o=await Promise.all(n);for(const a of o)a&&s.push(a);return s}async r(t,i,r,s,n){const o=this.s(t,r),a=t.identifier,c=this.h.get(i)?.metadata;if(!c||!this.h.has(i))throw an.NotFound(`Language model '${i}' is unknown.`);if(this.u(a,c)&&(!await this.t(t,{identifier:c.extension,displayName:c.auth.providerLabel},s.justification,!1)||!this.j.get(a)?.has(c.extension)))throw an.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`);const l=Math.random()*1e6|0,u=new F_;this.k.set(l,{languageModelId:i,res:u});try{await this.b.$tryStartChatRequest(a,i,l,new fi(o),s,n)}catch(h){throw this.k.delete(l),an.tryDeserialize(h)??h}return u.apiObject}s(t,i){const r=[];for(const s of i)s.role===sr.System&&T(t,"languageModelSystem"),r.push(Og.from(s));return r}async $acceptResponsePart(t,i){const r=this.k.get(t);r&&r.res.handleResponsePart(i.value)}async $acceptResponseDone(t,i){const r=this.k.get(t);r&&(this.k.delete(t),i?r.res.reject(an.tryDeserialize(i)??H5(i)):r.res.resolve())}async t(t,i,r,s){const n=P9+i.identifier.value;if(await this.p.getSession(t,n,[],{silent:!0}))return this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0;if(s)return!1;try{const a=r?d(3022,null,i.displayName,r):void 0;return await this.p.getSession(t,n,[],{forceNewSession:{detail:a}}),this.$updateModelAccesslist([{from:t.identifier,to:i.identifier,enabled:!0}]),!0}catch{return!1}}u(t,i){return!!i.auth&&!Ye.equals(i.extension,t)}async v(t){if(t.auth)for(const i of this.x)try{await this.t(i,{identifier:t.extension,displayName:""},void 0,!0)}catch(r){this.o.error("Fake Auth request failed"),this.o.error(r)}}async w(t,i,r){const s=this.h.get(t);if(!s)throw an.NotFound(`Language model '${t}' is unknown.`);return this.g.get(s.metadata.vendor)?.provider.provideTokenCount(s.info,i,r)??0}$updateModelAccesslist(t){const i=new Array;for(const{from:r,to:s,enabled:n}of t){const o=this.j.get(r)??new Go;if(o.has(s)!==n){n?o.add(s):o.delete(s),this.j.set(r,o);const c={from:r,to:s};i.push(c),this.c.fire(c)}}}createLanguageModelAccessInformation(t){this.x.add(t);const i=Ie.signal(Ie.filter(this.c.event,s=>Ye.equals(s.from,t.identifier))),r=Ie.signal(this.d.event);return{get onDidChange(){return Ie.any(i,r)},canSendRequest(s){return!0}}}fileIsIgnored(t,i,r=Fe.None){return T(t,"chatParticipantAdditions"),this.b.$fileIsIgnored(i,r)}get isModelProxyAvailable(){return!!this.n}async getModelProxy(t){if(T(t,"languageModelProxy"),!this.n)throw this.o.trace("[LanguageModelProxy] No LanguageModelProxyProvider registered"),new Error("No language model proxy provider is registered.");const i=Ye.toKey(t.identifier);try{const r=await Promise.resolve(this.n.provideModelProxy(i,Fe.None));if(!r)throw this.o.warn(`[LanguageModelProxy] Provider returned no proxy for ${i}`),new Error("Language model proxy is not available.");return r}catch(r){throw this.o.error(`[LanguageModelProxy] Provider failed to return proxy for ${i}`,r),r}}async $isFileIgnored(t,i,r){const s=this.l.get(t);if(!s)throw new Error("Unknown LanguageModelIgnoredFileProvider");return await s.provideFileIgnored(y.revive(i),r)??!1}registerIgnoredFileProvider(t,i){T(t,"chatParticipantPrivate");const r=EA.a++;return this.b.$registerFileIgnoreProvider(r),this.l.set(r,i),te(()=>{this.b.$unregisterFileIgnoreProvider(r),this.l.delete(r)})}registerLanguageModelProxyProvider(t,i){return T(t,"chatParticipantPrivate"),this.n=i,this.f.fire(),te(()=>{this.n===i&&(this.n=void 0,this.f.fire())})}};kA=EA=__decorate([__param(0,Ce),__param(1,Se),__param(2,AA)],kA);function Wh(e,t=ze){return Ov(e,t)?e.charAt(0).toUpperCase()+e.slice(1):e}function Am(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)}var H9="\u2026",Bh="\\\\",_h="~";function U_(e,t=St){const i=new Array(e.length);let r=!1;for(let s=0;s<e.length;s++){const n=e[s];if(n===""){i[s]=`.${t}`;continue}if(!n){i[s]=n;continue}r=!0;let o="",a=n;a.indexOf(Bh)===0?(o=a.substr(0,a.indexOf(Bh)+Bh.length),a=a.substr(a.indexOf(Bh)+Bh.length)):a.indexOf(t)===0?(o=a.substr(0,a.indexOf(t)+t.length),a=a.substr(a.indexOf(t)+t.length)):a.indexOf(_h)===0&&(o=a.substr(0,a.indexOf(_h)+_h.length),a=a.substr(a.indexOf(_h)+_h.length));const c=a.split(t);for(let l=1;r&&l<=c.length;l++)for(let u=c.length-l;r&&u>=0;u--){r=!1;let h=c.slice(u,u+l).join(t);for(let f=0;!r&&f<e.length;f++)if(f!==s&&e[f]&&e[f].indexOf(h)>-1){const p=u+l===c.length,g=u>0&&e[f].indexOf(t)>-1?t+h:h,v=e[f].endsWith(g);r=!p||v}if(!r){let f="";(c[0].endsWith(":")||o!=="")&&(u===1&&(u=0,l++,h=c[0]+t+h),u>0&&(f=c[0]+t),f=o+f),u>0&&(f=f+H9+t),f=f+h,u+l<c.length&&(f=f+t+H9),i[s]=f}}r&&(i[s]=n)}return i}var W9;(function(e){e[e.TEXT=0]="TEXT",e[e.VARIABLE=1]="VARIABLE",e[e.SEPARATOR=2]="SEPARATOR"})(W9||(W9={}));var j_=60,z_=j_*60,CA=z_*24,Wre=CA*7,Bre=CA*30,_re=CA*365;function H_(e){return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}var Sm={DateTimeFormat(e,t){return new Pt(()=>{try{return new Intl.DateTimeFormat(e,t)}catch{return new Intl.DateTimeFormat(void 0,t)}})},Collator(e,t){return new Pt(()=>{try{return new Intl.Collator(e,t)}catch{return new Intl.Collator(void 0,t)}})},Segmenter(e,t){return new Pt(()=>{try{return new Intl.Segmenter(e,t)}catch{return new Intl.Segmenter(void 0,t)}})},Locale(e,t){return new Pt(()=>{try{return new Intl.Locale(e,t)}catch{return new Intl.Locale(Pn,t)}})},NumberFormat(e,t){return new Pt(()=>{try{return new Intl.NumberFormat(e,t)}catch{return new Intl.NumberFormat(void 0,t)}})}},B9;(function(e){e[e.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",e[e.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",e[e.MAX_UINT_8=255]="MAX_UINT_8",e[e.MAX_UINT_16=65535]="MAX_UINT_16",e[e.MAX_UINT_32=4294967295]="MAX_UINT_32",e[e.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(B9||(B9={}));function _9(e){return e<0?0:e>255?255:e|0}function Al(e){return e<0?0:e>4294967295?4294967295:e|0}var V9=class bN{constructor(t){const i=_9(t);this.c=i,this.a=bN.d(i),this.b=new Map}static d(t){const i=new Uint8Array(256);return i.fill(t),i}set(t,i){const r=_9(i);t>=0&&t<256?this.a[t]=r:this.b.set(t,r)}get(t){return t>=0&&t<256?this.a[t]:this.b.get(t)||this.c}clear(){this.a.fill(this.c),this.b.clear()}},q9;(function(e){e[e.False=0]="False",e[e.True=1]="True"})(q9||(q9={}));var G9;(function(e){e[e.Regular=0]="Regular",e[e.Whitespace=1]="Whitespace",e[e.WordSeparator=2]="WordSeparator"})(G9||(G9={}));var W_=class extends V9{constructor(e,t){super(0),this.e=null,this.f=null,this.g=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this.e=Sm.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this.e=null;for(let i=0,r=e.length;i<r;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const r of this.h(e)){if(r.index>t)break;i=r}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this.h(e))if(!(i.index<t))return i;return null}h(e){return this.e?this.f===e?this.g:(this.f=e,this.g=this.j(this.e.value.segment(e)),this.g):[]}j(e){const t=[];for(const i of e)this.k(i)&&t.push(i);return t}k(e){return!!e.isWordLike}},Z9=new Ya(10);function B_(e,t){const i=`${e}/${t.join(",")}`;let r=Z9.get(i);return r||(r=new W_(e,t),Z9.set(i,r)),r}var $A;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=4]="Right",e[e.Full=7]="Full"})($A||($A={}));var J9;(function(e){e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right"})(J9||(J9={}));var Q9;(function(e){e[e.Inline=1]="Inline",e[e.Gutter=2]="Gutter"})(Q9||(Q9={}));var Y9;(function(e){e[e.Normal=1]="Normal",e[e.Underlined=2]="Underlined"})(Y9||(Y9={}));var X9;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(X9||(X9={}));var K9;(function(e){e[e.Both=0]="Both",e[e.Right=1]="Right",e[e.Left=2]="Left",e[e.None=3]="None"})(K9||(K9={}));var eD;(function(e){e[e.TextDefined=0]="TextDefined",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(eD||(eD={}));var tD;(function(e){e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(tD||(tD={}));var iD;(function(e){e[e.LF=0]="LF",e[e.CRLF=1]="CRLF"})(iD||(iD={}));var IA=class{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}},rD;(function(e){e[e.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",e[e.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",e[e.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",e[e.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(rD||(rD={}));var sD;(function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.None=2]="None",e[e.LeftOfInjectedText=3]="LeftOfInjectedText",e[e.RightOfInjectedText=4]="RightOfInjectedText"})(sD||(sD={}));var nD;(function(e){e[e.FIRST_LINE_DETECTION_LENGTH_LIMIT=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(nD||(nD={}));var __=class{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}},V_=class{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}},oD=class{constructor(e,t,i,r){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=r}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=aD(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=IE(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new __(t,this.wordSeparators?B_(this.wordSeparators,[]):null,i?this.searchString:null)}};function aD(e){if(!e||e.length===0)return!1;for(let t=0,i=e.length;t<i;t++){const r=e.charCodeAt(t);if(r===10)return!0;if(r===92){if(t++,t>=i)break;const s=e.charCodeAt(t);if(s===110||s===114||s===87)return!0}}return!1}function cD(e,t,i){if(!i)return new IA(e,null);const r=[];for(let s=0,n=t.length;s<n;s++)r[s]=t[s];return new IA(e,r)}function q_(e,t,i,r,s){if(r===0)return!0;const n=t.charCodeAt(r-1);if(e.get(n)!==0||n===13||n===10)return!0;if(s>0){const o=t.charCodeAt(r);if(e.get(o)!==0)return!0}return!1}function G_(e,t,i,r,s){if(r+s===i)return!0;const n=t.charCodeAt(r+s);if(e.get(n)!==0||n===13||n===10)return!0;if(s>0){const o=t.charCodeAt(r+s-1);if(e.get(o)!==0)return!0}return!1}function lD(e,t,i,r,s){return q_(e,t,i,r,s)&&G_(e,t,i,r,s)}var Z_=class{constructor(e,t){this._wordSeparators=e,this.a=t,this.b=-1,this.c=0}reset(e){this.a.lastIndex=e,this.b=-1,this.c=0}next(e){const t=e.length;let i;do{if(this.b+this.c===t||(i=this.a.exec(e),!i))return null;const r=i.index,s=i[0].length;if(r===this.b&&s===this.c){if(s===0){NE(e,t,this.a.lastIndex)>65535?this.a.lastIndex+=2:this.a.lastIndex+=1;continue}return null}if(this.b=r,this.c=s,!this._wordSeparators||lD(this._wordSeparators,e,t,r,s))return i}while(i);return null}},uD=H("IUriIdentityService");function hD(e){return e.scheme!==q.file&&e.scheme!==q.vscodeRemote}function J_(e){if(e.folders.length)return e.folders.every(t=>hD(t.uri))?e.folders[0].uri:void 0;if(e.configuration&&hD(e.configuration))return e.configuration}function Q_(e){return J_(e)?.scheme}var DA=H("environmentService"),Y_=DA,PA=DA,dD=H("remoteAgentService"),Vre=new class{constructor(){this.maxSampleCount=5,this.sampleDelay=2e3,this.initial=[],this.maxInitialCount=3,this.average=[],this.maxAverageCount=100,this.highLatencyMultiple=2,this.highLatencyMinThreshold=500,this.highLatencyMaxThreshold=1500,this.lastMeasurement=void 0}get latency(){return this.lastMeasurement}async measure(e){let t=1/0;for(let r=0;r<this.maxSampleCount;r++){const s=await e.getRoundTripTime();if(s===void 0)return;t=Math.min(t,s/2),await ri(this.sampleDelay)}this.average.push(t),this.average.length>this.maxAverageCount&&this.average.shift();let i;return this.initial.length<this.maxInitialCount?this.initial.push(t):i=this.initial.reduce((r,s)=>r+s,0)/this.initial.length,this.lastMeasurement={initial:i,current:t,average:this.average.reduce((r,s)=>r+s,0)/this.average.length,high:typeof i>"u"?!1:t>this.highLatencyMaxThreshold||t>this.highLatencyMinThreshold&&t>i*this.highLatencyMultiple},this.lastMeasurement}},TA,X_=H("pathService"),fD=TA=class{constructor(t,i,r,s){this.d=t,this.e=i,this.f=r,this.g=s,this.a=(async()=>(await this.e.getEnvironment())?.os||Lo)(),this.b=(async()=>{const n=await this.e.getEnvironment();return this.c=n?.userHome??t})()}hasValidBasename(t,i,r){return typeof i=="string"||typeof i>"u"?this.a.then(s=>this.h(t,s,i)):this.h(t,i,r)}h(t,i,r){return t.scheme===q.file||t.scheme===q.vscodeRemote?y2(r??dr(t),i===1):!0}get defaultUriScheme(){return TA.findDefaultUriScheme(this.f,this.g)}static findDefaultUriScheme(t,i){if(t.remoteAuthority)return q.vscodeRemote;const r=Q_(i.getWorkspace());if(r)return r;const s=i.getWorkspace().folders[0];if(s)return s.uri.scheme;const n=i.getWorkspace().configuration;return n?n.scheme:q.file}userHome(t){return t?.preferLocal?this.d:this.b}get resolvedUserHome(){return this.c}get path(){return this.a.then(t=>t===1?qt:Be)}async fileURI(t){let i="";if(await this.a===1&&(t=t.replace(/\\/g,"/")),t[0]==="/"&&t[1]==="/"){const s=t.indexOf("/",2);s===-1?(i=t.substring(2),t="/"):(i=t.substring(2,s),t=t.substring(s)||"/")}return y.from({scheme:q.file,authority:i,path:t,query:"",fragment:""})}};fD=TA=__decorate([__param(1,dD),__param(2,PA),__param(3,xf)],fD);function K_(e){return typeof e=="object"&&"uri"in e&&"pattern"in e}var pD=class{constructor(t,i,r,s,n,o){this.a=t,this.b=i,this.c=r,this.d=s,this.f=n,this.g=o}aiText(t,i,r={}){return{...this.j(i?.map(D0),r),type:3,contentPattern:t}}text(t,i,r={}){t=this.h(t,r);const s=this.a.getValue(),n=i&&i.some(a=>!this.a.getValue({resource:a}).search.useRipgrep);return{...this.j(i?.map(D0),r),type:2,contentPattern:t,previewOptions:r.previewOptions,maxFileSize:r.maxFileSize,usePCRE2:s.search.usePCRE2||n||!1,surroundingContext:r.surroundingContext,userDisabledExcludesAndIgnoreFiles:r.disregardExcludeSettings&&r.disregardIgnoreFiles}}h(t,i){const r=this.a.getValue();t.isRegExp&&(t.pattern=t.pattern.replace(/\r?\n/g,"\\n"));const s={...t,wordSeparators:r.editor.wordSeparators};return this.l(t,i)&&(s.isCaseSensitive=!0),this.m(t)&&(s.isMultiline=!0),i.notebookSearchConfig?.includeMarkupInput&&(s.notebookInfo||(s.notebookInfo={}),s.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput),i.notebookSearchConfig?.includeMarkupPreview&&(s.notebookInfo||(s.notebookInfo={}),s.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview),i.notebookSearchConfig?.includeCodeInput&&(s.notebookInfo||(s.notebookInfo={}),s.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput),i.notebookSearchConfig?.includeOutput&&(s.notebookInfo||(s.notebookInfo={}),s.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput),s}file(t,i={}){return{...this.j(t,i),type:1,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}i(t,i){if(!t)return{};if(Array.isArray(t)){if(t=t.filter(r=>r.length>0).map(Em),!t.length)return{}}else t=Em(t);return i?this.parseSearchPaths(t):{pattern:MA(...Array.isArray(t)?t:[t])}}j(t=[],i={}){let r=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;r=r?.length===1?r[0]:r;const s=this.i(i.includePattern,i.expandPatterns),n=this.i(r,i.expandPatterns),o=t.length>1,a=(s.searchPaths&&s.searchPaths.length?s.searchPaths.map(u=>this.t(u,i,n)):t.map(u=>this.u(u,i,n,o))).filter(u=>!!u),c={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(s.searchPaths&&s.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:n.pattern,includePattern:s.pattern,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=gt(this.c.groups.flatMap(p=>p.editors.map(g=>g.resource)));this.d.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const h=u.filter(p=>Z7(c,p.fsPath)),f=this.k(h);return this.d.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(f)),{...c,...f}}const l=i.extraFileResources&&i.extraFileResources.filter(u=>Z7(c,u.fsPath));return c.extraFileResources=l&&l.length?l:void 0,c}k(t){const i=[],r=new zt,s={};let n=!1;return t.forEach(o=>{if(o.scheme===q.walkThrough)return;if(H2(o)){const c=this.b.getWorkspaceFolder(o)?.uri??this.g.extUri.dirname(o);let l=r.get(c);l||(n=!0,l={folder:c,includePattern:{}},i.push(l),r.set(c,l));const u=tc(c.fsPath,o.fsPath);Xa(l.includePattern)[gD(u.replace(/\\/g,"/"))]=!0}else o.fsPath&&(n=!0,s[gD(o.fsPath)]=!0)}),{folderQueries:i,includePattern:s,usingSearchPaths:!0,excludePattern:n?void 0:{"**/*":!0}}}l(t,i){if(i.isSmartCase){if(t.isRegExp){if(FE(t.pattern,!0))return!0}else if(FE(t.pattern))return!0}return!!t.isCaseSensitive}m(t){return t.isMultiline||t.isRegExp&&aD(t.pattern)||t.pattern.indexOf(`
`)>=0?!0:!!t.isMultiline}parseSearchPaths(t){const i=h=>xr(h)||/^\.\.?([\/\\]|$)/.test(h),s=(Array.isArray(t)?t:tV(t)).map(h=>{const f=this.f.resolvedUserHome;return f?Am(h,f.scheme===q.file?f.fsPath:f.path):h}),n=lv(s,h=>i(h)?"searchPaths":"exprSegments"),o=(n.exprSegments||[]).map(h=>Ln(h,"/")).map(h=>Ln(h,"\\")).map(h=>(h[0]==="."&&(h="*"+h),iV(h))),a={},c=this.o(n.searchPaths||[]);c&&c.length&&(a.searchPaths=c);const l=o.flat(),u=MA(...l);return u&&(a.pattern=u),a}n(t,i){return i.disregardExcludeSettings?void 0:cB(t,!i.disregardSearchExcludeSettings)}o(t){if(!t||!t.length)return[];const i=t.flatMap(s=>{let{pathPortion:n,globPortion:o}=eV(s);return o&&(o=NA(o)),this.q(n).flatMap(c=>this.r(c,o))}),r=new Map;return i.forEach(s=>{const n=s.searchPath.toString(),o=r.get(n);o?s.pattern&&(o.pattern=o.pattern||{},o.pattern[s.pattern]=!0):r.set(n,{searchPath:s.searchPath,pattern:s.pattern?MA(s.pattern):void 0})}),Array.from(r.values())}q(t){if(xr(t)){const i=this.b.getWorkspace().folders;return i[0]&&i[0].uri.scheme!==q.file?[{searchPath:i[0].uri.with({path:t})}]:[{searchPath:y.file(Zs(t))}]}if(this.b.getWorkbenchState()===2){const i=this.b.getWorkspace().folders[0].uri;if(t=Em(t),t.startsWith("../")||t===".."){const s=Be.resolve(i.path,t);return[{searchPath:i.with({path:s})}]}const r=NA(t);return[{searchPath:i,pattern:r}]}else{if(t==="./"||t===".\\")return[];{const i=t.replace(/^\.[\/\\]/,""),s=this.b.getWorkspace().folders.map(n=>{const o=i.match(new RegExp(`^${Rn(n.name)}(?:/(.*)|$)`));return o?{match:o,folder:n}:null}).filter(hr);if(s.length)return s.map(n=>{const o=n.match[1];return{searchPath:n.folder.uri,pattern:o&&NA(o)}});{const n=t.match(/\.[\/\\](.+)[\/\\]?/),o=n?n[1]:t,a=d(15797,null,o);throw new Error(a)}}}}r(t,i){const r=t.pattern&&i?`${t.pattern}/${i}`:t.pattern||i,s=[{searchPath:t.searchPath,pattern:r}];return r&&!r.endsWith("**")&&s.push({searchPath:t.searchPath,pattern:r+"/**"}),s}t(t,i,r){const s=this.u(D0(t.searchPath),i,r,!1);return s?{...s,includePattern:t.pattern}:null}u(t,i,r,s){let n;const o=y.isUri(t)?t:t.uri;let a=i.excludePattern?.map(p=>{const g=i.excludePattern&&K_(p)?p.uri:void 0;return!g||!(y.isUri(t)&&this.g.extUri.isEqual(t,g))?g:void 0});if(a?.length||(a=[void 0]),r.searchPaths){const p=r.searchPaths.filter(g=>nc(g.searchPath,o))[0];if(p&&!p.pattern)return null;p&&(n=p.pattern)}const c=this.a.getValue({resource:o}),u={...this.n(c,i)||{},...n||{}},h=y.isUri(t)?dr(t):t.name,f=a.map(p=>Object.keys(u).length>0?{folder:p,pattern:u}:void 0).filter(p=>p);return{folder:o,folderName:s?h:void 0,excludePattern:f,fileEncoding:c.files&&c.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles=="boolean"?i.disregardIgnoreFiles:!c.search.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles=="boolean"?i.disregardGlobalIgnoreFiles:!c.search.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles=="boolean"?i.disregardParentIgnoreFiles:!c.search.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks=="boolean"?i.ignoreSymlinks:!c.search.followSymlinks}}};pD=__decorate([__param(0,yi),__param(1,xf),__param(2,JH),__param(3,Se),__param(4,X_),__param(5,uD)],pD);function eV(e){const t=e.match(/[\*\{\}\(\)\[\]\?]/);if(t){const i=t.index,r=e.substr(0,i).match(/[/|\\][^/\\]*$/);if(r){let s=e.substr(0,r.index);return s.match(/[/\\]/)||(s+="/"),{pathPortion:s,globPortion:e.substr((r.index||0)+1)}}}return{pathPortion:e}}function MA(...e){return e.length?e.reduce((t,i)=>(t[i]=!0,t),Object.create(null)):void 0}function tV(e){return Nu(e,",").map(t=>t.trim()).filter(t=>!!t.length)}function iV(e){return[`**/${e}/**`,`**/${e}`].map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function Em(e){return e.replace(/\\/g,"/")}function NA(e){return Em(e).replace(/^\.\//,"").replace(/\/+$/g,"")}function gD(e){return e.replace(/([?*[\]])/g,"[$1]")}var rV=7e3;function sV(e,t){const i=t.activationEvents;if(!i)return Promise.resolve(void 0);const r=[],s=[];for(const u of i)if(/^workspaceContains:/.test(u)){const h=u.substr(18);h.indexOf("*")>=0||h.indexOf("?")>=0||e.forceUsingSearch?s.push(h):r.push(h)}if(r.length===0&&s.length===0)return Promise.resolve(void 0);const{promise:n,resolve:o}=nx(),a=u=>o({activationEvent:u}),c=Promise.all(r.map(u=>nV(e,u,a))).then(()=>{}),l=oV(e,t.identifier,s,a);return Promise.all([c,l]).then(()=>{o(void 0)}),n}async function nV(e,t,i){for(const r of e.folders)if(await e.exists(It(y.revive(r),t))){i(`workspaceContains:${t}`);return}}async function oV(e,t,i,r){if(i.length===0)return Promise.resolve(void 0);const s=new Qe,n=e.checkExists(e.folders,i,s.token),o=setTimeout(async()=>{s.cancel(),e.logService.info(`Not activating extension '${t.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},rV);let a=!1;try{a=await n}catch(c){Ti(c)||lt(c)}s.dispose(),clearTimeout(o),a&&r(`workspaceContains:${i.join(",")}`)}var mD=class{constructor(e){this.b=new I,this.onDidChangePassword=this.b.event,this.a=e.getProxy(X.MainThreadSecretState)}async $onDidChangePassword(e){this.b.fire(e)}get(e,t){return this.a.$getPassword(e,t)}store(e,t,i){return this.a.$setPassword(e,t,i)}delete(e,t){return this.a.$deletePassword(e,t)}keys(e){return this.a.$getKeys(e)}},RA=H("IExtHostSecretState"),aV=class{#e;constructor(e,t){this.disposables=new ie,this.a=Ye.toKey(e.identifier),this.#e=t,this.onDidChange=Ie.map(Ie.filter(this.#e.onDidChangePassword,i=>i.extensionId===this.a),i=>({key:i.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this.a,e)}store(e,t){return this.#e.store(this.a,e,t)}delete(e){return this.#e.delete(this.a,e)}keys(){return this.#e.keys(this.a)||[]}},LA=class{constructor(t,i,r){this.f=r,this.d=new Map,this.a=i.getProxy(X.MainThreadLocalization),this.b=t.environment.appLanguage,this.c=this.b===Pn}getMessage(t,i){const{message:r,args:s,comment:n}=i;if(this.c)return $E(r,s??{});let o=r;n&&n.length>0&&(o+=`/${Array.isArray(n)?n.join(""):n}`);const a=this.d.get(t)?.contents[o];return a||this.f.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`),$E(a??r,s??{})}getBundle(t){return this.d.get(t)?.contents}getBundleUri(t){return this.d.get(t)?.uri}async initializeLocalizedMessages(t){if(this.c||!t.l10n&&!t.isBuiltin||this.d.has(t.identifier.value))return;let i;const r=await this.g(t);if(!r){this.f.error(`No bundle location found for extension ${t.identifier.value}`);return}try{const s=await this.a.$fetchBundleContents(r),n=JSON.parse(s);i=t.isBuiltin?n.contents?.bundle:n}catch(s){this.f.error(`Failed to load translations for ${t.identifier.value} from ${r}: ${s.message}`);return}i&&this.d.set(t.identifier.value,{contents:i,uri:r})}async g(t){if(t.isBuiltin){const i=await this.a.$fetchBuiltInBundleUri(t.identifier.value,this.b);return y.revive(i)}return t.l10n?y.joinPath(t.extensionLocation,t.l10n,`bundle.l10n.${this.b}.json`):void 0}};LA=__decorate([__param(0,Ft),__param(1,Ce),__param(2,Se)],LA);var OA=H("IExtHostLocalizationService"),FA=H("IExtHostManagedSockets"),UA=class{constructor(t){this.b=0,this.c=null,this.d=new Map,this.a=t.getProxy(X.MainThreadManagedSockets)}setFactory(t,i){for(const r of this.d.values())r.dispose();this.c&&this.a.$unregisterSocketFactory(this.c.socketFactoryId),this.c=new cV(t,i),this.a.$registerSocketFactory(this.c.socketFactoryId)}async $openRemoteSocket(t){if(!this.c||this.c.socketFactoryId!==t)throw new Error(`No socket factory with id ${t}`);const i=++this.b,r=await this.c.makeConnection(),s=new ie;return this.d.set(i,new lV(i,r,s)),s.add(te(()=>this.d.delete(i))),s.add(r.onDidEnd(()=>{this.a.$onDidManagedSocketEnd(i),s.dispose()})),s.add(r.onDidClose(n=>{this.a.$onDidManagedSocketClose(i,n?.stack??n?.message),s.dispose()})),s.add(r.onDidReceiveMessage(n=>this.a.$onDidManagedSocketHaveData(i,W.wrap(n)))),i}$remoteSocketWrite(t,i){this.d.get(t)?.actual.send(i.buffer)}$remoteSocketEnd(t){const i=this.d.get(t);i&&(i.actual.end(),i.dispose())}async $remoteSocketDrain(t){await this.d.get(t)?.actual.drain?.()}};UA=__decorate([__param(0,Ce)],UA);var cV=class{constructor(e,t){this.socketFactoryId=e,this.makeConnection=t}},lV=class extends Q{constructor(e,t,i){super(),this.socketId=e,this.actual=t,this.D(i)}},jA,vD=H("IHostUtils"),zA=jA=class extends Q{constructor(t,i,r,s,n,o,a,c,l,u,h,f,p){super(),this.Y=f,this.Z=p,this.a=this.D(new I),this.onDidChangeRemoteConnectionData=this.a.event,this.R=new Map,this.W=!1,this.c=i,this.g=r,this.f=a,this.j=s,this.m=n,this.q=o,this.s=l,this.t=u,this.u=h,this.w=this.g.getProxy(X.MainThreadWorkspace),this.y=this.g.getProxy(X.MainThreadTelemetry),this.z=this.g.getProxy(X.MainThreadExtensionService),this.C=new fr,this.F=new fr,this.G=new fr,this.H=new fr,this.I=new hV(this.f.extensions.activationEvents),this.L=new Fh(this.I,this.f.extensions.allExtensions);const g=new Go(this.f.extensions.myExtensions);this.J=new Fh(this.I,yD(this.L,g)),Ro&&(this.q.info(`Creating extension host with the following global extensions: ${Sl(this.L)}`),this.q.info(`Creating extension host with the following local extensions: ${Sl(this.J)}`)),this.M=new m9(this.g,this.q),this.N=new mD(this.g),this.O=c,this.h=this.B.add(t.createChild(new C0([eA,this.M],[RA,this.N]))),this.P=this.D(new Xy(this.J,this.L,{onExtensionActivationError:(v,b,S)=>{this.z.$onExtensionActivationError(v,Qa(b),S)},actualActivateExtension:async(v,b)=>{if(Fh.isHostExtension(v,this.J,this.L))return await this.z.$activateExtension(v,b),new QB;const S=this.J.getExtensionDescription(v);return this.fb(S,b)}},this.q)),this.Q=null,this.S=Object.create(null),this.U=!1,this.X=this.f.remote.connectionData}getRemoteConnectionData(){return this.X}async initialize(){try{await this.wb(),this.C.open(),await this.j.waitForInitializeCall(),Ot("code/extHost/ready"),this.F.open(),this.f.autoStart&&this.tb()}catch(t){lt(t)}}async $(){this.O.onWillDeactivateAll();let t=[];try{t=this.J.getAllExtensionDescriptions().map(n=>n.identifier).filter(n=>this.isActivated(n)).map(n=>this.eb(n))}catch{}await Promise.all(t)}terminate(t,i=0){if(this.W)return;this.W=!0,this.q.info(`Extension host terminating: ${t}`),this.q.flush(),this.t.dispose(),this.P.dispose(),uv(s=>{this.q.error(s)}),this.g.dispose();const r=this.$();Promise.race([ri(5e3),r]).finally(()=>{this.c.pid?this.q.info(`Extension host with pid ${this.c.pid} exiting with code ${i}`):this.q.info(`Extension host exiting with code ${i}`),this.q.flush(),this.q.dispose(),this.c.exit(i)})}isActivated(t){return this.G.isOpen()?this.P.isActivated(t):!1}async getExtension(t){const i=await this.z.$getExtension(t);return i&&{...i,identifier:new Ye(i.identifier.value),extensionLocation:y.revive(i.extensionLocation)}}ab(t,i){return this.P.activateByEvent(t,i)}bb(t,i){return this.P.activateById(t,i)}activateByIdWithErrors(t,i){return this.bb(t,i).then(()=>{const r=this.P.getActivatedExtension(t);if(r.activationFailed)return Promise.reject(r.activationFailedError)})}getExtensionRegistry(){return this.G.wait().then(t=>this.J)}getExtensionExports(t){if(this.G.isOpen())return this.P.getActivatedExtension(t).exports;try{return this.P.getActivatedExtension(t).exports}catch{return null}}async cb(t){if(t.scheme===q.file&&this.c.fsRealpath){const i=t.fsPath;this.R.has(i)||this.R.set(i,this.c.fsRealpath(i));const r=await this.R.get(i);return y.file(r)}return t}async getExtensionPathIndex(){return this.Q||(this.Q=this.db(this.J.getAllExtensionDescriptions()).then(t=>new uV(t))),this.Q}async db(t){const i=Vn.forUris(r=>jv.ignorePathCasing(r));return await Promise.all(t.map(async r=>{if(this.xb(r)){const s=await this.cb(r.extensionLocation);i.set(s,r)}})),i}eb(t){let i=Promise.resolve(void 0);if(!this.G.isOpen()||!this.P.isActivated(t))return i;const r=this.P.getActivatedExtension(t);if(!r)return i;try{typeof r.module.deactivate=="function"&&(i=Promise.resolve(r.module.deactivate()).then(void 0,s=>(this.q.error(s),Promise.resolve(void 0))))}catch(s){this.q.error(`An error occurred when deactivating the extension '${t.value}':`),this.q.error(s)}try{r.disposable.dispose()}catch(s){this.q.error(`An error occurred when disposing the subscriptions for extension '${t.value}':`),this.q.error(s)}return i}async fb(t,i){return this.f.remote.isRemote?this.z.$onWillActivateExtension(t.identifier):await this.z.$onWillActivateExtension(t.identifier),this.hb(t,i).then(r=>{const s=r.activationTimes;return this.z.$onDidActivateExtension(t.identifier,s.codeLoadingTime,s.activateCallTime,s.activateResolvedTime,i),this.gb(t,i,"success",s),r},r=>{throw this.gb(t,i,"failure"),r})}gb(t,i,r,s){const n=bD(t,i);this.y.$publicLog2("extensionActivationTimes",{...n,...s||{},outcome:r})}hb(t,i){const r=bD(t,i);this.y.$publicLog2("activatePlugin",r);const s=this.xb(t);if(!s)return Promise.resolve(new JB(cm.NONE));this.q.info(`ExtensionService#_doActivateExtension ${t.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${t.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:""}`),this.q.flush();const n=this.vb(t),o=new ie,a=new Yy(i.startup);return Promise.all([n?this.zb(t,It(t.extensionLocation,s),a):this.yb(t,It(t.extensionLocation,s),a),this.ib(t,o)]).then(c=>(Ot(`code/extHost/willActivateExtension/${t.identifier.value}`),jA.jb(this.q,t.identifier,c[0],c[1],o,a))).then(c=>(Ot(`code/extHost/didActivateExtension/${t.identifier.value}`),c))}ib(t,i){const r=this.Z.createLanguageModelAccessInformation(t),s=i.add(new YB(t,this.M)),n=i.add(new v9(t.identifier.value,!1,this.M)),o=i.add(new aV(t,this.N)),a=t.isUnderDevelopment?this.f.environment.extensionTestsLocationURI?Qc.Test:Qc.Development:Qc.Production,c=this.f.remote.isRemote?ba.Workspace:ba.UI;return this.q.trace(`ExtensionService#loadExtensionContext ${t.identifier.value}`),Promise.all([s.whenReady,n.whenReady,this.O.whenReady]).then(()=>{const l=this;let u,h;const f=et(t,"ipc")?this.f.messagePorts?.get(Ye.toKey(t.identifier)):void 0;return Object.freeze({globalState:s,workspaceState:n,secrets:o,subscriptions:[],get languageModelAccessInformation(){return r},get extensionUri(){return t.extensionLocation},get extensionPath(){return t.extensionLocation.fsPath},asAbsolutePath(p){return _e(t.extensionLocation.fsPath,p)},get storagePath(){return l.O.workspaceValue(t)?.fsPath},get globalStoragePath(){return l.O.globalValue(t).fsPath},get logPath(){return _e(l.f.logsLocation.fsPath,t.identifier.value)},get logUri(){return y.joinPath(l.f.logsLocation,t.identifier.value)},get storageUri(){return l.O.workspaceValue(t)},get globalStorageUri(){return l.O.globalValue(t)},get extensionMode(){return a},get extension(){return u===void 0&&(u=new Vh(l,t.identifier,t,c,!1)),u},get extensionRuntime(){return T(t,"extensionRuntime"),l.extensionRuntime},get environmentVariableCollection(){return l.t.getEnvironmentVariableCollection(t)},get messagePassingProtocol(){if(!h){if(!f)return;const p=Ie.buffer(Ie.fromDOMEventEmitter(f,"message",g=>g.data));f.start(),h={onDidReceiveMessage:p,postMessage:f.postMessage.bind(f)}}return h}})})}static jb(t,i,r,s,n,o){return r=r||{activate:void 0,deactivate:void 0},this.kb(t,i,r,s,o).then(a=>new lm(!1,null,o.build(),r,a,te(()=>{n.dispose(),Zi(s.subscriptions)})))}static kb(t,i,r,s,n){if(typeof r.activate=="function")try{n.activateCallStart(),t.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=r.activate.apply(globalThis,[s]);return n.activateCallStop(),n.activateResolveStart(),Promise.resolve(o).then(a=>(n.activateResolveStop(),a))}catch(o){return Promise.reject(o)}else return Promise.resolve(r)}lb(t,i){this.bb(t.identifier,{startup:!1,extensionId:t.identifier,activationEvent:i}).then(void 0,r=>{this.q.error(r)})}mb(t,i=0){const s=Date.now();wE(()=>{for(let n=i;n<t.length;n+=1){const o=t[n];for(const a of o.activationEvents??[])if(a==="onStartupFinished")if(Date.now()-s>50){this.mb(t,n);break}else this.lb(o,a)}})}nb(){this.z.$setPerformanceMarks(SO()),this.m.getConfigProvider().then(t=>{const i=t.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation"),r=this.J.getAllExtensionDescriptions();if(i)this.mb(r);else for(const s of r)if(s.activationEvents)for(const n of s.activationEvents)n==="onStartupFinished"&&this.lb(s,n)})}ob(){const t=this.ab("*",!0).then(void 0,o=>{this.q.error(o)});this.D(this.j.onDidChangeWorkspace(o=>this.pb(o.added)));const i=this.j.workspace?this.j.workspace.folders:[],r=this.pb(i),s=this.rb(),n=Promise.all([s,t,r]).then(()=>{});return Promise.race([n,ri(1e4)]).then(()=>{this.nb()}),n}pb(t){return t.length===0?Promise.resolve(void 0):Promise.all(this.J.getAllExtensionDescriptions().map(i=>this.qb(t,i))).then(()=>{})}async qb(t,i){if(this.isActivated(i.identifier))return;const r=!this.f.remote.isRemote&&!!this.f.remote.authority,s={logService:this.q,folders:t.map(o=>o.uri),forceUsingSearch:r||!this.c.fsExists,exists:o=>this.c.fsExists(o.fsPath),checkExists:(o,a,c)=>this.w.$checkExists(o,a,c)},n=await sV(s,i);if(n)return this.bb(i.identifier,{startup:!0,extensionId:i.identifier,activationEvent:n.activationEvent}).then(void 0,o=>this.q.error(o))}async rb(){if(this.f.remote.authority)return this.ab(`onResolveRemoteAuthority:${this.f.remote.authority}`,!1)}async $extensionTestsExecute(){await this.H.wait();try{return await this.sb()}catch(t){throw console.error(t),t}}async sb(){const{extensionDevelopmentLocationURI:t,extensionTestsLocationURI:i}=this.f.environment;if(!t||!i)throw new Error(d(3018,null));const r=(await this.getExtensionPathIndex()).findSubstr(i),n=await(this.vb(r,i.path)?this.zb(null,i,new Yy(!1)):this.yb(null,i,new Yy(!1)));if(!n||typeof n.run!="function")throw new Error(d(3019,null,i.toString()));return new Promise((o,a)=>{const c=(h,f)=>{h?(Ro&&this.q.error("Test runner called back with error",h),a(h)):(Ro&&(f?this.q.info(`Test runner called back with ${f} failures.`):this.q.info("Test runner called back with successful outcome.")),o(typeof f=="number"&&f>0?1:0))},l=Vr(i),u=n.run(l,c);u&&u.then&&u.then(()=>{Ro&&this.q.info("Test runner finished successfully."),o(0)}).catch(h=>{Ro&&this.q.error("Test runner finished with error",h),a(h instanceof Error&&h.stack?h.stack:String(h))})})}tb(){if(this.U)throw new Error("Extension host is already started!");return this.U=!0,this.F.wait().then(()=>this.G.open()).then(()=>Promise.race([this.P.waitForActivatingExtensions(),ri(1e3)])).then(()=>this.ob()).then(()=>{this.H.open(),this.q.info("Eager extensions activated")})}registerRemoteAuthorityResolver(t,i){return this.S[t]=i,te(()=>{delete this.S[t]})}async getRemoteExecServer(t){const{resolver:i}=await this.ub(t);return i?.resolveExecServer?.(t,{resolveAttempt:0})}async ub(t){const i=t.indexOf("+");if(i===-1)throw new $c("Not an authority that can be resolved!",Ui.InvalidAuthority);const r=t.substr(0,i);return await this.C.wait(),await this.ab(`onResolveRemoteAuthority:${r}`,!1),{authorityPrefix:r,resolver:this.S[r]}}async $resolveAuthority(t,i){const r=Ji.create(!1),s=()=>`[resolveAuthority(${Q6(t)},${i})][${r.elapsed()}ms] `,n=E=>this.q.info(`${s()}${E}`),o=E=>this.q.warn(`${s()}${E}`),a=(E,$=void 0)=>this.q.error(`${s()}${E}`,$),c=E=>{if(E instanceof $c)return{type:"error",error:{code:E._code,message:E._message,detail:E._detail}};throw E},l=async E=>{n(`activating resolver for ${E}...`);const{resolver:$,authorityPrefix:U}=await this.ub(E);if(!$)throw a(`no resolver for ${U}`),new $c(`No remote extension installed to resolve ${U}.`,Ui.NoResolverFound);return{resolver:$,authorityPrefix:U,remoteAuthority:E}},u=t.split(/@|%40/g).reverse();n(`activating remote resolvers ${u.join(" -> ")}`);let h;try{h=await Promise.all(u.map(l)).catch(async E=>{if(!(E instanceof $c)||E._code!==Ui.InvalidAuthority)throw E;return o(`resolving nested authorities failed: ${E.message}`),[await l(t)]})}catch(E){return c(E)}const f=new ux;f.cancelAndSet(()=>n("waiting..."),1e3);let p,g;for(const[E,{authorityPrefix:$,resolver:U,remoteAuthority:O}]of h.entries())try{if(E===h.length-1)n("invoking final resolve()..."),Ot(`code/extHost/willResolveAuthority/${$}`),p=await U.resolve(O,{resolveAttempt:i,execServer:g}),Ot(`code/extHost/didResolveAuthorityOK/${$}`),n("setting tunnel factory..."),this.D(await this.s.setTunnelFactory(U,yp.isManagedResolvedAuthority(p)?p:void 0));else{if(n(`invoking resolveExecServer() for ${O}`),Ot(`code/extHost/willResolveExecServer/${$}`),g=await U.resolveExecServer?.(O,{resolveAttempt:i,execServer:g}),!g)throw new $c(`Exec server was not available for ${O}`,Ui.NoResolverFound);Ot(`code/extHost/didResolveExecServerOK/${$}`)}}catch(J){return Ot(`code/extHost/didResolveAuthorityError/${$}`),a("returned an error",J),f.dispose(),c(J)}f.dispose();const v={environmentTunnels:p.environmentTunnels,features:p.tunnelFeatures?{elevation:p.tunnelFeatures.elevation,privacyOptions:p.tunnelFeatures.privacyOptions,protocol:p.tunnelFeatures.protocol===void 0?!0:p.tunnelFeatures.protocol}:void 0},b={extensionHostEnv:p.extensionHostEnv,isTrusted:p.isTrusted,authenticationSession:p.authenticationSessionForInitializingExtensions?{id:p.authenticationSessionForInitializingExtensions.id,providerId:p.authenticationSessionForInitializingExtensions.providerId}:void 0};n(`returned ${yp.isManagedResolvedAuthority(p)?"managed authority":`${p.host}:${p.port}`}`);let S;if(yp.isManagedResolvedAuthority(p)){const E=i;this.Y.setFactory(E,p.makeConnection),S={authority:t,connectTo:new J6(E),connectionToken:p.connectionToken}}else S={authority:t,connectTo:new DW(p.host,p.port),connectionToken:p.connectionToken};return{type:"ok",value:{authority:S,options:b,tunnelInformation:v}}}async $getCanonicalURI(t,i){this.q.info(`$getCanonicalURI invoked for authority (${Q6(t)})`);const{resolver:r}=await this.ub(t);if(!r)return null;const s=y.revive(i);if(typeof r.getCanonicalURI>"u")return s;const n=await di(()=>r.getCanonicalURI(s));return n||s}async $startExtensionHost(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:r}=wD(this.I,this.L,this.J,t),s=await this.db(r);return(await this.getExtensionPathIndex()).setSearchTree(s),this.L.set(i.getAllExtensionDescriptions()),this.J.set(r),Ro&&(this.q.info(`$startExtensionHost: global extensions: ${Sl(this.L)}`),this.q.info(`$startExtensionHost: local extensions: ${Sl(this.J)}`)),this.tb()}$activateByEvent(t,i){return i===1?this.C.wait().then(r=>this.ab(t,!1)):this.G.wait().then(r=>this.ab(t,!1))}async $activate(t,i){return await this.G.wait(),this.J.getExtensionDescription(t)?(await this.bb(t,i),!0):!1}async $deltaExtensions(t){t.toAdd.forEach(o=>o.extensionLocation=y.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:r}=wD(this.I,this.L,this.J,t),s=await this.db(r);return(await this.getExtensionPathIndex()).setSearchTree(s),this.L.set(i.getAllExtensionDescriptions()),this.J.set(r),Ro&&(this.q.info(`$deltaExtensions: global extensions: ${Sl(this.L)}`),this.q.info(`$deltaExtensions: local extensions: ${Sl(this.J)}`)),Promise.resolve(void 0)}async $test_latency(t){return t}async $test_up(t){return t.byteLength}async $test_down(t){const i=W.alloc(t),r=Math.random()%256;for(let s=0;s<t;s++)i.writeUInt8(r,s);return i}async $updateRemoteConnectionData(t){this.X=t,this.a.fire()}vb(t,i){return i??=t?this.xb(t):i,i?.endsWith(".mjs")||t?.type==="module"&&!i?.endsWith(".cjs")}};zA=jA=__decorate([__param(0,dc),__param(1,vD),__param(2,Ce),__param(3,Nr),__param(4,vr),__param(5,Se),__param(6,Ft),__param(7,iA),__param(8,dm),__param(9,dn),__param(10,OA),__param(11,FA),__param(12,xA)],zA);function wD(e,t,i,r){e.addActivationEvents(r.addActivationEvents);const s=new Fh(e,t.getAllExtensionDescriptions());s.deltaExtensions(r.toAdd,r.toRemove);const n=new Go(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of r.myToRemove)n.delete(a);for(const a of r.myToAdd)n.add(a);const o=yD(s,n);return{globalRegistry:s,myExtensions:o}}function bD(e,t){return{id:e.identifier.value,name:e.name,extensionVersion:e.version,publisherDisplayName:e.publisher,activationEvents:e.activationEvents?e.activationEvents.join(","):null,isBuiltin:e.isBuiltin,reason:t.activationEvent,reasonId:t.extensionId.value}}function Sl(e){return e.getAllExtensionDescriptions().map(t=>t.identifier.value).join(",")}var fn=H("IExtHostExtensionService"),Vh=class{#e;#t;#i;constructor(e,t,i,r,s){this.#e=e,this.#t=t,this.#i=i.identifier,this.id=i.identifier.value,this.extensionUri=i.extensionLocation,this.extensionPath=Zs(Vr(i.extensionLocation)),this.packageJSON=i,this.extensionKind=r,this.isFromDifferentExtensionHost=s}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(!(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost))return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost)throw new Error("Cannot activate foreign extension");return await this.#e.activateByIdWithErrors(this.#i,{startup:!1,extensionId:this.#t,activationEvent:"api"}),this.exports}};function yD(e,t){return e.getAllExtensionDescriptions().filter(i=>t.has(i.identifier))}var uV=class{constructor(e){this.a=e}setSearchTree(e){this.a=e}findSubstr(e){return this.a.findSubstr(e)}forEach(e){return this.a.forEach(e)}},hV=class{constructor(e){this.a=new Wn,this.addActivationEvents(e)}readActivationEvents(e){return this.a.get(e.identifier)??[]}addActivationEvents(e){for(const t of Object.keys(e))this.a.set(t,e[t])}},El=H("IExtHostApiDeprecationService"),HA=class{constructor(t,i){this.c=i,this.a=new Set,this.b=t.getProxy(X.MainThreadTelemetry)}report(t,i,r){const s=this.d(t,i);this.a.has(s)||(this.a.add(s),i.isUnderDevelopment&&this.c.warn(`[Deprecation Warning] '${t}' is deprecated. ${r}`),this.b.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:t}))}d(t,i){return`${t}-${i.identifier.value}`}};HA=__decorate([__param(0,Ce),__param(1,Se)],HA);var Xre=Object.freeze(new class{report(e,t,i){}}),AD=class{static async installEarlyHandler(e){Error.stackTraceLimit=100;const t=e.get(Se),r=e.get(Ce).getProxy(X.MainThreadErrors);uv(s=>{t.error(s);const n=Qa(s);r.$onUnexpectedError(n)})}static async installFullHandler(e){const t=e.get(Se),i=e.get(Ce),r=e.get(fn),s=e.get(pm),n=e.get(El),o=i.getProxy(X.MainThreadExtensionService),a=i.getProxy(X.MainThreadErrors),c=await r.getExtensionRegistry(),l=await r.getExtensionPathIndex(),u=new WeakMap;function h(g,v){if(u.has(g))return u.get(g).stack;let b="",S,E;for(const U of v)b+=`
	at ${U.toString()}`,E=U.getFileName(),!S&&E&&(S=l.findSubstr(y.file(E)));const $=`${g.name||"Error"}: ${g.message||""}${b}`;return u.set(g,{extensionIdentifier:S?.identifier,stack:$}),$}const f=Symbol("prepareStackTrace wrapped");let p=h;Object.defineProperty(Error,"prepareStackTrace",{configurable:!1,get(){return p},set(g){if(g===h||!g||g[f]){p=g||h;return}p=function(v,b){return h(v,b),g.call(Error,v,b)},Object.assign(p,{[f]:!0})}}),uv(g=>{hv.is(g)||t.error(g);const v=Qa(g);let b;if(g instanceof _k?b=g.extension:b=u.get(g)?.extensionIdentifier,!!b)if(hv.is(g)){const S=c.getExtensionDescription(b);S&&n.report(g.name,S,`${g.message}
 FROM: ${g.stack}`)}else{o.$onExtensionRuntimeError(b,v);const S=s.onExtensionError(b,g);t.trace("forwarded error to extension?",S,b)}}),Ql.addListener(g=>{a.$onUnexpectedError(g)})}},dV=class yN{constructor(t,i,r,s,n){this.a=r,this.b=new xU(t,null,s),i=yN.e(i,this.b);const o=new C0(...JU());o.set(Ft,{_serviceBrand:void 0,...i,messagePorts:n}),o.set(Ce,new KU(this.b)),o.set(wu,new ej(s)),o.set(vD,r);const a=new XU(o,!0);a.invokeFunction(AD.installEarlyHandler),this.d=a.invokeFunction(c=>c.get(Se)),Ot("code/extHost/didCreateServices"),this.a.pid?this.d.info(`Extension host with pid ${this.a.pid} started`):this.d.info("Extension host started"),this.d.trace("initData",i),this.c=a.invokeFunction(c=>c.get(fn)),this.c.initialize(),a.invokeFunction(AD.installFullHandler)}async asBrowserUri(t){const i=this.b.getProxy(X.MainThreadExtensionService);return y.revive(await i.$asBrowserUri(t))}terminate(t){this.c.terminate(t)}static e(t,i){t.extensions.allExtensions.forEach(s=>{s.extensionLocation=y.revive(i.transformIncomingURIs(s.extensionLocation))}),t.environment.appRoot=y.revive(i.transformIncomingURIs(t.environment.appRoot));const r=t.environment.extensionDevelopmentLocationURI;return r&&(t.environment.extensionDevelopmentLocationURI=r.map(s=>y.revive(i.transformIncomingURIs(s)))),t.environment.extensionTestsLocationURI=y.revive(i.transformIncomingURIs(t.environment.extensionTestsLocationURI)),t.environment.globalStorageHome=y.revive(i.transformIncomingURIs(t.environment.globalStorageHome)),t.environment.workspaceStorageHome=y.revive(i.transformIncomingURIs(t.environment.workspaceStorageHome)),t.nlsBaseUrl=y.revive(i.transformIncomingURIs(t.nlsBaseUrl)),t.logsLocation=y.revive(i.transformIncomingURIs(t.logsLocation)),t.workspace=i.transformIncomingURIs(t.workspace),t}};function fV(e){return{transformIncoming:t=>t.scheme==="vscode-remote"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="file"?{scheme:"vscode-local",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoing:t=>t.scheme==="file"?{scheme:"vscode-remote",authority:e,path:t.path,query:t.query,fragment:t.fragment}:t.scheme==="vscode-local"?{scheme:"file",path:t.path,query:t.query,fragment:t.fragment}:t,transformOutgoingScheme:t=>t==="file"?"vscode-remote":t==="vscode-local"?"file":t}}function pV(e){return new vU(fV(e))}var SD;(function(e){e[e.IPC=1]="IPC",e[e.Socket=2]="Socket",e[e.MessagePort=3]="MessagePort"})(SD||(SD={}));var xm=class AN{static{this.ENV_KEY="VSCODE_EXTHOST_IPC_HOOK"}constructor(t){this.pipeName=t,this.type=1}serialize(t){t[AN.ENV_KEY]=this.pipeName}},WA=class SN{constructor(){this.type=2}static{this.ENV_KEY="VSCODE_EXTHOST_WILL_SEND_SOCKET"}serialize(t){t[SN.ENV_KEY]="1"}},BA=class EN{constructor(){this.type=3}static{this.ENV_KEY="VSCODE_WILL_SEND_MESSAGE_PORT"}serialize(t){t[EN.ENV_KEY]="1"}};function gV(e){delete e[xm.ENV_KEY],delete e[WA.ENV_KEY],delete e[BA.ENV_KEY]}function mV(e){if(e[xm.ENV_KEY])return _A(e,new xm(e[xm.ENV_KEY]));if(e[WA.ENV_KEY])return _A(e,new WA);if(e[BA.ENV_KEY])return _A(e,new BA);throw new Error("No connection information defined in environment!")}function _A(e,t){return gV(e),t}var Kre=new k("inOutput",!1),ese=new k("activeLogOutput",!1),tse=new k("activeLogOutput.isLog",!1),ise=new k("activeLogOutput.levelSettable",!1),rse=new k("activeLogOutput.level",""),sse=new k("activeLogOutput.levelIsDefault",!1),nse=new k("outputView.scrollLock",!1),ose=new k("activeOutputChannel",""),ase=new k("output.filter.trace",!0),cse=new k("output.filter.debug",!0),lse=new k("output.filter.info",!0),use=new k("output.filter.warning",!0),hse=new k("output.filter.error",!0),dse=new k("outputFilterFocus",!1),fse=new k("output.filter.categories",""),pse=H("outputService"),qh;(function(e){e[e.Append=1]="Append",e[e.Replace=2]="Replace",e[e.Clear=3]="Clear"})(qh||(qh={}));var vV={OutputChannels:"workbench.contributions.outputChannels"};function wV(e){return Array.isArray(e.source)}var bV=class extends Q{constructor(){super(...arguments),this.a=new Map,this.b=this.D(new I),this.onDidRegisterChannel=this.b.event,this.c=this.D(new I),this.onDidRemoveChannel=this.c.event,this.f=this.D(new I),this.onDidUpdateChannelSources=this.f.event}registerChannel(e){this.a.has(e.id)||(this.a.set(e.id,e),this.b.fire(e.id))}getChannels(){const e=[];return this.a.forEach(t=>e.push(t)),e}getChannel(e){return this.a.get(e)}updateChannelSources(e,t){const i=this.a.get(e);i&&wV(i)&&(i.source=t,this.f.fire(i))}removeChannel(e){const t=this.a.get(e);t&&(this.a.delete(e),this.c.fire(t))}};Zt.add(vV.OutputChannels,new bV);var ED=class extends k0{constructor(e,t,i,r,s){super(),this.id=e,this.name=t,this.q=i,this.r=r,this.extension=s,this.n=0,this.visible=!1,this.setLevel(i.getLevel()),this.D(i.onDidChangeLogLevel(n=>this.setLevel(n))),this.D(te(()=>this.r.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+`
`)}append(e){this.info(e)}clear(){const e=this.n;this.q.flush(),this.r.$update(this.id,qh.Clear,e)}replace(e){const t=this.n;this.info(e),this.r.$update(this.id,qh.Replace,t),this.visible&&this.q.flush()}show(e,t){this.q.flush(),this.r.$reveal(this.id,!!(typeof e=="boolean"?e:t))}hide(){this.r.$close(this.id)}m(e,t){this.n+=W.fromString(t).byteLength,_U(this.q,e,t),this.visible&&(this.q.flush(),this.r.$update(this.id,qh.Append))}},yV=class extends ED{appendLine(e){this.append(e)}},VA=class{constructor(t,i,r,s,n,o){this.i=i,this.j=r,this.k=s,this.l=n,this.m=o,this.d=new Map,this.f=1,this.g=new Map,this.h=null,this.a=t.getProxy(X.MainThreadOutputService),this.b=this.k.extUri.joinPath(i.logsLocation,`output_logging_${H_(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(t){this.h=t;for(const[i,r]of this.g)r.visible=i===this.h}createOutputChannel(t,i,r){if(t=t.trim(),!t)throw new Error("illegal argument `name`. must not be falsy");const s=typeof i=="object"&&i.log,n=Oe(i)?i:void 0;if(Oe(n)&&!n.trim())throw new Error("illegal argument `languageId`. must not be empty");let o;const a=this.i.environment.extensionLogLevel?.find(([u])=>Ye.equals(r.identifier,u))?.[1];a&&(o=ZU(a));const c=new ie,l=s?this.o(t,o,r,c):this.n(t,n,r,c);return l.then(u=>{this.g.set(u.id,u),u.visible=u.id===this.h,c.add(te(()=>this.g.delete(u.id)))}),s?this.r(t,o??this.m.getLevel(),l,c):this.q(t,l,c)}async n(t,i,r,s){this.c||(this.c=this.j.value.createDirectory(this.b).then(()=>this.b));const n=await this.c,o=this.k.extUri.joinPath(n,`${this.f++}-${t.replace(/[\\/:\*\?"<>\|]/g,"")}.log`),a=s.add(this.l.createLogger(o,{logLevel:"always",donotRotate:!0,donotUseFormatters:!0,hidden:!0})),c=await this.a.$register(t,o,i,r.identifier.value);return s.add(te(()=>this.l.deregisterLogger(o))),new ED(c,t,a,this.a,r)}async o(t,i,r,s){const n=await this.p(r),o=t.replace(/[\\/:\*\?"<>\|]/g,""),a=this.k.extUri.joinPath(n,`${o}.log`),c=`${r.identifier.value}.${o}`,l=s.add(this.l.createLogger(a,{id:c,name:t,logLevel:i,extensionId:r.identifier.value}));return s.add(te(()=>this.l.deregisterLogger(a))),new yV(c,t,l,this.a,r)}p(t){let i=this.d.get(t.identifier.value);if(!i){const r=this.k.extUri.joinPath(this.i.logsLocation,t.identifier.value);this.d.set(t.identifier.value,i=(async()=>{try{await this.j.value.createDirectory(r)}catch(s){if(Of(s)!==he.FileExists)throw s}return r})())}return i}q(t,i,r){const s=()=>{if(r.isDisposed)throw new Error("Channel has been closed")};return i.then(n=>r.add(n)),{get name(){return t},append(n){s(),i.then(o=>o.append(n))},appendLine(n){s(),i.then(o=>o.appendLine(n))},clear(){s(),i.then(n=>n.clear())},replace(n){s(),i.then(o=>o.replace(n))},show(n,o){s(),i.then(a=>a.show(n,o))},hide(){s(),i.then(n=>n.hide())},dispose(){r.dispose()}}}r(t,i,r,s){const n=()=>{if(s.isDisposed)throw new Error("Channel has been closed")},o=s.add(new I);function a(c){i=c,o.fire(c)}return r.then(c=>{c.logLevel!==i&&a(c.logLevel),s.add(c.onDidChangeLogLevel(l=>a(l)))}),{...this.q(t,r,s),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(c,...l){n(),r.then(u=>u.trace(c,...l))},debug(c,...l){n(),r.then(u=>u.debug(c,...l))},info(c,...l){n(),r.then(u=>u.info(c,...l))},warn(c,...l){n(),r.then(u=>u.warn(c,...l))},error(c,...l){n(),r.then(u=>u.error(c,...l))}}}};VA=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Uh),__param(3,pc),__param(4,_n),__param(5,Se)],VA);var xD=H("IExtHostOutputService"),Gh,qA=class{static{Gh=this}static{this.c=0}static{this.d=250}constructor(t,i){this.h=i,this.f=new Map,this.g=t.getProxy(X.MainThreadDecorations)}registerFileDecorationProvider(t,i){const r=Gh.c++;this.f.set(r,{provider:t,extensionDescription:i}),this.g.$registerDecorationProvider(r,i.identifier.value);const s=t.onDidChangeFileDecorations&&t.onDidChangeFileDecorations(n=>{if(!n){this.g.$onDidChange(r,null);return}const o=Sr(n);if(o.length<=Gh.d){this.g.$onDidChange(r,o);return}this.h.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:JL(u.path,"/")})),c=FR(a,(u,h)=>u.rank-h.rank||jo(u.uri.path,h.uri.path)),l=[];e:for(const u of c){let h;for(const f of u){const p=Mi(f.uri.path);if(h!==p&&(h=p,l.push(f.uri)>=Gh.d))break e}}this.g.$onDidChange(r,l)});return new ke(()=>{s?.dispose(),this.g.$unregisterDecorationProvider(r),this.f.delete(r)})}async $provideDecorations(t,i,r){if(!this.f.has(t))return Object.create(null);const s=Object.create(null),{provider:n,extensionDescription:o}=this.f.get(t);return await Promise.all(i.map(async a=>{try{const{uri:c,id:l}=a,u=await Promise.resolve(n.provideFileDecoration(y.revive(c),r));if(!u)return;try{hb.validate(u),u.badge&&typeof u.badge!="string"&&T(o,"codiconDecoration"),s[l]=[u.propagate,u.tooltip,u.badge,u.color]}catch(h){this.h.warn(`INVALID decoration from extension '${o.identifier.value}': ${h}`)}}catch(c){this.h.error(c)}})),s}};qA=Gh=__decorate([__param(0,Ce),__param(1,Se)],qA);var kD=H("IExtHostDecorations"),AV=class{constructor(e){this.a=e,this.b=new Uint32Array(e.length),this.c=new Int32Array(1),this.c[0]=-1}getCount(){return this.a.length}insertValues(e,t){e=Al(e);const i=this.a,r=this.b,s=t.length;return s===0?!1:(this.a=new Uint32Array(i.length+s),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e),e+s),this.a.set(t,e),e-1<this.c[0]&&(this.c[0]=e-1),this.b=new Uint32Array(this.a.length),this.c[0]>=0&&this.b.set(r.subarray(0,this.c[0]+1)),!0)}setValue(e,t){return e=Al(e),t=Al(t),this.a[e]===t?!1:(this.a[e]=t,e-1<this.c[0]&&(this.c[0]=e-1),!0)}removeValues(e,t){e=Al(e),t=Al(t);const i=this.a,r=this.b;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.a=new Uint32Array(i.length-t),this.a.set(i.subarray(0,e),0),this.a.set(i.subarray(e+t),e),this.b=new Uint32Array(this.a.length),e-1<this.c[0]&&(this.c[0]=e-1),this.c[0]>=0&&this.b.set(r.subarray(0,this.c[0]+1)),!0)}getTotalSum(){return this.a.length===0?0:this.d(this.a.length-1)}getPrefixSum(e){return e<0?0:(e=Al(e),this.d(e))}d(e){if(e<=this.c[0])return this.b[e];let t=this.c[0]+1;t===0&&(this.b[0]=this.a[0],t++),e>=this.a.length&&(e=this.a.length-1);for(let i=t;i<=e;i++)this.b[i]=this.b[i-1]+this.a[i];return this.c[0]=Math.max(this.c[0],e),this.b[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.a.length-1,r=0,s=0,n=0;for(;t<=i;)if(r=t+(i-t)/2|0,s=this.b[r],n=s-this.a[r],e<n)i=r-1;else if(e>=s)t=r+1;else break;return new SV(r,e-n)}},SV=class{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}},EV=class{constructor(e,t,i,r){this.a=e,this.b=t,this.c=i,this.d=r,this.f=null,this.g=null}dispose(){this.b.length=0}get version(){return this.d}getText(){return this.g===null&&(this.g=this.b.join(this.c)),this.g}onEvents(e){e.eol&&e.eol!==this.c&&(this.c=e.eol,this.f=null);const t=e.changes;for(const i of t)this.k(i.range),this.l(new gr(i.range.startLineNumber,i.range.startColumn),i.text);this.d=e.versionId,this.g=null}h(){if(!this.f){const e=this.c.length,t=this.b.length,i=new Uint32Array(t);for(let r=0;r<t;r++)i[r]=this.b[r].length+e;this.f=new AV(i)}}j(e,t){this.b[e]=t,this.f&&this.f.setValue(e,this.b[e].length+this.c.length)}k(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.startLineNumber-1].substring(e.endColumn-1));return}this.j(e.startLineNumber-1,this.b[e.startLineNumber-1].substring(0,e.startColumn-1)+this.b[e.endLineNumber-1].substring(e.endColumn-1)),this.b.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this.f&&this.f.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}l(e,t){if(t.length===0)return;const i=PE(t);if(i.length===1){this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]+this.b[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this.b[e.lineNumber-1].substring(e.column-1),this.j(e.lineNumber-1,this.b[e.lineNumber-1].substring(0,e.column-1)+i[0]);const r=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this.b.splice(e.lineNumber+s-1,0,i[s]),r[s-1]=i[s].length+this.c.length;this.f&&this.f.insertValues(e.lineNumber,r)}},GA=new Map;function xV(e,t){t?GA.set(e,t):GA.delete(e)}function kV(e){return GA.get(e)}var CV=class extends EV{constructor(e,t,i,r,s,n,o,a,c=!0){super(t,i,r,s),this.o=e,this.p=n,this.q=o,this.r=a,this.s=c,this.n=!1}dispose(){ki(!this.n),this.n=!0,this.q=!1}equalLines(e){return Gi(this.b,e)}get document(){if(!this.m){const e=this;this.m={get uri(){return e.a},get fileName(){return e.a.fsPath},get isUntitled(){return e.a.scheme===q.untitled},get languageId(){return e.p},get version(){return e.d},get isClosed(){return e.n},get isDirty(){return e.q},get encoding(){return e.r},save(){return e.t()},getText(t){return t?e.u(t):e.getText()},get eol(){return e.c===`
`?ts.LF:ts.CRLF},get lineCount(){return e.b.length},lineAt(t){return e.v(t)},offsetAt(t){return e.w(t)},positionAt(t){return e.x(t)},validateRange(t){return e.y(t)},validatePosition(t){return e.z(t)},getWordRangeAtPosition(t,i){return e.A(t,i)},[Symbol.for("debug.description")](){return`TextDocument(${e.a.toString()})`}}}return Object.freeze(this.m)}_acceptLanguageId(e){ki(!this.n),this.p=e}_acceptIsDirty(e){ki(!this.n),this.q=e}_acceptEncoding(e){ki(!this.n),this.r=e}t(){return this.n?Promise.reject(new Error("Document has been closed")):this.o.$trySaveDocument(this.a)}u(e){const t=this.y(e);if(t.isEmpty)return"";if(t.isSingleLine)return this.b[t.start.line].substring(t.start.character,t.end.character);const i=this.c,r=t.start.line,s=t.end.line,n=[];n.push(this.b[r].substring(t.start.character));for(let o=r+1;o<s;o++)n.push(this.b[o]);return n.push(this.b[s].substring(0,t.end.character)),n.join(i)}v(e){let t;if(e instanceof Pe?t=e.line:typeof e=="number"?t=e:!this.s&&Pe.isPosition(e)&&(t=e.line),typeof t!="number"||t<0||t>=this.b.length||Math.floor(t)!==t)throw new Error("Illegal value for `line`");return new $V(t,this.b[t],t===this.b.length-1)}w(e){return e=this.z(e),this.h(),this.f.getPrefixSum(e.line-1)+e.character}x(e){e=Math.floor(e),e=Math.max(0,e),this.h();const t=this.f.getIndexOf(e),i=this.b[t.index].length;return new Pe(t.index,Math.min(t.remainder,i))}y(e){if(this.s){if(!(e instanceof xe))throw new Error("Invalid argument")}else if(!xe.isRange(e))throw new Error("Invalid argument");const t=this.z(e.start),i=this.z(e.end);return t===e.start&&i===e.end?e:new xe(t.line,t.character,i.line,i.character)}z(e){if(this.s){if(!(e instanceof Pe))throw new Error("Invalid argument")}else if(!Pe.isPosition(e))throw new Error("Invalid argument");if(this.b.length===0)return e.with(0,0);let{line:t,character:i}=e,r=!1;if(t<0)t=0,i=0,r=!0;else if(t>=this.b.length)t=this.b.length-1,i=this.b[t].length,r=!0;else{const s=this.b[t].length;i<0?(i=0,r=!0):i>s&&(i=s,r=!0)}return r?new Pe(t,i):e}A(e,t){const i=this.z(e);if(!t)t=kV(this.p);else if(DE(t))throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${t.source}' because it matches the empty string.`);const r=ck(i.character+1,ok(t),this.b[i.line],0);if(r)return new xe(i.line,r.startColumn-1,i.line,r.endColumn-1)}},$V=class{constructor(e,t,i){this.a=e,this.b=t,this.c=i}get lineNumber(){return this.a}get text(){return this.b}get range(){return new xe(this.a,0,this.a,this.b.length)}get rangeIncludingLineBreak(){return this.c?this.range:new xe(this.a,0,this.a+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this.b)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this.b.length}},km=class{constructor(e){this.a=e,this.b=0}nextId(){return this.a+ ++this.b}},vse=new km("id#"),IV=class xN{static{this.c=new km("TextEditorDecorationType")}constructor(t,i,r){const s=xN.c.nextId();t.$registerTextEditorDecorationType(i.identifier,s,Zb.from(r)),this.value=Object.freeze({key:s,dispose(){t.$removeTextEditorDecorationType(s)}})}},DV=class{constructor(e,t){this.g=[],this.h=void 0,this.j=!1,this.c=e,this.d=e.version,this.e=t.undoStopBefore,this.f=t.undoStopAfter}finalize(){return this.j=!0,{documentVersionId:this.d,edits:this.g,setEndOfLine:this.h,undoStopBefore:this.e,undoStopAfter:this.f}}k(){if(this.j)throw new Error("Edit is only valid while callback runs")}replace(e,t){this.k();let i=null;if(e instanceof Pe)i=new xe(e,e);else if(e instanceof xe)i=e;else throw new Error("Unrecognized location");this.l(i,t,!1)}insert(e,t){this.k(),this.l(new xe(e,e),t,!0)}delete(e){this.k();let t=null;if(e instanceof xe)t=e;else throw new Error("Unrecognized location");this.l(t,null,!0)}l(e,t,i){const r=this.c.validateRange(e);this.g.push({range:r,text:t,forceMoveMarkers:i})}setEndOfLine(e){if(this.k(),e!==ts.LF&&e!==ts.CRLF)throw $e("endOfLine");this.h=e}},PV=class{constructor(e,t,i,r){this.c=e,this.d=t,this._accept(i),this.e=r;const s=this;this.value={get tabSize(){return s.f},set tabSize(n){s.n(n)},get indentSize(){return s.g},set indentSize(n){s.p(n)},get insertSpaces(){return s.j},set insertSpaces(n){s.s(n)},get cursorStyle(){return s.k},set cursorStyle(n){s.t(n)},get lineNumbers(){return s.l},set lineNumbers(n){s.u(n)}}}_accept(e){this.f=e.tabSize,this.g=e.indentSize,this.h=e.originalIndentSize,this.j=e.insertSpaces,this.k=e.cursorStyle,this.l=sl.to(e.lineNumbers)}m(e){if(e==="auto")return"auto";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}n(e){const t=this.m(e);if(t!==null){if(typeof t=="number"){if(this.f===t)return;this.f=t}this.v("setTabSize",this.c.$trySetOptions(this.d,{tabSize:t}))}}o(e){if(e==="tabSize")return"tabSize";if(typeof e=="number"){const t=Math.floor(e);return t>0?t:null}if(typeof e=="string"){const t=parseInt(e,10);return isNaN(t)?null:t>0?t:null}return null}p(e){const t=this.o(e);if(t!==null){if(typeof t=="number"){if(this.h===t)return;this.g=t,this.h=t}this.v("setIndentSize",this.c.$trySetOptions(this.d,{indentSize:t}))}}q(e){return e==="auto"?"auto":e==="false"?!1:!!e}s(e){const t=this.q(e);if(typeof t=="boolean"){if(this.j===t)return;this.j=t}this.v("setInsertSpaces",this.c.$trySetOptions(this.d,{insertSpaces:t}))}t(e){this.k!==e&&(this.k=e,this.v("setCursorStyle",this.c.$trySetOptions(this.d,{cursorStyle:e})))}u(e){this.l!==e&&(this.l=e,this.v("setLineNumbers",this.c.$trySetOptions(this.d,{lineNumbers:sl.from(e)})))}assign(e){const t={};let i=!1;if(typeof e.tabSize<"u"){const r=this.m(e.tabSize);r==="auto"?(i=!0,t.tabSize=r):typeof r=="number"&&this.f!==r&&(this.f=r,i=!0,t.tabSize=r)}if(typeof e.indentSize<"u"){const r=this.o(e.indentSize);r==="tabSize"?(i=!0,t.indentSize=r):typeof r=="number"&&this.h!==r&&(this.g=r,this.h=r,i=!0,t.indentSize=r)}if(typeof e.insertSpaces<"u"){const r=this.q(e.insertSpaces);r==="auto"?(i=!0,t.insertSpaces=r):this.j!==r&&(this.j=r,i=!0,t.insertSpaces=r)}typeof e.cursorStyle<"u"&&this.k!==e.cursorStyle&&(this.k=e.cursorStyle,i=!0,t.cursorStyle=e.cursorStyle),typeof e.lineNumbers<"u"&&this.l!==e.lineNumbers&&(this.l=e.lineNumbers,i=!0,t.lineNumbers=sl.from(e.lineNumbers)),i&&this.v("setOptions",this.c.$trySetOptions(this.d,t))}v(e,t){t.catch(i=>{this.e.warn(`ExtHostTextEditorOptions '${e}' failed:'`),this.e.warn(i)})}},TV=class{constructor(e,t,i,r,s,n,o,a){this.id=e,this.k=t,this.l=i,this.g=!1,this.h=new Set,this.c=s,this.d=new PV(this.k,this.id,n,i),this.e=o,this.f=a;const c=this;this.value=Object.freeze({get document(){return r.value},set document(l){throw new Do("document")},get selection(){return c.c&&c.c[0]},set selection(l){if(!(l instanceof Cs))throw $e("selection");c.c=[l],c.m()},get selections(){return c.c},set selections(l){if(!Array.isArray(l)||l.some(u=>!(u instanceof Cs)))throw $e("selections");l.length===0&&(l=[new Cs(0,0,0,0)]),c.c=l,c.m()},get visibleRanges(){return c.e},set visibleRanges(l){throw new Do("visibleRanges")},get diffInformation(){return c.j},get options(){return c.d.value},set options(l){c.g||c.d.assign(l)},get viewColumn(){return c.f},set viewColumn(l){throw new Do("viewColumn")},edit(l,u={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#edit not possible on closed editors"));const h=new DV(r.value,u);return l(h),c.n(h)},insertSnippet(l,u,h={undoStopBefore:!0,undoStopAfter:!0}){if(c.g)return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"));let f;if(!u||Array.isArray(u)&&u.length===0)f=c.c.map(p=>j.from(p));else if(u instanceof Pe){const{lineNumber:p,column:g}=Xe.from(u);f=[{startLineNumber:p,startColumn:g,endLineNumber:p,endColumn:g}]}else if(u instanceof xe)f=[j.from(u)];else{f=[];for(const p of u)if(p instanceof xe)f.push(j.from(p));else{const{lineNumber:g,column:v}=Xe.from(p);f.push({startLineNumber:g,startColumn:v,endLineNumber:g,endColumn:v})}}return h.keepWhitespace===void 0&&(h.keepWhitespace=!1),t.$tryInsertSnippet(e,r.value.version,l.value,f,h)},setDecorations(l,u){const h=u.length===0;h&&!c.h.has(l.key)||(h?c.h.delete(l.key):c.h.add(l.key),c.o(()=>{if(N7(u))return t.$trySetDecorations(e,l.key,sB(u));{const f=new Array(4*u.length);for(let p=0,g=u.length;p<g;p++){const v=u[p];f[4*p]=v.start.line+1,f[4*p+1]=v.start.character+1,f[4*p+2]=v.end.line+1,f[4*p+3]=v.end.character+1}return t.$trySetDecorationsFast(e,l.key,f)}}))},revealRange(l,u){c.o(()=>t.$tryRevealRange(e,j.from(l),u||Dp.Default))},show(l){t.$tryShowEditor(e,Xt.from(l))},hide(){t.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){ki(!this.g),this.g=!0}_acceptOptions(e){ki(!this.g),this.d._accept(e)}_acceptVisibleRanges(e){ki(!this.g),this.e=e}_acceptViewColumn(e){ki(!this.g),this.f=e}_acceptSelections(e){ki(!this.g),this.c=e}_acceptDiffInformation(e){ki(!this.g),this.j=e}async m(){const e=this.c.map(ss.from);return await this.o(()=>this.k.$trySetSelections(this.id,e)),this.value}n(e){const t=e.finalize();if(t.edits.length===0&&!t.setEndOfLine)return Promise.resolve(!0);const i=t.edits.map(s=>s.range);i.sort((s,n)=>s.end.line===n.end.line?s.end.character===n.end.character?s.start.line===n.start.line?s.start.character-n.start.character:s.start.line-n.start.line:s.end.character-n.end.character:s.end.line-n.end.line);for(let s=0,n=i.length-1;s<n;s++){const o=i[s].end;if(i[s+1].start.isBefore(o))return Promise.reject(new Error("Overlapping ranges are not allowed!"))}const r=t.edits.map(s=>({range:j.from(s.range),text:s.text,forceMoveMarkers:s.forceMoveMarkers}));return this.k.$tryApplyEdits(this.id,t.documentVersionId,r,{setEndOfLine:typeof t.setEndOfLine=="number"?nl.from(t.setEndOfLine):void 0,undoStopBefore:t.undoStopBefore,undoStopAfter:t.undoStopAfter})}o(e){return this.g?(this.l.warn("TextEditor is closed/disposed"),Promise.resolve(void 0)):e().then(()=>this,t=>(t instanceof Error&&t.name==="DISPOSED"||this.l.warn(t),null))}},MV=class{constructor(e){this.value=e,this.a=0}ref(){this.a++}unref(){return--this.a===0}},ZA=class{constructor(t,i){this.h=t,this.i=i,this.a=null,this.b=new Map,this.c=new zt,this.d=new I,this.e=new I,this.f=new I,this.g=new I,this.onDidAddDocuments=this.d.event,this.onDidRemoveDocuments=this.e.event,this.onDidChangeVisibleTextEditors=this.f.event,this.onDidChangeActiveTextEditor=this.g.event}$acceptDocumentsAndEditorsDelta(t){this.acceptDocumentsAndEditorsDelta(t)}acceptDocumentsAndEditorsDelta(t){const i=[],r=[],s=[];if(t.removedDocuments)for(const n of t.removedDocuments){const o=y.revive(n),a=this.c.get(o);a?.unref()&&(this.c.delete(o),i.push(a.value))}if(t.addedDocuments)for(const n of t.addedDocuments){const o=y.revive(n.uri);let a=this.c.get(o);if(a&&o.scheme!==q.vscodeNotebookCell&&o.scheme!==q.vscodeInteractiveInput)throw new Error(`document '${o} already exists!'`);a||(a=new MV(new CV(this.h.getProxy(X.MainThreadDocuments),o,n.lines,n.EOL,n.versionId,n.languageId,n.isDirty,n.encoding)),this.c.set(o,a),r.push(a.value)),a.ref()}if(t.removedEditors)for(const n of t.removedEditors){const o=this.b.get(n);this.b.delete(n),o&&s.push(o)}if(t.addedEditors)for(const n of t.addedEditors){const o=y.revive(n.documentUri);ki(this.c.has(o),`document '${o}' does not exist`),ki(!this.b.has(n.id),`editor '${n.id}' already exists!`);const a=this.c.get(o).value,c=new TV(n.id,this.h.getProxy(X.MainThreadTextEditors),this.i,new Pt(()=>a.document),n.selections.map(ss.to),n.options,n.visibleRanges.map(l=>j.to(l)),typeof n.editorPosition=="number"?Xt.to(n.editorPosition):void 0);this.b.set(n.id,c)}t.newActiveEditor!==void 0&&(ki(t.newActiveEditor===null||this.b.has(t.newActiveEditor),`active editor '${t.newActiveEditor}' does not exist`),this.a=t.newActiveEditor),Zi(i),Zi(s),t.removedDocuments&&this.e.fire(i),t.addedDocuments&&this.d.fire(r),(t.removedEditors||t.addedEditors)&&this.f.fire(this.allEditors().map(n=>n.value)),t.newActiveEditor!==void 0&&this.g.fire(this.activeEditor())}getDocument(t){return this.c.get(t)?.value}allDocuments(){return Wt.map(this.c.values(),t=>t.value)}getEditor(t){return this.b.get(t)}activeEditor(t){if(!this.a)return;const i=this.b.get(this.a);return t?i:i?.value}allEditors(){return[...this.b.values()]}};ZA=__decorate([__param(0,Ce),__param(1,Se)],ZA);var La=H("IExtHostDocumentsAndEditors"),Zh=H("productService"),NV="vscode://schemas/vscode-product",RV={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authIssuers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authIssuers.d.ts"},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authProviderSpecific:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authProviderSpecific.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},authenticationChallenges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authenticationChallenges.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatContextProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatContextProvider.d.ts"},chatEditing:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts"},chatOutputRenderer:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatOutputRenderer.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:11},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts",version:4},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatSessionsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatSessionsProvider.d.ts",version:3},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribLanguageModelToolSets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLanguageModelToolSets.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlArtifactGroupMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactGroupMenu.d.ts"},contribSourceControlArtifactMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlArtifactMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},dataChannels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.dataChannels.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},devDeviceId:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.devDeviceId.d.ts"},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelProxy:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelProxy.d.ts"},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageModelThinkingPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelThinkingPart.d.ts",version:1},languageModelToolResultAudience:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelToolResultAudience.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},markdownAlertSyntax:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.markdownAlertSyntax.d.ts"},mcpToolDefinitions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpToolDefinitions.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemResource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemResource.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickPrompt:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickPrompt.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},remoteCodingAgents:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.remoteCodingAgents.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmArtifactProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmArtifactProvider.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmProviderOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmProviderOptions.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskExecutionTerminal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskExecutionTerminal.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textDocumentChangeReason:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textDocumentChangeReason.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeItemMarkdownLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeItemMarkdownLabel.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}},Cm=Object.freeze(RV),JA=Zt.as(rp.JSONContribution),LV=class X1{static a(t){const i=new Go;for(let r=0,s=t.length;r<s;r++)i.add(t[r].description.identifier);return i}static compute(t,i){if(!t||!t.length)return new X1(i,[]);if(!i||!i.length)return new X1([],t);const r=this.a(t),s=this.a(i),n=i.filter(a=>!r.has(a.description.identifier)),o=t.filter(a=>!s.has(a.description.identifier));return new X1(n,o)}constructor(t,i){this.added=t,this.removed=i}},OV=class{constructor(e,t,i){this.name=e,this.defaultExtensionKind=t,this.canHandleResolver=i,this.a=null,this.b=null,this.c=null}setHandler(e){if(this.a!==null)throw new Error("Handler already set!");return this.a=e,this.d(),{dispose:()=>{this.a=null}}}acceptUsers(e){this.c=LV.compute(this.b,e),this.b=e,this.d()}d(){if(!(this.a===null||this.b===null||this.c===null))try{this.a(this.b,this.c)}catch(e){lt(e)}}},FV={type:"string",enum:["ui","workspace"],enumDescriptions:[d(15490,null),d(15491,null)]},CD="vscode://schemas/vscode-extensions",QA={properties:{engines:{type:"object",description:d(15492,null),properties:{vscode:{type:"string",description:d(15493,null),default:"^1.22.0"}}},publisher:{description:d(15494,null),type:"string"},displayName:{description:d(15495,null),type:"string"},categories:{description:d(15496,null),type:"array",uniqueItems:!0,items:{oneOf:[{type:"string",enum:Hk},{type:"string",const:"Languages",deprecationMessage:d(15497,null)}]}},galleryBanner:{type:"object",description:d(15498,null),properties:{color:{description:d(15499,null),type:"string"},theme:{description:d(15500,null),type:"string",enum:["dark","light"]}}},contributes:{description:d(15501,null),type:"object",properties:{},default:{}},preview:{type:"boolean",description:d(15502,null)},enableProposedApi:{type:"boolean",deprecationMessage:d(15503,null)},enabledApiProposals:{markdownDescription:d(15504,null),type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Cm).map(e=>e),markdownEnumDescriptions:Object.values(Cm).map(e=>e.proposal)}},api:{markdownDescription:d(15505,null),type:"string",enum:["none"],enumDescriptions:[d(15506,null)]},activationEvents:{description:d(15507,null),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:d(15508,null),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:d(15509,null),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:d(15510,null),body:"onCommand:${2:commandId}"},{label:"onDebug",description:d(15511,null),body:"onDebug"},{label:"onDebugInitialConfigurations",description:d(15512,null),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:d(15513,null),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:d(15514,null),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:d(15515,null),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:d(15516,null),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:d(15517,null),body:"onStartupFinished"},{label:"onTaskType",description:d(15518,null),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:d(15519,null),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:d(15520,null),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:d(15521,null),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:d(15522,null)},{label:"onUri",body:"onUri",description:d(15523,null)},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:d(15524,null)},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:d(15525,null)},{label:"onNotebook",body:"onNotebook:${1:type}",description:d(15526,null)},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:d(15527,null)},{label:"onRenderer",description:d(15528,null),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:d(15529,null)},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:d(15530,null)},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:d(15531,null)},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:d(15532,null)},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:d(15533,null)},{label:"onLanguageModelChatProvider",body:"onLanguageModelChatProvider:${1:vendor}",description:d(15534,null)},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:d(15535,null)},{label:"onTerminal",body:"onTerminal:{1:shellType}",description:d(15536,null)},{label:"onTerminalShellIntegration",body:"onTerminalShellIntegration:${1:shellType}",description:d(15537,null)},{label:"onMcpCollection",description:d(15538,null),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:d(15539,null),body:"*"}]}},badges:{type:"array",description:d(15540,null),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:d(15541,null)},href:{type:"string",description:d(15542,null)},description:{type:"string",description:d(15543,null)}}}},markdown:{type:"string",description:d(15544,null),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:d(15545,null),anyOf:[{type:["string","boolean"],enum:["marketplace",!1]},{type:"string"}]},extensionDependencies:{description:d(15546,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Cw}},extensionPack:{description:d(15547,null),type:"array",uniqueItems:!0,items:{type:"string",pattern:Cw}},extensionKind:{description:d(15548,null),type:"array",items:FV,default:["workspace"],defaultSnippets:[{body:["ui"],description:d(15549,null)},{body:["workspace"],description:d(15550,null)},{body:["ui","workspace"],description:d(15551,null)},{body:["workspace","ui"],description:d(15552,null)},{body:[],description:d(15553,null)}]},capabilities:{description:d(15554,null),type:"object",properties:{virtualWorkspaces:{description:d(15555,null),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:!1,description:"${2}"}}],default:(!0).valueOf,properties:{supported:{markdownDescription:d(15556,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(15557,null),d(15558,null),d(15559,null)]},description:{type:"string",markdownDescription:d(15560,null)}}},untrustedWorkspaces:{description:d(15561,null),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:d(15562,null),type:["string","boolean"],enum:["limited",!0,!1],enumDescriptions:[d(15563,null),d(15564,null),d(15565,null)]},restrictedConfigurations:{description:d(15566,null),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:d(15567,null)}}}}},sponsor:{description:d(15568,null),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{url:{description:d(15569,null),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:d(15570,null),type:"string"},"vscode:uninstall":{description:d(15571,null),type:"string"}}},icon:{type:"string",description:d(15572,null)},l10n:{type:"string",description:d(15573,null)},pricing:{type:"string",markdownDescription:d(15574,null),enum:["Free","Trial"],default:"Free"}}},UV=class{constructor(){this.a=new Map}registerExtensionPoint(e){if(this.a.has(e.extensionPoint))throw new Error("Duplicate extension point: "+e.extensionPoint);const t=new OV(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);return this.a.set(e.extensionPoint,t),e.activationEventsGenerator&&wW.register(e.extensionPoint,e.activationEventsGenerator),QA.properties.contributes.properties[e.extensionPoint]=e.jsonSchema,JA.registerSchema(CD,QA),t}getExtensionPoints(){return Array.from(this.a.values())}},$D={ExtensionsRegistry:"ExtensionsRegistry"};Zt.add($D.ExtensionsRegistry,new UV);var ID=Zt.as($D.ExtensionsRegistry);JA.registerSchema(CD,QA),JA.registerSchema(NV,{properties:{extensionEnabledApiProposals:{description:d(15575,null),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:!0,items:{type:"string",enum:Object.keys(Cm),markdownEnumDescriptions:Object.values(Cm).map(e=>e.proposal)}}]}}}});var jV={type:"object",additionalProperties:!1,properties:{type:{type:"string",description:d(12628,null)},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:d(12629,null),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:d(12630,null),default:""}}},YA;(function(e){function t(i,r,s){if(!i)return;const n=Oe(i.type)?i.type:void 0;if(!n||n.length===0){s.error(d(12631,null));return}const o=[];if(Array.isArray(i.required))for(const a of i.required)Oe(a)&&o.push(a);return{extensionId:r.value,taskType:n,required:o,properties:i.properties?ot(i.properties):{},when:i.when?xt.deserialize(i.when):void 0}}e.from=t})(YA||(YA={}));var zV=ID.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:function*(e){for(const t of e)t.type&&(yield`onTaskType:${t.type}`)},jsonSchema:{description:d(12632,null),type:"array",items:jV}}),HV=class{constructor(){this.d=new I,this.onDefinitionsChanged=this.d.event,this.a=Object.create(null),this.b=new Promise((e,t)=>{zV.setHandler((i,r)=>{this.c=void 0;try{for(const s of r.removed){const n=s.value;for(const o of n)this.a&&o.type&&this.a[o.type]&&delete this.a[o.type]}for(const s of r.added){const n=s.value;for(const o of n){const a=YA.from(o,s.description.identifier,s.collector);a&&(this.a[a.taskType]=a)}}(r.removed.length>0||r.added.length>0)&&this.d.fire()}catch{}e(void 0)})})}onReady(){return this.b}get(e){return this.a[e]}all(){return Object.keys(this.a).map(e=>this.a[e])}getJsonSchema(){if(this.c===void 0){const e=[];for(const t of this.all()){const i={type:"object",additionalProperties:!1};t.required.length>0&&(i.required=t.required.slice(0)),t.properties!==void 0?i.properties=ot(t.properties):i.properties=Object.create(null),i.properties.type={type:"string",enum:[t.taskType]},e.push(i)}this.c={oneOf:e}}return this.c}},WV=new HV,BV={IconContribution:"base.contributions.icons"},DD;(function(e){function t(i,r){let s=i.defaults;for(;Nt.isThemeIcon(s);){const n=xl.getIcon(s.id);if(!n)return;s=n.defaults}return s}e.getDefinition=t})(DD||(DD={}));var PD;(function(e){function t(r){return{weight:r.weight,style:r.style,src:r.src.map(s=>({format:s.format,location:s.location.toString()}))}}e.toJSONObject=t;function i(r){const s=n=>Oe(n)?n:void 0;if(r&&Array.isArray(r.src)&&r.src.every(n=>Oe(n.format)&&Oe(n.location)))return{weight:s(r.weight),style:s(r.style),src:r.src.map(n=>({format:n.format,location:y.parse(n.location)}))}}e.fromJSONObject=i})(PD||(PD={}));var _V=/^([\w_-]+)$/,VV=d(2629,null),qV=class extends Q{constructor(){super(),this.a=this.D(new I),this.onDidChange=this.a.event,this.f={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:d(2630,null),pattern:_V.source,patternErrorMessage:VV},fontCharacter:{type:"string",description:d(2631,null)}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.g={type:"string",pattern:`^${Nt.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.b={},this.h={}}registerIcon(e,t,i,r){const s=this.b[e];if(s){if(i&&!s.description){s.description=i,this.f.properties[e].markdownDescription=`${i} $(${e})`;const a=this.g.enum.indexOf(e);a!==-1&&(this.g.enumDescriptions[a]=i),this.a.fire()}return s}const n={id:e,description:i,defaults:t,deprecationMessage:r};this.b[e]=n;const o={$ref:"#/definitions/icons"};return r&&(o.deprecationMessage=r),i&&(o.markdownDescription=`${i}: $(${e})`),this.f.properties[e]=o,this.g.enum.push(e),this.g.enumDescriptions.push(i||""),this.a.fire(),{id:e}}deregisterIcon(e){delete this.b[e],delete this.f.properties[e];const t=this.g.enum.indexOf(e);t!==-1&&(this.g.enum.splice(t,1),this.g.enumDescriptions.splice(t,1)),this.a.fire()}getIcons(){return Object.keys(this.b).map(e=>this.b[e])}getIcon(e){return this.b[e]}getIconSchema(){return this.f}getIconReferenceSchema(){return this.g}registerIconFont(e,t){const i=this.h[e];return i||(this.h[e]=t,this.a.fire(),t)}deregisterIconFont(e){delete this.h[e]}getIconFont(e){return this.h[e]}toString(){const e=(s,n)=>s.id.localeCompare(n.id),t=s=>{for(;Nt.isThemeIcon(s.defaults);)s=this.b[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const r=Object.keys(this.b).map(s=>this.b[s]);for(const s of r.filter(n=>!!n.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${Nt.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of r.filter(n=>!Nt.isThemeIcon(n.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}},xl=new qV;Zt.add(BV.IconContribution,xl);function Jh(e,t,i,r){return xl.registerIcon(e,t,i,r)}function GV(){const e=Aj();for(const t in e){const i="\\"+e[t].toString(16);xl.registerIcon(t,{fontCharacter:i})}}GV();var TD="vscode://schemas/icons",MD=Zt.as(rp.JSONContribution);MD.registerSchema(TD,xl.getIconSchema());var ND=new vs(()=>MD.notifySchemaChanged(TD),200);xl.onDidChange(()=>{ND.isScheduled()||ND.schedule()});var bse=Jh("widget-close",oe.close,d(2632,null)),yse=Jh("goto-previous-location",oe.arrowUp,d(2633,null)),Ase=Jh("goto-next-location",oe.arrowDown,d(2634,null)),Sse=Nt.modify(oe.sync,"spin"),Ese=Nt.modify(oe.loading,"spin"),ZV="settings",xse=new k("taskRunning",!1,d(12633,null)),kse=new k("taskTerminalActive",!1,d(12634,null)),Cse=Gd(12637,"Tasks"),$m;(function(e){e[e.Escape=1]="Escape",e[e.Strong=2]="Strong",e[e.Weak=3]="Weak"})($m||($m={})),function(e){function t(i){if(!i)return e.Strong;switch(i.toLowerCase()){case"escape":return e.Escape;case"strong":return e.Strong;case"weak":return e.Weak;default:return e.Strong}}e.from=t}($m||($m={}));var RD;(function(e){e.defaults={cwd:"${workspaceFolder}"}})(RD||(RD={}));var Qh;(function(e){e[e.Always=1]="Always",e[e.Silent=2]="Silent",e[e.Never=3]="Never"})(Qh||(Qh={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"silent":return e.Silent;case"never":return e.Never;default:return e.Always}}e.fromString=t}(Qh||(Qh={}));var Yh;(function(e){e[e.Never=1]="Never",e[e.OnProblem=2]="OnProblem",e[e.Always=3]="Always"})(Yh||(Yh={})),function(e){function t(i){switch(i.toLowerCase()){case"always":return e.Always;case"never":return e.Never;case"onproblem":return e.OnProblem;default:return e.OnProblem}}e.fromString=t}(Yh||(Yh={}));var Xh;(function(e){e[e.Shared=1]="Shared",e[e.Dedicated=2]="Dedicated",e[e.New=3]="New"})(Xh||(Xh={})),function(e){function t(i){switch(i.toLowerCase()){case"shared":return e.Shared;case"dedicated":return e.Dedicated;case"new":return e.New;default:return e.Shared}}e.fromString=t}(Xh||(Xh={}));var LD;(function(e){e.defaults={echo:!0,reveal:Qh.Always,revealProblems:Yh.Never,focus:!1,panel:Xh.Shared,showReuseMessage:!0,clear:!1,preserveTerminalName:!1}})(LD||(LD={}));var Im;(function(e){e[e.Shell=1]="Shell",e[e.Process=2]="Process",e[e.CustomExecution=3]="CustomExecution"})(Im||(Im={})),function(e){function t(r){switch(r.toLowerCase()){case"shell":return e.Shell;case"process":return e.Process;case"customExecution":return e.CustomExecution;default:return e.Process}}e.fromString=t;function i(r){switch(r){case e.Shell:return"shell";case e.Process:return"process";case e.CustomExecution:return"customExecution";default:return"process"}}e.toString=i}(Im||(Im={}));var OD;(function(e){function t(i){return Oe(i)?i:i.value}e.value=t})(OD||(OD={}));var FD;(function(e){e.Clean={_id:"clean",isDefault:!1},e.Build={_id:"build",isDefault:!1},e.Rebuild={_id:"rebuild",isDefault:!1},e.Test={_id:"test",isDefault:!1};function t(r){return r===e.Clean._id||r===e.Build._id||r===e.Rebuild._id||r===e.Test._id}e.is=t;function i(r){if(r!==void 0)return Oe(r)?t(r)?{_id:r,isDefault:!1}:void 0:r}e.from=i})(FD||(FD={}));var UD;(function(e){e[e.Global=1]="Global",e[e.Workspace=2]="Workspace",e[e.Folder=3]="Folder"})(UD||(UD={}));var jD;(function(e){e.Workspace="workspace",e.Extension="extension",e.InMemory="inMemory",e.WorkspaceFile="workspaceFile",e.User="user";function t(i){switch(i){case e.User:return 2;case e.WorkspaceFile:return 5;default:return 6}}e.toConfigurationTarget=t})(jD||(jD={}));var zD;(function(e){e.parallel="parallel",e.sequence="sequence"})(zD||(zD={}));var XA;(function(e){e[e.default=1]="default",e[e.folderOpen=2]="folderOpen"})(XA||(XA={}));var HD;(function(e){e.terminateNewest="terminateNewest",e.terminateOldest="terminateOldest",e.prompt="prompt",e.warn="warn",e.silent="silent"})(HD||(HD={}));var WD;(function(e){e.defaults={reevaluateOnRerun:!0,runOn:XA.default,instanceLimit:1,instancePolicy:"prompt"}})(WD||(WD={}));var Dm;(function(e){e[e.Process=1]="Process",e[e.Terminal=2]="Terminal"})(Dm||(Dm={})),function(e){e._default=e.Terminal}(Dm||(Dm={}));var BD;(function(e){e[e.V0_1_0=1]="V0_1_0",e[e.V2_0_0=2]="V2_0_0"})(BD||(BD={}));var _D;(function(e){e.SingleRun="singleRun",e.Background="background"})(_D||(_D={}));var pn;(function(e){e.Changed="changed",e.ProcessStarted="processStarted",e.ProcessEnded="processEnded",e.Terminated="terminated",e.Start="start",e.AcquiredInput="acquiredInput",e.DependsOnStarted="dependsOnStarted",e.Active="active",e.Inactive="inactive",e.End="end",e.ProblemMatcherStarted="problemMatcherStarted",e.ProblemMatcherEnded="problemMatcherEnded",e.ProblemMatcherFoundErrors="problemMatcherFoundErrors"})(pn||(pn={}));var VD;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.FolderOpen=2]="FolderOpen",e[e.ConfigurationChange=3]="ConfigurationChange",e[e.Reconnect=4]="Reconnect",e[e.ChatAgent=5]="ChatAgent"})(VD||(VD={}));var qD;(function(e){function t(u){return{taskId:u._id,taskName:u.configurationProperties.name,runType:u.configurationProperties.isBackground?"background":"singleRun",group:u.configurationProperties.group,__task:u}}function i(u,h,f){return{...t(u),kind:pn.Start,terminalId:h,resolvedVariables:f}}e.start=i;function r(u,h,f){return{...t(u),kind:pn.ProcessStarted,terminalId:h,processId:f}}e.processStarted=r;function s(u,h,f,p){return{...t(u),kind:pn.ProcessEnded,terminalId:h,exitCode:f,durationMs:p}}e.processEnded=s;function n(u,h,f){return{...t(u),kind:pn.Inactive,terminalId:h,durationMs:f}}e.inactive=n;function o(u,h,f){return{...t(u),kind:pn.Terminated,exitReason:f,terminalId:h}}e.terminated=o;function a(u,h,f){return{...t(h),kind:u,terminalId:f}}e.general=a;function c(u,h,f){return{...t(u),kind:pn.ProblemMatcherEnded,hasErrors:h}}e.problemMatcherEnded=c;function l(){return{kind:pn.Changed}}e.changed=l})(qD||(qD={}));var Pm;(function(e){function t(r){const s=Object.keys(r).sort();let n="";for(const o of s){let a=r[o];a instanceof Object?a=t(a):typeof a=="string"&&(a=a.replace(/,/g,",,")),n+=o+","+a+","}return n}function i(r){const n={_key:t(r),type:r.taskType};return Object.assign(n,r),n}e.create=i})(Pm||(Pm={}));var GD;(function(e){e.AutoDetect="task.autoDetect",e.SaveBeforeRun="task.saveBeforeRun",e.ShowDecorations="task.showDecorations",e.ProblemMatchersNeverPrompt="task.problemMatchers.neverPrompt",e.SlowProviderWarning="task.slowProviderWarning",e.QuickOpenHistory="task.quickOpen.history",e.QuickOpenDetail="task.quickOpen.detail",e.QuickOpenSkip="task.quickOpen.skip",e.QuickOpenShowAll="task.quickOpen.showAll",e.AllowAutomaticTasks="task.allowAutomaticTasks",e.Reconnection="task.reconnection",e.VerboseLogging="task.verboseLogging",e.NotifyWindowOnTaskCompletion="task.notifyWindowOnTaskCompletion"})(GD||(GD={}));var ZD;(function(e){e.Tasks="tasks",e.SuppressTaskName="tasks.suppressTaskName",e.Windows="tasks.windows",e.Osx="tasks.osx",e.Linux="tasks.linux",e.ShowOutput="tasks.showOutput",e.IsShellCommand="tasks.isShellCommand",e.ServiceTestSetting="tasks.service.testSetting"})(ZD||(ZD={}));var JD;(function(e){function t(i,r){const s=WV.get(i.type);if(s===void 0){const c=ot(i);return delete c._key,Pm.create(c)}const n=Object.create(null);n.type=s.taskType;const o=new Set;s.required.forEach(c=>o.add(c));const a=s.properties;for(const c of Object.keys(a)){const l=i[c];if(l!=null)n[c]=l;else if(o.has(c)){const u=a[c];if(u.default!==void 0)n[c]=ot(u.default);else switch(u.type){case"boolean":n[c]=!1;break;case"number":case"integer":n[c]=0;break;case"string":n[c]="";break;default:r.error(d(12635,null,JSON.stringify(i,void 0,0),c));return}}}return Pm.create(n)}e.createTaskIdentifier=t})(JD||(JD={}));var $se=Jh("rerun-task",oe.refresh,d(12636,null)),Tm;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(Tm||(Tm={}));var Mm;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(Mm||(Mm={}));var KA;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(KA||(KA={}));var Kh;(function(e){function t(s){if(s){const n=s;return n&&!!n.process}else return!1}e.is=t;function i(s){if(s==null)return;const n={process:s.process,args:s.args};return s.options&&(n.options=KA.from(s.options)),n}e.from=i;function r(s){if(s!=null)return new zc(s.process,s.args,s.options)}e.to=r})(Kh||(Kh={}));var e4;(function(e){function t(r){if(r!=null)return r}e.from=t;function i(r){if(r!=null)return r}e.to=i})(e4||(e4={}));var ed;(function(e){function t(s){if(s){const n=s;return n&&(!!n.commandLine||!!n.command)}else return!1}e.is=t;function i(s){if(s==null)return;const n={};return s.commandLine!==void 0?n.commandLine=s.commandLine:(n.command=s.command,n.args=s.args),s.options&&(n.options=e4.from(s.options)),n}e.from=i;function r(s){if(!(s==null||s.command===void 0&&s.commandLine===void 0))return s.commandLine?new ga(s.commandLine,s.options):new ga(s.command,s.args?s.args:[],s.options)}e.to=r})(ed||(ed={}));var as;(function(e){function t(s){if(s){const n=s;return n&&n.customExecution==="customExecution"}else return!1}e.is=t;function i(s){return{customExecution:"customExecution"}}e.from=i;function r(s,n){return n.get(s)}e.to=r})(as||(as={}));var t4;(function(e){function t(i,r){let s;return i.scope!==void 0&&typeof i.scope!="number"?s=i.scope.uri:i.scope!==void 0&&typeof i.scope=="number"&&(i.scope===oo.Workspace&&r&&r.workspaceFile?s=r.workspaceFile:s=ZV),{id:i._id,workspaceFolder:s}}e.from=t})(t4||(t4={}));var i4;(function(e){function t(i){if(i!=null)return{_id:i.id,isDefault:i.isDefault}}e.from=t})(i4||(i4={}));var Ls;(function(e){function t(s,n){if(s==null)return[];const o=[];for(const a of s){const c=i(a,n);c&&o.push(c)}return o}e.fromMany=t;function i(s,n){if(s==null)return;let o;s.execution instanceof zc?o=Kh.from(s.execution):s.execution instanceof ga?o=ed.from(s.execution):s.execution&&s.execution instanceof tb&&(o=as.from(s.execution));const a=Tm.from(s.definition);let c;return s.scope?typeof s.scope=="number"?c=s.scope:c=s.scope.uri:c=oo.Workspace,!a||!c?void 0:{_id:s._id,definition:a,name:s.name,source:{extensionId:n.identifier.value,label:s.source,scope:c},execution:o,isBackground:s.isBackground,group:i4.from(s.group),presentationOptions:Mm.from(s.presentationOptions),problemMatchers:Sr(s.problemMatchers),hasDefinedMatchers:s.hasDefinedMatchers,runOptions:s.runOptions?s.runOptions:{reevaluateOnRerun:!0},detail:s.detail}}e.from=i;async function r(s,n,o){if(s==null)return;let a;Kh.is(s.execution)?a=Kh.to(s.execution):ed.is(s.execution)?a=ed.to(s.execution):as.is(s.execution)&&(a=as.to(s._id,o));const c=Tm.to(s.definition);let l;if(s.source&&(s.source.scope!==void 0?typeof s.source.scope=="number"?l=s.source.scope:l=await n.resolveWorkspaceFolder(y.revive(s.source.scope)):l=oo.Workspace),!c||!l)return;const u=new Np(c,l,s.name,s.source.label,a,s.problemMatchers);return s.isBackground!==void 0&&(u.isBackground=s.isBackground),s.group!==void 0&&(u.group=Xu.from(s.group._id),u.group&&s.group.isDefault&&(u.group=new Xu(u.group.id,u.group.label),s.group.isDefault===!0&&(u.group.isDefault=s.group.isDefault))),s.presentationOptions&&(u.presentationOptions=Mm.to(s.presentationOptions)),s._id&&(u._id=s._id),s.detail&&(u.detail=s.detail),u}e.to=r})(Ls||(Ls={}));var r4;(function(e){function t(r){return r}e.from=t;function i(r){if(r)return Object.assign(Object.create(null),r)}e.to=i})(r4||(r4={}));var s4=class{#e;constructor(e,t,i){this._id=t,this.b=i,this.#e=e}get task(){return this.b}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}get terminal(){return this.a}set terminal(e){this.a=e}},Nm=class{constructor(t,i,r,s,n,o,a,c){this.q=new I,this.r=new I,this.s=new I,this.u=new I,this.v=new I,this.w=new I,this.a=t.getProxy(X.MainThreadTask),this.b=r,this.c=s,this.d=n,this.e=o,this.h=0,this.j=new Map,this.k=new Map,this.l=new Map,this.m=new Map,this.n=new Set,this.o=new Map,this.f=a,this.g=c,this.a.$registerSupportedExecutions(!0)}registerTaskProvider(t,i,r){if(!r)return new ke(()=>{});const s=this.z();return this.j.set(s,{type:i,provider:r,extension:t}),this.a.$registerTaskProvider(s,i),new ke(()=>{this.j.delete(s),this.a.$unregisterTaskProvider(s)})}registerTaskSystem(t,i){this.a.$registerTaskSystem(t,i)}fetchTasks(t){return this.a.$fetchTasks(r4.from(t)).then(async i=>{const r=[];for(const s of i){const n=await Ls.to(s,this.b,this.m);n&&r.push(n)}return r})}get taskExecutions(){const t=[];return this.k.forEach(i=>t.push(i)),t}terminateTask(t){if(!(t instanceof s4))throw new Error("No valid task execution provided");return this.a.$terminateTask(t._id)}get onDidStartTask(){return this.q.event}async $onDidStartTask(t,i,r){const s=this.m.get(t.id);s&&(this.o.set(t.id,s),this.e.attachPtyToTerminal(i,await s.callback(r))),this.p=t.id;const n=await this.B(t),o=this.e.getTerminalById(i)?.value;n&&(n.terminal=o),this.q.fire({execution:n})}get onDidEndTask(){return this.r.event}async $OnDidEndTask(t){if(!this.l.has(t.id))return;const i=await this.B(t);this.l.delete(t.id),this.k.delete(t.id),this.D(t),this.r.fire({execution:i})}get onDidStartTaskProcess(){return this.s.event}async $onDidStartTaskProcess(t){const i=await this.B(t.id);this.s.fire({execution:i,processId:t.processId})}get onDidEndTaskProcess(){return this.u.event}async $onDidEndTaskProcess(t){const i=await this.B(t.id);this.u.fire({execution:i,exitCode:t.exitCode})}get onDidStartTaskProblemMatchers(){return this.v.event}async $onDidStartTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.v.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this.w.event}async $onDidEndTaskProblemMatchers(t){let i;try{i=await this.B(t.execution.id)}catch{return}this.w.fire({execution:i,hasErrors:t.hasErrors})}$provideTasks(t,i){const r=this.j.get(t);if(!r)return Promise.reject(new Error("no handler found"));const s=[],n=di(()=>r.provider.provideTasks(Fe.None)).then(o=>this.x(i,s,r,o));return new Promise(o=>{n.then(a=>{Promise.all(s).then(()=>{o(a)})})})}async $resolveTask(t,i){const r=this.j.get(t);if(!r)return Promise.reject(new Error("no handler found"));if(i.definition.type!==r.type)throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${r.type}].`);const s=await Ls.to(i,this.b,this.m);if(!s)throw new Error("Unexpected: Task cannot be resolved.");const n=await r.provider.resolveTask(s,Fe.None);if(!n)return;this.C(n,r);const o=Ls.from(n,r.extension);if(!o)throw new Error("Unexpected: Task cannot be resolved.");if(n.definition!==s.definition)throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.");return as.is(o.execution)&&await this.A(o,n,!0),await this.y(o)}z(){return this.h++}async A(t,i,r){const s=await this.a.$createTaskId(t);!r&&!this.m.has(s)&&(this.n.add(s),this.o.set(s,i.execution)),this.m.set(s,i.execution)}async B(t,i){if(typeof t=="string"){const n=this.l.get(t);if(!n)throw new Wr("Unexpected: The specified task is missing an execution");return n}const r=this.l.get(t.id);if(r)return r;let s;return i?s=Promise.resolve(new s4(this,t.id,i)):s=Ls.to(t.task,this.b,this.m).then(n=>{if(!n)throw new Wr("Unexpected: Task does not exist.");return new s4(this,t.id,n)}),this.l.set(t.id,s),s.then(n=>(this.k.set(t.id,n),n))}C(t,i){t._deprecated&&this.g.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}D(t){this.o.get(t.id)&&this.o.delete(t.id),this.n.has(t.id)&&this.p!==t.id&&(this.m.delete(t.id),this.n.delete(t.id));const r=this.n.values();let s=r.next();for(;!s.done;)!this.o.has(s.value)&&this.p!==s.value&&(this.m.delete(s.value),this.n.delete(s.value)),s=r.next()}};Nm=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Nr),__param(3,La),__param(4,vr),__param(5,dn),__param(6,Se),__param(7,El)],Nm);var n4=class extends Nm{constructor(t,i,r,s,n,o,a,c){super(t,i,r,s,n,o,a,c),this.registerTaskSystem(q.vscodeRemote,{scheme:q.vscodeRemote,authority:"",platform:$L(0)})}async executeTask(t,i){if(!i.execution)throw new Error("Tasks to execute must include an execution");const r=Ls.from(i,t);if(r===void 0)throw new Error("Task is not valid");if(as.is(r.execution))await this.A(r,i,!1);else throw new fv;const s=await this.B(await this.a.$getTaskExecution(r),i);return this.a.$executeTask(r).catch(n=>{throw new Error(n)}),s}x(t,i,r,s){const n=[];if(s)for(const o of s){if(this.C(o,r),!o.definition||!t[o.definition.type]){const c=o.source?o.source:"No task source";this.f.warn(`The task [${c}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=Ls.from(o,r.extension);a&&as.is(a.execution)?(n.push(a),i.push(this.A(a,o,!0))):this.f.warn("Only custom execution tasks supported.")}return{tasks:n,extension:r.extension}}async y(t){if(as.is(t.execution))return t;this.f.warn("Only custom execution tasks supported.")}async $resolveVariables(t,i){return{process:void 0,variables:Object.create(null)}}async $jsonTasksSupported(){return!1}async $findExecutable(t,i,r){}};n4=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Nr),__param(3,La),__param(4,vr),__param(5,dn),__param(6,Se),__param(7,El)],n4);var o4=H("IExtHostTask"),QD=class{constructor(){this.f=new Map,this.m=[],this.n=new I,this.o=new I,this.d=1}get onError(){return this.n.event}get onExit(){return this.o.event}onMessage(e){this.k&&this.n.fire(new Error("attempt to set more than one 'Message' callback")),this.k=e}onEvent(e){this.j&&this.n.fire(new Error("attempt to set more than one 'Event' callback")),this.j=e}onRequest(e){this.g&&this.n.fire(new Error("attempt to set more than one 'Request' callback")),this.g=e}sendResponse(e){e.seq>0?this.n.fire(new Error(`attempt to send more than one response for command ${e.command}`)):this.u("response",e)}sendRequest(e,t,i,r){const s={command:e};if(t&&Object.keys(t).length>0&&(s.arguments=t),this.u("request",s),typeof r=="number"){const n=setTimeout(()=>{clearTimeout(n);const o=this.f.get(s.seq);if(o){this.f.delete(s.seq);const a={type:"response",seq:0,request_seq:s.seq,success:!1,command:e,message:d(7734,null,r,e)};o(a)}},r)}return i&&this.f.set(s.seq,i),s.seq}acceptMessage(e){this.k?this.k(e):(this.m.push(e),this.m.length===1&&this.s())}q(e,t){return e.type!=="event"||t.type!=="event"}async s(){let e;for(;this.m.length;){if((!e||this.q(this.m[0],e))&&await ri(0),e=this.m.shift(),!e)return;switch(e.type){case"event":this.j?.(e);break;case"request":this.g?.(e);break;case"response":{const t=e,i=this.f.get(t.request_seq);i&&(this.f.delete(t.request_seq),i(t));break}}}}u(e,t){t.type=e,t.seq=this.d++,this.sendMessage(t)}async w(){if(this.f.size===0)return Promise.resolve();const e=new Map;this.f.forEach((t,i)=>e.set(i,t)),await ri(500),e.forEach((t,i)=>{t({type:"response",seq:0,request_seq:i,success:!1,command:"canceled",message:"canceled"}),this.f.delete(i)})}getPendingRequestIds(){return Array.from(this.f.keys())}dispose(){this.m=[]}};function JV(e){return e.type&&(e.label||e.program||e.runtime)}var QV=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function YV(e){return!!(e&&e.match(QV))}function YD(e){if(typeof e.path=="string"&&!(typeof e.sourceReference=="number"&&e.sourceReference>0)){if(YV(e.path))return y.parse(e.path);if(xr(e.path))return y.file(e.path)}return e.path}function XD(e){if(typeof e.path=="object"){const t=y.revive(e.path);if(t)return t.scheme===q.file?t.fsPath:t.toString()}return e.path}function XV(e,t){const i=t?YD:XD,r=ot(e);return KD(r,(s,n)=>{s&&n&&(n.path=i(n))}),r}function KV(e,t){const i=t?YD:XD,r=ot(e);return KD(r,(s,n)=>{!s&&n&&(n.path=i(n))}),r}function KD(e,t){switch(e.type){case"event":{const i=e;switch(i.event){case"output":t(!1,i.body.source);break;case"loadedSource":t(!1,i.body.source);break;case"breakpoint":t(!1,i.body.breakpoint.source);break;default:break}break}case"request":{const i=e;switch(i.command){case"setBreakpoints":t(!0,i.arguments.source);break;case"breakpointLocations":t(!0,i.arguments.source);break;case"source":t(!0,i.arguments.source);break;case"gotoTargets":t(!0,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(r=>t(!1,r));break;default:break}break}case"response":{const i=e;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(r=>t(!1,r.source));break;case"loadedSources":i.body.sources.forEach(r=>t(!1,r));break;case"scopes":i.body.scopes.forEach(r=>t(!1,r.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(r=>t(!1,r.source));break;case"setBreakpoints":i.body.breakpoints.forEach(r=>t(!1,r.source));break;case"disassemble":i.body?.instructions.forEach(s=>t(!1,s.location));break;case"locations":t(!1,i.body?.source);break;default:break}break}}}var kl=H("IExtHostEditorTabs"),e8=class{constructor(e,t,i){this.e=i,this.d=t,this.acceptDtoUpdate(e)}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.id===e.e()},get label(){return e.b.label},get input(){return e.c},get isDirty(){return e.b.isDirty},get isPinned(){return e.b.isPinned},get isPreview(){return e.b.isPreview},get group(){return e.d.apiObject}};this.a=Object.freeze(t)}return this.a}get tabId(){return this.b.id}acceptDtoUpdate(e){this.b=e,this.c=this.f()}f(){switch(this.b.input.kind){case 1:return new yb(y.revive(this.b.input.uri));case 2:return new tg(y.revive(this.b.input.original),y.revive(this.b.input.modified));case 3:return new m7(y.revive(this.b.input.base),y.revive(this.b.input.input1),y.revive(this.b.input.input2),y.revive(this.b.input.result));case 6:return new Ab(y.revive(this.b.input.uri),this.b.input.viewType);case 7:return new v7(this.b.input.viewType);case 4:return new Sb(y.revive(this.b.input.uri),this.b.input.notebookType);case 5:return new Eb(y.revive(this.b.input.original),y.revive(this.b.input.modified),this.b.input.notebookType);case 8:return new w7;case 9:return new b7(y.revive(this.b.input.uri),y.revive(this.b.input.inputBoxUri));case 10:return new y7;case 11:return new A7(this.b.input.diffEditors.map(e=>new tg(y.revive(e.original),y.revive(e.modified))));default:return}}},eq=class{constructor(e,t){this.c=[],this.d="",this.b=e,this.e=t;for(const i of e.tabs)i.isActive&&(this.d=i.id),this.c.push(new e8(i,this,()=>this.activeTabId()))}get apiObject(){if(!this.a){const e=this,t={get isActive(){return e.b.groupId===e.e()},get viewColumn(){return Xt.to(e.b.viewColumn)},get activeTab(){return e.c.find(i=>i.tabId===e.d)?.apiObject},get tabs(){return Object.freeze(e.c.map(i=>i.apiObject))}};this.a=Object.freeze(t)}return this.a}get groupId(){return this.b.groupId}get tabs(){return this.c}acceptGroupDtoUpdate(e){this.b=e}acceptTabOperation(e){if(e.kind===0){const i=new e8(e.tabDto,this,()=>this.activeTabId());return this.c.splice(e.index,0,i),e.tabDto.isActive&&(this.d=i.tabId),i}else if(e.kind===1){const i=this.c.splice(e.index,1)[0];if(!i)throw new Error(`Tab close updated received for index ${e.index} which does not exist`);return i.tabId===this.d&&(this.d=""),i}else if(e.kind===3){if(e.oldIndex===void 0)throw new Error("Invalid old index on move IPC");const i=this.c.splice(e.oldIndex,1)[0];if(!i)throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`);return this.c.splice(e.index,0,i),i}const t=this.c.find(i=>i.tabId===e.tabDto.id);if(!t)throw new Error("INVALID tab");return e.tabDto.isActive?this.d=e.tabDto.id:this.d===e.tabDto.id&&!e.tabDto.isActive&&(this.d=""),t.acceptDtoUpdate(e.tabDto),t}activeTabId(){return this.d}},a4=class{constructor(t){this.b=new I,this.c=new I,this.e=[],this.a=t.getProxy(X.MainThreadEditorTabs)}get tabGroups(){if(!this.f){const t=this,i={onDidChangeTabGroups:t.c.event,onDidChangeTabs:t.b.event,get all(){return Object.freeze(t.e.map(r=>r.apiObject))},get activeTabGroup(){const r=t.d;return Xa(t.e.find(n=>n.groupId===r)?.apiObject)},close:async(r,s)=>{const n=Array.isArray(r)?r:[r];return n.length?tq(n[0])?this.j(n,s):this.i(n,s):!0}};this.f=Object.freeze(i)}return this.f}$acceptEditorTabModel(t){const i=new Set(this.e.map(l=>l.groupId)),r=new Set(t.map(l=>l.groupId)),s=DR(i,r),n=this.e.filter(l=>s.removed.includes(l.groupId)).map(l=>l.apiObject),o=[],a=[];this.e=t.map(l=>{const u=new eq(l,()=>this.d);return s.added.includes(u.groupId)?o.push(u.apiObject):a.push(u.apiObject),u});const c=Xa(t.find(l=>l.isActive===!0)?.groupId);c!==void 0&&this.d!==c&&(this.d=c),this.c.fire(Object.freeze({opened:o,closed:n,changed:a}))}$acceptTabGroupUpdate(t){const i=this.e.find(r=>r.groupId===t.groupId);if(!i)throw new Error("Update Group IPC call received before group creation.");i.acceptGroupDtoUpdate(t),t.isActive&&(this.d=t.groupId),this.c.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(t){const i=this.e.find(s=>s.groupId===t.groupId);if(!i)throw new Error("Update Tabs IPC call received before group creation.");const r=i.acceptTabOperation(t);switch(t.kind){case 0:this.b.fire(Object.freeze({opened:[r.apiObject],closed:[],changed:[]}));return;case 1:this.b.fire(Object.freeze({opened:[],closed:[r.apiObject],changed:[]}));return;case 3:case 2:this.b.fire(Object.freeze({opened:[],closed:[],changed:[r.apiObject]}));return}}g(t){for(const i of this.e)for(const r of i.tabs)if(r.apiObject===t)return r}h(t){return this.e.find(i=>i.apiObject===t)}async i(t,i){const r=[];for(const s of t){const n=this.g(s);if(!n)throw new Error("Tab close: Invalid tab not found!");r.push(n.tabId)}return this.a.$closeTab(r,i)}async j(t,i){const r=[];for(const s of t){const n=this.h(s);if(!n)throw new Error("Group close: Invalid group not found!");r.push(n.groupId)}return this.a.$closeGroup(r,i)}};a4=__decorate([__param(0,Ce)],a4);function tq(e){return e.tabs!==void 0}var iq=0,t8=new WeakMap,td=H("IExtHostTesting"),c4=class extends Q{constructor(t,i,r,s){super(),this.z=i,this.C=r,this.F=s,this.f=this.D(new I),this.g=new Map,this.q=this.D(new I),this.w=new Set,this.y=new Map,this.onResultsChanged=this.f.event,this.results=[],this.h=t.getProxy(X.MainThreadTesting),this.m=new cq(this.h),this.j=new nq(this.h,i),r.registerArgumentProcessor({processArgument:n=>{switch(n?.$mid){case 16:{const o=n,a=o.tests[o.tests.length-1].item.extId;return this.g.get(Ve.root(a))?.collection.tree.get(a)?.actual??w9(n)}case 18:{const{test:o,message:a}=n,c=o.item.extId;return{test:this.g.get(Ve.root(c))?.collection.tree.get(c)?.actual??w9({$mid:16,tests:[o]}),message:ll.to(a)}}default:return n}}}),r.registerCommand(!1,"testing.getExplorerSelection",async()=>{const n=await r.executeCommand("_testing.getExplorerSelection"),o=a=>{const c=this.g.get(Ve.root(a));if(c)return Ve.isRoot(a)?c.controller:c.collection.tree.get(a)?.actual};return{include:n?.include.map(o).filter(hr)||[],exclude:n?.exclude.map(o).filter(hr)||[]}})}createTestController(t,i,r,s){if(this.g.has(i))throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`);const n=new ie,o=n.add(new l_(i,r,this.F));o.root.label=r;const a=new Map,c=new Set,l=this.h,u=()=>{let p=0;s&&(p|=2);const g=f.relatedCodeProvider;return g&&(g?.provideRelatedTests&&(p|=8),g?.provideRelatedCode&&(p|=4)),p},h={items:o.root.children,get label(){return r},set label(p){r=p,o.root.label=p,l.$updateController(i,{label:r})},get refreshHandler(){return s},set refreshHandler(p){s=p,l.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return f.relatedCodeProvider},set relatedCodeProvider(p){T(t,"testRelatedCode"),f.relatedCodeProvider=p,l.$updateController(i,{capabilities:u()})},createRunProfile:(p,g,v,b,S,E)=>{let $=Xs(p);for(;a.has($);)$++;return new n8(this.h,a,c,this.q.event,i,$,p,g,v,b,S,E)},createTestItem(p,g,v){return new zh(i,p,g,v)},createTestRun:(p,g,v=!0)=>this.j.createTestRun(t,i,o,p,g,v),invalidateTestResults:p=>{if(p===void 0)this.h.$markTestRetired(void 0);else{const g=p instanceof Array?p:[p];this.h.$markTestRetired(g.map(v=>Ve.fromExtHostTestItem(v,i).toString()))}},set resolveHandler(p){o.resolveHandler=p},get resolveHandler(){return o.resolveHandler},dispose:()=>{n.dispose()}},f={controller:h,collection:o,profiles:a,extension:t,activeProfiles:c};return l.$registerTestController(i,r,u()),n.add(te(()=>l.$unregisterTestController(i))),this.g.set(i,f),n.add(te(()=>this.g.delete(i))),n.add(o.onDidGenerateDiff(p=>l.$publishDiff(i,p.map(tp.serialize)))),h}createTestObserver(){return this.m.checkout()}async runTests(t,i=Fe.None){const r=r8(t);if(!r)throw new Error("The request passed to `vscode.test.runTests` must include a profile");const s=this.g.get(r.controllerId);if(!s)throw new Error("Controller not found");await this.h.$runTests({preserveFocus:t.preserveFocus??!0,group:ul.from(r.kind),targets:[{testIds:t.include?.map(n=>Ve.fromExtHostTestItem(n,s.collection.root.id).toString())??[s.collection.root.id],profileId:r.profileId,controllerId:r.controllerId}],exclude:t.exclude?.map(n=>n.id)},i)}registerTestFollowupProvider(t){return this.w.add(t),{dispose:()=>{this.w.delete(t)}}}async $getTestsRelatedToCode(t,i,r){const s=this.F.getDocument(y.revive(t));if(!s)return[];const n=Xe.to(i),o=[];return await Promise.all([...this.g.values()].map(async a=>{let c;try{c=await a.relatedCodeProvider?.provideRelatedTests?.(s.document,n,r)}catch(l){r.isCancellationRequested||this.z.warn(`Error thrown while providing related tests for ${a.controller.label}`,l)}if(c){for(const l of c)o.push(Ve.fromExtHostTestItem(l,a.controller.id).toString());a.collection.flushDiff()}})),o}async $getCodeRelatedToTest(t,i){const r=this.g.get(Ve.root(t));if(!r)return[];const s=r.collection.tree.get(t);return s?(await r.relatedCodeProvider?.provideRelatedCode?.(s.actual,i))?.map(Hi.from)??[]:[]}$syncTests(){for(const{collection:t}of this.g.values())t.flushDiff();return Promise.resolve()}async $getCoverageDetails(t,i,r){return(await this.j.getCoverageDetails(t,i,r))?.map(xh.fromDetails)}async $disposeRun(t){this.j.disposeTestRun(t)}$configureRunProfile(t,i){this.g.get(t)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(t){const i=new Map;for(const[r,s]of Object.entries(t)){const n=this.g.get(r);if(!n)continue;const o=new Map,a=s.filter(l=>!n.activeProfiles.has(l)),c=[...n.activeProfiles].filter(l=>!s.includes(l));for(const l of a)o.set(l,!0),n.activeProfiles.add(l);for(const l of c)o.set(l,!1),n.activeProfiles.delete(l);o.size&&i.set(r,o)}this.q.fire(i)}async $refreshTests(t,i){await this.g.get(t)?.controller.refreshHandler?.(i)}$publishTestResults(t){this.results=Object.freeze(t.map(i=>{const r=dy.to(i),s=i.tasks.findIndex(n=>n.hasCoverage);return s!==-1&&(r.getDetailedCoverage=(n,o=Fe.None)=>this.h.$getCoverageDetails(i.id,s,n,o).then(a=>a.map(xh.to))),t8.set(r,i.id),r}).concat(this.results).sort((i,r)=>r.completedAt-i.completedAt).slice(0,32)),this.f.fire()}async $expandTest(t,i){const r=this.g.get(Ve.fromString(t).controllerId)?.collection;r&&(await r.expand(t,i<0?1/0:i),r.flushDiff())}$acceptDiff(t){this.m.applyDiff(t.map(i=>tp.deserialize({asCanonicalUri:r=>r},i)))}async $runControllerTests(t,i){return Promise.all(t.map(r=>this.G(r,!1,i)))}async $startContinuousRun(t,i){const r=new Qe(i),s=await Promise.all(t.map(n=>this.G(n,!0,r.token)));return!i.isCancellationRequested&&!s.some(n=>n.error)&&await new Promise(n=>i.onCancellationRequested(n)),r.dispose(!0),s}async $provideTestFollowups(t,i){const r=this.results.find(o=>t8.get(o)===t.resultId),s=r&&lq(Ve.fromString(t.extId),r?.results);if(!s)return[];let n=[];return await Promise.all([...this.w].map(async o=>{try{const a=await o.provideFollowup(r,s,t.taskIndex,t.messageIndex,i);a&&(n=n.concat(a))}catch(a){this.z.error("Error thrown while providing followup for test message",a)}})),i.isCancellationRequested?[]:n.map(o=>{const a=iq++;return this.y.set(a,o),{title:o.title,id:a}})}$disposeTestFollowups(t){for(const i of t)this.y.delete(i)}$executeTestFollowup(t){const i=this.y.get(t);return i?this.C.executeCommand(i.command,...i.arguments||[]):Promise.resolve()}$cancelExtensionTestRun(t,i){t===void 0?this.j.cancelAllRuns():this.j.cancelRunById(t,i)}getMetadataForRun(t){for(const i of this.j.trackers){const r=i.getTaskIdForRun(t);if(r)return{taskId:r,runId:i.id}}}async G(t,i,r){const s=this.g.get(t.controllerId);if(!s)return{};const{collection:n,profiles:o,extension:a}=s,c=o.get(t.profileId);if(!c)return{};const l=t.testIds.map(p=>n.tree.get(p)).filter(hr),u=t.excludeExtIds.map(p=>s.collection.tree.get(p)).filter(hr).filter(p=>l.some(g=>g.fullId.compare(p.fullId)===2));if(!l.length)return{};const h=new Qp(l.some(p=>p.actual instanceof oA)?void 0:l.map(p=>p.actual),u.map(p=>p.actual),c,i),f=GH(t)&&this.j.prepareForMainThreadTestRun(a,h,s8.fromInternal(t,s.collection),c,r);try{return await c.runHandler(h,r),{}}catch(p){return{error:String(p)}}finally{f&&f.hasRunningTasks&&!r.isCancellationRequested&&await Ie.toPromise(f.onEnd)}}};c4=__decorate([__param(0,Ce),__param(1,Se),__param(2,os),__param(3,La)],c4);var rq=1e4,i8;(function(e){e[e.Running=0]="Running",e[e.Cancelling=1]="Cancelling",e[e.Ended=2]="Ended"})(i8||(i8={}));var sq=class extends Q{get hasRunningTasks(){return this.g>0}get id(){return this.z.id}constructor(e,t,i,r,s,n){super(),this.z=e,this.C=t,this.F=i,this.G=r,this.H=s,this.f=0,this.g=0,this.h=new Map,this.j=new Set,this.q=this.D(new I),this.y=new Map,this.onEnd=this.q.event,this.m=this.D(new Qe(n));const o=this.D(new vs(()=>this.I(),rq));this.D(this.m.token.onCancellationRequested(()=>o.schedule()));const a=new I;this.w=a.event,this.D(te(()=>{a.fire(),a.dispose()}))}getTaskIdForRun(e){for(const[t,{run:i}]of this.h)if(i===e)return t}cancel(e){e?this.h.get(e)?.cts.cancel():this.f===0?(this.m.cancel(),this.f=1):this.f===1&&this.I()}async getCoverageDetails(e,t,i){const[,r]=Ve.fromString(e).path,s=this.y.get(e);if(!s)return[];const{report:n,extIds:o}=s,a=this.h.get(r);if(!a)throw new Error("unreachable: run task was not found");let c;if(t&&n instanceof eg){const u=o.indexOf(t);if(u===-1)return[];c=n.includesTests[u]}return await(c?this.G?.loadDetailedCoverageForTest?.(a.run,n,c,i):this.G?.loadDetailedCoverage?.(a.run,n,i))??[]}createRun(e){const t=this.z.id,i=this.z.controllerId,r=Tt(),s=l=>(u,...h)=>{if(o){this.F.warn(`Setting the state of test "${u.id}" is a no-op after the run ends.`);return}this.L(u),l(u,...h)},n=(l,u)=>{const h=u instanceof Array?u.map(ll.from):[ll.from(u)];if(l.uri&&l.range){const f={range:j.from(l.range),uri:l.uri};for(const p of h)p.location=p.location||f}this.C.$appendTestMessagesInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),h)};let o=!1;const a=this.D(new Qe(this.m.token)),c={isPersisted:this.z.isPersisted,token:a.token,name:e,onDidDispose:this.w,addCoverage:l=>{if(o)return;const u=l instanceof eg?l.includesTests:[];if(u.length)for(const p of u)this.L(p);const h=l.uri.toString(),f=new Ve([t,r,h]).toString();this.y.set(f,{report:l,extIds:u.map(p=>Ve.fromExtHostTestItem(p,i).toString())}),this.C.$appendCoverage(t,r,xh.fromFile(i,f,l))},enqueued:s(l=>{this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),1)}),skipped:s(l=>{this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),5)}),started:s(l=>{this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),2)}),errored:s((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),6,h)}),failed:s((l,u,h)=>{n(l,u),this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,i).toString(),4,h)}),passed:s((l,u)=>{this.C.$updateTestStateInRun(t,r,Ve.fromExtHostTestItem(l,this.z.controllerId).toString(),3,u)}),appendOutput:(l,u,h)=>{o||(h&&this.L(h),this.C.$appendOutputToRun(t,r,W.fromString(l),u&&Hi.from(u),h&&Ve.fromExtHostTestItem(h,i).toString()))},end:()=>{o||(o=!0,this.C.$finishedTestRunTask(t,r),--this.g||this.J())}};return this.g++,this.h.set(r,{run:c,cts:a}),this.C.$startedTestRunTask(t,{id:r,ctrlId:this.z.controllerId,name:e||this.H.displayName||this.H.identifier.value,running:!0}),c}I(){for(const{run:e}of this.h.values())e.end()}J(){this.f!==2&&(this.f=2,this.q.fire())}L(e){if(!(e instanceof zh))throw new fp(e.id);if(this.j.has(Ve.fromExtHostTestItem(e,this.z.controllerId).toString()))return;const t=[],i=this.z.colllection.root;for(;;){const r=po.from(e);if(t.unshift(r),this.j.has(r.extId)||(this.j.add(r.extId),e===i))break;e=e.parent||i}this.C.$addTestsToRun(this.z.controllerId,this.z.id,t)}dispose(){this.J(),super.dispose()}},nq=class{get trackers(){return this.f.values()}constructor(e,t){this.h=e,this.j=t,this.f=new Map,this.g=new Map}getCoverageDetails(e,t,i){const r=Ve.root(e);return this.g.get(r)?.getCoverageDetails(e,t,i)||[]}disposeTestRun(e){this.g.get(e)?.dispose(),this.g.delete(e);for(const[t,{id:i}]of this.f)i===e&&this.f.delete(t)}prepareForMainThreadTestRun(e,t,i,r,s){return this.k(t,i,r,e,s)}cancelRunById(e,t){this.g.get(e)?.cancel(t)}cancelAllRuns(){for(const e of this.f.values())e.cancel()}createTestRun(e,t,i,r,s,n){const o=this.f.get(r);if(o)return o.createRun(s);const a=s8.fromPublic(t,i,r,n),c=r8(r);this.h.$startedExtensionTestRun({controllerId:t,continuous:!!r.continuous,profile:c&&{group:ul.from(c.kind),id:c.profileId},exclude:r.exclude?.map(u=>Ve.fromExtHostTestItem(u,i.root.id).toString())??[],id:a.id,include:r.include?.map(u=>Ve.fromExtHostTestItem(u,i.root.id).toString())??[i.root.id],preserveFocus:r.preserveFocus??!0,persist:n});const l=this.k(r,a,r.profile,e);return Ie.once(l.onEnd)(()=>{this.h.$finishedExtensionTestRun(a.id)}),l.createRun(s)}k(e,t,i,r,s){const n=new sq(t,this.h,this.j,i,r,s);return this.f.set(e,n),this.g.set(n.id,n),n}},r8=e=>{if(e.profile){if(!(e.profile instanceof n8))throw new Error("TestRunRequest.profile is not an instance created from TestController.createRunProfile");return e.profile}},s8=class $5{static fromPublic(t,i,r,s){return new $5(t,Tt(),s,i)}static fromInternal(t,i){return new $5(t.controllerId,t.runId,!0,i)}constructor(t,i,r,s){this.controllerId=t,this.id=i,this.isPersisted=r,this.colllection=s}},oq=class{get isEmpty(){return this.f.size===0&&this.h.size===0&&this.g.size===0}constructor(e){this.k=e,this.f=new Set,this.g=new Set,this.h=new Set,this.j=new Set}add(e){this.f.add(e)}update(e){Object.assign(e.revived,po.toPlain(e.item)),this.f.has(e)||this.g.add(e)}remove(e){if(this.f.delete(e))return;this.g.delete(e);const t=Ve.parentId(e.item.extId);if(t&&this.j.has(t.toString())){this.j.add(e.item.extId);return}this.h.add(e)}getChangeEvent(){const{f:e,g:t,h:i}=this;return{get added(){return[...e].map(r=>r.revived)},get updated(){return[...t].map(r=>r.revived)},get removed(){return[...i].map(r=>r.revived)}}}complete(){this.isEmpty||this.k.fire(this.getChangeEvent())}},aq=class extends ZH{constructor(){super(...arguments),this.z=new I,this.onDidChangeTests=this.z.event}get rootTests(){return this.h}getMirroredTestDataById(e){return this.g.get(e)}getMirroredTestDataByReference(e){return this.g.get(e.id)}y(e,t){return{...e,revived:po.toPlain(e.item),depth:t?t.depth+1:0,children:new Set}}x(){return new oq(this.z)}},cq=class{constructor(e){this.g=e}checkout(){this.f||(this.f=this.h());const e=this.f;return e.observers++,{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(t=>t.revived)},dispose:pv(()=>{--e.observers===0&&(this.g.$unsubscribeFromDiffs(),this.f=void 0)})}}getMirroredTestDataByReference(e){return this.f?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.f?.tests.apply(e)}h(){const e=new aq({asCanonicalUri:t=>t});return this.g.$subscribeToDiffs(),{observers:0,tests:e}}},id=(e,t,i,r)=>{i?Object.assign(i,r):t.$updateTestRunConfig(e.controllerId,e.profileId,r)},n8=class extends d7{#e;#t;#i;#r;#n;get label(){return this.g}set label(e){e!==this.g&&(this.g=e,id(this,this.#e,this.#r,{label:e}))}get supportsContinuousRun(){return this.j}set supportsContinuousRun(e){e!==this.j&&(this.j=e,id(this,this.#e,this.#r,{supportsContinuousRun:e}))}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){e!==this.isDefault&&(e?this.#t.add(this.profileId):this.#t.delete(this.profileId),id(this,this.#e,this.#r,{isDefault:e}))}get tag(){return this._tag}set tag(e){e?.id!==this._tag?.id&&(this._tag=e,id(this,this.#e,this.#r,{tag:e?ns.namespace(this.controllerId,e.id):null}))}get configureHandler(){return this.f}set configureHandler(e){e!==this.f&&(this.f=e,id(this,this.#e,this.#r,{hasConfigurationHandler:!!e}))}get onDidChangeDefault(){return Ie.chain(this.#i,e=>e.map(t=>t.get(this.controllerId)?.get(this.profileId)).filter(hr))}constructor(e,t,i,r,s,n,o,a,c,l=!1,u=void 0,h=!1){super(s,n,a),this.g=o,this.runHandler=c,this._tag=u,this.j=h,this.#e=e,this.#n=t,this.#t=i,this.#i=r,t.set(n,this);const f=ul.from(a);l&&i.add(n),this.#r={profileId:n,controllerId:s,tag:u?ns.namespace(this.controllerId,u.id):null,label:o,group:f,isDefault:l,hasConfigurationHandler:!1,supportsContinuousRun:h},queueMicrotask(()=>{this.#r&&(this.#e.$publishTestRunProfile(this.#r),this.#r=void 0)})}dispose(){this.#n?.delete(this.profileId)&&(this.#n=void 0,this.#e.$removeTestProfile(this.controllerId,this.profileId)),this.#r=void 0}};function lq(e,t){for(let i=0;i<e.path.length;i++){const r=t.find(s=>s.id===e.path[i]);if(!r)return;if(i===e.path.length-1)return r;t=r.children}}var Mse=H("configurationResolverService"),ht;(function(e){e.Unknown="unknown",e.Env="env",e.Config="config",e.Command="command",e.Input="input",e.ExtensionInstallFolder="extensionInstallFolder",e.WorkspaceFolder="workspaceFolder",e.Cwd="cwd",e.WorkspaceFolderBasename="workspaceFolderBasename",e.UserHome="userHome",e.LineNumber="lineNumber",e.ColumnNumber="columnNumber",e.SelectedText="selectedText",e.File="file",e.FileWorkspaceFolder="fileWorkspaceFolder",e.FileWorkspaceFolderBasename="fileWorkspaceFolderBasename",e.RelativeFile="relativeFile",e.RelativeFileDirname="relativeFileDirname",e.FileDirname="fileDirname",e.FileExtname="fileExtname",e.FileBasename="fileBasename",e.FileBasenameNoExtension="fileBasenameNoExtension",e.FileDirnameBasename="fileDirnameBasename",e.ExecPath="execPath",e.ExecInstallFolder="execInstallFolder",e.PathSeparator="pathSeparator",e.PathSeparatorAlias="/"})(ht||(ht={}));var uq=Object.values(ht).filter(e=>typeof e=="string"),Bi=class extends Wr{constructor(e,t){super(t),this.variable=e}},o8=class I5{static{this.VARIABLE_LHS="${"}constructor(t){this.a=new Map,this.d=new Set,typeof t=="string"?(this.c=!0,this.b={value:t}):(this.c=!1,this.b=structuredClone(t))}static parse(t){if(t instanceof I5)return t;const i=new I5(t);return i.e(),i.g(i.b),i}e(){const t=this.b,i=ze?"windows":Dt?"osx":$t?"linux":void 0;i&&t&&typeof t=="object"&&t.hasOwnProperty(i)&&Object.keys(t[i]).forEach(r=>t[r]=t[i][r]),delete t.windows,delete t.osx,delete t.linux}f(t,i){if(t[i]!=="$"||t[i+1]!=="{")return;let r=i+2,s=1;for(;r<t.length;){if(t[r]==="{")s++;else if(t[r]==="}"&&(s--,s===0))break;r++}if(s!==0)return;const n=t.slice(i,r+1),o=t.substring(i+2,r),a=o.indexOf(":");return a===-1?{replacement:{id:n,name:o,inner:o},end:r}:{replacement:{id:n,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:r}}g(t){if(!(typeof t!="object"||t===null)){if(Array.isArray(t)){for(let i=0;i<t.length;i++){const r=t[i];typeof r=="string"?this.h(t,i,r):this.g(r)}return}for(const[i,r]of Object.entries(t))this.h(t,i,i,!0),typeof r=="string"?this.h(t,i,r):this.g(r)}}h(t,i,r,s,n){let o=0;for(;o<r.length;){const a=r.indexOf("${",o);if(a===-1)break;const c=this.f(r,a);if(c){if(o=c.end+1,n?.includes(c.replacement.id))continue;const l=this.a.get(c.replacement.id)||{locations:[],replacement:c.replacement},u={object:t,propertyName:i,replaceKeyName:s};l.locations.push(u),this.a.set(c.replacement.id,l),l.resolved?this.j(c.replacement,u,l.resolved,n):this.d.forEach(h=>h(c.replacement))}else o=a+2}}*unresolved(){const t=new Map,i=r=>{t.set(r.id,r)};for(const r of this.a.values())r.resolved===void 0&&t.set(r.replacement.id,r.replacement);for(this.d.add(i);;){const r=Wt.first(t);if(!r)break;const[s,n]=r;yield n,t.delete(s)}this.d.delete(i)}resolved(){return Wt.map(Wt.filter(this.a.values(),t=>!!t.resolved),t=>[t.replacement,t.resolved])}resolve(t,i){typeof i!="object"&&(i={value:String(i)});const r=this.a.get(t.id);if(r&&(r.resolved=i,i.value!==void 0))for(const s of r.locations||Wt.empty())this.j(t,s,i)}j(t,{replaceKeyName:i,propertyName:r,object:s},n,o=[]){if(n.value!==void 0){if(o.push(t.id),i&&typeof r=="string"){const a=s[r],c=r.replaceAll(t.id,n.value);delete s[r],s[c]=a,this.m(s,r,c),this.h(s,c,n.value,!0,o)}else s[r]=s[r].replaceAll(t.id,n.value),this.h(s,r,n.value,!1,o);o.pop()}}m(t,i,r){for(const s of this.a.values())for(const n of s.locations)n.object===t&&n.propertyName===i&&(n.propertyName=r)}toObject(){return this.c?this.b.value:this.b}},hq=class{constructor(e,t,i,r){this.h=new Map,this.resolvableVariables=new Set(uq),this.a=e,this.b=t,this.g=i,r&&(this.c=r.then(s=>this.i(s)))}i(e){if(ze){const t=Object.create(null);return Object.keys(e).forEach(i=>{t[i.toLowerCase()]=e[i]}),t}return e}async resolveWithEnvironment(e,t,i){const r=o8.parse(i);for(const s of r.unresolved()){const n=await this.l(s,t?.uri,e);n!==void 0&&r.resolve(s,String(n))}return r.toObject()}async resolveAsync(e,t){const i=o8.parse(t);for(const r of i.unresolved()){const s=await this.l(r,e?.uri);s!==void 0&&i.resolve(r,String(s))}return i.toObject()}resolveWithInteractionReplace(e,t){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,t){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,t){if(this.h.has(e))throw new Error("Variable "+e+" is contributed twice.");this.resolvableVariables.add(e),this.h.set(e,t)}j(e){return this.b?this.b.getUriLabel(e,{noPrefix:!0}):e.fsPath}async l(e,t,i,r){const s={env:i!==void 0?this.i(i):await this.c,userHome:i!==void 0?void 0:await this.g},{name:n,arg:o}=e,a=u=>{const h=this.a.getFilePath();if(h)return Wh(h);throw new Bi(u,d(15285,null,e.id))},c=u=>{const h=a(u);if(this.a.getWorkspaceFolderPathForFile){const f=this.a.getWorkspaceFolderPathForFile();if(f)return Wh(f)}throw new Bi(u,d(15286,null,e.id,At(h)))},l=u=>{if(o){const h=this.a.getFolderUri(o);if(h)return h;throw new Bi(u,d(15287,null,u,o))}if(t)return t;throw this.a.getWorkspaceFolderCount()>1?new Bi(u,d(15288,null,u)):new Bi(u,d(15289,null,u))};switch(n){case"env":if(o){if(s.env){const u=s.env[ze?o.toLowerCase():o];if(Oe(u))return u}return""}throw new Bi(ht.Env,d(15290,null,e.id));case"config":if(o){const u=this.a.getConfigurationValue(t,o);if(Ht(u))throw new Bi(ht.Config,d(15291,null,e.id,o));if(yt(u))throw new Bi(ht.Config,d(15292,null,e.id,o));return u}throw new Bi(ht.Config,d(15293,null,e.id));case"command":return this.m(ht.Command,e.id,o,r,"command");case"input":return this.m(ht.Input,e.id,o,r,"input");case"extensionInstallFolder":if(o){const u=await this.a.getExtension(o);if(!u)throw new Bi(ht.ExtensionInstallFolder,d(15294,null,e.id,o));return this.j(u.extensionLocation)}throw new Bi(ht.ExtensionInstallFolder,d(15295,null,e.id));default:switch(n){case"workspaceRoot":case"workspaceFolder":{const u=l(ht.WorkspaceFolder);return u?Wh(this.j(u)):void 0}case"cwd":{if(!t&&!o)return Fo();const u=l(ht.Cwd);return u?Wh(this.j(u)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const u=l(ht.WorkspaceFolderBasename);return u?Wh(At(this.j(u))):void 0}case"userHome":if(s.userHome)return s.userHome;throw new Bi(ht.UserHome,d(15296,null,e.id));case"lineNumber":{const u=this.a.getLineNumber();if(u)return u;throw new Bi(ht.LineNumber,d(15297,null,e.id))}case"columnNumber":{const u=this.a.getColumnNumber();if(u)return u;throw new Error(d(15298,null,e.id))}case"selectedText":{const u=this.a.getSelectedText();if(u)return u;throw new Bi(ht.SelectedText,d(15299,null,e.id))}case"file":return a(ht.File);case"fileWorkspaceFolder":return c(ht.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return At(c(ht.FileWorkspaceFolderBasename));case"relativeFile":return t||o?tc(this.j(l(ht.RelativeFile)),a(ht.RelativeFile)):a(ht.RelativeFile);case"relativeFileDirname":{const u=Mi(a(ht.RelativeFileDirname));if(t||o){const h=tc(this.j(l(ht.RelativeFileDirname)),u);return h.length===0?".":h}return u}case"fileDirname":return Mi(a(ht.FileDirname));case"fileExtname":return Xd(a(ht.FileExtname));case"fileBasename":return At(a(ht.FileBasename));case"fileBasenameNoExtension":{const u=At(a(ht.FileBasenameNoExtension));return u.slice(0,u.length-Xd(u).length)}case"fileDirnameBasename":return At(Mi(a(ht.FileDirnameBasename)));case"execPath":{const u=this.a.getExecPath();return u||e.id}case"execInstallFolder":{const u=this.a.getAppRoot();return u||e.id}case"pathSeparator":case"/":return St;default:try{return this.m(ht.Unknown,e.id,o,r,void 0)}catch{return e.id}}}}m(e,t,i,r,s){if(i&&r){const n=s===void 0?r[i]:r[s+":"+i];if(typeof n=="string")return n;throw new Bi(e,d(15300,null,t))}return t}},Oa=H("IExtHostVariableResolverProvider"),dq=class extends hq{constructor(e,t,i,r,s,n,o){function a(){if(i){const c=i.activeEditor();if(c)return c.document.uri;const l=r.tabGroups.all.find(u=>u.isActive)?.activeTab;if(l!==void 0){if(l.input instanceof tg||l.input instanceof Eb)return l.input.modified;if(l.input instanceof yb||l.input instanceof Sb||l.input instanceof Ab)return l.input.uri}}}super({getFolderUri:c=>{const l=n.folders.filter(u=>u.name===c);if(l&&l.length>0)return l[0].uri},getWorkspaceFolderCount:()=>n.folders.length,getConfigurationValue:(c,l)=>s.getConfiguration(void 0,c).get(l),getAppRoot:()=>Fo(),getExecPath:()=>Mn.VSCODE_EXEC_PATH,getFilePath:()=>{const c=a();if(c)return Zs(c.fsPath)},getWorkspaceFolderPathForFile:()=>{if(t){const c=a();if(c){const l=t.getWorkspaceFolder(c);if(l)return Zs(l.uri.fsPath)}}},getSelectedText:()=>{if(i){const c=i.activeEditor();if(c&&!c.selection.isEmpty)return c.document.getText(c.selection)}},getLineNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.line+1)}},getColumnNumber:()=>{if(i){const c=i.activeEditor();if(c)return String(c.selection.end.character+1)}},getExtension:c=>e.getExtension(c)},void 0,o?Promise.resolve(o):void 0,Promise.resolve(Mn))}},Rm=class extends Q{constructor(t,i,r,s,n){super(),this.b=t,this.c=i,this.g=r,this.h=s,this.j=n,this.a=new Pt(async()=>{const o=await this.h.getConfigProvider(),c={folders:await this.c.getWorkspaceFolders2()||[]};return this.D(this.c.onDidChangeWorkspace(async l=>{c.folders=await this.c.getWorkspaceFolders2()||[]})),new dq(this.b,this.c,this.g,this.j,o,c,this.m())})}getResolver(){return this.a.value}m(){}};Rm=__decorate([__param(0,fn),__param(1,Nr),__param(2,La),__param(3,vr),__param(4,kl)],Rm);var l4=H("IExtHostDebugService"),Lm=class extends Q{get onDidStartDebugSession(){return this.w.event}get onDidTerminateDebugSession(){return this.y.event}get onDidChangeActiveDebugSession(){return this.z.event}get activeDebugSession(){return this.C?.api}get onDidReceiveDebugSessionCustomEvent(){return this.F.event}get activeDebugConsole(){return this.G.value}constructor(t,i,r,s,n,o,a,c){super(),this.Z=i,this.$=r,this.ab=s,this.bb=n,this.cb=o,this.db=a,this.eb=c,this.u=new Map,this.O=0,this.P=new Map,this.Q=new Map,this.R=new WeakMap,this.S=new Map,this.W=new Map,this.X=0,this.f=0,this.g=[],this.h=0,this.j=[],this.m=0,this.n=[],this.M=new Map,this.N=new Map,this.w=this.D(new I),this.y=this.D(new I),this.z=this.D(new I),this.F=this.D(new I),this.q=t.getProxy(X.MainThreadDebugService),this.I=this.D(new I),this.L=this.D(new I),this.G=new pq(this.q),this.H=new Map,this.$.getExtensionRegistry().then(l=>{this.D(l.onDidChange(u=>{this.gb(l)})),this.gb(l)}),this.Y=t.getProxy(X.MainThreadTelemetry)}async $getVisualizerTreeItem(t,i){const r=this.hb(i);if(!r)return;const s=await this.Q.get(t)?.getTreeItem?.(r);return s?this.fb(t,s):void 0}registerDebugVisualizationTree(t,i,r){const s=Ye.toKey(t.identifier),n=this.zb(s,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.Q.set(n,r),this.q.$registerDebugVisualizerTree(n,!!r.editItem),te(()=>{this.q.$unregisterDebugVisualizerTree(n),this.Q.delete(i)})}async $getVisualizerTreeItemChildren(t,i){const r=this.S.get(i)?.item;return r?(await this.Q.get(t)?.getChildren?.(r))?.map(n=>this.fb(t,n))||[]:[]}async $editVisualizerTreeItem(t,i){const r=this.S.get(t);if(!r)return;const s=await this.Q.get(r.provider)?.editItem?.(r.item,i);return this.fb(r.provider,s||r.item)}$disposeVisualizedTree(t){const i=this.S.get(t);if(!i)return;const r=[i.children];for(const s of r)if(s)for(const n of s)r.push(this.S.get(n)?.children),this.S.delete(n)}fb(t,i){let r=this.R.get(i);return r||(r=this.O++,this.R.set(i,r),this.S.set(r,{provider:t,item:i})),Py.from(i,r)}asDebugSourceUri(t,i){const r=t;if(typeof r.sourceReference=="number"&&r.sourceReference>0){let s=`debug:${encodeURIComponent(r.path||"")}`,n="?";return i&&(s+=`${n}session=${encodeURIComponent(i.id)}`,n="&"),s+=`${n}ref=${r.sourceReference}`,y.parse(s)}else{if(r.path)return y.file(r.path);throw new Error("cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.")}}gb(t){const i=[];for(const r of t.getAllExtensionDescriptions())if(r.contributes){const s=r.contributes.debuggers;if(s&&s.length>0)for(const n of s)JV(n)&&i.push(n.type)}this.q.$registerDebugTypes(i)}get activeStackItem(){return this.J}get onDidChangeActiveStackItem(){return this.L.event}get onDidChangeBreakpoints(){return this.I.event}get breakpoints(){const t=[];return this.H.forEach(i=>t.push(i)),t}async $resolveDebugVisualizer(t,i){const r=this.W.get(t);if(!r)throw new Error(`No debug visualizer found with id '${t}'`);let{v:s,provider:n,extensionId:o}=r;if(s.visualization||(s=await n.resolveDebugVisualization?.(s,i)||s,r.v=s),!s.visualization)throw new Error(`No visualization returned from resolveDebugVisualization in '${n}'`);return this.Ab(o,s.visualization)}async $executeDebugVisualizerCommand(t){const i=this.W.get(t);if(!i)throw new Error(`No debug visualizer found with id '${t}'`);const r=i.v.visualization;r&&"command"in r&&this.db.executeCommand(r.command,...r.arguments||[])}hb(t){const i=this.u.get(t.sessionId);return i&&{session:i.api,variable:t.variable,containerId:t.containerId,frameId:t.frameId,threadId:t.threadId}}async $provideDebugVisualizers(t,i,r,s){const n=this.hb(r),o=this.zb(t,i),a=this.P.get(o);if(!n||!a)return[];const c=await a.provideDebugVisualization(n,s);return c?c.map(l=>{const u=++this.X;this.W.set(u,{v:l,provider:a,extensionId:t});const h=l.iconPath?this.Bb(l.iconPath):void 0;return{id:u,name:l.name,iconClass:h?.iconClass,iconPath:h?.iconPath,visualization:this.Ab(t,l.visualization)}}):[]}$disposeDebugVisualizers(t){for(const i of t)this.W.delete(i)}registerDebugVisualizationProvider(t,i,r){if(!t.contributes?.debugVisualizers?.some(o=>o.id===i))throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`);const s=Ye.toKey(t.identifier),n=this.zb(s,i);if(this.P.has(n))throw new Error(`A debug visualization provider with id '${i}' is already registered`);return this.P.set(n,r),this.q.$registerDebugVisualizer(s,i),te(()=>{this.q.$unregisterDebugVisualizer(s,i),this.P.delete(i)})}addBreakpoints(t){const i=t.filter(n=>{const o=n.id;return this.H.has(o)?!1:(this.H.set(o,n),!0)});this.wb(i,[],[]);const r=[],s=new Map;for(const n of i)if(n instanceof va){let o=s.get(n.location.uri.toString());o||(o={type:"sourceMulti",uri:n.location.uri,lines:[]},s.set(n.location.uri.toString(),o),r.push(o)),o.lines.push({id:n.id,enabled:n.enabled,condition:n.condition,hitCondition:n.hitCondition,logMessage:n.logMessage,line:n.location.range.start.line,character:n.location.range.start.character,mode:n.mode})}else n instanceof wa&&r.push({type:"function",id:n.id,enabled:n.enabled,hitCondition:n.hitCondition,logMessage:n.logMessage,condition:n.condition,functionName:n.functionName,mode:n.mode});return this.q.$registerBreakpoints(r)}removeBreakpoints(t){const i=t.filter(o=>this.H.delete(o.id));this.wb([],i,[]);const r=i.filter(o=>o instanceof va).map(o=>o.id),s=i.filter(o=>o instanceof wa).map(o=>o.id),n=i.filter(o=>o instanceof Fp).map(o=>o.id);return this.q.$unregisterBreakpoints(r,s,n)}startDebugging(t,i,r){const s=r.testRun&&this.eb.getMetadataForRun(r.testRun);return this.q.$startDebugging(t?t.uri:void 0,i,{parentSessionID:r.parentSession?r.parentSession.id:void 0,lifecycleManagedByParent:r.lifecycleManagedByParent,repl:r.consoleMode===Bp.MergeWithParent?"mergeWithParent":"separate",noDebug:r.noDebug,compact:r.compact,suppressSaveBeforeStart:r.suppressSaveBeforeStart,testRun:s&&{runId:s.runId,taskId:s.taskId},suppressDebugStatusbar:r.suppressDebugStatusbar??r.debugUI?.simple,suppressDebugToolbar:r.suppressDebugToolbar??r.debugUI?.simple,suppressDebugView:r.suppressDebugView??r.debugUI?.simple})}stopDebugging(t){return this.q.$stopDebugging(t?t.id:void 0)}registerDebugConfigurationProvider(t,i,r){if(!i)return new ke(()=>{});const s=this.f++;return this.g.push({type:t,handle:s,provider:i}),this.q.$registerDebugConfigurationProvider(t,r,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,s),new ke(()=>{this.g=this.g.filter(n=>n.provider!==i),this.q.$unregisterDebugConfigurationProvider(s)})}registerDebugAdapterDescriptorFactory(t,i,r){if(!r)return new ke(()=>{});if(!this.sb(t,i))throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`);if(this.pb(i))throw new Error("a DebugAdapterDescriptorFactory can only be registered once per a type.");const s=this.h++;return this.j.push({type:i,handle:s,factory:r}),this.q.$registerDebugAdapterDescriptorFactory(i,s),new ke(()=>{this.j=this.j.filter(n=>n.factory!==r),this.q.$unregisterDebugAdapterDescriptorFactory(s)})}registerDebugAdapterTrackerFactory(t,i){if(!i)return new ke(()=>{});const r=this.m++;return this.n.push({type:t,handle:r,factory:i}),new ke(()=>{this.n=this.n.filter(s=>s.factory!==i)})}async $runInTerminal(t,i){return Promise.resolve(void 0)}async $substituteVariables(t,i){let r;const s=await this.yb(t);return s&&(r={uri:s.uri,name:s.name,index:s.index}),(await this.cb.getResolver()).resolveAsync(r,i)}ib(t,i){if(t instanceof th)return new mq(t.implementation)}jb(){}async $startDASession(t,i){const r=this,s=await this.xb(i);return this.ub(this.pb(s.type),s).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}' (extension might have failed to activate)`);const o=this.ib(n,s);if(!o)throw new Error(`Couldn't create a debug adapter for type '${s.type}'.`);const a=o;return this.M.set(t,a),this.tb(s).then(c=>(c&&this.N.set(t,c),a.onMessage(async l=>{if(l.type==="request"&&l.command==="handshake"){const u=l,h={type:"response",seq:0,command:u.command,request_seq:u.seq,success:!0};this.U||(this.U=this.jb());try{if(this.U){const f=await this.U.sign(u.arguments.value);h.body={signature:f},a.sendResponse(h)}else throw new Error("no signer")}catch(f){h.success=!1,h.message=f.message,a.sendResponse(h)}}else{c&&c.onDidSendMessage&&c.onDidSendMessage(l);try{l=KV(l,!0)}catch(u){const h=l.type+"_"+(l.command??l.event??"");throw this.Y.$publicLog2("debugProtocolMessageError",{type:h,from:s.type}),u}r.q.$acceptDAMessage(t,l)}}),a.onError(l=>{c&&c.onError&&c.onError(l),this.q.$acceptDAError(t,l.name,l.message,l.stack)}),a.onExit(l=>{c&&c.onExit&&c.onExit(l??void 0,void 0),this.q.$acceptDAExit(t,l??void 0,void 0)}),c&&c.onWillStartSession&&c.onWillStartSession(),a.startSession()))})}$sendDAMessage(t,i){i=XV(i,!1);const r=this.N.get(t);r&&r.onWillReceiveMessage&&r.onWillReceiveMessage(i),this.M.get(t)?.sendMessage(i)}$stopDASession(t){const i=this.N.get(t);this.N.delete(t),i&&i.onWillStopSession&&i.onWillStopSession();const r=this.M.get(t);return this.M.delete(t),r?r.stopSession():Promise.resolve(void 0)}$acceptBreakpointsDelta(t){const i=[],r=[],s=[];if(t.added)for(const n of t.added){const o=n.id;if(o&&!this.H.has(o)){let a;if(n.type==="function")a=new wa(n.functionName,n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode);else if(n.type==="data")a=new Fp(n.label,n.dataId,n.canPersist,n.enabled,n.hitCondition,n.condition,n.logMessage,n.mode);else{const c=y.revive(n.uri);a=new va(new rr(c,new Pe(n.line,n.character)),n.enabled,n.condition,n.hitCondition,n.logMessage,n.mode)}WW(a,o),this.H.set(o,a),i.push(a)}}if(t.removed)for(const n of t.removed){const o=this.H.get(n);o&&(this.H.delete(n),r.push(o))}if(t.changed){for(const n of t.changed)if(n.id){const o=this.H.get(n.id);if(o){if(o instanceof wa&&n.type==="function"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.functionName=n.functionName}else if(o instanceof va&&n.type==="source"){const a=o;a.enabled=n.enabled,a.condition=n.condition,a.hitCondition=n.hitCondition,a.logMessage=n.logMessage,a.location=new rr(y.revive(n.uri),new Pe(n.line,n.character))}s.push(o)}}}this.wb(i,r,s)}async $acceptStackFrameFocus(t){let i;if(t){const r=await this.xb(t.sessionId);t.kind==="thread"?i=new l7(r.api,t.threadId):i=new c7(r.api,t.threadId,t.frameId)}this.J=i,this.L.fire(this.J)}$provideDebugConfigurations(t,i,r){return di(async()=>{const s=this.rb(t);if(!s)throw new Error("no DebugConfigurationProvider found");if(!s.provideDebugConfigurations)throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations");const n=await this.yb(i);return s.provideDebugConfigurations(n,r)}).then(s=>{if(!s)throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations");return s})}$resolveDebugConfiguration(t,i,r,s){return di(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfiguration)throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration");const o=await this.yb(i);return n.resolveDebugConfiguration(o,r,s)})}$resolveDebugConfigurationWithSubstitutedVariables(t,i,r,s){return di(async()=>{const n=this.rb(t);if(!n)throw new Error("no DebugConfigurationProvider found");if(!n.resolveDebugConfigurationWithSubstitutedVariables)throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables");const o=await this.yb(i);return n.resolveDebugConfigurationWithSubstitutedVariables(o,r,s)})}async $provideDebugAdapter(t,i){const r=this.qb(t);if(!r)return Promise.reject(new Error("no adapter descriptor factory found for handle"));const s=await this.xb(i);return this.ub(r,s).then(n=>{if(!n)throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}'`);return this.kb(n)})}async $acceptDebugSessionStarted(t){const i=await this.xb(t);this.w.fire(i.api)}async $acceptDebugSessionTerminated(t){const i=await this.xb(t);i&&(this.y.fire(i.api),this.u.delete(i.id))}async $acceptDebugSessionActiveChanged(t){this.C=t?await this.xb(t):void 0,this.z.fire(this.C?.api)}async $acceptDebugSessionNameChanged(t,i){(await this.xb(t))?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(t,i){const s={session:(await this.xb(t)).api,event:i.event,body:i.body};this.F.fire(s)}kb(t){if(t instanceof Vc)return this.lb(t);if(t instanceof qc)return this.mb(t);if(t instanceof eh)return this.nb(t);if(t instanceof th)return this.ob(t);throw new Error("convertToDto unexpected type")}lb(t){return{type:"executable",command:t.command,args:t.args,options:t.options}}mb(t){return{type:"server",port:t.port,host:t.host}}nb(t){return{type:"pipeServer",path:t.path}}ob(t){return{type:"implementation"}}pb(t){const i=this.j.filter(r=>r.type===t);if(i.length>0)return i[0].factory}qb(t){const i=this.j.filter(r=>r.handle===t);if(i.length>0)return i[0].factory}rb(t){const i=this.g.filter(r=>r.handle===t);if(i.length>0)return i[0].provider}sb(t,i){if(t.contributes){const r=t.contributes.debuggers;if(r&&r.length>0){for(const s of r)if(s.label&&s.type&&s.type===i)return!0}}return!1}tb(t){const r=t.configuration.type,s=this.n.filter(n=>n.type===r||n.type==="*").map(n=>di(()=>n.factory.createDebugAdapterTracker(t.api)).then(o=>o,o=>null));return Promise.race([Promise.all(s).then(n=>{const o=gt(n);if(o.length>0)return new gq(o)}),new Promise(n=>setTimeout(()=>n(void 0),1e3))]).catch(n=>{})}async ub(t,i){const r=i.configuration.debugServer;if(typeof r=="number")return Promise.resolve(new qc(r));if(t){const n=await this.$.getExtensionRegistry();return di(()=>t.createDebugAdapterDescriptor(i.api,this.vb(i,n))).then(o=>{if(o)return o})}const s=await this.$.getExtensionRegistry();return Promise.resolve(this.vb(i,s))}vb(t,i){}wb(t,i,r){(t.length>0||i.length>0||r.length>0)&&this.I.fire(Object.freeze({added:t,removed:i,changed:r}))}async xb(t){if(t)if(typeof t=="string"){const i=this.u.get(t);if(i)return i}else{let i=this.u.get(t.id);if(!i){const r=await this.yb(t.folderUri),s=t.parent?this.u.get(t.parent):void 0;i=new fq(this.q,t.id,t.type,t.name,r,t.configuration,s?.api),this.u.set(i.id,i),this.q.$sessionCached(i.id)}return i}throw new Error("cannot find session")}yb(t){if(t){const i=y.revive(t);return this.Z.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}zb(t,i){return`${t}\0${i}`}Ab(t,i){if(i){if("title"in i&&"command"in i)return{type:0};if("treeId"in i)return{type:1,id:`${t}\0${i.treeId}`};throw new Error("Unsupported debug visualization type")}}Bb(t){const i=this.Cb(t);let r,s;return"id"in i?s=Nt.asClassName(i):r=i,{iconPath:r,iconClass:s}}Cb(t){if(t instanceof Di)return{id:t.id};const i=typeof t=="object"&&"dark"in t?t.dark:t,r=typeof t=="object"&&"light"in t?t.light:t;return{dark:typeof i=="string"?y.file(i):i,light:typeof r=="string"?y.file(r):r}}};Lm=__decorate([__param(0,Ce),__param(1,Nr),__param(2,fn),__param(3,vr),__param(4,kl),__param(5,Oa),__param(6,os),__param(7,td)],Lm);var fq=class{constructor(e,t,i,r,s,n,o){this.f=e,this.g=t,this.h=i,this.j=r,this.k=s,this.l=n,this.m=o}get api(){const e=this;return this.d??=Object.freeze({id:e.g,type:e.h,get name(){return e.j},set name(t){e.j=t,e.f.$setDebugSessionName(e.g,t)},parentSession:e.m,workspaceFolder:e.k,configuration:e.l,customRequest(t,i){return e.f.$customDebugAdapterRequest(e.g,t,i)},getDebugProtocolBreakpoint(t){return e.f.$getDebugProtocolBreakpoint(e.g,t.id)}})}get id(){return this.g}get type(){return this.h}_acceptNameChanged(e){this.j=e}get configuration(){return this.l}},pq=class{constructor(e){this.value=Object.freeze({append(t){e.$appendDebugConsole(t)},appendLine(t){this.append(t+`
`)}})}},gq=class{constructor(e){this.d=e}onWillStartSession(){this.d.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.d.forEach(t=>t.onWillReceiveMessage?t.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.d.forEach(t=>t.onDidSendMessage?t.onDidSendMessage(e):void 0)}onWillStopSession(){this.d.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.d.forEach(t=>t.onError?t.onError(e):void 0)}onExit(e,t){this.d.forEach(i=>i.onExit?i.onExit(e,t):void 0)}},mq=class extends QD{constructor(e){super(),this.h=e,e.onDidSendMessage(t=>{this.acceptMessage(t)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.h.handleMessage(e)}stopSession(){return this.h.dispose(),Promise.resolve(void 0)}},u4=class extends Lm{constructor(t,i,r,s,n,o,a,c){super(t,i,r,s,n,o,a,c)}};u4=__decorate([__param(0,Ce),__param(1,Nr),__param(2,fn),__param(3,vr),__param(4,kl),__param(5,Oa),__param(6,os),__param(7,td)],u4);function vq(e){return"uri"in e&&"ranges"in e&&"preview"in e}function wq(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,session:e.session}))}var a8=class{constructor(e){this.a=e}provideFileSearchResults(e,t,i){return(async()=>{const s=wq(t);return Promise.all(s.map(n=>this.a.provideFileSearchResults({pattern:e},n,i)))})().then(s=>gt(s).flat())}};function bq(e){return e.folderOptions.map(t=>({folder:t.folder,excludes:t.excludes.map(i=>typeof i=="string"?i:i.pattern),includes:t.includes,useGlobalIgnoreFiles:t.useIgnoreFiles.global,useIgnoreFiles:t.useIgnoreFiles.local,useParentIgnoreFiles:t.useIgnoreFiles.parent,followSymlinks:t.followSymlinks,maxResults:e.maxResults,previewOptions:c8(e.previewOptions),maxFileSize:e.maxFileSize,encoding:t.encoding,afterContext:e.surroundingContext,beforeContext:e.surroundingContext}))}function c8(e){return{matchLines:e?.matchLines??jy.matchLines,charsPerLine:e?.charsPerLine??jy.charsPerLine}}function yq(e){if(vq(e)){const t=Sr(e.ranges).map((i,r)=>{const n=Sr(e.preview.matches)[r];return{sourceRange:i,previewRange:n}});return new ln(e.uri,t,e.preview.text)}else return new Yg(e.uri,e.text,e.lineNumber)}var Aq=class{constructor(e){this.a=e}provideTextSearchResults(e,t,i,r){const s=a=>{Sq(a)&&i.report(yq(a))};return(async()=>gt(await Promise.all(bq(t).map(a=>this.a.provideTextSearchResults(e,a,{report:c=>s(c)},r)))).reduce((a,c)=>({limitHit:a.limitHit||c.limitHit}),{limitHit:!1}))().then(a=>({limitHit:a.limitHit,message:gt(Sr(a.message))}))}};function Sq(e){if(Eq(e)){if(Array.isArray(e.ranges)){if(!Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type."),!1;if(e.preview.matches.length!==e.ranges.length)return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}else if(Array.isArray(e.preview.matches))return console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length."),!1}return!0}function Eq(e){return!!e.preview}var l8=class extends Vn{constructor(e,t,i=()=>!1){const r=new dC(i,()=>!1);super(r);const s=new zt;e.forEach((n,o)=>{const a=n.folder.with({query:"",fragment:""});s.has(a)?s.get(a).push({fq:n,i:o}):s.set(a,[{fq:n,i:o}])}),s.forEach((n,o)=>{const a=new Map;for(const c of n){const l=t(c.fq,c.i);a.set(this.m(c.fq.folder),l)}super.set(o,a)})}findQueryFragmentAwareSubstr(e){const t=super.findSubstr(e.with({query:"",fragment:""}));if(!t)return;const i=this.m(e);return t.get(i)}forEachFolderQueryInfo(e){return this.forEach(t=>t.forEach(i=>e(i)))}m(e){let t="";return e.query&&(t+=e.query),e.fragment&&(t+="#"+e.fragment),t}},xq=class{constructor(e,t,i){this.l=e,this.o=t,this.p=i,this.f=!1,this.g=0,this.h=!1,this.a=e.filePattern,this.b=e.includePattern&&Kr(e.includePattern),this.c=e.maxResults||void 0,this.d=e.exists,this.j=new Set,this.k=e.excludePattern&&Kr(e.excludePattern)}cancel(){this.h=!0,this.j.forEach(e=>e.cancel()),this.j=new Set}search(e){const t=this.l.folderQueries||[];return new Promise((i,r)=>{const s=n=>{this.g++,e(n)};if(this.h)return i({limitHit:this.f});this.l.extraFileResources&&this.l.extraFileResources.forEach(n=>{const o=n.toString(),a=At(o);this.k&&this.k(o,a)||this.w(s,{base:n,basename:a})}),this.q(t,s).then(n=>{i({limitHit:this.f,stats:n||void 0})},n=>{r(new Error(ys(n)))})})}async q(e,t){const i=new Qe,r=e.map(l=>this.r(l)),s=this.o instanceof a8?this.p?.tokenSource.token:this.p?.obj,n={folderOptions:r,maxResults:this.l.maxResults??Kg,session:s},o=l=>{const u=new Q7(this.l,l),h=!u.hasSiblingExcludeClauses();return{queryTester:u,noSiblingsClauses:h,folder:l.folder,tree:this.s()}},a=new l8(e,o);let c;try{this.j.add(i),c=Ji.create();const l=await this.o.provideFileSearchResults(this.l.filePattern||"",n,i.token),u=c.elapsed(),h=Ji.create();return this.h&&!this.f||(l&&l.forEach(f=>{const p=a.findQueryFragmentAwareSubstr(f),g=Be.relative(p.folder.path,f.path);if(p.noSiblingsClauses){const v=At(f.path);this.w(t,{base:p.folder,relativePath:g,basename:v});return}this.u(p.tree,p.folder,g,t)}),this.h&&!this.f)?null:(a.forEachFolderQueryInfo(f=>{this.v(f.tree,f.queryTester,t)}),{providerTime:u,postProcessTime:h.elapsed()})}finally{i.dispose(),this.j.delete(i)}}r(e){const t=ml(this.l.includePattern,e.includePattern);let i=e.excludePattern?.map(s=>({folder:s.folder,patterns:ml(this.l.excludePattern,s.pattern)}));i?.length||(i=[{folder:void 0,patterns:ml(this.l.excludePattern,void 0)}]);const r=X7(i);return{folder:e.folder,excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}s(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}u({pathToEntries:e},t,i,r){if(i===this.a){const n=At(this.a);this.w(r,{base:t,relativePath:this.a,basename:n})}function s(n){const o=At(n),a=Mi(n);let c=e[a];c||(c=e[a]=[],s(a)),c.push({base:t,relativePath:n,basename:o})}s(i)}v({rootEntries:e,pathToEntries:t},i,r){const s=this,n=this.a;function o(a){const c=Uy(()=>a.map(l=>l.basename));for(let l=0,u=a.length;l<u;l++){const h=a[l],{relativePath:f,basename:p}=h;if(i.matchesExcludesSync(f,p,n!==p?c:void 0))continue;const g=t[f];if(g)o(g);else{if(f===n)continue;s.w(r,h)}if(s.f)break}}o(e)}w(e,t){(!this.b||t.relativePath&&this.b(t.relativePath,t.basename))&&((this.d||this.c&&this.g>=this.c)&&(this.f=!0,this.cancel()),this.f||e(t))}},kq=class{constructor(){this.a=new Object,this.tokenSource=new Qe}get obj(){if(this.a)return this.a;throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel(),this.a=void 0}},Cq=class kN{constructor(){this.b=new Map}static{this.a=512}fileSearch(t,i,r,s){const n=this.c(t.cacheKey),o=new xq(t,i,n);let a=0;const c=l=>{a+=l.length,r(l.map(u=>this.d(u)))};return this.f(o,kN.a,c,s).then(l=>({limitHit:l.limitHit,stats:l.stats?{fromCache:!1,type:"fileSearchProvider",resultCount:a,detailStats:l.stats}:void 0,messages:[]}))}clearCache(t){this.b.get(t)?.cancel(),this.b.delete(t)}c(t){if(t)return this.b.has(t)||this.b.set(t,new kq),this.b.get(t)}d(t){return t.relativePath?{resource:It(t.base,t.relativePath)}:{resource:t.base}}f(t,i,r,s){const n=s.onCancellationRequested(()=>{t.cancel()}),o=c=>{c&&(a.push(c),i>0&&a.length>=i&&(r(a),a=[]))};let a=[];return t.search(o).then(c=>(a.length&&r(a),n.dispose(),c),c=>(a.length&&r(a),n.dispose(),Promise.reject(c)))}},h4=class{constructor(e,t,i){this.f=e,this.g=t,this.h=i,this.b=null,this.c=!1,this.d=0}get j(){return this.f.query}search(e,t,i){const r=this.j.folderQueries||[],s=new Qe(t);return new Promise((n,o)=>{this.b=new Iq(e);let a=!1;const c=(l,u)=>{if(!(l instanceof Ry)&&!a&&!this.c){const h=this.l(l);l instanceof ln&&typeof this.j.maxResults=="number"&&this.d+h>this.j.maxResults&&(this.c=!0,a=!0,s.cancel(),l=this.m(l,this.j.maxResults-this.d));const f=this.l(l);this.d+=f;const p=l instanceof ln;(f>0||!p)&&this.b.add(l,u)}};this.n(r,c,s.token,i).then(l=>{s.dispose(),this.b.flush(),n({limitHit:this.c||l?.limitHit,messages:this.k(l),stats:{type:this.h}})},l=>{s.dispose();const u=ys(l);o(new Error(u))})})}k(e){return e?.message?Array.isArray(e.message)?e.message:[e.message]:[]}l(e){return e instanceof ln?Array.isArray(e.ranges)?e.ranges.length:1:0}m(e,t){return new ln(e.uri,e.ranges.slice(0,t),e.previewText)}async n(e,t,i,r){const s=new l8(e,(u,h)=>({queryTester:new Q7(this.j,u),folder:u.folder,folderIdx:h}),()=>!0),n=[],o={report:u=>{if(u instanceof Ry)r?.(u);else{if(u.uri===void 0)throw Error("Text search result URI is undefined. Please check provider implementation.");const h=s.findQueryFragmentAwareSubstr(u.uri),f=h.folder.scheme===q.file?hB(()=>this.g.readdir(ou(u.uri))):void 0,p=tx(h.folder,u.uri);if(p){const g=h.queryTester.includedInQuery(p,At(p),f);Fn(g)?n.push(g.then(v=>{v&&t(u,h.folderIdx)})):g&&t(u,h.folderIdx)}}}},c={folderOptions:e.map(u=>this.o(u)),maxFileSize:this.j.maxFileSize,maxResults:this.j.maxResults??Kg,previewOptions:this.j.previewOptions??jy,surroundingContext:this.j.surroundingContext??0};"usePCRE2"in this.j&&(c.usePCRE2=this.j.usePCRE2);let l;return this.f.query.type===3?l=await this.f.provider.provideAITextSearchResults(this.f.query.contentPattern,c,o,i):l=await this.f.provider.provideTextSearchResults($q(this.f.query.contentPattern),c,o,i),n.length&&await Promise.all(n),l}o(e){const t=ml(this.j.includePattern,e.includePattern);let i=e.excludePattern?.map(n=>({folder:n.folder,patterns:ml(this.j.excludePattern,n.pattern)}));(!i||i.length===0)&&(i=[{folder:void 0,patterns:ml(this.j.excludePattern,void 0)}]);const r=X7(i);return{folder:y.from(e.folder),excludes:r,includes:t,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.g.toCanonicalName(e.fileEncoding))??""}}};function $q(e){return{isCaseSensitive:e.isCaseSensitive||!1,isRegExp:e.isRegExp||!1,isWordMatch:e.isWordMatch||!1,isMultiline:e.isMultiline||!1,pattern:e.pattern}}var Iq=class{constructor(e){this.g=e,this.c=-1,this.f=null,this.b=new Pq(512,t=>this.j(t))}add(e,t){this.f&&(this.c!==t||!nc(this.d,e.uri))&&(this.h(),this.f=null),this.f||(this.c=t,this.f={resource:e.uri,results:[]}),this.f.results.push(Dq(e))}h(){const e=this.f&&this.f.results?this.f.results.length:0;this.b.addItem(this.f,e)}flush(){this.h(),this.b.flush()}j(e){this.g(e)}};function Dq(e){return e instanceof ln?{previewText:e.previewText,rangeLocations:e.ranges.map(t=>({preview:{startLineNumber:t.previewRange.start.line,startColumn:t.previewRange.start.character,endLineNumber:t.previewRange.end.line,endColumn:t.previewRange.end.character},source:{startLineNumber:t.sourceRange.start.line,startColumn:t.sourceRange.start.character,endLineNumber:t.sourceRange.end.line,endColumn:t.sourceRange.end.character}}))}:{text:e.text,lineNumber:e.lineNumber}}var Pq=class D5{static{this.b=4e3}static{this.c=50}constructor(t,i){this.j=t,this.k=i,this.d=0,this.f=[],this.g=0}addItem(t,i){t&&this.l(t,i)}addItems(t,i){t&&this.m(t,i)}l(t,i){this.f.push(t),this.g+=i,this.n()}m(t,i){this.f=this.f.concat(t),this.g+=i,this.n()}n(){this.d<D5.c?this.flush():this.g>=this.j?this.flush():this.h||(this.h=setTimeout(()=>{this.flush()},D5.b))}flush(){this.g&&(this.d+=this.g,this.k(this.f),this.f=[],this.g=0,this.h&&(clearTimeout(this.h),this.h=void 0))}},d4=H("IExtHostSearch"),Om=class{constructor(t,i,r){this.o=t,this.q=i,this.s=r,this.c=this.o.getProxy(X.MainThreadSearch),this.e=0,this.g=new Map,this.h=new Set,this.i=new Map,this.j=new Set,this.k=new Map,this.l=new Set,this.n=new Cq}t(t){return this.q.transformOutgoingScheme(t)}registerTextSearchProviderOld(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const r=this.e++;return this.g.set(r,new Aq(i)),this.c.$registerTextSearchProvider(r,this.t(t)),te(()=>{this.h.delete(t),this.g.delete(r),this.c.$unregisterProvider(r)})}registerTextSearchProvider(t,i){if(this.h.has(t))throw new Error(`a text search provider for the scheme '${t}' is already registered`);this.h.add(t);const r=this.e++;return this.g.set(r,i),this.c.$registerTextSearchProvider(r,this.t(t)),te(()=>{this.h.delete(t),this.g.delete(r),this.c.$unregisterProvider(r)})}registerAITextSearchProvider(t,i){if(this.j.has(t))throw new Error(`an AI text search provider for the scheme '${t}'is already registered`);this.j.add(t);const r=this.e++;return this.i.set(r,i),this.c.$registerAITextSearchProvider(r,this.t(t)),te(()=>{this.j.delete(t),this.i.delete(r),this.c.$unregisterProvider(r)})}registerFileSearchProviderOld(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const r=this.e++;return this.k.set(r,new a8(i)),this.c.$registerFileSearchProvider(r,this.t(t)),te(()=>{this.l.delete(t),this.k.delete(r),this.c.$unregisterProvider(r)})}registerFileSearchProvider(t,i){if(this.l.has(t))throw new Error(`a file search provider for the scheme '${t}' is already registered`);this.l.add(t);const r=this.e++;return this.k.set(r,i),this.c.$registerFileSearchProvider(r,this.t(t)),te(()=>{this.l.delete(t),this.k.delete(r),this.c.$unregisterProvider(r)})}$provideFileSearchResults(t,i,r,s){const n=Fm(r),o=this.k.get(t);if(o)return this.n.fileSearch(n,o,a=>{this.c.$handleFileMatch(t,i,a.map(c=>c.resource))},s);throw new Error("unknown provider: "+t)}async doInternalFileSearchWithCustomCallback(t,i,r){return{messages:[]}}$clearCache(t){return this.n.clearCache(t),Promise.resolve(void 0)}$provideTextSearchResults(t,i,r,s){const n=this.g.get(t);if(!n||!n.provideTextSearchResults)throw new Error(`Unknown Text Search Provider ${t}`);const o=Fm(r);return this.v(o,n).search(c=>this.c.$handleTextMatch(t,i,c),s)}$provideAITextSearchResults(t,i,r,s){const n=this.i.get(t);if(!n||!n.provideAITextSearchResults)throw new Error(`Unknown AI Text Search Provider ${t}`);const o=Fm(r);return this.w(o,n).search(c=>this.c.$handleTextMatch(t,i,c),s,c=>this.c.$handleKeywordResult(t,i,c))}$enableExtensionHostSearch(){}async $getAIName(t){const i=this.i.get(t);if(!(!i||!i.provideAITextSearchResults))return i.name??"AI"}v(t,i){return new h4({query:t,provider:i},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"textSearchProvider")}w(t,i){return new h4({query:t,provider:i},{readdir:r=>Promise.resolve([]),toCanonicalName:r=>r},"aiTextSearchProvider")}};Om=__decorate([__param(0,Ce),__param(1,wu),__param(2,Se)],Om);function Fm(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(Tq),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function Tq(e){return Gt(e)}var Um=class extends qU{constructor(t,i){super(i.logLevel,i.logsLocation,i.loggers.map(r=>Gt(r))),this.c=t.getProxy(X.MainThreadLogger)}$setLogLevel(t,i){i?this.setLogLevel(y.revive(i),t):this.setLogLevel(t)}setVisibility(t,i){super.setVisibility(t,i),this.c.$setVisibility(t,i)}s(t,i,r){return new Mq(this.c,t,i,r)}};Um=__decorate([__param(0,Ce),__param(1,Ft)],Um);var Mq=class extends k0{constructor(e,t,i,r){super(r?.logLevel==="always"),this.r=e,this.s=t,this.n=!1,this.q=[],this.setLevel(i),this.r.$createLogger(t,r).then(()=>{this.u(this.q),this.n=!0})}m(e,t){const i=[[e,t]];this.n?this.u(i):this.q.push(...i)}u(e){this.r.$log(this.s,e)}flush(){this.r.$flush(this.s)}},f4=H("IExtHostTerminalShellIntegration"),p4=class extends Q{constructor(t,i){super(),this.h=i,this.b=new Map,this.c=new I,this.onDidChangeTerminalShellIntegration=this.c.event,this.f=new I,this.onDidStartTerminalShellExecution=this.f.event,this.g=new I,this.onDidEndTerminalShellExecution=this.g.event,this.a=t.getProxy(X.MainThreadTerminalShellIntegration),this.D(te(()=>{for(const[r,s]of this.b)s.dispose();this.b.clear()}))}$shellIntegrationChange(t,i){const r=this.h.getTerminalById(t);if(!r)return;const s=r.value;let n=this.b.get(t);n||(n=new Nq(r.value,i,this.f),this.b.set(t,n),n.store.add(r.onWillDispose(()=>this.b.get(t)?.dispose())),n.store.add(n.onDidRequestShellExecution(o=>this.a.$executeCommand(t,o))),n.store.add(n.onDidRequestEndExecution(o=>this.g.fire(o))),n.store.add(n.onDidRequestChangeShellIntegration(o=>this.c.fire(o))),r.shellIntegration=n.value),this.c.fire({terminal:s,shellIntegration:n.value})}$shellExecutionStart(t,i,r,s,n,o){this.b.has(t)||this.$shellIntegrationChange(t,i);const a={value:r,confidence:s,isTrusted:n};this.b.get(t)?.startShellExecution(a,this.j(o))}$shellExecutionEnd(t,i,r,s,n){const o={value:i,confidence:r,isTrusted:s};this.b.get(t)?.endShellExecution(o,n)}$shellExecutionData(t,i){this.b.get(t)?.emitData(i)}$shellEnvChange(t,i,r,s){this.b.get(t)?.setEnv(i,r,s)}$cwdChange(t,i){this.b.get(t)?.setCwd(this.j(i))}$closeTerminal(t){this.b.get(t)?.dispose(),this.b.delete(t)}j(t){return t?y.file(t):void 0}};p4=__decorate([__param(0,Ce),__param(1,dn)],p4);var Nq=class extends Q{get currentExecution(){return this.f}constructor(e,t,i){super(),this.r=e,this.s=i,this.a=[],this.store=this.D(new ie),this.j=this.D(new I),this.onDidRequestChangeShellIntegration=this.j.event,this.m=this.D(new I),this.onDidRequestShellExecution=this.m.event,this.n=this.D(new I),this.onDidRequestEndExecution=this.n.event,this.q=this.D(new I),this.onDidRequestNewExecution=this.q.event;const r=this;this.value={get cwd(){return r.h},get env(){if(r.g)return Object.freeze({isTrusted:r.g.isTrusted,value:Object.freeze({...r.g.value})})},executeCommand(s,n){if(!t)throw new Error("This terminal does not support the executeCommand API.");let o=s;if(n)for(const l of n)!l.match(/["'`]/)&&l.match(/\s/)?o+=` "${l}"`:o+=` ${l}`;r.m.fire(o);const a={value:o,confidence:Yu.High,isTrusted:!0};return r.requestNewShellExecution(a,r.h).value}}}requestNewShellExecution(e,t){const i=new u8(e,t??this.h);return jm(e.value).length>1&&(this.c={isMultiLine:!0,unresolvedCommandLines:jm(e.value)}),this.a.push(i),this.q.fire(e.value),i}startShellExecution(e,t){if(this.b&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.b.value,exitCode:void 0}),this.b=void 0),this.f){if(this.c?.isMultiLine&&this.c.unresolvedCommandLines){const r=h8(this.c.unresolvedCommandLines,e);if(r){this.c.unresolvedCommandLines=r.unresolvedCommandLines;return}}this.f.endExecution(void 0),this.f.flush(),this.n.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value,exitCode:void 0})}let i;if(e.confidence===Yu.High)for(const[r,s]of this.a.entries())if(s.value.commandLine.value===e.value){i=s,this.c={isMultiLine:!1,unresolvedCommandLines:void 0},i=s,this.a.splice(r,1);break}else{const n=h8(jm(s.value.commandLine.value),e);if(n){this.c={isMultiLine:!0,unresolvedCommandLines:n.unresolvedCommandLines},i=s,this.a.splice(r,1);break}}else i=this.a.shift();i||(i=new u8(e,t??this.h)),this.f=i,this.s.fire({terminal:this.r,shellIntegration:this.value,execution:this.f.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,t){if(!(this.c?.isMultiLine&&this.c.unresolvedCommandLines&&this.c.unresolvedCommandLines.length>0)&&this.f){const i=this.c?.isMultiLine?this.f.value.commandLine:e;this.f.endExecution(i);const r=this.f;this.b=r,this.f=void 0,r.flush().then(()=>{this.b===r&&(this.n.fire({terminal:this.r,shellIntegration:this.value,execution:r.value,exitCode:t}),this.b=void 0)})}}setEnv(e,t,i){const r={};for(let s=0;s<e.length;s++)r[e[s]]=t[s];this.g={value:r,isTrusted:i},this.t()}setCwd(e){let t=!1;y.isUri(this.h)?t=!y.isUri(e)||this.h.toString()!==e.toString():this.h!==e&&(t=!0),t&&(this.h=e,this.t())}t(){this.j.fire({terminal:this.r,shellIntegration:this.value})}},u8=class{constructor(e,t){this.c=e,this.cwd=t,this.b=!1;const i=this;this.value={get commandLine(){return i.c},get cwd(){return i.cwd},read(){return i.d()}}}d(){if(!this.a){if(this.b)return Wv.EMPTY;this.a=new Rq}return this.a.createIterable()}emitData(e){this.b||this.a?.emitData(e)}endExecution(e){e&&(this.c=e),this.a?.endExecution(),this.b=!0}async flush(){this.a&&(await this.a.flush(),this.a.dispose(),this.a=void 0)}},Rq=class extends Q{constructor(){super(...arguments),this.b=[],this.c=[]}createIterable(){this.a||(this.a=new fr);const e=this.a,t=new Wv(async i=>{this.c.push(i),await e.wait()});return this.b.push(t),t}emitData(e){for(const t of this.c)t.emitOne(e)}endExecution(){this.a?.open()}async flush(){await Promise.all(this.b.map(e=>e.toPromise()))}};function jm(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0)}function h8(e,t){if(e.length===0)return!1;const i=[...e],r=jm(t.value);if(i&&i.length>0){for(;i.length>0&&i[0]===r[0];)i.shift(),r.shift();if(r.length===0)return{unresolvedCommandLines:i}}return!1}var d8;(function(e){e[e.CR=13]="CR",e[e.LF=10]="LF",e[e.COLON=58]="COLON",e[e.SPACE=32]="SPACE"})(d8||(d8={}));var g4=class{constructor(e){this.a="",this.b="",this.f=[],this.g=!1,this.h=e,this.i=new TextDecoder("utf-8")}getLastEventId(){return this.d}getReconnectionTime(){return this.e}feed(e){if(e.length===0)return;let t=0;for(this.g&&e[0]===10&&t++,this.g=!1;t<e.length;){const i=e.indexOf(13,t),r=e.indexOf(10,t),s=i===-1?r:r===-1?i:Math.min(i,r);if(s===-1)break;let n="";for(const o of this.f)n+=this.i.decode(o,{stream:!0});n+=this.i.decode(e.subarray(t,s)),this.j(n),this.f.length=0,t=s+(e[s]===13&&e[s+1]===10?2:1)}t<e.length?this.f.push(e.subarray(t)):this.g=e[e.length-1]===13}j(e){if(!e.length){this.l();return}if(e.startsWith(":"))return;let t,i;const r=e.indexOf(":");r===-1?(t=e,i=""):(t=e.substring(0,r),i=e.substring(r+1),i.startsWith(" ")&&(i=i.substring(1))),this.k(t,i)}k(e,t){switch(e){case"event":this.b=t;break;case"data":this.a+=t,this.a+=`
`;break;case"id":t.includes("\0")?this.c=void 0:this.c=this.d=t;break;case"retry":/^\d+$/.test(t)&&(this.e=parseInt(t,10));break}}l(){if(this.a===""){this.a="",this.b="";return}this.a.endsWith(`
`)&&(this.a=this.a.substring(0,this.a.length-1));const e={type:this.b||"message",data:this.a};this.c!==void 0&&(e.id=this.c),this.e!==void 0&&(e.retry=this.e),this.h(e),this.reset()}reset(){this.a="",this.b="",this.c=void 0}},m4=class{validateOrThrow(e){const t=this.validate(e);if(t.error)throw new Error(t.error.message);return t.content}},zm=class extends m4{constructor(e){super(),this.a=e}validate(e){return typeof e!==this.a?{content:void 0,error:{message:`Expected ${this.a}, but got ${typeof e}`}}:{content:e,error:void 0}}getJSONSchema(){return{type:this.a}}},Lq=new zm("string");function Hm(){return Lq}var Oq=new zm("number");function Fq(){return Oq}var jse=new zm("boolean"),Uq=new zm("object");function v4(){return Uq}var w4=class{constructor(e){this.validator=e}};function Cl(e){return new w4(e)}var jq=class extends m4{constructor(e){super(),this.a=e}validate(e){if(typeof e!="object"||e===null)return{content:void 0,error:{message:"Expected object"}};const t={};for(const i in this.a){const r=this.a[i],s=e[i],n=r instanceof w4,o=n?r.validator:r;if(n&&s===void 0)continue;const{content:a,error:c}=o.validate(s);if(c)return{content:void 0,error:{message:`Error in property '${i}': ${c.message}`}};t[i]=a}return{content:t,error:void 0}}getJSONSchema(){const e=[],t={};for(const[r,s]of Object.entries(this.a)){const n=s instanceof w4,o=n?s.validator:s;t[r]=o.getJSONSchema(),n||e.push(r)}return{type:"object",properties:t,...e.length>0?{required:e}:{}}}};function Wm(e){return new jq(e)}var zq=class extends m4{constructor(e){super(),this.a=e}validate(e){if(!Array.isArray(e))return{content:void 0,error:{message:"Expected array"}};const t=[];for(let i=0;i<e.length;i++){const{content:r,error:s}=this.a.validate(e[i]);if(s)return{content:void 0,error:{message:`Error in element ${i}: ${s.message}`}};t.push(r)}return{content:t,error:void 0}}getJSONSchema(){return{type:"array",items:this.a.getJSONSchema()}}};function f8(e){return new zq(e)}var Bm=H("IExtHostMpcService"),Hq=Wm({label:Hm(),version:Cl(Hm()),metadata:Cl(Wm({capabilities:Cl(v4()),serverInfo:Cl(v4()),tools:Cl(f8(Wm({availability:Fq(),definition:v4()})))})),authentication:Cl(Wm({providerId:Hm(),scopes:f8(Hm())}))}),_m=class extends Q{constructor(t,i,r,s,n){super(),this.h=i,this.j=r,this.n=s,this.q=n,this.c=new Set,this.f=this.D(new Mo),this.g=new Map,this.b=t.getProxy(X.MainThreadMcp)}$startMcp(t,i){this.r(t,Mu.fromSerialized(i.launch),i.defaultCwd&&y.revive(i.defaultCwd),i.errorOnUserInteraction)}r(t,i,r,s){if(i.type===2){this.f.set(t,new g8(t,i,this.b,this.h,s));return}throw new Error("not implemented")}async $substituteVariables(t,i){const r=y.revive(t),s=r&&await this.n.resolveWorkspaceFolder(r);return(await this.q.getResolver()).resolveAsync(s&&{uri:s.uri,name:s.name,index:s.index},i)}$stopMcp(t){this.f.get(t)?.close().then(()=>this.u(t))}u(t){this.f.deleteAndDispose(t)}$sendMessage(t,i){this.f.get(t)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this.c)}async $resolveMcpLaunch(t,i){const r=this.g.get(t);if(!r)return;const s=r.servers.find(o=>o.label===i);if(!s)return;if(!r.provider.resolveMcpServerDefinition)return Nh.from(s);const n=await r.provider.resolveMcpServerDefinition(s,Fe.None);return n?Nh.from(n):void 0}registerMcpConfigurationProvider(t,i,r){const s=new ie,n=t.contributes?.mcpServerDefinitionProviders?.find(l=>l.id===i);if(!n)throw new Error(`MCP configuration providers must be registered in the contributes.mcpServerDefinitionProviders array within your package.json, but "${i}" was not`);const o={id:mH(t.identifier,i),isTrustedByDefault:!0,label:n?.label??t.displayName??t.name,scope:1,canResolveLaunch:typeof r.resolveMcpServerDefinition=="function",extensionId:t.identifier.value,configTarget:this.j.remote.isRemote?4:2},a=async()=>{const l=await r.provideMcpServerDefinitions(Fe.None);this.g.set(o.id,{servers:l??[],provider:r});const u=[];for(const h of l??[]){let f=Ye.toKey(t.identifier)+"/"+h.label;if(u.some(v=>v.id===f)){let v=2;for(;u.some(b=>b.id===f+v);)v++;f=f+v}Hq.validateOrThrow(h),h.authentication&&T(t,"mcpToolDefinitions");let p;const g=h;et(t,"mcpToolDefinitions")&&g.metadata&&(p={capabilities:g.metadata.capabilities,instructions:g.metadata.instructions,serverInfo:g.metadata.serverInfo,tools:g.metadata.tools?.map(v=>({availability:v.availability===gg.Dynamic?1:0,definition:v.definition}))}),u.push({id:f,label:h.label,cacheNonce:h.version||"$$NONE",staticMetadata:p,launch:Nh.from(h)})}this.b.$upsertMcpCollection(o,u)};s.add(te(()=>{this.g.delete(o.id),this.b.$deleteMcpCollection(o.id)})),r.onDidChangeMcpServerDefinitions&&s.add(r.onDidChangeMcpServerDefinitions(a)),r.onDidChangeServerDefinitions&&s.add(r.onDidChangeServerDefinitions(a)),r.onDidChange&&s.add(r.onDidChange(a));const c=new Promise(l=>{setTimeout(()=>a().finally(()=>{this.c.delete(c),l()}),0)});return this.c.add(c),s}};_m=__decorate([__param(0,Ce),__param(1,Se),__param(2,Ft),__param(3,Nr),__param(4,Oa)],_m);var p8;(function(e){e[e.Unknown=0]="Unknown",e[e.Http=1]="Http",e[e.SSE=2]="SSE"})(p8||(p8={}));var Wq=5,Bq=[301,302,303,307,308],g8=class extends Q{constructor(e,t,i,r,s){super(),this.q=e,this.r=t,this.u=i,this.w=r,this.y=s,this.b=new V2,this.c=new Ni,this.f={value:0},this.g=new Qe,this.h=new AbortController,this.n=!1,this.D(te(()=>{this.h.abort(),this.g.dispose(!0)})),this.u.$onDidChangeState(this.q,{state:2})}async send(e){try{this.f.value===0?await this.b.queue(()=>this.C(e)):await this.C(e)}catch(t){const i=`Error sending message to ${this.r.uri}: ${String(t)}`;this.u.$onDidChangeState(this.q,{state:3,message:i})}}async close(){if(this.f.value===1&&this.f.sessionId&&!this.n){this.n=!0;try{await this.z(this.f.sessionId)}catch{}}this.u.$onDidChangeState(this.q,{state:0})}async z(e){const t={...Object.fromEntries(this.r.headers),"Mcp-Session-Id":e};await this.N(t),await this.R(this.r.uri.toString(!0),{method:"DELETE",headers:t})}C(e){return this.f.value===2?this.L(this.f.endpoint,e):this.F(e,this.f.value===1?this.f.sessionId:void 0)}async F(e,t){const i=new TextEncoder().encode(e),r={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length),Accept:"text/event-stream, application/json"};t&&(r["Mcp-Session-Id"]=t),await this.N(r);const s=await this.Q(this.r.uri.toString(!0),{method:"POST",headers:r,body:i},r),n=this.f.value===0,o=s.headers.get("Mcp-Session-Id");if(o&&(this.f={value:1,sessionId:o}),this.f.value===0&&s.status>=400&&s.status<500&&!b4(s.status)){this.O(Y.Info,`${s.status} status sending message to ${this.r.uri}, will attempt to fall back to legacy SSE`),this.G(e);return}if(s.status>=300){const a=this.f.value===1&&!!this.f.sessionId&&(s.status===400||s.status===404);this.u.$onDidChangeState(this.q,{state:3,message:`${s.status} status sending message to ${this.r.uri}: ${await this.P(s)}`+(a?"; will retry with new session ID":""),shouldRetry:a});return}this.f.value===0&&(this.f={value:1,sessionId:void 0}),n&&this.I(),await this.H(s,e)}async G(e){const t=await this.J();t&&(this.f={value:2,endpoint:t},await this.L(t,e))}async H(e,t){if(e.status===202)return;const i=e.headers.get("Content-Type")?.toLowerCase()||"";if(i.startsWith("text/event-stream")){const r=new g4(s=>{if(s.type==="message")this.u.$onDidReceiveMessage(this.q,s.data);else if(s.type==="endpoint")throw this.O(Y.Warning,`Received SSE endpoint from a POST to ${this.r.uri}, will fall back to legacy SSE`),this.G(t),new dt});try{await this.M(r,e)}catch(s){this.O(Y.Warning,`Error reading SSE stream: ${String(s)}`)}}else if(i.startsWith("application/json"))this.u.$onDidReceiveMessage(this.q,await e.text());else{const r=await e.text();_q(r)?this.u.$onDidReceiveMessage(this.q,r):this.O(Y.Warning,`Unexpected ${e.status} response for request: ${r}`)}}async I(){let e,t;for(let i=0;!this.B.isDisposed;i++){t!==void 0?(await ri(Math.max(0,t-Date.now()),this.g.token),t=void 0):await ri(Math.min(i*1e3,3e4),this.g.token);let r;try{const n={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(n),this.f.value===1&&this.f.sessionId!==void 0&&(n["Mcp-Session-Id"]=this.f.sessionId),e&&(n["Last-Event-ID"]=e),r=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:n},n)}catch{this.O(Y.Info,`Error connecting to ${this.r.uri} for async notifications, will retry`);continue}if(r.status>=400){this.O(Y.Debug,`${r.status} status connecting to ${this.r.uri} for async notifications; they will be disabled: ${await this.P(r)}`);return}r.headers.get("content-type")?.toLowerCase().includes("text/event-stream")&&(i=0);const s=new g4(n=>{n.retry&&(t=Date.now()+n.retry),n.type==="message"&&n.data&&this.u.$onDidReceiveMessage(this.q,n.data),n.id&&(e=n.id)});try{await this.M(s,r)}catch(n){this.O(Y.Info,`Error reading from async stream, we will reconnect: ${n}`)}}}async J(){const e=new Ni,t={...Object.fromEntries(this.r.headers),Accept:"text/event-stream"};await this.N(t);let i;try{if(i=await this.Q(this.r.uri.toString(!0),{method:"GET",headers:t},t),i.status>=300){this.u.$onDidChangeState(this.q,{state:3,message:`${i.status} status connecting to ${this.r.uri} as SSE: ${await this.P(i)}`});return}}catch(s){this.u.$onDidChangeState(this.q,{state:3,message:`Error connecting to ${this.r.uri} as SSE: ${s}`});return}const r=new g4(s=>{s.type==="message"?this.u.$onDidReceiveMessage(this.q,s.data):s.type==="endpoint"&&e.complete(new URL(s.data,this.r.uri.toString(!0)).toString())});return this.D(te(()=>e.cancel())),this.M(r,i).catch(s=>{this.u.$onDidChangeState(this.q,{state:3,message:`Error reading SSE stream: ${String(s)}`})}),e.p}async L(e,t){const i=new TextEncoder().encode(t),r={...Object.fromEntries(this.r.headers),"Content-Type":"application/json","Content-Length":String(i.length)};await this.N(r);const s=await this.R(e,{method:"POST",headers:r,body:i});s.status>=300&&this.O(Y.Warning,`${s.status} status sending message to ${this.c}: ${await this.P(s)}`)}async M(e,t){if(!t.body)return;const i=t.body.getReader();let r;do{try{r=await cf(i.read(),this.g.token)}catch(s){if(i.cancel(),this.B.isDisposed)return;throw s}r.value&&e.feed(r.value)}while(!r.done)}async N(e,t){if(this.j)try{const i={authorizationServer:this.j.authorizationServer.toJSON(),authorizationServerMetadata:this.j.serverMetadata,resourceMetadata:this.j.resourceMetadata,scopes:this.j.scopes},r=await this.u.$getTokenFromServerMetadata(this.q,i,{errorOnUserInteraction:this.y,forceNewRegistration:t});r&&(e.Authorization=`Bearer ${r}`)}catch(i){if(yI.is(i))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(Y.Warning,`Error getting token from server metadata: ${String(i)}`)}if(this.r.authentication)try{this.O(Y.Debug,`Using provided authentication config: providerId=${this.r.authentication.providerId}, scopes=${this.r.authentication.scopes.join(", ")}`);const i=await this.u.$getTokenForProviderId(this.q,this.r.authentication.providerId,this.r.authentication.scopes,{errorOnUserInteraction:this.y,forceNewRegistration:t});i&&(e.Authorization=`Bearer ${i}`,this.O(Y.Info,"Successfully obtained token from provided authentication config"))}catch(i){if(yI.is(i))throw this.u.$onDidChangeState(this.q,{state:0,reason:"needs-user-interaction"}),new dt;this.O(Y.Warning,`Error getting token from provided authentication config: ${String(i)}`)}return e}O(e,t){this.B.isDisposed||this.u.$onDidPublishLog(this.q,e,t)}async P(e){try{return await e.text()}catch{return e.statusText}}async Q(e,t,i){const r=()=>this.R(e,t);let s=await r();if(b4(s.status)&&(this.j?this.j.update(s)&&(await this.N(i),i.Authorization&&(t.headers=i,s=await r())):(this.j=await Vq(e,s,{launchHeaders:this.r.headers,fetch:(n,o)=>this.R(n,o),log:(n,o)=>this.O(n,o)}),await this.N(i),i.Authorization&&(t.headers=i,s=await r()))),i.Authorization&&b4(s.status)){const n=await this.P(s);this.O(Y.Debug,`Received ${s.status} status with Authorization header, retrying with new auth registration. Error details: ${n||"no additional details"}`),await this.N(i,!0),s=await r()}return s}async R(e,t){if(t.headers["user-agent"]=`${bi.nameLong}/${bi.version}`,x0(this.w.getLevel(),Y.Trace)){const s={...t,headers:{...t.headers}};s.body&&(s.body=new TextDecoder().decode(s.body)),s.headers?.Authorization&&(s.headers.Authorization="***"),this.O(Y.Trace,`Fetching ${e} with options: ${JSON.stringify(s)}`)}let i=e,r;for(let s=0;s<Wq&&(r=await this.S(i,{...t,signal:this.h.signal,redirect:"manual"}),!!Bq.includes(r.status));s++){const n=r.headers.get("location");if(!n)break;const o=new URL(n,i).toString();this.O(Y.Trace,`Redirect (${r.status}) from ${i} to ${o}`),i=o,(r.status===303||(r.status===301||r.status===302)&&t.method==="POST")&&(t.method="GET",delete t.body)}if(x0(this.w.getLevel(),Y.Trace)){const s={};r.headers.forEach((n,o)=>{s[o]=n}),this.O(Y.Trace,`Fetched ${i}: ${JSON.stringify({status:r.status,headers:s})}`)}return r}S(e,t){return fetch(e,t)}};function _q(e){try{return JSON.parse(e),!0}catch{return!1}}function b4(e){return e===401||e===403}var m8=class{constructor(e,t,i,r,s){this.authorizationServer=e,this.serverMetadata=t,this.resourceMetadata=i,this.b=s,this.a=r}get scopes(){return this.a}update(e){const t=this.c(e);return D_(t,this.a)?!1:(this.b(Y.Debug,`Scopes changed from ${JSON.stringify(this.a)} to ${JSON.stringify(t)}, updating`),this.a=t,!0)}c(e){if(!e.headers.has("WWW-Authenticate"))return;const t=e.headers.get("WWW-Authenticate"),i=U9(t);for(const r of i)if(r.scheme==="Bearer"&&r.params.scope){const s=r.params.scope.split(pA).filter(n=>n.trim().length);if(s.length)return this.b(Y.Debug,`Found scope challenge in WWW-Authenticate header: ${r.params.scope}`),s}}};async function Vq(e,t,i){const{launchHeaders:r,fetch:s,log:n}=i,{resourceMetadataChallenge:o,scopesChallenge:a}=qq(t,n);let c,l,u=a;try{const g=await P_(e,o,{sameOriginHeaders:{...Object.fromEntries(r),"MCP-Protocol-Version":Wf.LATEST_PROTOCOL_VERSION},fetch:(v,b)=>s(v,b)});c=g.authorization_servers?.[0],n(Y.Debug,`Using auth server metadata url: ${c}`),u??=g.scopes_supported,l=g}catch(g){n(Y.Warning,`Could not fetch resource metadata: ${String(g)}`)}const h=new URL(t.url).origin;let f={};c||(c=h,f={...Object.fromEntries(r),"MCP-Protocol-Version":Wf.LATEST_PROTOCOL_VERSION});try{n(Y.Debug,`Fetching auth server metadata for: ${c} ...`);const g=await N_(c,{additionalHeaders:f,fetch:(v,b)=>s(v,b)});return n(Y.Info,"Populated auth metadata"),new m8(y.parse(c),g,l,u,n)}catch(g){n(Y.Warning,`Error populating auth server metadata for ${c}: ${String(g)}`)}const p=I_(new URL(h));return n(Y.Info,"Using default auth metadata"),new m8(y.parse(h),p,l,u,n)}function qq(e,t){let i,r;if(e.headers.has("WWW-Authenticate")){const s=e.headers.get("WWW-Authenticate"),n=U9(s);for(const o of n)if(o.scheme==="Bearer"){if(!i&&o.params.resource_metadata&&(i=o.params.resource_metadata,t(Y.Debug,`Found resource_metadata challenge in WWW-Authenticate header: ${i}`)),!r&&o.params.scope){const a=o.params.scope.split(pA).filter(c=>c.trim().length);a.length&&(t(Y.Debug,`Found scope challenge in WWW-Authenticate header: ${o.params.scope}`),r=a)}if(i&&r)break}}return{resourceMetadataChallenge:i,scopesChallenge:r}}var v8=H("IExtHostDataChannels"),Gq=class{constructor(){this.a=new Map}createDataChannel(e,t){T(e,"dataChannels");let i=this.a.get(t);return i||(i=new Zq(t),this.a.set(t,i)),i}$onDidReceiveData(e,t){const i=this.a.get(e);i&&i._fireDidReceiveData(t)}},Zq=class extends Q{constructor(e){super(),this.b=e,this.a=new I,this.onDidReceiveData=this.a.event,this.D(this.a)}_fireDidReceiveData(e){this.a.fire({data:e})}toString(){return`DataChannel(${this.b})`}};De(OA,LA,1),De(_n,Um,1),De(El,HA,1),De(os,cA,0),De(bm,yA,0),De(xA,kA,0),De(vr,Qy,0),De(Uh,tA,0),De(td,c4,0),De(l4,u4,0),De(kD,qA,0),De(La,ZA,0),De(FA,UA,0),De(pc,dj,0),De(xD,VA,1),De(d4,Om,0),De(eA,m9,0),De(o4,n4,0),De(dn,hA,0),De(f4,p4,0),De(dm,fm,0),De(vm,vA,0),De(wm,bA,0),De(Nr,qy,0),De(RA,mD,0),De(kl,a4,0),De(Oa,Rm,0),De(Bm,_m,0),De(v8,Gq,0);var y4=class extends gm{constructor(t,i){super(!0,t,i)}createTerminal(t,i,r){return this.createTerminalFromOptions({name:t,shellPath:i,shellArgs:r})}createTerminalFromOptions(t,i){const r=new lA(this.a,Tt(),t,t.name);return this.f.push(r),r.create(t,this.S(t,i)),r.value}};y4=__decorate([__param(0,os),__param(1,Ce)],y4);import*as w8 from"child_process";import{promises as b8}from"fs";var y8;(function(e){e[e.stdout=0]="stdout",e[e.stderr=1]="stderr"})(y8||(y8={}));var A8;(function(e){e[e.Success=0]="Success",e[e.Unknown=1]="Unknown",e[e.AccessDenied=2]="AccessDenied",e[e.ProcessNotFound=3]="ProcessNotFound"})(A8||(A8={}));function Jq(e,...t){const i=t.reduce((n,o)=>(n[o]=!0,n),{}),r=[/^ELECTRON_.+$/,/^VSCODE_(?!(PORTABLE|SHELL_LOGIN|ENV_REPLACE|ENV_APPEND|ENV_PREPEND)).+$/,/^SNAP(|_.*)$/,/^GDK_PIXBUF_.+$/];Object.keys(e).filter(n=>!i[n]).forEach(n=>{for(let o=0;o<r.length;o++)if(n.search(r[o])!==-1){delete e[n];break}})}function Qq(e){e&&(delete e.DEBUG,$t&&delete e.LD_PRELOAD)}function S8(e=Mn){return e.comspec||"cmd.exe"}function Yq(e){let t=[],i=!1;const r=function(s){if(i){t.push(s);return}(!e.send(s,o=>{if(o&&console.error(o),i=!1,t.length>0){const a=t.slice(0);t=[],a.forEach(c=>r(c))}})||ze)&&(i=!0)};return{send:r}}async function Xq(e){if(await nt.exists(e)){let t;try{t=await b8.stat(e)}catch(i){i.message.startsWith("EACCES")&&(t=await b8.lstat(e))}return t?!t.isDirectory():!1}return!1}async function Vm(e,t,i,r=Mn,s=Xq){if(xr(e))return await s(e)?e:void 0;if(t===void 0&&(t=Fo()),Mi(e)!=="."){const c=_e(t,e);return await s(c)?c:void 0}const o=ek(r,"PATH");if(i===void 0&&Oe(o)&&(i=o.split(CE)),i===void 0||i.length===0){const c=_e(t,e);return await s(c)?c:void 0}for(const c of i){let l;if(xr(c)?l=_e(c,e):l=_e(t,c,e),ze){const h=(ek(r,"PATHEXT")||".COM;.EXE;.BAT;.CMD").split(";").map(async f=>{const p=l+f;return await s(p)?p:void 0});for(const f of h){const p=await f;if(p)return p}}if(await s(l))return l}const a=_e(t,e);return await s(a)?a:void 0}async function A4(e,t=!1){let i;if(ze){const r=process.env.WINDIR||"C:\\Windows",s=_e(r,"System32","taskkill.exe"),n=["/T"];t&&n.push("/F"),n.push("/PID",String(e)),i=w8.spawn(s,n,{stdio:["ignore","pipe","pipe"]})}else{const r=af.asFileUri("vs/base/node/terminateProcess.sh").fsPath;i=w8.spawn("/bin/sh",[r,String(e),t?"9":"15"],{stdio:["ignore","pipe","pipe"]})}return new Promise((r,s)=>{const n=[];i.stdout.on("data",o=>n.push(o)),i.stderr.on("data",o=>n.push(o)),i.on("error",s),i.on("exit",o=>{o===0?r():s(new Error(`taskkill exited with code ${o}: ${Buffer.concat(n).toString()}`))})})}import{homedir as Kq}from"os";var S4=class extends Nm{constructor(t,i,r,s,n,o,a,c,l){super(t,i,r,s,n,o,a,c),this.E=r,this.F=l,i.remote.isRemote&&i.remote.authority?this.registerTaskSystem(q.vscodeRemote,{scheme:q.vscodeRemote,authority:i.remote.authority,platform:process.platform}):this.registerTaskSystem(q.file,{scheme:q.file,authority:"",platform:process.platform}),this.a.$registerSupportedExecutions(!0,!0,!0)}async executeTask(t,i){const r=i;if(!i.execution&&r._id===void 0)throw new Error("Tasks to execute must include an execution");if(r._id!==void 0){const s=t4.from(r,this.E),n=await this.a.$getTaskExecution(s);if(n.task===void 0)throw new Error("Task from execution DTO is undefined");const o=await this.B(n,i);return this.a.$executeTask(s).catch(()=>{}),o}else{const s=Ls.from(i,t);if(s===void 0)return Promise.reject(new Error("Task is not valid"));as.is(s.execution)&&await this.A(s,i,!1);const n=await this.B(await this.a.$getTaskExecution(s),i);return this.a.$executeTask(s).catch(()=>{}),n}}x(t,i,r,s){const n=[];if(s)for(const o of s){this.C(o,r),(!o.definition||!t[o.definition.type])&&this.f.warn(`The task [${o.source}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`);const a=Ls.from(o,r.extension);a&&(n.push(a),as.is(a.execution)&&i.push(this.A(a,o,!0)))}return{tasks:n,extension:r.extension}}async y(t){return t}async I(t){let i=t&&t.length>0?t[0]:void 0;if(!i){const r=y.file(Kq());i=new I0({uri:r,name:dr(r),index:0})}return{uri:i.uri,name:i.name,index:i.index,toResource:()=>{throw new Error("Not implemented")}}}async $resolveVariables(t,i){const r=y.revive(t),s={process:void 0,variables:Object.create(null)},n=await this.b.resolveWorkspaceFolder(r),o=await this.b.getWorkspaceFolders2()??[],a=await this.F.getResolver(),c=n?{uri:n.uri,name:n.name,index:n.index,toResource:()=>{throw new Error("Not implemented")}}:await this.I(o);for(const l of i.variables)s.variables[l]=await a.resolveAsync(c,l);if(i.process!==void 0){let l;if(i.process.path!==void 0){l=i.process.path.split(CE);for(let p=0;p<l.length;p++)l[p]=await a.resolveAsync(c,l[p])}const u=await a.resolveAsync(c,i.process.name),h=i.process.cwd!==void 0?await a.resolveAsync(c,i.process.cwd):void 0,f=await Vm(u,h,l);f?s.process=f:xr(u)?s.process=u:s.process=_e(h??"",u)}return s}async $jsonTasksSupported(){return!0}async $findExecutable(t,i,r){return Vm(t,i,r)}};S4=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Nr),__param(3,La),__param(4,vr),__param(5,dn),__param(6,Se),__param(7,El),__param(8,Oa)],S4);import*as $l from"child_process";var Vse=H("externalTerminal"),qm="Terminal.app",E8=d(2071,null),E4=class{async getDefaultTerminalForPlatforms(){return{windows:x4.getDefaultTerminalWindows(),linux:await x8.getDefaultTerminalLinuxReady(),osx:"xterm"}}},x4=class En extends E4{static{this.b="cmd.exe"}openTerminal(t,i){return this.spawnTerminal($l,t,S8(),i)}spawnTerminal(t,i,r,s){const n=i.windowsExec||En.getDefaultTerminalWindows();s&&s[1]===":"&&(s=s[0].toUpperCase()+s.substr(1));const o=At(n,".exe").toLowerCase();if(o==="cmder")return t.spawn(n,s?[s]:void 0),Promise.resolve(void 0);const a=["/c","start","/wait"];return n.indexOf(" ")>=0&&a.push(n),a.push(n),o==="wt"&&a.push("-d ."),new Promise((c,l)=>{const u=Il(process),h=t.spawn(r,a,{cwd:s,env:u,detached:!0});h.on("error",l),h.on("exit",()=>c())})}async runInTerminal(t,i,r,s,n){const o=n.windowsExec||En.getDefaultTerminalWindows(),a=await En.f();return new Promise((c,l)=>{const u=`"${i} - ${E8}"`,h=`"${r.join('" "')}" & pause`,f=Object.assign({},Il(process),s);Object.keys(f).filter(S=>f[S]===null).forEach(S=>delete f[S]);const p={cwd:i,env:f,windowsVerbatimArguments:!0};let g,v;At(o,".exe")==="wt"?(g=o,v=["-d",".",En.b,"/c",h]):a?(g=a,v=["-d",".",o,"/c",h]):(g=En.b,v=["/c","start",u,"/wait",o,"/c",`"${h}"`]),$l.spawn(g,v,p).on("error",S=>{l(k4(S))}),c(void 0)})}static getDefaultTerminalWindows(){if(!En.d){const t=!!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432");En.d=`${process.env.windir?process.env.windir:"C:\\Windows"}\\${t?"Sysnative":"System32"}\\cmd.exe`}return En.d}static async f(){try{return await Vm("wt")}catch{return}}};__decorate([Rx],x4,"f",null);var eG=class CN extends E4{static{this.b="/usr/bin/osascript"}openTerminal(t,i){return this.spawnTerminal($l,t,i)}runInTerminal(t,i,r,s,n){const o=n.osxExec||qm;return new Promise((a,c)=>{if(o===qm||o==="iTerm.app"){const l=o===qm?"TerminalHelper":"iTermHelper",h=[af.asFileUri(`vs/workbench/contrib/externalTerminal/node/${l}.scpt`).fsPath,"-t",t||E8,"-w",i];for(const g of r)h.push("-a"),h.push(g);if(s){const g=Object.assign({},Il(process),s);for(const v in g){const b=g[v];b===null?(h.push("-u"),h.push(v)):(h.push("-e"),h.push(`${v}=${b}`))}}let f="";const p=$l.spawn(CN.b,h);p.on("error",g=>{c(k4(g))}),p.stderr.on("data",g=>{f+=g.toString()}),p.on("exit",g=>{if(g===0)a(void 0);else if(f){const v=f.split(`
`,1);c(new Error(v[0]))}else c(new Error(d(2072,null,l,g)))})}else c(new Error(d(2073,null,o)))})}spawnTerminal(t,i,r){const s=i.osxExec||qm;return new Promise((n,o)=>{const a=["-a",s];r&&a.push(r);const c=Il(process),l=t.spawn("/usr/bin/open",a,{cwd:r,env:c});l.on("error",o),l.on("exit",()=>n())})}},x8=class $o extends E4{static{this.b=d(2074,null)}openTerminal(t,i){return this.spawnTerminal($l,t,i)}runInTerminal(t,i,r,s,n){const o=n.linuxExec?Promise.resolve(n.linuxExec):$o.getDefaultTerminalLinuxReady();return new Promise((a,c)=>{const l=[];o.then(u=>{u.indexOf("gnome-terminal")>=0?l.push("-x"):l.push("-e"),l.push("bash"),l.push("-c");const h=`${tG(r)}; echo; read -p "${$o.b}" -n1;`;l.push(`''${h}''`);const f=Object.assign({},Il(process),s);Object.keys(f).filter(b=>f[b]===null).forEach(b=>delete f[b]);const p={cwd:i,env:f};let g="";const v=$l.spawn(u,l,p);v.on("error",b=>{c(k4(b))}),v.stderr.on("data",b=>{g+=b.toString()}),v.on("exit",b=>{if(b===0)a(void 0);else if(g){const S=g.split(`
`,1);c(new Error(S[0]))}else c(new Error(d(2075,null,u,b)))})})})}static async getDefaultTerminalLinuxReady(){if(!$o.d)if(!$t)$o.d=Promise.resolve("xterm");else{const t=await nt.exists("/etc/debian_version");$o.d=new Promise(i=>{t?i("x-terminal-emulator"):process.env.DESKTOP_SESSION==="gnome"||process.env.DESKTOP_SESSION==="gnome-classic"?i("gnome-terminal"):process.env.DESKTOP_SESSION==="kde-plasma"?i("konsole"):process.env.COLORTERM?i(process.env.COLORTERM):process.env.TERM?i(process.env.TERM):i("xterm")})}return $o.d}spawnTerminal(t,i,r){const s=i.linuxExec?Promise.resolve(i.linuxExec):$o.getDefaultTerminalLinuxReady();return new Promise((n,o)=>{s.then(a=>{const c=Il(process),l=t.spawn(a,[],{cwd:r,env:c});l.on("error",o),l.on("exit",()=>n())})})}};function Il(e){const t={...e.env};return Jq(t),t}function k4(e){return e.errno==="ENOENT"&&e.path?new Error(d(2076,null,e.path)):e}function tG(e){let t="";for(const i of e)i.indexOf(" ")>=0?t+='"'+i+'"':t+=i,t+=" ";return t}var iG=class $N{constructor(){this.b=new Map}static{this.a=1}async createNewMessage(t){try{const i=await this.c();if(i){const r=String($N.a++);return this.b.set(r,i),{id:r,data:i.createNewMessage(t)}}}catch{}return{id:"",data:t}}async validate(t,i){if(!t.id)return!0;const r=this.b.get(t.id);if(!r)return!1;this.b.delete(t.id);try{return r.validate(i)==="ok"}catch{return!1}finally{r.dispose?.()}}async sign(t){try{return await this.d(t)}catch{}return t}},k8=class extends iG{c(){return this.h().then(e=>new e.validator)}d(e){return this.h().then(t=>new t.signer().sign(e))}async h(){const e="vsda",{default:t}=await import(e);return t}};import*as C8 from"child_process";import*as $8 from"net";var I8=class Bl extends QD{static{this.b=`\r
\r
`}static{this.c=/\r?\n/}static{this.i=/: */}constructor(){super(),this.p=Buffer.allocUnsafe(0),this.r=-1}t(t,i){this.l=i,this.p=Buffer.allocUnsafe(0),this.r=-1,t.on("data",r=>this.v(r))}sendMessage(t){if(this.l){const i=JSON.stringify(t);this.l.write(`Content-Length: ${Buffer.byteLength(i,"utf8")}${Bl.b}${i}`,"utf8")}}v(t){for(this.p=Buffer.concat([this.p,t]);;){if(this.r>=0){if(this.p.length>=this.r){const i=this.p.toString("utf8",0,this.r);if(this.p=this.p.slice(this.r),this.r=-1,i.length>0)try{this.acceptMessage(JSON.parse(i))}catch(r){this.n.fire(new Error((r.message||r)+`
`+i))}continue}}else{const i=this.p.indexOf(Bl.b);if(i!==-1){const s=this.p.toString("utf8",0,i).split(Bl.c);for(const n of s){const o=n.split(Bl.i);o[0]==="Content-Length"&&(this.r=Number(o[1]))}this.p=this.p.slice(i+Bl.b.length);continue}}break}}},D8=class extends I8{startSession(){return new Promise((e,t)=>{let i=!1;this.x=this.y(()=>{this.t(this.x,this.x),e(),i=!0}),this.x.on("close",()=>{i?this.n.fire(new Error("connection closed")):t(new Error("connection closed"))}),this.x.on("error",r=>{r instanceof AggregateError&&(r=r.errors[0]),i?this.n.fire(r):t(r)})})}async stopSession(){await this.w(),this.x&&(this.x.end(),this.x=void 0)}},rG=class extends D8{constructor(e){super(),this.z=e}y(e){return $8.createConnection(this.z.port,this.z.host||"127.0.0.1",e)}},sG=class extends D8{constructor(e){super(),this.z=e}y(e){return $8.createConnection(this.z.path,e)}},P8=class qa extends I8{constructor(t,i){super(),this.y=t,this.z=i}async startSession(){const t=this.y.command,i=this.y.args,r=this.y.options||{};try{if(t)if(xr(t)){if(!await nt.exists(t))throw new Error(d(7873,null,t))}else t.indexOf("/")<0&&t.indexOf("\\")<0;else throw new Error(d(7874,null,this.z));let s=process.env;if(r.env&&Object.keys(r.env).length>0&&(s=Qs(ot(process.env),r.env)),t==="node")if(Array.isArray(i)&&i.length>0){const n=!!process.env.ELECTRON_RUN_AS_NODE||!!process.versions.electron,o={env:s,execArgv:n?["-e","delete process.env.ELECTRON_RUN_AS_NODE;require(process.argv[1])"]:[],silent:!0};r.cwd&&(o.cwd=r.cwd);const a=C8.fork(i[0],i.slice(1),o);if(!a.pid)throw new Error(d(7875,null,i[0]));this.x=a}else throw new Error(d(7876,null));else{let n=t,o=i;const a={env:s};r.cwd&&(a.cwd=r.cwd),ze&&(t.endsWith(".bat")||t.endsWith(".cmd"))&&(a.shell=!0,n=`"${t}"`,o=i.map(c=>(c=c.replace(/"/g,'\\"'),`"${c}"`))),this.x=C8.spawn(n,o,a)}this.x.on("error",n=>{this.n.fire(n)}),this.x.on("exit",(n,o)=>{this.o.fire(n)}),this.x.stdout.on("close",()=>{this.n.fire(new Error("read error"))}),this.x.stdout.on("error",n=>{this.n.fire(n)}),this.x.stdin.on("error",n=>{this.n.fire(n)}),this.x.stderr.resume(),this.t(this.x.stdout,this.x.stdin)}catch(s){this.n.fire(s)}}async stopSession(){return this.x?(await this.w(),ze?A4(this.x.pid,!0).catch(()=>{this.x?.kill()}):(this.x.kill("SIGTERM"),Promise.resolve(void 0))):Promise.resolve(void 0)}static A(t,i){if(!t)return;const r=Object.create(null);t.runtime&&(t.runtime.indexOf("./")===0?r.runtime=_e(i,t.runtime):r.runtime=t.runtime),t.runtimeArgs&&(r.runtimeArgs=t.runtimeArgs),t.program&&(xr(t.program)?r.program=t.program:r.program=_e(i,t.program)),t.args&&(r.args=t.args);const s=t;return s.win&&(r.win=qa.A(s.win,i)),s.winx86&&(r.winx86=qa.A(s.winx86,i)),s.windows&&(r.windows=qa.A(s.windows,i)),s.osx&&(r.osx=qa.A(s.osx,i)),s.linux&&(r.linux=qa.A(s.linux,i)),r}static platformAdapterExecutable(t,i){let r=Object.create(null);i=i.toLowerCase();for(const l of t)if(l.contributes){const u=l.contributes.debuggers;u&&u.length>0&&u.filter(h=>typeof h.type=="string"&&kr(h.type,i)).forEach(h=>{const f=qa.A(h,l.extensionLocation.fsPath);r=Qs(r,f,l.isBuiltin)})}let s;ze&&!process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?s=r.winx86||r.win||r.windows:ze?s=r.win||r.windows:Dt?s=r.osx:$t&&(s=r.linux),s=s||r;const n=s.program||r.program,o=s.args||r.args,a=s.runtime||r.runtime,c=s.runtimeArgs||r.runtimeArgs;if(a)return{type:"executable",command:a,args:(c||[]).concat(typeof n=="string"?[n]:[]).concat(o||[])};if(n)return{type:"executable",command:n,args:o||[]}}};import*as nG from"child_process";function oG(e,t){return new Promise((i,r)=>{let s="";const n=nG.spawn(e,t);n.pid&&n.stdout.on("data",o=>{s+=o.toString()}),n.on("error",o=>{r(o)}),n.on("close",o=>{i(s)})})}async function aG(e){if(e)if(ze){const t=await import("@vscode/windows-process-tree");return new Promise(i=>{t.getProcessTree(e,r=>{i(!!r&&r.children.length>0)})})}else return oG("/usr/bin/pgrep",["-lP",String(e)]).then(t=>{const i=t.trim();return!(i.length===0||i.indexOf(" tmux")>=0)},t=>!0);return Promise.resolve(!0)}var T8;(function(e){e[e.cmd=0]="cmd",e[e.powershell=1]="powershell",e[e.bash=2]="bash"})(T8||(T8={}));function cG(e,t,i,r,s){e=e.trim().toLowerCase();let n;e.indexOf("powershell")>=0||e.indexOf("pwsh")>=0?n=1:e.indexOf("cmd.exe")>=0?n=0:e.indexOf("bash")>=0?n=2:ze?n=0:n=2;let o,a=" ";switch(n){case 1:if(o=c=>(c=c.replace(/\'/g,"''"),c.length>0&&c.charAt(c.length-1)==="\\"?`'${c}\\'`:`'${c}'`),r){const c=VE(r);c&&(a+=`${c}:; `),a+=`cd ${o(r)}; `}if(s)for(const c in s){const l=s[c];l===null?a+=`Remove-Item env:${c}; `:a+=`\${env:${c}}='${l}'; `}if(t.length>0){const c=t.shift(),l=i?c:o(c);a+=l[0]==="'"?`& ${l} `:`${l} `;for(const u of t)a+=u==="<"||u===">"||i?u:o(u),a+=" "}break;case 0:if(o=c=>(c=c.replace(/\"/g,'""'),c=c.replace(/([><!^&|])/g,"^$1"),' "'.split("").some(l=>c.includes(l))||c.length===0?`"${c}"`:c),r){const c=VE(r);c&&(a+=`${c}: && `),a+=`cd ${o(r)} && `}if(s){a+='cmd /C "';for(const c in s){let l=s[c];l===null?a+=`set "${c}=" && `:(l=l.replace(/[&^|<>]/g,u=>`^${u}`),a+=`set "${c}=${l}" && `)}}for(const c of t)a+=c==="<"||c===">"||i?c:o(c),a+=" ";s&&(a+='"');break;case 2:{o=l=>(l=l.replace(/(["'\\\$!><#()\[\]*&^| ;{}?`])/g,"\\$1"),l.length===0?'""':l);const c=l=>/[^\w@%\/+=,.:^-]/.test(l)?`'${l.replace(/'/g,"'\\''")}'`:l;if(r&&(a+=`cd ${o(r)} ; `),s){a+="/usr/bin/env";for(const l in s){const u=s[l];u===null?a+=` -u ${c(l)}`:a+=` ${c(`${l}=${u}`)}`}a+=" "}for(const l of t)a+=l==="<"||l===">"||i?l:o(l),a+=" ";break}}return a}var C4=class extends Lm{constructor(t,i,r,s,n,o,a,c,l,u){super(t,i,r,s,a,c,l,u),this.Fb=n,this.Gb=o,this.Db=new uG}ib(t,i){return t instanceof Vc?new P8(this.lb(t),i.type):t instanceof qc?new rG(this.mb(t)):t instanceof eh?new sG(this.nb(t)):super.ib(t,i)}vb(t,i){const r=P8.platformAdapterExecutable(i.getAllExtensionDescriptions(),t.type);if(r)return new Vc(r.command,r.args,r.options)}jb(){return new k8}async $runInTerminal(t,i){if(t.kind==="integrated"){this.Eb||(this.Eb=this.D(this.Fb.onDidCloseTerminal(g=>{this.Db.onTerminalClosed(g)})));const r=await this.ab.getConfigProvider(),s=this.Fb.getDefaultShell(!0),n=this.Fb.getDefaultShellArgs(!0),o=t.title||d(3052,null),a=JSON.stringify({shell:s,shellArgs:n});let c=await this.Db.checkout(a,o),l,u=!1;if(c)l=t.cwd;else{const g={shellPath:s,shellArgs:n,cwd:t.cwd,name:o,iconPath:new Di("debug")};u=!0,c=this.Fb.createTerminalFromOptions(g,{isFeatureTerminal:!0,forceShellIntegration:!0,useShellEnvironment:!0}),this.Db.insert(c,a)}c.show(!0);const h=await c.processId;if(u){let g;(function(b){b[b.DataDebounce=500]="DataDebounce",b[b.MaxDelay=5e3]="MaxDelay"})(g||(g={}));const v=new ie;await new Promise(b=>{const S=v.add(new vs(b,500));v.add(this.Fb.onDidWriteTerminalData(E=>{E.terminal===c&&S.schedule()})),v.add(this.Gb.onDidChangeTerminalShellIntegration(E=>{E.terminal===c&&b()})),v.add(Hv(b,5e3))}),v.dispose()}else if(c.state.isInteractedWith&&!c.shellIntegration&&(c.sendText(""),await ri(200)),r.getConfiguration("debug.terminal").get("clearBeforeReusing")){let g;if(s.indexOf("powershell")>=0||s.indexOf("pwsh")>=0||s.indexOf("cmd.exe")>=0?g="cls":s.indexOf("bash")>=0?g="clear":ze?g="cls":g="clear",c.shellIntegration){const v=new ie,b=c.shellIntegration.executeCommand(g);await new Promise(S=>{v.add(this.Gb.onDidEndTerminalShellExecution(E=>{E.execution===b&&S()})),v.add(Hv(S,500))}),v.dispose()}else c.sendText(g),await ri(200)}const f=cG(s,t.args,!!t.argsCanBeInterpretedByShell,l,t.env);c.shellIntegration?c.shellIntegration.executeCommand(f):c.sendText(f);const p=this.onDidTerminateDebugSession(g=>{g.id===i&&(this.Db.free(c),p.dispose())});return h}else if(t.kind==="external")return lG(t,await this.ab.getConfigProvider());return super.$runInTerminal(t,i)}};C4=__decorate([__param(0,Ce),__param(1,Nr),__param(2,fn),__param(3,vr),__param(4,dn),__param(5,f4),__param(6,kl),__param(7,Oa),__param(8,os),__param(9,td)],C4);var rd=void 0;function lG(e,t){if(!rd)if(ze)rd=new x4;else if(Dt)rd=new eG;else if($t)rd=new x8;else throw new Error("external terminals not supported on this platform");const i=t.getConfiguration("terminal");return rd.runInTerminal(e.title,e.cwd,e.args,e.env||{},i.external||{})}var uG=class IN{constructor(){this.b=new Map}static{this.a=1e3}async checkout(t,i,r=!1){const n=[...this.b.entries()].map(([o,a])=>Js(async c=>{if(o.name!==i||a.lastUsedAt!==-1&&await aG(await o.processId))return null;const l=Date.now();return a.lastUsedAt+IN.a>l||c.isCancellationRequested?null:a.config!==t?(r&&o.dispose(),null):(a.lastUsedAt=l,o)}));return await Z2(n,o=>!!o)}insert(t,i){this.b.set(t,{lastUsedAt:Date.now(),config:i})}free(t){const i=this.b.get(t);i&&(i.lastUsedAt=-1)}onTerminalClosed(t){this.b.delete(t)}},M8=new Pt(()=>{const e=Sm.Collator(void 0,{numeric:!0,sensitivity:"base"}).value;return{collator:e,collatorIsNumeric:e.resolvedOptions().numeric}}),Gse=new Pt(()=>({collator:Sm.Collator(void 0,{numeric:!0}).value})),Zse=new Pt(()=>({collator:Sm.Collator(void 0,{numeric:!0,sensitivity:"accent"}).value}));function N8(e,t,i=!1){const r=e||"",s=t||"",n=M8.value.collator.compare(r,s);return M8.value.collatorIsNumeric&&n===0&&r!==s?r<s?-1:1:n}function hG(e,t,i=!1){return i||(e=e&&e.toLowerCase(),t=t&&t.toLowerCase()),e===t?0:e<t?-1:1}function Gm(e,t,i=!1){const r=e.split(St),s=t.split(St),n=r.length-1,o=s.length-1;let a,c;for(let l=0;;l++){if(a=n===l,c=o===l,a&&c)return N8(r[l],s[l],i);if(a)return-1;if(c)return 1;const u=hG(r[l],s[l],i);if(u!==0)return u}}function $4(e,t,i){const r=e.toLowerCase(),s=t.toLowerCase(),n=dG(e,t,i);if(n)return n;const o=r.endsWith(i),a=s.endsWith(i);if(o!==a)return o?-1:1;const c=N8(r,s);return c!==0?c:r.localeCompare(s)}function dG(e,t,i){const r=e.toLowerCase(),s=t.toLowerCase(),n=r.startsWith(i),o=s.startsWith(i);if(n!==o)return n?-1:1;if(n&&o){if(r.length<s.length)return-1;if(r.length>s.length)return 1}return 0}var Zm=0,R8=[Zm,[]];function L8(e,t,i,r){if(!e||!t)return R8;const s=e.length,n=t.length;if(s<n)return R8;const o=e.toLowerCase();return fG(t,i,n,e,o,s,r)}function fG(e,t,i,r,s,n,o){const a=[],c=[];for(let f=0;f<i;f++){const p=f*n,g=p-n,v=f>0,b=e[f],S=t[f];for(let E=0;E<n;E++){const $=E>0,U=p+E,O=U-1,J=g+E-1,F=$?a[O]:0,V=v&&$?a[J]:0,z=v&&$?c[J]:0;let ue;!V&&v?ue=0:ue=pG(b,S,r,s,E,z),ue&&V+ue>=F&&(o||v||s.startsWith(t,E))?(c[U]=z+1,a[U]=V+ue):(c[U]=Zm,a[U]=F)}}const l=[];let u=i-1,h=n-1;for(;u>=0&&h>=0;){const f=u*n+h;c[f]===Zm||(l.push(h),u--),h--}return[a[i*n-1],l.reverse()]}function pG(e,t,i,r,s,n){let o=0;if(!gG(t,r[s]))return o;if(o+=1,n>0&&(o+=Math.min(n,3)*6+Math.max(0,n-3)*3),e===i[s]&&(o+=1),s===0)o+=8;else{const a=mG(i.charCodeAt(s-1));a?o+=a:yu(i.charCodeAt(s))&&n===0&&(o+=2)}return o}function gG(e,t){return e===t?!0:e==="/"||e==="\\"?t==="/"||t==="\\":!1}function mG(e){switch(e){case 47:case 92:return 5;case 95:case 45:case 46:case 32:case 39:case 34:case 58:return 4;default:return 0}}var Jm=Object.freeze({score:0}),Qm=1<<18,I4=1<<17,D4=65536;function vG(e,t,i,r){const s=r.values?r.values:[r];return Xs({[r.normalized]:{values:s.map(o=>({value:o.normalized,expectContiguousMatch:o.expectContiguousMatch})),label:e,description:t,allowNonContiguousMatches:i}})}function O8(e,t,i,r,s){if(!e||!t.normalized)return Jm;const n=r.getItemLabel(e);if(!n)return Jm;const o=r.getItemDescription(e),a=vG(n,o,i,t),c=s[a];if(c)return c;const l=wG(n,o,r.getItemPath(e),t,i);return s[a]=l,l}function wG(e,t,i,r,s){const n=!i||!r.containsPathSeparator;return i&&($t?r.pathNormalized===i:kr(r.pathNormalized,i))?{score:Qm,labelMatch:[{start:0,end:e.length}],descriptionMatch:t?[{start:0,end:t.length}]:void 0}:r.values&&r.values.length>1?bG(e,t,i,r.values,n,s):F8(e,t,i,r,n,s)}function bG(e,t,i,r,s,n){let o=0;const a=[],c=[];for(const l of r){const{score:u,labelMatch:h,descriptionMatch:f}=F8(e,t,i,l,s,n);if(u===Zm)return Jm;o+=u,h&&a.push(...h),f&&c.push(...f)}return{score:o,labelMatch:j8(a),descriptionMatch:j8(c)}}function F8(e,t,i,r,s,n){if(s||!t){const[o,a]=L8(e,r.normalized,r.normalizedLowercase,n&&!r.expectContiguousMatch);if(o){const c=T0(r.normalized,e);let l;if(c){l=I4;const u=Math.round(r.normalized.length/e.length*100);l+=u}else l=D4;return{score:l+o,labelMatch:c||U8(a)}}}if(t){let o=t;i&&(o=`${t}${St}`);const a=o.length,c=`${o}${e}`,[l,u]=L8(c,r.normalized,r.normalizedLowercase,n&&!r.expectContiguousMatch);if(l){const h=U8(u),f=[],p=[];return h.forEach(g=>{g.start<a&&g.end>a?(f.push({start:0,end:g.end-a}),p.push({start:g.start,end:a})):g.start>=a?f.push({start:g.start-a,end:g.end-a}):p.push(g)}),{score:l,labelMatch:f,descriptionMatch:p}}}return Jm}function U8(e){const t=[];if(!e)return t;let i;for(const r of e)i&&i.end===r?i.end+=1:(i={start:r,end:r+1},t.push(i));return t}function j8(e){const t=e.sort((s,n)=>s.start-n.start),i=[];let r;for(const s of t)!r||!yG(r,s)?(r=s,i.push(s)):(r.start=Math.min(r.start,s.start),r.end=Math.max(r.end,s.end));return i}function yG(e,t){return!(e.end<t.start||t.end<e.start)}function AG(e,t,i,r,s,n){const o=O8(e,i,r,s,n),a=O8(t,i,r,s,n),c=o.score,l=a.score;if((c===Qm||l===Qm)&&c!==l)return c===Qm?-1:1;if(c>D4||l>D4){if(c!==l)return c>l?-1:1;if(c<I4&&l<I4){const b=SG(o.labelMatch,a.labelMatch);if(b!==0)return b}const g=s.getItemLabel(e)||"",v=s.getItemLabel(t)||"";if(g.length!==v.length)return g.length-v.length}if(c!==l)return c>l?-1:1;const u=Array.isArray(o.labelMatch)&&o.labelMatch.length>0,h=Array.isArray(a.labelMatch)&&a.labelMatch.length>0;if(u&&!h)return-1;if(h&&!u)return 1;const f=z8(e,o,s),p=z8(t,a,s);return f&&p&&f!==p?p>f?-1:1:EG(e,t,i,s)}function z8(e,t,i){let r=-1,s=-1;if(t.descriptionMatch?.length?r=t.descriptionMatch[0].start:t.labelMatch?.length&&(r=t.labelMatch[0].start),t.labelMatch?.length){if(s=t.labelMatch[t.labelMatch.length-1].end,t.descriptionMatch?.length){const n=i.getItemDescription(e);n&&(s+=n.length)}}else t.descriptionMatch?.length&&(s=t.descriptionMatch[t.descriptionMatch.length-1].end);return s-r}function SG(e,t){if(!e&&!t||!e?.length&&!t?.length)return 0;if(!t?.length)return-1;if(!e?.length)return 1;const i=e[0].start,s=e[e.length-1].end-i,n=t[0].start,a=t[t.length-1].end-n;return s===a?0:a<s?1:-1}function EG(e,t,i,r){const s=r.getItemLabel(e)||"",n=r.getItemLabel(t)||"",o=r.getItemDescription(e),a=r.getItemDescription(t),c=s.length+(o?o.length:0),l=n.length+(a?a.length:0);if(c!==l)return c-l;const u=r.getItemPath(e),h=r.getItemPath(t);return u&&h&&u.length!==h.length?u.length-h.length:s!==n?$4(s,n,i.normalized):o&&a&&o!==a?$4(o,a,i.normalized):u&&h&&u!==h?$4(u,h,i.normalized):0}function H8(e){return e.startsWith('"')&&e.endsWith('"')}var xG=" ";function P4(e){typeof e!="string"&&(e="");const t=e.toLowerCase(),{pathNormalized:i,normalized:r,normalizedLowercase:s}=W8(e),n=i.indexOf(St)>=0,o=H8(e);let a;const c=e.split(xG);if(c.length>1)for(const l of c){const u=H8(l),{pathNormalized:h,normalized:f,normalizedLowercase:p}=W8(l);f&&(a||(a=[]),a.push({original:l,originalLowercase:l.toLowerCase(),pathNormalized:h,normalized:f,normalizedLowercase:p,expectContiguousMatch:u}))}return{original:e,originalLowercase:t,pathNormalized:i,normalized:r,normalizedLowercase:s,values:a,containsPathSeparator:n,expectContiguousMatch:o}}function W8(e){let t;ze?t=e.replace(/\//g,St):t=e.replace(/\\/g,St);const i=t.replace(/[\*\u2026\s"]/g,"");return{pathNormalized:t,normalized:i,normalizedLowercase:i.toLowerCase()}}import*as kG from"child_process";import*as T4 from"fs";import{StringDecoder as B8}from"string_decoder";import*as CG from"child_process";function Ym(e){return e.startsWith("**")||e.startsWith("/")?e:`/${e}`}function $G(e){return new Oy(e.start.line,e.start.character,e.end.line,e.end.character)}function _8(e){return new U7(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}var Xm=class{constructor(t,i){this.a=t,this.b=i}appendLine(t){this.b.debug(`${this.a}#search`,t)}};Xm=__decorate([__param(1,Se)],Xm);import{rgPath as IG}from"@vscode/ripgrep";var V8=IG.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked");function DG(e,t,i,r,s){const n=PG(e,t,i,r,s),o=t.folder.fsPath;return{cmd:CG.spawn(V8,n.args,{cwd:o}),rgDiskPath:V8,siblingClauses:n.siblingClauses,rgArgs:n,cwd:o}}function PG(e,t,i,r,s){const n=["--files","--hidden","--case-sensitive","--no-require-git"];MG([t],i,!1).forEach(a=>{const c=Ym(a);if(n.push("-g",c),Dt){const l=Zv(c);l!==c&&n.push("-g",l)}});const o=TG([t],r,void 0,!1);return o.globArgs.forEach(a=>{const c=`!${Ym(a)}`;if(n.push("-g",c),Dt){const l=Zv(c);l!==c&&n.push("-g",l)}}),t.disregardIgnoreFiles!==!1?n.push("--no-ignore"):t.disregardParentIgnoreFiles!==!1&&n.push("--no-ignore-parent"),t.ignoreSymlinks||n.push("--follow"),e.exists&&n.push("--quiet"),s&&n.push("--threads",`${s}`),n.push("--no-config"),t.disregardGlobalIgnoreFiles&&n.push("--no-ignore-global"),{args:n,siblingClauses:o.siblingClauses}}function TG(e,t,i,r=!0){const s=[];let n={};return e.forEach(o=>{const a=Object.assign({},o.excludePattern||{},t||{}),c=q8(a,r?o.folder.fsPath:void 0,i);s.push(...c.globArgs),c.siblingClauses&&(n=Object.assign(n,c.siblingClauses))}),{globArgs:s,siblingClauses:n}}function MG(e,t,i=!0){const r=[];return e.forEach(s=>{const n=Object.assign({},t||{},s.includePattern||{}),o=q8(n,i?s.folder.fsPath:void 0);r.push(...o.globArgs)}),r}function q8(e,t,i){const r=[],s={};return Object.keys(e).forEach(n=>{if(i&&i.has(n)||!n)return;const o=e[n];n=RG(t?NG(t,n):n),n.startsWith("\\\\")?n="\\\\"+n.substr(2).replace(/\\/g,"/"):n=n.replace(/\\/g,"/"),typeof o=="boolean"&&o?(n.startsWith("\\\\")&&(n+="**"),r.push(LG(n))):o&&o.when&&(s[n]=o)}),{globArgs:r,siblingClauses:s}}function NG(e,t){return xr(t)?t:_e(e,t)}function RG(e){return e=Ln(e,"\\"),Ln(e,"/")}function LG(e){return Lv(e).toLowerCase()==="c:/"?e.replace(/^c:[/\\]/i,"/"):e}var Km=new Set;process.on("exit",()=>{Km.forEach(e=>e())});var OG=class{constructor(e){this.c=null,this.h=null,this.l=!1,this.m=null,this.r=null,this.s=0,this.a=e,this.b=e.filePattern||"",this.d=e.includePattern&&Kr(e.includePattern),this.f=e.maxResults||null,this.g=!!e.exists,this.v=Object.create(null),this.k=0,this.j=!1,this.o=0,this.p=0,this.q=[],this.b&&(this.c=e.shouldGlobMatchFilePattern?null:P4(this.b).normalizedLowercase),this.u=e.excludePattern&&Kr(e.excludePattern),this.t=new Map,e.folderQueries.forEach(t=>{const i={};t.excludePattern?.forEach(s=>{Object.assign(i,s.pattern||{},this.a.excludePattern||{})}),t.excludePattern?.length||Object.assign(i,this.a.excludePattern||{});const r=t.folder.fsPath;e.folderQueries.map(s=>s.folder.fsPath).filter(s=>s!==r).forEach(s=>{zo(s,r)&&(i[tc(r,s)]=!0)}),this.t.set(r,new FG(i,r))})}cancel(){this.l=!0,Km.forEach(e=>e())}walk(e,t,i,r,s,n){if(this.m=Ji.create(!1),this.l)return n(null,this.j);t.forEach(o=>{const a=At(o.fsPath);this.u&&this.u(o.fsPath,a)||this.J(r,{relativePath:o.fsPath,searchPath:void 0})}),this.r=Ji.create(!1),this.w(e,(o,a)=>{this.x(this.y,this,o,i,r,s,c=>{if(c){const l=ys(c);console.error(l),this.q.push(l),a(c,void 0)}else a(null,void 0)})},(o,a)=>{this.m.stop();const c=o?gt(o)[0]:null;n(c,this.j)})}w(e,t,i){const r=new Array(e.length),s=new Array(e.length);let n=!1,o=0;if(e.length===0)return i(null,[]);e.forEach((a,c)=>{t(a,(l,u)=>{if(l?(n=!0,r[c]=null,s[c]=l):(r[c]=u,s[c]=null),++o===e.length)return i(n?s:null,r)})})}x(e,t,...i){try{e.apply(t,i)}catch(r){i[i.length-1](r)}}y(e,t,i,r,s){const n=e.folder.fsPath,o=Dt,a=()=>f&&f.kill();Km.add(a);let c=b=>{Km.delete(a),c=()=>{},s(b)},l="";const u=this.D(),h=DG(this.a,e,this.a.includePattern,this.t.get(e.folder.fsPath).expression,t),f=h.cmd,p=!Object.keys(h.siblingClauses).length,g=h.rgArgs.args.map(b=>b.match(/^-/)?b:`'${b}'`).join(" ");let v=`${h.rgDiskPath} ${g}
 - cwd: ${h.cwd}`;h.rgArgs.siblingClauses&&(v+=`
 - Sibling clauses: ${JSON.stringify(h.rgArgs.siblingClauses)}`),r({message:v}),this.s=0,this.z(f,"utf8",r,(b,S,E)=>{if(b){c(b);return}if(this.j){c();return}const U=(l+(o?pf(S||""):S)).split(`
`);if(E){const O=U.length;U[O-1]=U[O-1].trim(),U[O-1]||U.pop()}else l=U.pop()||"";if(U.length&&U[0].indexOf(`
`)!==-1){c(new Error("Splitting up files failed"));return}if(this.s+=U.length,p){for(const O of U)if(this.J(i,{base:n,relativePath:O,searchPath:this.N(e,O)}),this.j){a();break}(E||this.j)&&c();return}this.G(e,u,n,U,i),E&&(this.H(u,n,i),c())})}spawnFindCmd(e){const t=this.t.get(e.folder.fsPath),i=t.getBasenameTerms(),r=t.getPathTerms(),s=["-L","."];if(i.length||r.length){s.push("-not","(","(");for(const n of i)s.push("-name",n),s.push("-o");for(const n of r)s.push("-path",n),s.push("-o");s.pop(),s.push(")","-prune",")")}return s.push("-type","f"),kG.spawn("find",s,{cwd:e.folder.fsPath})}readStdout(e,t,i){let r="";this.z(e,t,()=>{},(s,n,o)=>{if(s){i(s);return}r+=n,o&&i(null,r)})}z(e,t,i,r){let s=(a,c,l)=>{(a||l)&&(s=()=>{},this.r?.stop()),r(a,c,l)},n=!1;e.stdout?(this.A(e.stdout,t,s),e.stdout.once("data",()=>n=!0)):i({message:"stdout is null"});let o;e.stderr?o=this.B(e.stderr):i({message:"stderr is null"}),e.on("error",a=>{s(a)}),e.on("close",a=>{let c;!n&&(c=this.C(o,t))&&UG(c)?s(new Error(`command failed with error code ${a}: ${this.C(o,t)}`)):(this.g&&a===0&&(this.j=!0),s(null,"",!0))})}A(e,t,i){const r=new B8(t);return e.on("data",s=>{i(null,r.write(s))}),r}B(e){const t=[];return e.on("data",i=>{t.push(i)}),t}C(e,t){const i=new B8(t);return e.map(r=>i.write(r)).join("")}D(){const e={rootEntries:[],pathToEntries:Object.create(null)};return e.pathToEntries["."]=e.rootEntries,e}G(e,{pathToEntries:t},i,r,s){r.indexOf(this.b)!==-1&&this.J(s,{base:i,relativePath:this.b,searchPath:this.N(e,this.b)});const n=o=>{const a=At(o),c=Mi(o);let l=t[c];l||(l=t[c]=[],n(c)),l.push({base:i,relativePath:o,basename:a,searchPath:this.N(e,o)})};r.forEach(n)}H({rootEntries:e,pathToEntries:t},i,r){const s=this,n=this.t.get(i),o=this.b;function a(c){s.o++;const l=Uy(()=>c.map(u=>u.basename));for(let u=0,h=c.length;u<h;u++){const f=c[u],{relativePath:p,basename:g}=f;if(n.test(p,g,o!==g?l:void 0))continue;const v=t[p];if(v)a(v);else{if(s.p++,p===o)continue;s.J(r,f)}if(s.j)break}}a(e)}getStats(){return{cmdTime:this.r.elapsed(),fileWalkTime:this.m.elapsed(),directoriesWalked:this.o,filesWalked:this.p,cmdResultCount:this.s}}I(e,t,i,r,s){const n=e.folder,o=Uy(()=>i);this.w(i,(a,c)=>{if(this.l||this.j)return c(null);const l=t?[t,a].join(St):a;if(this.t.get(e.folder.fsPath).test(l,a,this.a.filePattern!==a?o:void 0))return c(null);const u=[n.fsPath,l].join(St);T4.lstat(u,(h,f)=>{if(h||this.l||this.j)return c(null);this.L(u,f,(p,g)=>p||this.l||this.j?c(null):g.isDirectory()?(this.o++,this.M(u,f,(v,b)=>v||this.l||this.j||(b=b||"",this.v[b])?c(null):(this.v[b]=!0,nt.readdir(u).then(S=>{if(this.l||this.j)return c(null);this.I(e,l,S,r,E=>c(E||null))},S=>{c(null)})))):(this.p++,l===this.b||this.h&&Er(g.size)&&g.size>this.h||this.J(r,{base:n.fsPath,relativePath:l,searchPath:this.N(e,l)}),c(null,void 0)))})},a=>{const c=a&&gt(a);return s(c&&c.length>0?c[0]:void 0)})}J(e,t){this.K(t)&&(!this.d||this.d(t.relativePath,At(t.relativePath)))&&(this.k++,(this.g||this.f&&this.k>this.f)&&(this.j=!0),this.j||e(t))}K(e){if(this.b){if(this.b==="*")return!0;if(this.c)return Fy(e,this.c);if(this.b)return Fy(e,this.b,!1)}return!0}L(e,t,i){return t.isSymbolicLink()?T4.stat(e,i):i(null,t)}M(e,t,i){return t.isSymbolicLink()?T4.realpath(e,(r,s)=>r?i(r):i(null,s)):i(null,e)}N(e,t){return e.folderName?_e(e.folderName,t):t}},G8=class{constructor(e,t){this.a=e.folderQueries,this.b=e.extraFileResources||[],this.d=t,this.c=new OG(e)}search(e,t,i){this.c.walk(this.a,this.b,this.d,e,t,(r,s)=>{i(r,{limitHit:s,stats:this.c.getStats(),messages:[]})})}cancel(){this.c.cancel()}},FG=class{constructor(e,t){this.expression=e,this.c=t,this.d(e)}d(e){let t,i;Object.keys(e).filter(r=>e[r]).forEach(r=>{xr(r)?(t=t||DI(),t[r]=e[r]):(i=i||DI(),i[r]=e[r])}),this.a=t&&Kr(t,{trimForExclusions:!0}),this.b=i&&Kr(i,{trimForExclusions:!0})}test(e,t,i){return this.b&&this.b(e,t,i)||this.a&&this.a(_e(this.c,e),t,i)}getBasenameTerms(){const e=[];return this.a&&e.push(...OI(this.a)),this.b&&e.push(...OI(this.b)),e}getPathTerms(){const e=[];return this.a&&e.push(...FI(this.a)),this.b&&e.push(...FI(this.b)),e}};function UG(e){const t=e.trim().split(`
`),i=t[0].trim();if(i.startsWith("Error parsing regex"))return i;if(i.startsWith("regex parse error"))return f2(t[t.length-1].trim());if(i.startsWith("error parsing glob")||i.startsWith("unsupported encoding"))return i.charAt(0).toUpperCase()+i.substr(1);if(i==="Literal '\\n' not allowed.")return"Literal '\\n' currently not supported";if(i.startsWith("Literal "))return i}import*as jG from"child_process";import{EventEmitter as zG}from"events";import{StringDecoder as HG}from"string_decoder";import{RegExpParser as WG,RegExpVisitor as BG}from"vscode-regexpp";import{rgPath as _G}from"@vscode/ripgrep";var Z8=_G.replace(/\bnode_modules\.asar\b/,"node_modules.asar.unpacked"),J8=class{constructor(e,t){this.a=e,this.b=t}provideTextSearchResults(e,t,i,r){return Promise.all(t.folderOptions.map(s=>{const n={folderOptions:s,numThreads:this.b,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};return this.provideTextSearchResultsWithRgOptions(e,n,i,r)})).then(s=>({limitHit:s.some(o=>!!o&&o.limitHit)}))}provideTextSearchResultsWithRgOptions(e,t,i,r){return this.a.appendLine(`provideTextSearchResults ${e.pattern}, ${JSON.stringify({...t,folder:t.folderOptions.folder.toString()})}`),e.pattern?new Promise((s,n)=>{r.onCancellationRequested(()=>g());const o={...t,numThreads:this.b},a=ZG(e,o),c=t.folderOptions.folder.fsPath,l=a.map($=>$.match(/^-/)?$:`'${$}'`).join(" ");this.a.appendLine(`${Z8} ${l}
 - cwd: ${c}`);let u=jG.spawn(Z8,a,{cwd:c});u.on("error",$=>{console.error($),this.a.appendLine("Error: "+($&&$.message)),n(J7(new Ta($&&$.message,mo.rgProcessError)))});let h=!1;const f=new GG(t.maxResults??Kg,t.folderOptions.folder,c8(t.previewOptions));f.on("result",$=>{h=!0,b="",i.report($)});let p=!1;const g=()=>{p=!0,u?.kill(),f?.cancel()};let v=!1;f.on("hitLimit",()=>{v=!0,g()});let b="";u.stdout.on("data",$=>{f.handleData($),h||(b+=$)});let S=!1;u.stdout.once("data",()=>S=!0);let E="";u.stderr.on("data",$=>{const U=$.toString();this.a.appendLine(U),E.length+U.length<1e6&&(E+=U)}),u.on("close",()=>{if(this.a.appendLine(S?"Got data from stdout":"No data from stdout"),this.a.appendLine(h?"Got result from parser":"No result from parser"),b&&this.a.appendLine(`Got data without result: ${b}`),this.a.appendLine(""),p)s({limitHit:v});else{f.flush(),u=null;let $;E&&!S&&($=VG(E))?n(J7(new Ta($.message,$.code))):s({limitHit:v})}})}):Promise.resolve({limitHit:!1})}};function VG(e){const t=e.split(`
`),i=t[0].trim();if(t.some(s=>s.startsWith("regex parse error")))return new Ta(qG(t),mo.regexParseError);const r=i.match(/grep config error: unknown encoding: (.*)/);if(r)return new Ta(`Unknown encoding: ${r[1]}`,mo.unknownEncoding);if(i.startsWith("error parsing glob"))return new Ta(i.charAt(0).toUpperCase()+i.substr(1),mo.globParseError);if(i.startsWith("the literal"))return new Ta(i.charAt(0).toUpperCase()+i.substr(1),mo.invalidLiteral);if(i.startsWith("PCRE2: error compiling pattern"))return new Ta(i,mo.regexParseError)}function qG(e){const t=["Regex parse error"],i=e.filter(r=>r.startsWith("PCRE2:"));if(i.length>=1){const r=i[0].replace("PCRE2:","");if(r.indexOf(":")!==-1&&r.split(":").length>=2){const s=r.split(":")[1];t.push(":"+s)}}return t.join("")}var GG=class extends zG{constructor(e,t,i){super(),this.g=e,this.h=t,this.j=i,this.a="",this.b=!1,this.c=!1,this.f=0,this.d=new HG}cancel(){this.b=!0}flush(){this.k(this.d.end())}on(e,t){return super.on(e,t),this}handleData(e){if(this.b)return;const t=typeof e=="string"?e:this.d.write(e);this.k(t)}k(e){let t=e.indexOf(`
`);const i=this.a+e;if(t>=0)t+=this.a.length;else{this.a=i;return}let r=0;for(;t>=0;)this.m(i.substring(r,t).trim()),r=t+1,t=i.indexOf(`
`,r);this.a=i.substring(r)}m(e){if(this.b||!e)return;let t;try{t=JSON.parse(e)}catch{throw new Error(`malformed line from rg: ${e}`)}if(t.type==="match"){const i=sd(t.data.path),r=y.joinPath(this.h,i),s=this.n(t.data,r);this.p(s),this.c&&(this.cancel(),this.emit("hitLimit"))}else if(t.type==="context"){const i=sd(t.data.path),r=y.joinPath(this.h,i);this.o(t.data,r).forEach(n=>this.p(n))}}n(e,t){const i=e.line_number-1,r=sd(e.lines),s=Buffer.from(r);let n=0,o=0,a=i;e.submatches.length===0&&e.submatches.push(r.length?{start:0,end:1,match:{text:r[0]}}:{start:0,end:0,match:{text:""}});const c=gt(e.submatches.map((h,f)=>{if(this.c)return null;this.f++,this.f>=this.g&&(this.c=!0);const p=sd(h.match),g=s.slice(n,h.start).toString(),v=Q8(g),b=v.numLines>0?v.lastLineLength:v.lastLineLength+o,S=Q8(p),E=v.numLines+a,$=S.numLines+E,U=S.numLines>0?S.lastLineLength:S.lastLineLength+b;return n=h.end,o=U,a=$,new U7(E,b,$,U)})),l=Bd(c,$G),u=new _7(r,l,this.j);return new ln(t,u.rangeLocations.map(h=>({sourceRange:_8(h.source),previewRange:_8(h.preview)})),u.previewText)}o(e,t){const i=sd(e.lines),r=e.line_number;return i.replace(/\r?\n$/,"").split(`
`).map((s,n)=>new Yg(t,s,r+n))}p(e){this.emit("result",e)}};function sd(e){return e.bytes?Buffer.from(e.bytes,"base64").toString():e.text}function Q8(e){const t=/\n/g;let i=0,r=-1,s;for(;s=t.exec(e);)i++,r=s.index;const n=r>=0?e.length-r-1:e.length;return{numLines:i,lastLineLength:n}}function ZG(e,t){const i=["--hidden","--no-require-git"];i.push(e.isCaseSensitive?"--case-sensitive":"--ignore-case");const{doubleStarIncludes:r,otherIncludes:s}=lv(t.folderOptions.includes,o=>o.startsWith("**")?"doubleStarIncludes":"otherIncludes");if(s&&s.length){const o=new Set;s.forEach(a=>{o.add(a)}),i.push("-g","!*"),o.forEach(a=>{JG(a).map(Ym).forEach(c=>{i.push("-g",c)})})}r&&r.length&&r.forEach(o=>{i.push("-g",o)}),t.folderOptions.excludes.map(o=>typeof o=="string"?o:o.pattern).map(Ym).forEach(o=>i.push("-g",`!${o}`)),t.maxFileSize&&i.push("--max-filesize",t.maxFileSize+""),t.folderOptions.useIgnoreFiles.local?t.folderOptions.useIgnoreFiles.parent||i.push("--no-ignore-parent"):i.push("--no-ignore"),t.folderOptions.followSymlinks&&i.push("--follow"),t.folderOptions.encoding&&t.folderOptions.encoding!=="utf8"&&i.push("--encoding",t.folderOptions.encoding),t.numThreads&&i.push("--threads",`${t.numThreads}`),e.pattern==="--"&&(e.isRegExp=!0,e.pattern="\\-\\-"),e.isMultiline&&!e.isRegExp&&(e.pattern=Rn(e.pattern),e.isRegExp=!0),t.usePCRE2&&i.push("--pcre2"),i.push("--crlf"),e.isRegExp&&(e.pattern=QG(e.pattern),i.push("--engine","auto"));let n;if(e.isWordMatch){const a=IE(e.pattern,!!e.isRegExp,{wholeWord:e.isWordMatch}).source.replace(/\\\//g,"/");i.push("--regexp",a)}else if(e.isRegExp){let o=YG(e.pattern);o=XG(o),i.push("--regexp",o)}else n=e.pattern,i.push("--fixed-strings");return i.push("--no-config"),t.folderOptions.useIgnoreFiles.global||i.push("--no-ignore-global"),i.push("--json"),e.isMultiline&&i.push("--multiline"),t.surroundingContext&&(i.push("--before-context",t.surroundingContext+""),i.push("--after-context",t.surroundingContext+"")),i.push("--"),n&&i.push(n),i.push("."),i}function JG(e){return X8(e).flatMap(i=>{const r=Nu(i,"/");return r.map((s,n)=>r.slice(0,n+1).join("/"))})}function QG(e){const t=/((?:[^\\]|^)(?:\\\\)*)\\u([a-z0-9]{4})/gi;for(;e.match(t);)e=e.replace(t,"$1\\x{$2}");const i=/((?:[^\\]|^)(?:\\\\)*)\\u\{([a-z0-9]{4})\}/gi;for(;e.match(i);)e=e.replace(i,"$1\\x{$2}");return e}var Y8=e=>e.type==="Assertion"&&e.kind==="lookbehind";function YG(e){let t;try{t=new WG().parsePattern(e)}catch{return e}let i="",r=0;const s=(a,c,l)=>{i+=e.slice(r,a)+l,r=c},n=[];return new BG({onCharacterEnter(a){if(a.raw!=="\\n")return;const c=n[0];if(!c)s(a.start,a.end,"\\r?\\n");else if(!n.some(Y8))if(c.type==="CharacterClass")if(c.negate){const l=e.slice(c.start+2,a.start)+e.slice(a.end,c.end-1);c.parent?.type==="Quantifier"?s(c.start,c.end,l?`[^${l}]`:"."):s(c.start,c.end,"(?!\\r?\\n"+(l?`|[${l}]`:"")+")")}else{const l=e.slice(c.start+1,a.start)+e.slice(a.end,c.end-1);s(c.start,c.end,l===""?"\\r?\\n":`(?:[${l}]|\\r?\\n)`)}else c.type==="Quantifier"&&s(a.start,a.end,"(?:\\r?\\n)")},onQuantifierEnter(a){n.unshift(a)},onQuantifierLeave(){n.shift()},onCharacterClassRangeEnter(a){n.unshift(a)},onCharacterClassRangeLeave(){n.shift()},onCharacterClassEnter(a){n.unshift(a)},onCharacterClassLeave(){n.shift()},onAssertionEnter(a){Y8(a)&&n.push(a)},onAssertionLeave(a){n[0]===a&&n.shift()}}).visit(t),i+=e.slice(r),i}function XG(e){return e.replace(/\n/g,"\\r?\\n")}function KG(e){let t=!1,i=!1,r="",s="";for(let n=0;n<e.length;n++){const o=e[n];switch(o){case"\\":i?(t?s+="\\"+o:r+="\\"+o,i=!1):i=!0;break;case"{":if(i)t?s+=o:r+=o,i=!1;else{if(t)return{strInBraces:r+"{"+s+"{"+e.substring(n+1)};t=!0}break;case"}":if(i)t?s+=o:r+=o,i=!1;else{if(t)return{fixedStart:r,strInBraces:s,fixedEnd:e.substring(n+1)};r+=o}break;default:t?s+=(i?"\\":"")+o:r+=(i?"\\":"")+o,i=!1;break}}return{strInBraces:r+(t?"{"+s:"")}}function X8(e){const{fixedStart:t,strInBraces:i,fixedEnd:r}=KG(e);if(t===void 0||r===void 0)return[i];let s=Nu(i,",");s.length||(s=[""]);const n=X8(r);return s.flatMap(o=>{const a=t+o;return n.map(c=>a+c)})}var K8=class extends h4{constructor(e,t,i=ff,r="searchProcess"){super({query:e,provider:t},{readdir:s=>i.Promises.readdir(s.fsPath),toCanonicalName:s=>PB(s)},r)}},eZ=class{constructor(e,t){this.a=e,this.b=t}search(e,t,i){if((!this.a.folderQueries||!this.a.folderQueries.length)&&(!this.a.extraFileResources||!this.a.extraFileResources.length))return Promise.resolve({type:"success",limitHit:!1,stats:{type:"searchProcess"},messages:[]});const r={appendLine(n){i({message:n})}},s=new K8(this.a,new J8(r,this.b),ff);return new Promise((n,o)=>s.search(a=>{t(a.map(tZ))},e).then(a=>n({limitHit:a.limitHit??!1,type:"success",stats:a.stats,messages:[]}),o))}};function tZ(e){return{path:e.resource&&e.resource.fsPath,results:e.results,numMatches:(e.results||[]).reduce((t,i)=>Ly(i)?t+i.rangeLocations.length:t+1,0)}}var iZ=class K1{static{this.a=512}constructor(t="searchProcess",i){this.d=t,this.f=i,this.b=Object.create(null)}fileSearch(t){let i;const r=eP(t),s=new I({onDidAddFirstListener:()=>{i=Js(async n=>{const o=await this.f?.();return this.doFileSearchWithEngine(G8,r,a=>s.fire(a),n,K1.a,o)}),i.then(n=>s.fire(n),n=>s.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return s.event}textSearch(t){let i;const r=eP(t),s=new I({onDidAddFirstListener:()=>{i=Js(n=>this.g(r,o=>s.fire(o),n)),i.then(n=>s.fire(n),n=>s.fire({type:"error",error:{message:n.message,stack:n.stack}}))},onDidRemoveLastListener:()=>{i.cancel()}});return s.event}async g(t,i,r){t.maxFileSize=this.h().maxFileSize;const s=await this.f?.();return new eZ(t,s).search(r,i,i)}h(){return{maxFileSize:16*k$.GB}}doFileSearch(t,i,r,s){return this.doFileSearchWithEngine(G8,t,r,s,K1.a,i)}doFileSearchWithEngine(t,i,r,s,n=K1.a,o){let a=0;const c=u=>{Array.isArray(u)?(a+=u.length,r(u.map(h=>this.j(h)))):u.relativePath?(a++,r(this.j(u))):r(u)};if(i.sortByScore){let u=this.n(i,c,s);if(!u){const h=i.maxResults?Object.assign({},i,{maxResults:null}):i,f=new t(h,o);u=this.k(f,i,r,c,s)}return new Promise((h,f)=>{u.then(([p,g])=>{const v=g.map(b=>this.j(b));this.q(v,r,n),h(p)},f)})}const l=new t(i,o);return this.s(l,c,n,s).then(u=>({limitHit:u.limitHit,type:"success",stats:{detailStats:u.stats,type:this.d,fromCache:!1,resultCount:a,sortingTime:void 0},messages:[]}))}j(t){return{path:t.base?_e(t.base,t.relativePath):t.relativePath}}k(t,i,r,s,n){const o=new I;let a=Js(l=>{let u=[];const h=f=>{Array.isArray(f)?u=f:(s(f),o.fire(f))};return this.s(t,h,-1,l).then(f=>[f,u])}),c;if(i.cacheKey){c=this.l(i.cacheKey);const l={promise:a,event:o.event,resolved:!1};c.resultsToSearchCache[i.filePattern||""]=l,a.then(()=>{l.resolved=!0},u=>{delete c.resultsToSearchCache[i.filePattern||""]}),a=this.t(a)}return a.then(([l,u])=>{const h=c?c.scorerCache:Object.create(null),f=(typeof i.maxResults!="number"||i.maxResults>0)&&Ji.create(!1);return this.o(i,u,h,n).then(p=>{const g=f?f.elapsed():-1;return[{type:"success",stats:{detailStats:l.stats,sortingTime:g,fromCache:!1,type:this.d,resultCount:p.length},messages:l.messages,limitHit:l.limitHit||typeof i.maxResults=="number"&&u.length>i.maxResults},p]})})}l(t){const i=this.b[t];return i||(this.b[t]=new rZ)}n(t,i,r){const s=t.cacheKey&&this.b[t.cacheKey];if(!s)return;const n=this.r(s,t.filePattern||"",i,r);if(n)return n.then(([o,a,c])=>{const l=Ji.create(!1);return this.o(t,a,s.scorerCache,r).then(u=>{const h=l.elapsed(),f={fromCache:!0,detailStats:c,type:this.d,resultCount:a.length,sortingTime:h};return[{type:"success",limitHit:o.limitHit||typeof t.maxResults=="number"&&a.length>t.maxResults,stats:f,messages:[]},u]})})}o(t,i,r,s){const n=P4(t.filePattern||""),o=(c,l)=>AG(c,l,n,!0,sZ,r),a=typeof t.maxResults=="number"?t.maxResults:Kg;return jR(i,o,a,1e4,s)}q(t,i,r){if(r&&r>0)for(let s=0;s<t.length;s+=r)i(t.slice(s,s+r));else i(t)}r(t,i,r,s){const n=Ji.create(!1),o=i.indexOf(St)>=0;let a;for(const h in t.resultsToSearchCache)if(i.startsWith(h)){if(o&&h.indexOf(St)<0&&h!=="")continue;const f=t.resultsToSearchCache[h];a={promise:this.t(f.promise),event:f.event,resolved:f.resolved};break}if(!a)return null;const c=n.elapsed(),l=Ji.create(!1),u=a.event(r);return s&&s.onCancellationRequested(()=>{u.dispose()}),a.promise.then(([h,f])=>{if(s&&s.isCancellationRequested)throw Yl();const p=[],g=P4(i).normalizedLowercase;for(const v of f)Fy(v,g)&&p.push(v);return[h,p,{cacheWasResolved:a.resolved,cacheLookupTime:c,cacheFilterTime:l.elapsed(),cacheEntryCount:f.length}]})}s(t,i,r,s){return new Promise((n,o)=>{let a=[];s?.onCancellationRequested(()=>t.cancel()),t.search(c=>{c&&(r?(a.push(c),r>0&&a.length>=r&&(i(a),a=[])):i(c))},c=>{i(c)},(c,l)=>{a.length&&i(a),c?(i({message:"Search finished. Error: "+c.message}),o(c)):(i({message:"Search finished. Stats: "+JSON.stringify(l.stats)}),n(l))})})}clearCache(t){return delete this.b[t],Promise.resolve(void 0)}t(t){return new class{get[Symbol.toStringTag](){return this.toString()}cancel(){}then(i,r){return t.then(i,r)}catch(i){return this.then(void 0,i)}finally(i){return t.finally(i)}}}},rZ=class{constructor(){this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null)}},sZ=new class{getItemLabel(e){return At(e.relativePath)}getItemDescription(e){return Mi(e.relativePath)}getItemPath(e){return e.relativePath}};function eP(e){return{...e,folderQueries:e.folderQueries&&e.folderQueries.map(nZ),extraFileResources:e.extraFileResources&&e.extraFileResources.map(t=>y.revive(t))}}function nZ(e){return Gt(e)}var tP=class{constructor(e,t){this.b=e,this.c=t,this.a=new Set,process.once("exit",()=>this.f())}async provideTextSearchResults(e,t,i,r){const s=await this.c(),n=new J8(this.b,s);return Promise.all(t.folderOptions.map(o=>{const a={folderOptions:o,numThreads:s,maxResults:t.maxResults,previewOptions:t.previewOptions,maxFileSize:t.maxFileSize,surroundingContext:t.surroundingContext};if(o.folder.scheme===q.vscodeUserData){const c={...a,folder:o.folder.with({scheme:q.file})},l=new mm(u=>i.report({...u,uri:u.uri.with({scheme:o.folder.scheme})}));return this.d(r,u=>n.provideTextSearchResultsWithRgOptions(e,c,l,u))}else return this.d(r,c=>n.provideTextSearchResultsWithRgOptions(e,a,i,c))})).then(o=>({limitHit:o.some(c=>!!c&&c.limitHit)}))}async d(e,t){const i=oZ(e);this.a.add(i);const r=await t(i.token);return this.a.delete(i),r}f(){this.a.forEach(e=>e.cancel())}};function oZ(e){const t=new Qe;return e.onCancellationRequested(()=>t.cancel()),t}var M4=class extends Om{constructor(t,i,r,s,n){super(t,r,n),this.E=s,this.x=ff,this.y=-1,this.z=null,this.A=!1,this.C=new ie,this.D=!1,this.getNumThreads=this.getNumThreads.bind(this),this.getNumThreadsCached=this.getNumThreadsCached.bind(this),this.F=this.F.bind(this);const o=new Xm("RipgrepSearchUD",this.s);this.C.add(this.registerTextSearchProvider(q.vscodeUserData,new tP(o,this.getNumThreadsCached))),i.remote.isRemote&&i.remote.authority&&this.G(),s.getConfigProvider().then(a=>{this.D||this.C.add(a.onDidChangeConfiguration(this.F))})}F(t){t.affectsConfiguration("search")&&(this.B=void 0)}async getNumThreads(){return(await this.E.getConfigProvider()).getConfiguration("search").get("ripgrep.maxThreads")}async getNumThreadsCached(){return this.B||(this.B=this.getNumThreads()),this.B}dispose(){this.D=!0,this.C.dispose()}$enableExtensionHostSearch(){this.G()}G(){if(this.A)return;this.A=!0;const t=new Xm("RipgrepSearchEH",this.s);this.C.add(this.registerTextSearchProvider(q.file,new tP(t,this.getNumThreadsCached))),this.C.add(this.H(q.file,new iZ("fileSearchProvider",this.getNumThreadsCached)))}H(t,i){const r=this.e++;return this.z=i,this.y=r,this.c.$registerFileSearchProvider(r,this.t(t)),te(()=>{this.z=null,this.c.$unregisterProvider(r)})}$provideFileSearchResults(t,i,r,s){const n=Fm(r);if(t===this.y){const o=Date.now();return this.I(t,i,n,s).then(a=>{const c=Date.now()-o;return this.s.debug(`Ext host file search time: ${c}ms`),a})}return super.$provideFileSearchResults(t,i,r,s)}async doInternalFileSearchWithCustomCallback(t,i,r){const s=o=>{if(lB(o)&&(o=[o]),Array.isArray(o)){r(o.map(a=>y.file(a.path)));return}o.message&&this.s.debug("ExtHostSearch",o.message)};if(!this.z)throw new Error("No internal file search handler");const n=await this.getNumThreadsCached();return this.z.doFileSearch(t,n,s,i)}async I(t,i,r,s){return this.doInternalFileSearchWithCustomCallback(r,s,n=>{this.c.$handleFileMatch(t,i,n)})}$clearCache(t){return this.z?.clearCache(t),super.$clearCache(t)}v(t,i){return new K8(t,i,void 0,"textSearchProvider")}};M4=__decorate([__param(0,Ce),__param(1,Ft),__param(2,wu),__param(3,vr),__param(4,Se)],M4);function iP(e,t,i,r,s,n){if(Array.isArray(e)){let o=0;for(const a of e){const c=iP(a,t,i,r,s,n);if(c===10)return c;c>o&&(o=c)}return o}else{if(typeof e=="string")return r?e==="*"?5:e===i?10:0:0;if(e){const{language:o,pattern:a,scheme:c,hasAccessToAllModels:l,notebookType:u}=e;if(!r&&!l)return 0;u&&s&&(t=s);let h=0;if(c)if(c===t.scheme)h=10;else if(c==="*")h=5;else return 0;if(o)if(o===i)h=10;else if(o==="*")h=Math.max(h,5);else return 0;if(u)if(u===n)h=10;else if(u==="*"&&n!==void 0)h=Math.max(h,5);else return 0;if(a){let f;if(typeof a=="string"?f=a:f={...a,base:Zs(a.base)},f===t.fsPath||Ec(f,t.fsPath))h=10;else return 0}return h}else return 0}}function rP(e){return typeof e=="string"?!1:Array.isArray(e)?e.some(rP):!!e.notebookType}var N4;(function(e){e[e.None=0]="None",e[e.Indent=1]="Indent",e[e.IndentOutdent=2]="IndentOutdent",e[e.Outdent=3]="Outdent"})(N4||(N4={}));var rne=H("editSessionIdentityService"),R4;(function(e){e[e.Complete=100]="Complete",e[e.Partial=50]="Partial",e[e.None=0]="None"})(R4||(R4={}));var sne=new k("debugType",void 0,{type:"string",description:d(7735,null)}),nne=new k("debugConfigurationType",void 0,{type:"string",description:d(7736,null)}),one=new k("debugState","inactive",{type:"string",description:d(7737,null)}),aZ="debugUx",ane=new k(aZ,"default",{type:"string",description:d(7738,null)}),cne=new k("hasDebugged",!1,{type:"boolean",description:d(7739,null)}),lne=new k("inDebugMode",!1,{type:"boolean",description:d(7740,null)}),une=new k("inDebugRepl",!1,{type:"boolean",description:d(7741,null)}),hne=new k("breakpointWidgetVisible",!1,{type:"boolean",description:d(7742,null)}),dne=new k("inBreakpointWidget",!1,{type:"boolean",description:d(7743,null)}),fne=new k("breakpointsFocused",!0,{type:"boolean",description:d(7744,null)}),pne=new k("watchExpressionsFocused",!0,{type:"boolean",description:d(7745,null)}),gne=new k("watchExpressionsExist",!1,{type:"boolean",description:d(7746,null)}),mne=new k("variablesFocused",!0,{type:"boolean",description:d(7747,null)}),vne=new k("expressionSelected",!1,{type:"boolean",description:d(7748,null)}),wne=new k("breakpointInputFocused",!1,{type:"boolean",description:d(7749,null)}),bne=new k("callStackItemType",void 0,{type:"string",description:d(7750,null)}),yne=new k("callStackSessionIsAttach",!1,{type:"boolean",description:d(7751,null)}),Ane=new k("callStackItemStopped",!1,{type:"boolean",description:d(7752,null)}),Sne=new k("callStackSessionHasOneThread",!1,{type:"boolean",description:d(7753,null)}),Ene=new k("callStackFocused",!0,{type:"boolean",description:d(7754,null)}),xne=new k("watchItemType",void 0,{type:"string",description:d(7755,null)}),kne=new k("canViewMemory",void 0,{type:"boolean",description:d(7756,null)}),Cne=new k("breakpointItemType",void 0,{type:"string",description:d(7757,null)}),$ne=new k("breakpointItemBytes",void 0,{type:"boolean",description:d(7758,null)}),Ine=new k("breakpointHasModes",!1,{type:"boolean",description:d(7759,null)}),Dne=new k("breakpointSupportsCondition",!1,{type:"boolean",description:d(7760,null)}),Pne=new k("loadedScriptsSupported",!1,{type:"boolean",description:d(7761,null)}),Tne=new k("loadedScriptsItemType",void 0,{type:"string",description:d(7762,null)}),Mne=new k("focusedSessionIsAttach",!1,{type:"boolean",description:d(7763,null)}),Nne=new k("focusedSessionIsNoDebug",!1,{type:"boolean",description:d(7764,null)}),Rne=new k("stepBackSupported",!1,{type:"boolean",description:d(7765,null)}),Lne=new k("restartFrameSupported",!1,{type:"boolean",description:d(7766,null)}),One=new k("stackFrameSupportsRestart",!1,{type:"boolean",description:d(7767,null)}),Fne=new k("jumpToCursorSupported",!1,{type:"boolean",description:d(7768,null)}),Une=new k("stepIntoTargetsSupported",!1,{type:"boolean",description:d(7769,null)}),jne=new k("breakpointsExist",!1,{type:"boolean",description:d(7770,null)}),zne=new k("debuggersAvailable",!1,{type:"boolean",description:d(7771,null)}),Hne=new k("debugExtensionAvailable",!0,{type:"boolean",description:d(7772,null)}),Wne=new k("debugProtocolVariableMenuContext",void 0,{type:"string",description:d(7773,null)}),Bne=new k("debugSetVariableSupported",!1,{type:"boolean",description:d(7774,null)}),_ne=new k("debugSetDataBreakpointAddressSupported",!1,{type:"boolean",description:d(7775,null)}),Vne=new k("debugSetExpressionSupported",!1,{type:"boolean",description:d(7776,null)}),qne=new k("breakWhenValueChangesSupported",!1,{type:"boolean",description:d(7777,null)}),Gne=new k("breakWhenValueIsAccessedSupported",!1,{type:"boolean",description:d(7778,null)}),Zne=new k("breakWhenValueIsReadSupported",!1,{type:"boolean",description:d(7779,null)}),Jne=new k("terminateDebuggeeSupported",!1,{type:"boolean",description:d(7780,null)}),Qne=new k("suspendDebuggeeSupported",!1,{type:"boolean",description:d(7781,null)}),Yne=new k("terminateThreadsSupported",!1,{type:"boolean",description:d(7782,null)}),Xne=new k("variableEvaluateNamePresent",!1,{type:"boolean",description:d(7783,null)}),Kne=new k("variableIsReadonly",!1,{type:"boolean",description:d(7784,null)}),eoe=new k("variableValue",!1,{type:"string",description:d(7785,null)}),toe=new k("variableType",!1,{type:"string",description:d(7786,null)}),ioe=new k("variableInterfaces",!1,{type:"array",description:d(7787,null)}),roe=new k("variableName",!1,{type:"string",description:d(7788,null)}),soe=new k("variableLanguage",!1,{type:"string",description:d(7789,null)}),noe=new k("variableExtensionId",!1,{type:"string",description:d(7790,null)}),ooe=new k("exceptionWidgetVisible",!1,{type:"boolean",description:d(7791,null)}),aoe=new k("multiSessionRepl",!1,{type:"boolean",description:d(7792,null)}),coe=new k("multiSessionDebug",!1,{type:"boolean",description:d(7793,null)}),loe=new k("disassembleRequestSupported",!1,{type:"boolean",description:d(7794,null)}),uoe=new k("disassemblyViewFocus",!1,{type:"boolean",description:d(7795,null)}),hoe=new k("languageSupportsDisassembleRequest",!1,{type:"boolean",description:d(7796,null)}),doe=new k("focusedStackFrameHasInstructionReference",!1,{type:"boolean",description:d(7797,null)}),foe={enum:["neverOpen","openOnSessionStart","openOnFirstSessionStart"],default:"openOnFirstSessionStart",description:d(7799,null)},sP;(function(e){e[e.Inactive=0]="Inactive",e[e.Initializing=1]="Initializing",e[e.Stopped=2]="Stopped",e[e.Running=3]="Running"})(sP||(sP={}));var nP;(function(e){e[e.Valid=0]="Valid",e[e.Unreadable=1]="Unreadable",e[e.Error=2]="Error"})(nP||(nP={}));var oP;(function(e){e[e.Variable=0]="Variable",e[e.Address=1]="Address"})(oP||(oP={}));var e1;(function(e){e[e.Initial=1]="Initial",e[e.Dynamic=2]="Dynamic"})(e1||(e1={}));var aP;(function(e){e.UnverifiedBreakpoints="unverifiedBreakpoints"})(aP||(aP={}));var poe=H("debugService"),cP;(function(e){e[e.CONDITION=0]="CONDITION",e[e.HIT_COUNT=1]="HIT_COUNT",e[e.LOG_MESSAGE=2]="LOG_MESSAGE",e[e.TRIGGER_POINT=3]="TRIGGER_POINT"})(cP||(cP={}));var lP;(function(e){e[e.Command=0]="Command",e[e.Tree=1]="Tree"})(lP||(lP={}));var uP;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(uP||(uP={}));var hP;(function(e){e.deserialize=t=>t,e.serialize=t=>t})(hP||(hP={}));var dP;(function(e){e.deserialize=t=>({id:t.id,name:t.name,iconPath:t.iconPath&&{light:y.revive(t.iconPath.light),dark:y.revive(t.iconPath.dark)},iconClass:t.iconClass,visualization:t.visualization}),e.serialize=t=>t})(dP||(dP={}));var cZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(X.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,t,i){if(this.a.size===0)throw new Error("No related information providers registered");const r=this.a.get(e);if(!r)throw new Error("related information provider not found");return await r.provideRelatedInformation(t,i)??[]}getRelatedInformation(e,t,i){return this.c.$getAiRelatedInformation(t,i)}registerRelatedInformationProvider(e,t,i){const r=this.b;return this.b++,this.a.set(r,i),this.c.$registerAiRelatedInformationProvider(r,t),new ke(()=>{this.c.$unregisterAiRelatedInformationProvider(r),this.a.delete(r)})}},lZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(X.MainThreadAiSettingsSearch)}async $startSearch(e,t,i,r){if(this.a.size===0)throw new Error("No related information providers registered");const s=this.a.get(e);if(!s)throw new Error("Settings search provider not found");const n=new mm(o=>{this.c.$handleSearchResult(e,My.fromSettingsSearchResult(o))});return s.provideSettingsSearchResults(t,i,n,r)}registerSettingsSearchProvider(e,t){const i=this.b;return this.b++,this.a.set(i,t),this.c.$registerAiSettingsSearchProvider(i),new ke(()=>{this.c.$unregisterAiSettingsSearchProvider(i),this.a.delete(i)})}},fP;(function(e){e[e.Full=1]="Full",e[e.Delta=2]="Delta"})(fP||(fP={}));function pP(e){for(let t=0,i=e.length;t<i;t+=4){const r=e[t+0],s=e[t+1],n=e[t+2],o=e[t+3];e[t+0]=o,e[t+1]=n,e[t+2]=s,e[t+3]=r}}function uZ(e){const t=new Uint8Array(e.buffer,e.byteOffset,e.length*4);return SE()||pP(t),W.wrap(t)}function hZ(e){const t=e.buffer;if(SE()||pP(t),t.byteOffset%4===0)return new Uint32Array(t.buffer,t.byteOffset,t.length/4);{const i=new Uint8Array(t.byteLength);return i.set(t),new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function L4(e){const t=new Uint32Array(dZ(e));let i=0;if(t[i++]=e.id,e.type==="full")t[i++]=1,t[i++]=e.data.length,t.set(e.data,i),i+=e.data.length;else{t[i++]=2,t[i++]=e.deltas.length;for(const r of e.deltas)t[i++]=r.start,t[i++]=r.deleteCount,r.data?(t[i++]=r.data.length,t.set(r.data,i),i+=r.data.length):t[i++]=0}return uZ(t)}function dZ(e){let t=0;if(t+=2,e.type==="full")t+=1+e.data.length;else{t+=1,t+=3*e.deltas.length;for(const i of e.deltas)i.data&&(t+=i.data.length)}return t}function gP(e){const t=hZ(e);let i=0;const r=t[i++];if(t[i++]===1){const a=t[i++],c=t.subarray(i,i+a);return i+=a,{id:r,type:"full",data:c}}const n=t[i++],o=[];for(let a=0;a<n;a++){const c=t[i++],l=t[i++],u=t[i++];let h;u>0&&(h=t.subarray(i,i+u),i+=u),o[a]={start:c,deleteCount:l,data:h}}return{id:r,type:"delta",deltas:o}}var fZ=[new ye("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[B.Uri,B.Position],new be("A promise that resolves to an array of DocumentHighlight-instances.",cs(il.to))),new ye("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[B.Uri],new be("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(e,t)=>{if(gv(e))return;class i extends Wu{constructor(){super(...arguments),this.containerName=""}static to(s){const n=new i(s.name,Mr.to(s.kind),s.containerName||"",new rr(t[0],j.to(s.range)));return n.detail=s.detail,n.range=n.location.range,n.selectionRange=j.to(s.selectionRange),n.children=s.children?s.children.map(i.to):[],n}}return e.map(i.to)})),new ye("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[B.Uri,new B("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",cs(Kt.to))),new ye("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[B.Uri,B.Range,new B("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",cs(Kt.to))),new ye("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[B.Uri,B.Position,new B("ch","Trigger character",e=>typeof e=="string",e=>e),new B("options","Formatting options",e=>!0,e=>e)],new be("A promise that resolves to an array of TextEdits.",cs(Kt.to))),new ye("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location or LocationLink instances.",yo)),new ye("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location-instances.",cs(Hi.to))),new ye("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Location-instances.",cs(Hi.to))),new ye("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Hover-instances.",cs(yh.to))),new ye("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[B.Uri,B.Position],new be("A promise that resolves to an array of Hover-instances.",cs(yh.to))),new ye("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[B.Uri,new B("position","A position in a text document",e=>Array.isArray(e)&&e.every(t=>Pe.isPosition(t)),e=>e.map(Xe.from))],new be("A promise that resolves to an array of ranges.",e=>e.map(t=>{let i;for(const r of t.reverse())i=new Gu(j.to(r),i);return i}))),new ye("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[B.String.with("query","Search string")],new be("A promise that resolves to an array of SymbolInformation-instances.",e=>e.map(xa.to))),new ye("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[B.Uri,B.Position],new be("A promise that resolves to an array of CallHierarchyItem-instances",e=>e.map(ka.to))),new ye("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[B.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyIncomingCall-instances",e=>e.map(Qb.to))),new ye("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[B.CallHierarchyItem],new be("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",e=>e.map(Yb.to))),new ye("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[B.Uri,B.Position],new be("A promise that resolves to a range and placeholder text.",e=>{if(e)return{range:j.to(e.range),placeholder:e.text}})),new ye("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[B.Uri,B.Position,B.String.with("newName","The new symbol name")],new be("A promise that resolves to a WorkspaceEdit.",e=>{if(e){if(e.rejectReason)throw new Error(e.rejectReason);return nr.to(e)}})),new ye("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[B.Uri,B.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new be("A promise that resolves to an array of DocumentLink-instances.",e=>e.map(Ca.to))),new ye("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[B.Uri],new be("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new ub(e.tokenTypes,e.tokenModifiers)})),new ye("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[B.Uri],new be("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=gP(e);if(t.type==="full")return new Zc(t.data,void 0)})),new ye("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[B.Uri,B.Range.optional()],new be("A promise that resolves to SemanticTokensLegend.",e=>{if(e)return new ub(e.tokenTypes,e.tokenModifiers)})),new ye("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[B.Uri,B.Range],new be("A promise that resolves to SemanticTokens.",e=>{if(!e)return;const t=gP(e);if(t.type==="full")return new Zc(t.data,void 0)})),new ye("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[B.Uri,B.Position,B.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),B.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new be("A promise that resolves to a CompletionList-instance.",(e,t,i)=>{if(!e)return new Tc([]);const r=e.suggestions.map(s=>ry.to(s,i));return new Tc(r,e.incomplete)})),new ye("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[B.Uri,B.Position,B.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new be("A promise that resolves to SignatureHelp.",e=>{if(e)return Ah.to(e)})),new ye("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[B.Uri,B.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new be("A promise that resolves to an array of CodeLens-instances.",(e,t,i)=>cs(r=>new kp(j.to(r.range),r.command&&i.fromInternal(r.command)))(e))),new ye("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[B.Uri,new B("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",e=>xe.isRange(e),e=>Cs.isSelection(e)?ss.from(e):j.from(e)),B.String.with("kind","Code action kind to return code actions for").optional(),B.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new be("A promise that resolves to an array of Command-instances.",(e,t,i)=>cs(r=>{if(r._isSynthetic){if(!r.command)throw new Error("Synthetic code actions must have a command");return i.fromInternal(r.command)}else{const s=new qu(r.title,r.kind?new kt(r.kind):void 0);return r.edit&&(s.edit=nr.to(r.edit)),r.command&&(s.command=i.fromInternal(r.command)),s.isPreferred=r.isPreferred,s}})(e))),new ye("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[B.Uri],new be("A promise that resolves to an array of ColorInformation objects.",e=>e?e.map(t=>new Tp(j.to(t.range),rl.to(t.color))):[])),new ye("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new B("color","The color to show and insert",e=>e instanceof Uc,rl.from),new B("context","Context object with uri and range",e=>!0,e=>({uri:e.uri,range:j.from(e.range)}))],new be("A promise that resolves to an array of ColorPresentation objects.",e=>e?e.map($g.to):[])),new ye("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[B.Uri,B.Range],new be("A promise that resolves to an array of Inlay objects",(e,t,i)=>e.map(sy.to.bind(void 0,i)))),new ye("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[B.Uri],new be("A promise that resolves to an array of FoldingRange objects",(e,t)=>{if(e)return e.map(Pg.to)})),new ye("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new be("A promise that resolves to an array of NotebookContentProvider static info objects.",cs(e=>({viewType:e.viewType,displayName:e.displayName,options:{transientOutputs:e.options.transientOutputs,transientCellMetadata:e.options.transientCellMetadata,transientDocumentMetadata:e.options.transientDocumentMetadata},filenamePattern:e.filenamePattern.map(t=>Mg.to(t))})))),new ye("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[B.Uri,B.Range,new B("context","An InlineValueContext",e=>e&&typeof e.frameId=="number"&&e.stoppedLocation instanceof xe,e=>Ag.from(e))],new be("A promise that resolves to an array of InlineValue objects",e=>e.map(yg.to))),new ye("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new B("uriOrString","Uri-instance or string (only http/https)",e=>y.isUri(e)||typeof e=="string"&&N2(e,q.http,q.https),e=>e),new B("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Xt.from(e),void 0]:[Xt.from(e.viewColumn),Sh.from(e)])).optional(),B.String.with("label","").optional()],be.Void),new ye("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[B.Uri.with("resource","Resource to open"),B.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new B("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="number"||typeof e=="object",e=>e&&(typeof e=="number"?[Xt.from(e),void 0]:[Xt.from(e.viewColumn),Sh.from(e)])).optional()],be.Void),new ye("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[B.Uri.with("left","Left-hand side resource of the diff editor"),B.Uri.with("right","Right-hand side resource of the diff editor"),B.String.with("title","Human readable title for the diff editor").optional(),new B("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",e=>e===void 0||typeof e=="object",e=>e&&[Xt.from(e.viewColumn),Sh.from(e)]).optional()],be.Void),new ye("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[B.String.with("title","Human readable title for the changes editor"),new B("resourceList","List of resources to compare",e=>{for(const t of e){if(t.length!==3)return!1;const[i,r,s]=t;if(!y.isUri(i)||!y.isUri(r)&&r!==void 0&&r!==null||!y.isUri(s)&&s!==void 0&&s!==null)return!1}return!0},e=>e)],be.Void),new ye("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[B.Uri,B.Position],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map($a.to))),new ye("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[B.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map($a.to))),new ye("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[B.TypeHierarchyItem],new be("A promise that resolves to an array of TypeHierarchyItem-instances",e=>e.map($a.to))),new ye("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[B.TestItem],be.Void),new ye("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[B.TestProfile,B.Arr(B.TestItem)],be.Void),new ye("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[B.Arr(B.TestItem)],be.Void),new ye("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[B.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],be.Void),new ye("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[B.String.with("name","The context key name"),new B("value","The context key value",()=>!0,e=>e)],be.Void),new ye("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new B("Run arguments","",e=>!0,e=>{if(e)return{initialRange:e.initialRange?j.from(e.initialRange):void 0,initialSelection:Cs.isSelection(e.initialSelection)?ss.from(e.initialSelection):void 0,message:e.message,attachments:e.attachments,autoSend:e.autoSend,position:e.position?Xe.from(e.position):void 0}})],be.Void)],pZ=class{static register(e){fZ.forEach(e.registerApiCommand,e),this.a(e)}static a(e){e.registerCommand(!1,"_validateWhenClauses",HU)}};function cs(e){return t=>{if(Array.isArray(t))return t.map(e)}}function yo(e){if(!Array.isArray(e))return;const t=[];for(const i of e)dz(i)?t.push(bh.to(i)):t.push(Hi.to(i));return t}var O4=class{constructor(t,i){this.a=t.getProxy(X.MainThreadBulkEdits),this.b={getTextDocumentVersion:r=>i.getDocument(r)?.version,getNotebookDocumentVersion:()=>{}}}applyWorkspaceEdit(t,i,r){const s=new fi(nr.from(t,this.b));return this.a.$tryApplyWorkspaceEdit(s,void 0,r?.isRefactoring??!1)}};O4=__decorate([__param(0,Ce)],O4);function gZ(e){return!!e&&y.isUri(e.sessionResource)&&e.$mid===19}var mP;(function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"})(mP||(mP={}));var vP;(function(e){e[e.Complete=1]="Complete",e[e.Partial=2]="Partial",e[e.Omitted=3]="Omitted"})(vP||(vP={}));var wP;(function(e){e[e.NoReason=0]="NoReason",e[e.FilteredContentRetry=1]="FilteredContentRetry",e[e.CopyrightContentRetry=2]="CopyrightContentRetry"})(wP||(wP={}));var bP;(function(e){e.Pending="pending",e.Accepted="accepted",e.Rejected="rejected"})(bP||(bP={}));var yP;(function(e){e[e.Denied=0]="Denied",e[e.ConfirmationNotNeeded=1]="ConfirmationNotNeeded",e[e.Setting=2]="Setting",e[e.LmServicePerTool=3]="LmServicePerTool",e[e.UserAction=4]="UserAction",e[e.Skipped=5]="Skipped"})(yP||(yP={}));var AP;(function(e){let t;(function(l){l[l.WaitingForConfirmation=0]="WaitingForConfirmation",l[l.Executing=1]="Executing",l[l.WaitingForPostApproval=2]="WaitingForPostApproval",l[l.Completed=3]="Completed",l[l.Cancelled=4]="Cancelled"})(t=e.StateKind||(e.StateKind={}));function i(l,u){if(l.kind==="toolInvocationSerialized")return l.isConfirmed===void 0||typeof l.isConfirmed=="boolean"?{type:l.isConfirmed?4:0}:l.isConfirmed;const h=l.state.read(u);if(h.type!==0)return h.type===4?{type:h.reason}:h.confirmed}e.executionConfirmedOrDenied=i;function r(l,u){const h=i(l);if(h)return Promise.resolve(h);const f=new ie;return new Promise(p=>{u&&f.add(u.onCancellationRequested(()=>{p({type:0})})),f.add(zf(g=>{const v=i(l,g);v&&(f.dispose(),p(v))}))}).finally(()=>{f.dispose()})}e.awaitConfirmation=r;function s(l,u){const h=l.state.read(u);if(h.type===3)return h.postConfirmed||{type:1};if(h.type===4)return{type:h.reason}}function n(l,u){const h=l?.state.get();return h?.type===0||h?.type===2?(h.confirm(u),!0):!1}e.confirmWith=n;function o(l,u){const h=s(l);if(h)return Promise.resolve(h);const f=new ie;return new Promise(p=>{u&&f.add(u.onCancellationRequested(()=>{p({type:0})})),f.add(zf(g=>{const v=s(l,g);v&&(f.dispose(),p(v))}))}).finally(()=>{f.dispose()})}e.awaitPostConfirmation=o;function a(l,u){if(l.kind==="toolInvocationSerialized")return l.resultDetails;const h=l.state.read(u);if(h.type===3||h.type===2)return h.resultDetails}e.resultDetails=a;function c(l,u){if("isComplete"in l)return!0;const h=l.state.read(u);return h.type===3||h.type===4}e.isComplete=c})(AP||(AP={}));var t1;(function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"})(t1||(t1={}));var SP;(function(e){e.IncorrectCode="incorrectCode",e.DidNotFollowInstructions="didNotFollowInstructions",e.IncompleteCode="incompleteCode",e.MissingContext="missingContext",e.PoorlyWrittenOrFormatted="poorlyWrittenOrFormatted",e.RefusedAValidRequest="refusedAValidRequest",e.OffensiveOrUnsafe="offensiveOrUnsafe",e.Other="other",e.WillReportIssue="willReportIssue"})(SP||(SP={}));var EP;(function(e){e[e.Action=1]="Action",e[e.Toolbar=2]="Toolbar"})(EP||(EP={}));var xP;(function(e){e[e.Pending=0]="Pending",e[e.Complete=1]="Complete",e[e.Cancelled=2]="Cancelled",e[e.Failed=3]="Failed",e[e.NeedsInput=4]="NeedsInput"})(xP||(xP={}));var kP=H("IChatService"),F4=class{constructor(e,t,i,r,s){this.j=e,this.l=t,this.m=i,this.n=r,this.o=s,this.b=Ji.create(!1),this.c=!1}close(){this.c=!0}get timings(){return{firstProgress:this.d,totalElapsed:this.b.elapsed()}}get apiObject(){if(!this.g){let i=function(l){if(s.c){const u=new Error("Response stream has been closed");throw Error.captureStackTrace(u,l),u}},r=function(l,u){if(o.push(u!==void 0?[l,u]:l)===1&&queueMicrotask(()=>{const f=a;a=[],s.m.$handleProgressChunk(s.l.requestId,o).finally(()=>{f.forEach(p=>p())}),o.length=0}),u!==void 0)return new Promise(f=>{a.push(f)})};var e=i,t=r;const s=this;this.b.reset();let n=0;const o=[];let a=[];const c=(l,u)=>{if(typeof this.d>"u"&&(l.kind==="markdownContent"||l.kind==="markdownVuln"||l.kind==="prepareToolInvocation")&&(this.d=this.b.elapsed()),u){const h=n++,f=r(l,h),p={report:g=>{f.then(()=>{ji.isMarkdownString(g.value)?r(Dh.from(g),h):r(Da.from(g),h)})}};Promise.all([f,u(p)]).then(([g,v])=>{r(by.from(v),h)})}else r(l)};this.g=Object.freeze({clearToPreviousToolInvocation(l){return i(this.markdown),r({kind:"clearToPreviousToolInvocation",reason:l}),this},markdown(l){i(this.markdown);const u=new ig(l),h=kh.from(u);return c(h),this},markdownWithVulnerabilities(l,u){i(this.markdown),u&&T(s.j,"chatParticipantAdditions");const h=new fh(l,u),f=Ug.from(h);return c(f),this},codeblockUri(l,u){i(this.codeblockUri),T(s.j,"chatParticipantAdditions");const h=new ag(l,u),f=Fg.from(h);return c(f),this},filetree(l,u){i(this.filetree);const h=new sg(l,u),f=Ch.from(h);return c(f),this},anchor(l,u){const h=new ph(l,u);return this.push(h)},button(l){i(this.anchor);const u=new og(l),h=Th.from(u,s.n,s.o);return c(h),this},progress(l,u){i(this.progress);const h=new ng(l,u),f=u?zg.from(h):$h.from(h);return c(f,u),this},thinkingProgress(l){i(this.thinkingProgress),T(s.j,"chatParticipantAdditions");const u=new Xc(l.text??"",l.id,l.metadata),h=Ih.from(u);return c(h),this},warning(l){i(this.progress),T(s.j,"chatParticipantAdditions");const u=new gh(l),h=Dh.from(u);return c(h),this},reference(l,u){return this.reference2(l,u)},reference2(l,u,h){if(i(this.reference),typeof l=="object"&&"variableName"in l&&T(s.j,"chatParticipantAdditions"),typeof l=="object"&&"variableName"in l&&!l.value){const f=s.l.variables.variables.find(p=>p.name===l.variableName);if(f){let p;if(f.references?.length)p=f.references.map(g=>({kind:"reference",reference:{variableName:l.variableName,value:g.reference}}));else{const g=new ya(l,u,h);p=[Da.from(g)]}return p.forEach(g=>c(g)),this}}else{const f=new ya(l,u,h),p=Da.from(f);c(p)}return this},codeCitation(l,u,h){i(this.codeCitation),T(s.j,"chatParticipantAdditions");const f=new cg(l,u,h),p=_g.from(f);c(p)},textEdit(l,u){i(this.textEdit),T(s.j,"chatParticipantAdditions");const h=new mh(l,u);h.isDone=u===!0?!0:void 0;const f=Hg.from(h);return c(f),this},notebookEdit(l,u){i(this.notebookEdit),T(s.j,"chatParticipantAdditions");const h=new ug(l,u),f=Bg.from(h);return c(f),this},async externalEdit(l,u){i(this.externalEdit);const h=Array.isArray(l)?l:[l],f=n++,p=Tt();await r({kind:"externalEdits",start:!0,resources:h,undoStopId:p},f);try{return await u(),p}finally{await r({kind:"externalEdits",start:!1,resources:h,undoStopId:p},f)}},confirmation(l,u,h,f){i(this.confirmation),T(s.j,"chatParticipantAdditions");const p=new rg(l,u,h,f),g=jg.from(p);return c(g),this},prepareToolInvocation(l){i(this.prepareToolInvocation),T(s.j,"chatParticipantAdditions");const u=new vh(l),h=Ph.from(u);return c(h),this},push(l){if(i(this.push),(l instanceof mh||l instanceof ug||l instanceof fh||l instanceof gh||l instanceof rg||l instanceof cg||l instanceof lg||l instanceof Mb||l instanceof Pb||l instanceof Xc||l instanceof Nb||l instanceof ng)&&T(s.j,"chatParticipantAdditions"),l instanceof ya)this.reference2(l.value,l.iconPath,l.options);else if(l instanceof ng){const u=l.task?zg.from(l):$h.from(l);c(u,l.task)}else if(l instanceof Xc){const u=Ih.from(l);c(u)}else if(l instanceof ph){const u=fl.from(l);if(l.resolve){T(s.j,"chatParticipantAdditions"),u.resolveId=Tt();const h=new Qe;l.resolve(h.token).then(()=>{const f=fl.from(l);s.m.$handleAnchorResolve(s.l.requestId,u.resolveId,f)}).then(()=>h.dispose(),()=>h.dispose()),s.o.add(te(()=>h.dispose(!0)))}c(u)}else if(l instanceof vh){T(s.j,"chatParticipantAdditions");const u=Ph.from(l);return c(u),this}else{if(l instanceof Pb)return this.externalEdit(l.uris,l.callback).then(h=>l.didGetApplied(h)),this;{const u=Mh.from(l,s.n,s.o);c(u)}}return this}})}return this.g}},mZ=class _l extends Q{static{this.b=0}static{this.j=0}static{this.n=0}static{this.s=0}constructor(t,i,r,s,n,o,a,c){super(),this.F=i,this.G=r,this.H=s,this.I=n,this.J=o,this.L=a,this.M=c,this.c=new Map,this.m=new Map,this.q=new Map,this.t=new Map,this.u=this.D(new cL),this.w=this.D(new Mo),this.y=new Set,this.z=this.D(new I),this.onDidChangeChatRequestTools=this.z.event,this.C=this.D(new I),this.onDidDisposeChatSession=this.C.event,this.g=t.getProxy(X.MainThreadChatAgents2),r.registerArgumentProcessor({processArgument:l=>gZ(l)?null:l})}transferActiveChat(t){this.g.$transferActiveChatSession(t)}createChatAgent(t,i,r){const s=_l.b++,n=new CP(t,i,this.g,s,r);return this.c.set(s,n),this.g.$registerAgent(s,t.identifier,i,{},void 0),n.apiAgent}createDynamicChatAgent(t,i,r,s){const n=_l.b++,o=new CP(t,i,this.g,n,s);return this.c.set(n,o),this.g.$registerAgent(n,t.identifier,i,{isSticky:!0},r),o.apiAgent}registerChatParticipantDetectionProvider(t,i){const r=_l.j++;return this.m.set(r,new vZ(t,i)),this.g.$registerChatParticipantDetectionProvider(r),te(()=>{this.m.delete(r),this.g.$unregisterChatParticipantDetectionProvider(r)})}registerRelatedFilesProvider(t,i,r){const s=_l.n++;return this.q.set(s,new wZ(t,i)),this.g.$registerRelatedFilesProvider(s,r),te(()=>{this.q.delete(s),this.g.$unregisterRelatedFilesProvider(s)})}registerCustomAgentsProvider(t,i){const r=_l.s++;this.t.set(r,{extension:t,provider:i}),this.g.$registerCustomAgentsProvider(r,t.identifier);const s=new ie;return i.onDidChangeCustomAgents&&s.add(i.onDidChangeCustomAgents(()=>{this.g.$onDidChangeCustomAgents(r)})),s.add(te(()=>{this.t.delete(r),this.g.$unregisterCustomAgentsProvider(r)})),s}async $provideRelatedFiles(t,i,r){const s=this.q.get(t);if(!s)return Promise.resolve([]);const n=yy.to(i);return await s.provider.provideRelatedFiles(n,r)??void 0}async $provideCustomAgents(t,i,r){const s=this.t.get(t);return s?await s.provider.provideCustomAgents(i,r)??void 0:Promise.resolve(void 0)}async $detectChatParticipant(t,i,r,s,n){const o=this.m.get(t);if(!o)return;const{request:a,location:c,history:l}=await this.N(i,r,o.extension),u=await this.O(a,o.extension),h=pl.to(a,c,u,this.P(o.extension),this.Q(o.extension,a.userSelectedTools),o.extension,this.F);return o.provider.provideParticipantDetection(h,{history:l},{participants:s.participants,location:Vg.to(s.location)},n)}async N(t,i,r){const s=Gt(t),n=await this.R(r,s.agentId,i);let o;if(s.locationData?.type===li.EditorInline){const a=this.H.getDocument(s.locationData.document),c=this.I.getEditor(s.locationData.id);o=new E7(c.value,a,ss.to(s.locationData.selection),j.to(s.locationData.wholeRange))}else if(s.locationData?.type===li.Notebook){const a=this.H.getDocument(s.locationData.sessionInputUri);o=new x7(a)}else s.locationData?.type,li.Terminal;return{request:s,location:o,history:n}}async O(t,i){let r;if(t.userSelectedModelId&&(r=await this.J.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!r&&(r=await this.J.getDefaultLanguageModel(i),!r))throw new Error("Language model unavailable");return r}async $setRequestTools(t,i){const r=[...this.y].find(s=>s.requestId===t);if(r){r.extRequest.tools.clear();for(const[s,n]of this.Q(r.extension,i))r.extRequest.tools.set(s,n);this.z.fire(r.extRequest)}}async $invokeAgent(t,i,r,s){const n=this.c.get(t);if(!n)throw new Error(`[CHAT](${t}) CANNOT invoke agent because the agent is not registered`);let o,a;try{const{request:c,location:l,history:u}=await this.N(i,r,n.extension);let h=this.u.get(c.sessionResource);h||(h=new ie,this.u.set(c.sessionResource,h)),o=new F4(n.extension,c,this.g,this.G.converter,h);const f=await this.O(c,n.extension),p=pl.to(c,l,f,this.P(n.extension),this.Q(n.extension,c.userSelectedTools),n.extension,this.F);a={requestId:i.requestId,extRequest:p,extension:n.extension},this.y.add(a);let g;r.chatSessionContext&&(g={chatSessionItem:{resource:y.revive(r.chatSessionContext.chatSessionResource),label:r.chatSessionContext.isUntitled?"Untitled Session":"Session"},isUntitled:r.chatSessionContext.isUntitled});const v={history:u,chatSessionContext:g},b=n.invoke(p,v,o.apiObject,s);return await bZ(1e3,Promise.resolve(b).then(S=>{if(S?.metadata)try{JSON.stringify(S.metadata)}catch($){const U=`result.metadata MUST be JSON.stringify-able. Got error: ${$.message}`;return this.F.error(`[${n.extension.identifier.value}] [@${n.id}] ${U}`,n.extension),{errorDetails:{message:U},timings:o?.timings,nextQuestion:S.nextQuestion}}let E;return S?.errorDetails&&(E={...S.errorDetails,responseIsIncomplete:!0}),(E?.responseIsRedacted||E?.isQuotaExceeded||E?.isRateLimited||E?.confirmationButtons||E?.code)&&T(n.extension,"chatParticipantPrivate"),{errorDetails:E,timings:o?.timings,metadata:S?.metadata,nextQuestion:S?.nextQuestion,details:S?.details}}),s)}catch(c){this.F.error(c,n.extension),c instanceof an&&c.cause&&(c=c.cause);const l=c instanceof Error&&c.name==="ChatQuotaExceeded",u=c instanceof Error&&c.name==="ChatRateLimited";return{errorDetails:{message:ys(c),responseIsIncomplete:!0,isQuotaExceeded:l,isRateLimited:u}}}finally{a&&this.y.delete(a),o?.close()}}P(t){return et(t,"chatReferenceDiagnostic")?this.L.getDiagnostics():[]}Q(t,i){if(!i)return new Map;const r=new Map;for(const s of this.M.getTools(t))typeof i[s.name]=="boolean"&&r.set(s.name,i[s.name]);return r}async R(t,i,r){const s=[];for(const n of r.history){const o=gl.to(n.result),a=i===n.request.agentId?o:{...o,metadata:void 0},c=[],l=[];for(const p of n.request.variables.variables)if(p.kind==="tool")l.push(Pa.to(p));else if(p.kind==="toolset")l.push(...p.value.map(Pa.to));else{const g=qg.to(p,this.P(t),this.F);g&&c.push(g)}const u=et(t,"chatParticipantPrivate")?n.request.editedFileEvents:void 0,h=new hg(n.request.message,n.request.command,c,n.request.agentId,l,u,n.request.requestId);s.push(h);const f=gt(n.response.map(p=>Mh.toContent(p,this.G.converter)));s.push(new S7(f,a,n.request.agentId,n.request.command))}return s}$releaseSession(t){const i=y.revive(t);this.u.deleteAndDispose(i);const r=Ss.parseLocalSessionId(i);r&&this.C.fire(r)}async $provideFollowups(t,i,r,s,n){const o=this.c.get(i);if(!o)return Promise.resolve([]);const a=Gt(t),c=await this.R(o.extension,o.id,s),l=gl.to(r);return(await o.provideFollowups(l,{history:c},n)).filter(u=>{const h=!u.participant||Wt.some(this.c.values(),f=>f.id===u.participant&&Ye.equals(f.extension.identifier,o.extension.identifier));return h||this.F.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`),h}).map(u=>Lg.from(u,a))}$acceptFeedback(t,i,r){const s=this.c.get(t);if(!s)return;const n=gl.to(i);let o;switch(r.direction){case t1.Down:o=dh.Unhelpful;break;case t1.Up:o=dh.Helpful;break}const a={result:n,kind:o,unhelpfulReason:et(s.extension,"chatParticipantAdditions")?r.reason:void 0};s.acceptFeedback(Object.freeze(a))}$acceptAction(t,i,r){const s=this.c.get(t);if(!s||r.action.kind==="vote")return;const n=Ey.to(i,r,this.G.converter);n&&s.acceptAction(Object.freeze(n))}async $invokeCompletionProvider(t,i,r){const s=this.c.get(t);if(!s)return[];let n=this.w.get(t);return n?n.clear():(n=new ie,this.w.set(t,n)),(await s.invokeCompletionProvider(i,r)).map(a=>Sy.from(a,this.G.converter,n))}async $provideChatTitle(t,i,r){const s=this.c.get(t);if(!s)return;const n=await this.R(s.extension,s.id,{history:i});return await s.provideTitle({history:n},r)}async $provideChatSummary(t,i,r){const s=this.c.get(t);if(!s)return;const n=await this.R(s.extension,s.id,{history:i});return await s.provideSummary({history:n},r)}},vZ=class{constructor(e,t){this.extension=e,this.provider=t}},wZ=class{constructor(e,t){this.extension=e,this.provider=t}},CP=class{constructor(e,t,i,r,s){this.extension=e,this.id=t,this.u=i,this.w=r,this.x=s,this.j=new I,this.l=new I,this.t=new I}acceptFeedback(e){this.j.fire(e)}acceptAction(e){this.l.fire(e)}setChatRequestPauseState(e){this.t.fire(e)}async invokeCompletionProvider(e,t){return this.n?await this.n.provider.provideCompletionItems(e,t)??[]:[]}async provideFollowups(e,t,i){if(!this.b)return[];const r=await this.b.provideFollowups(e,t,i);return r?r.filter(s=>!(s&&"commandId"in s)).filter(s=>!(s&&"message"in s)):[]}async provideTitle(e,t){if(this.q)return await this.q.provideChatTitle(e,t)??void 0}async provideSummary(e,t){if(this.s)return await this.s.provideChatSummary(e,t)??void 0}get apiAgent(){let e=!1,t=!1;const i=()=>{e||t||(t=!0,queueMicrotask(()=>{this.u.$updateAgent(this.w,{icon:this.c?this.c instanceof y?this.c:"light"in this.c?this.c.light:void 0:void 0,iconDark:this.c&&"dark"in this.c?this.c.dark:void 0,themeIcon:this.c instanceof Di?this.c:void 0,hasFollowups:this.b!==void 0,helpTextPrefix:!this.d||typeof this.d=="string"?this.d:ge.from(this.d),helpTextPostfix:!this.g||typeof this.g=="string"?this.g:ge.from(this.g),supportIssueReporting:this.m,additionalWelcomeMessage:!this.o||typeof this.o=="string"?this.o:ge.from(this.o)}),t=!1}))},r=this;return{get id(){return r.id},get iconPath(){return r.c},set iconPath(s){r.c=s,i()},get requestHandler(){return r.x},set requestHandler(s){bv(typeof s=="function","Invalid request handler"),r.x=s},get followupProvider(){return r.b},set followupProvider(s){r.b=s,i()},get helpTextPrefix(){return T(r.extension,"defaultChatParticipant"),r.d},set helpTextPrefix(s){T(r.extension,"defaultChatParticipant"),r.d=s,i()},get helpTextPostfix(){return T(r.extension,"defaultChatParticipant"),r.g},set helpTextPostfix(s){T(r.extension,"defaultChatParticipant"),r.g=s,i()},get supportIssueReporting(){return T(r.extension,"chatParticipantPrivate"),r.m},set supportIssueReporting(s){T(r.extension,"chatParticipantPrivate"),r.m=s,i()},get onDidReceiveFeedback(){return r.j.event},set participantVariableProvider(s){if(T(r.extension,"chatParticipantAdditions"),r.n=s,s){if(!s.triggerCharacters.length)throw new Error("triggerCharacters are required");r.u.$registerAgentCompletionsProvider(r.w,r.id,s.triggerCharacters)}else r.u.$unregisterAgentCompletionsProvider(r.w,r.id)},get participantVariableProvider(){return T(r.extension,"chatParticipantAdditions"),r.n},set additionalWelcomeMessage(s){T(r.extension,"defaultChatParticipant"),r.o=s,i()},get additionalWelcomeMessage(){return T(r.extension,"defaultChatParticipant"),r.o},set titleProvider(s){T(r.extension,"defaultChatParticipant"),r.q=s,i()},get titleProvider(){return T(r.extension,"defaultChatParticipant"),r.q},set summarizer(s){T(r.extension,"defaultChatParticipant"),r.s=s},get summarizer(){return T(r.extension,"defaultChatParticipant"),r.s},get onDidChangePauseState(){return T(r.extension,"chatParticipantAdditions"),r.t.event},onDidPerformAction:et(this.extension,"chatParticipantAdditions")?this.l.event:void 0,dispose(){e=!0,r.b=void 0,r.j.dispose(),r.u.$unregisterAgent(r.w)}}}invoke(e,t,i,r){return this.x(e,t,i,r)}};function bZ(e,t,i){return new Promise((r,s)=>{const n=i.onCancellationRequested(async()=>{n.dispose(),await ri(e),r(void 0)});t.then(r,s).finally(()=>n.dispose())})}var yZ=class{constructor(e,t){this.c=t,this.b=new Map,this.a=e.getProxy(X.MainThreadChatOutputRenderer)}registerChatOutputRenderer(e,t,i){if(this.b.has(t))throw new Error(`Chat output renderer already registered for: ${t}`);return this.b.set(t,{extension:e,renderer:i}),this.a.$registerChatOutputRenderer(t,e.identifier,e.extensionLocation),new ke(()=>{this.b.delete(t),this.a.$unregisterChatOutputRenderer(t)})}async $renderChatOutput(e,t,i,r,s){const n=this.b.get(e);if(!n)throw new Error(`No chat output renderer registered for: ${e}`);const o=this.c.createNewWebview(r,{},n.extension);return n.renderer.renderChatOutput(Object.freeze({mime:t,value:i.buffer}),o,{},s)}},U4,AZ=class{constructor(e,t,i,r,s,n){this.session=e,this.extension=t,this.proxy=r,this.commandsConverter=s,this.sessionDisposables=n,this.a=new F4(t,i,r,s,n)}get activeResponseStream(){return this.a}getActiveRequestStream(e){return new F4(this.extension,e,this.proxy,this.commandsConverter,this.sessionDisposables)}},j4=class extends Q{static{U4=this}static{this.a=0}constructor(t,i,r,s){super(),this.n=t,this.q=i,this.s=r,this.t=s,this.c=new Map,this.f=new Map,this.g=0,this.h=0,this.j=new zt,this.m=new zt,this.b=this.s.getProxy(X.MainThreadChatSessions),t.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===25){const o=n.session.resource||n.sessionId,a=this.j.get(o);return a||(this.t.warn(`No chat session found for ID: ${o}`),n)}return n}})}registerChatSessionItemProvider(t,i,r){const s=this.g++,n=new ie;return this.c.set(s,{provider:r,extension:t,disposable:n,sessionType:i}),this.b.$registerChatSessionItemProvider(s,i),r.onDidChangeChatSessionItems&&n.add(r.onDidChangeChatSessionItems(()=>{this.b.$onDidChangeChatSessionItems(s)})),r.onDidCommitChatSessionItem&&n.add(r.onDidCommitChatSessionItem(o=>{const{original:a,modified:c}=o;this.b.$onDidCommitChatSessionItem(s,a.resource,c.resource)})),{dispose:()=>{this.c.delete(s),n.dispose(),this.b.$unregisterChatSessionItemProvider(s)}}}registerChatSessionContentProvider(t,i,r,s,n){const o=this.h++,a=new ie;return this.f.set(o,{provider:s,extension:t,capabilities:n,disposable:a}),this.b.$registerChatSessionContentProvider(o,i),s.onDidChangeChatSessionOptions&&a.add(s.onDidChangeChatSessionOptions(c=>{this.b.$onDidChangeChatSessionOptions(o,c.resource,c.updates)})),new ke(()=>{this.f.delete(o),a.dispose(),this.b.$unregisterChatSessionContentProvider(o)})}u(t){if(t!==void 0)switch(t){case 0:return 0;case 1:return 1;case 2:return 2;default:return}}w(t,i){return{resource:i.resource,label:i.label,description:i.description?ge.from(i.description):void 0,status:this.u(i.status),tooltip:ge.fromStrict(i.tooltip),timing:{startTime:i.timing?.startTime??0,endTime:i.timing?.endTime},changes:i.changes instanceof Array?i.changes:i.changes&&{files:i.changes?.files??0,insertions:i.changes?.insertions??0,deletions:i.changes?.deletions??0}}}async $provideNewChatSessionItem(t,i,r){const s=this.c.get(t);if(!s||!s.provider.provideNewChatSessionItem)throw new Error(`No provider registered for handle ${t} or provider does not support creating sessions`);try{const n=await this.y(i.request,s.extension),a={request:pl.to(Gt(i.request),void 0,n,[],new Map,s.extension,this.t),metadata:i.metadata},c=await s.provider.provideNewChatSessionItem(a,r);if(!c)throw new Error("Provider did not create session");return this.j.set(c.resource,c),this.w(s.sessionType,c)}catch(n){throw this.t.error(`Error creating chat session: ${n}`),n}}async $provideChatSessionItems(t,i){const r=this.c.get(t);if(!r)return this.t.error(`No provider registered for handle ${t}`),[];const s=await r.provider.provideChatSessionItems(i);if(!s)return[];const n=[];for(const o of s)this.j.set(o.resource,o),n.push(this.w(r.sessionType,o));return n}async $provideChatSessionContent(t,i,r){const s=this.f.get(t);if(!s)throw new Error(`No provider for handle ${t}`);const n=y.revive(i),o=await s.provider.provideChatSessionContent(n,r);if(r.isCancellationRequested)throw new dt;const a=new ie,c=U4.a++,l=n.toString(),u=new AZ(o,s.extension,{sessionResource:n,requestId:"ongoing",agentId:l,message:"",variables:{variables:[]},location:li.Chat},{$handleProgressChunk:(p,g)=>this.b.$handleProgressChunk(t,n,p,g),$handleAnchorResolve:(p,g,v)=>{this.b.$handleAnchorResolve(t,n,p,g,v)}},this.n.converter,a),h=a.add(new Qe);this.m.set(n,{sessionObj:u,disposeCts:h}),o.activeResponseCallback&&Promise.resolve(o.activeResponseCallback(u.activeResponseStream.apiObject,h.token)).finally(()=>{this.b.$handleProgressComplete(t,n,"ongoing")});const{capabilities:f}=s;return{id:c+"",resource:y.revive(n),hasActiveResponseCallback:!!o.activeResponseCallback,hasRequestHandler:!!o.requestHandler,supportsInterruption:!!f?.supportsInterruptions,options:o.options,history:o.history.map(p=>p instanceof hg?this.z(p):this.F(p,a))}}async $provideHandleOptionsChange(t,i,r,s){const n=y.revive(i),o=this.f.get(t);if(!o){this.t.warn(`No provider for handle ${t}`);return}if(!o.provider.provideHandleOptionsChange){this.t.debug(`Provider for handle ${t} does not implement provideHandleOptionsChange`);return}try{const a=r.map(c=>({optionId:c.optionId,value:c.value===void 0?void 0:typeof c.value=="string"?c.value:c.value.id}));await o.provider.provideHandleOptionsChange(n,a,s)}catch(a){this.t.error(`Error calling provideHandleOptionsChange for handle ${t}, sessionResource ${n}:`,a)}}async $provideChatSessionProviderOptions(t,i){const r=this.f.get(t);if(!r){this.t.warn(`No provider for handle ${t} when requesting chat session options`);return}const s=r.provider;if(s.provideChatSessionProviderOptions)try{const{optionGroups:n}=await s.provideChatSessionProviderOptions(i);return n?{optionGroups:n}:void 0}catch(n){this.t.error(`Error calling provideChatSessionProviderOptions for handle ${t}:`,n);return}}async $interruptChatSessionActiveResponse(t,i,r){this.m.get(y.revive(i))?.disposeCts.cancel()}async $disposeChatSessionContent(t,i){const r=this.m.get(y.revive(i));if(!r){this.t.warn(`No chat session found for resource: ${i}`);return}r.disposeCts.cancel(),r.sessionObj.sessionDisposables.dispose(),this.m.delete(y.revive(i))}async $invokeChatSessionRequestHandler(t,i,r,s,n){const o=this.m.get(y.revive(i));if(!o||!o.sessionObj.session.requestHandler)return{};const a=pl.to(r,void 0,await this.y(r,o.sessionObj.extension),[],new Map,o.sessionObj.extension,this.t),c=o.sessionObj.getActiveRequestStream(r);return await o.sessionObj.session.requestHandler(a,{history:s},c.apiObject,n),{}}async y(t,i){let r;if(t.userSelectedModelId&&(r=await this.q.getLanguageModelByIdentifier(i,t.userSelectedModelId)),!r&&(r=await this.q.getDefaultLanguageModel(i),!r))throw new Error("Language model unavailable");return r}z(t){const i=t.references.map(r=>this.C(r));return{type:"request",id:t.id,prompt:t.prompt,participant:t.participant,command:t.command,variableData:i.length>0?{variables:i}:void 0}}C(t){const i=t.value&&typeof t.value=="object"&&"uri"in t.value&&"range"in t.value?Tr.from(t.value):t.value,r=t.range?{start:t.range[0],endExclusive:t.range[1]}:void 0;if(i&&i instanceof Ub&&Array.isArray(i.diagnostics)&&i.diagnostics.length&&i.diagnostics[0][1].length){const o=Ea.from(i.diagnostics[0][1][0]),a={filterRange:{startLineNumber:o.startLineNumber,startColumn:o.startColumn,endLineNumber:o.endLineNumber,endColumn:o.endColumn},filterSeverity:o.severity,filterUri:i.diagnostics[0][0],problemMessage:i.diagnostics[0][1][0].message};return K0.toEntry(a)}if(rr.isLocation(t.value)&&t.name.startsWith("sym:")){const o=Tr.from(t.value);return{id:t.id,name:t.name,fullName:t.name.substring(4),value:{uri:t.value.uri,range:o.range},symbolKind:6,icon:Z0.toIcon(6),kind:"symbol",range:r}}if(y.isUri(i)&&t.name.startsWith("prompt:")&&t.id.startsWith(ew.PromptFile)&&t.id.endsWith(i.toString()))return{id:t.id,name:`prompt:${dr(i)}`,value:i,kind:"promptFile",modelDescription:"Prompt instructions file",isRoot:!0,automaticallyAdded:!1,range:r};const s=y.isUri(i)||i&&typeof i=="object"&&"uri"in i,n=s&&y.isUri(i)&&i.path.endsWith("/");return{id:t.id,name:t.name,value:i,modelDescription:t.modelDescription,range:r,kind:n?"directory":s?"file":"generic"}}F(t,i){return{type:"response",parts:gt(t.response.map(s=>Mh.from(s,this.n.converter,i))),participant:t.participant}}};j4=U4=__decorate([__param(2,Ce),__param(3,Se)],j4);var SZ=class{constructor(e){this.b=new Map,this.a=e.getProxy(X.MainThreadChatStatus)}createChatStatusItem(e,t){const i=EZ(e.identifier,t);if(this.b.has(i))throw new Error(`Chat status item '${t}' already exists`);const r={id:i,title:"",description:"",detail:""};let s=!1,n=!1;const o=()=>{if(s)throw new Error("Chat status item is disposed");n&&this.a.$setEntry(t,r)},a=Object.freeze({id:t,get title(){return r.title},set title(c){r.title=c,o()},get description(){return r.description},set description(c){r.description=c,o()},get detail(){return r.detail},set detail(c){r.detail=c,o()},show:()=>{n=!0,o()},hide:()=>{n=!1,this.a.$disposeEntry(t)},dispose:()=>{s=!0,this.a.$disposeEntry(t),this.b.delete(i)}});return this.b.set(i,a),a}};function EZ(e,t){return`${Ye.toKey(e)}.${t}`}var xZ=class{constructor(e){const t=e.getProxy(X.MainThreadClipboard);this.value=Object.freeze({readText(){return t.$readText()},writeText(i){return t.$writeText(i)}})}},$P="vscode-cdn.net",kZ=`vscode-resource.${$P}`,z4=`'self' https://*.${$P}`;function nd(e,t){return e.scheme===q.http||e.scheme===q.https?e:(t&&t.authority&&t.isRemote&&e.scheme===q.file&&(e=y.from({scheme:q.vscodeRemote,authority:t.authority,path:e.path})),y.from({scheme:q.https,authority:`${e.scheme}+${CZ(e.authority)}.${kZ}`,path:e.path,fragment:e.fragment,query:e.query}))}function CZ(e){return e.replace(/./g,t=>{const i=t.charCodeAt(0);return i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57?t:"-"+i.toString(16).padStart(4,"0")})}var $Z=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i,this.a=0,this.b=new ie,this.c=new Map,this.b.add(t.onDidChangeVisibleTextEditors(()=>{const r=t.getVisibleTextEditors();for(const s of this.c.values())r.indexOf(s.editor)<0&&s.inset.dispose()}))}dispose(){this.c.forEach(e=>e.inset.dispose()),this.b.dispose()}createWebviewEditorInset(e,t,i,r,s){let n;for(const f of this.e.getVisibleTextEditors(!0))if(f.value===e){n=f;break}if(!n)throw new Error("not a visible editor");const o=this,a=this.a++,c=new I,l=new I,u=new class{constructor(){this.a="",this.b=Object.create(null)}asWebviewUri(f){return nd(f,o.f)}get cspSource(){return z4}set options(f){this.b=f,o.d.$setOptions(a,f)}get options(){return this.b}set html(f){this.a=f,o.d.$setHtml(a,f)}get html(){return this.a}get onDidReceiveMessage(){return c.event}postMessage(f){return o.d.$postMessage(a,f)}},h=new class{constructor(){this.editor=e,this.line=t,this.height=i,this.webview=u,this.onDidDispose=l.event}dispose(){o.c.delete(a)&&(o.d.$disposeEditorInset(a),l.fire(),l.dispose(),c.dispose())}};return this.d.$createEditorInset(a,n.id,n.value.document.uri,t+1,i,r||{},s.identifier,s.extensionLocation),this.c.set(a,{editor:e,inset:h,onDidReceiveMessage:c}),h}$onDidDispose(e){const t=this.c.get(e);t&&t.inset.dispose()}$onDidReceiveMessage(e,t){this.c.get(e)?.onDidReceiveMessage.fire(t)}},IZ=class DN{static{this.a=0}constructor(t){this.c=new Map,this.b=t.getProxy(X.MainThreadCodeMapper)}async $mapCode(t,i,r){const s=this.c.get(t);if(!s)throw new Error(`Received request to map code for unknown provider handle ${t}`);const n={textEdit:(c,l)=>{l=Sr(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(Kt.from)})},notebookEdit:(c,l)=>{l=Sr(l),this.b.$handleProgress(i.requestId,{uri:c,edits:l.map(Wg.from)})}},o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionResource?Ss.parseLocalSessionId(y.revive(i.chatSessionResource)):void 0,codeBlocks:i.codeBlocks.map(c=>({code:c.code,resource:y.revive(c.resource),markdownBeforeBlock:c.markdownBeforeBlock}))};return await s.provideMappedEdits(o,n,r)??null}registerMappedEditsProvider(t,i){const r=DN.a++;return this.b.$registerCodeMapperProvider(r,t.displayName??t.name),this.c.set(r,i),{dispose:()=>this.b.$unregisterCodeMapperProvider(r)}}};function DZ(e,t,i){const r=e.getProxy(X.MainThreadComments);class s{static{this.a=0}constructor(){this.b=new Map,this.c=new Wn,t.registerArgumentProcessor({processArgument:g=>{if(g&&g.$mid===6){const v=this.b.get(g.handle);return v?v.value:g}else if(g&&g.$mid===7){const v=g,b=this.b.get(v.commentControlHandle);if(!b)return v;const S=b.getCommentThread(v.commentThreadHandle);return S?S.value:v}else if(g&&(g.$mid===9||g.$mid===8)){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);return b?g.$mid===8?b.value:{thread:b.value,text:g.text}:g}else if(g&&g.$mid===10){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.commentUniqueId,E=b.getCommentByUniqueId(S);return E||g}else if(g&&g.$mid===11){const v=this.b.get(g.thread.commentControlHandle);if(!v)return g;const b=v.getCommentThread(g.thread.commentThreadHandle);if(!b)return g;const S=g.text,E=g.commentUniqueId,$=b.getCommentByUniqueId(E);return $?(typeof $.body=="string"?$.body=S:$.body=new ji(S),$):g}return g}})}createCommentController(g,v,b){const S=s.a++,E=new o(g,S,v,b);this.b.set(E.handle,E);const $=this.c.get(g.identifier)||[];return $.push(E),this.c.set(g.identifier,$),E.value}async $createCommentThreadTemplate(g,v,b,S){const E=this.b.get(g);E&&E.$createCommentThreadTemplate(v,b,S)}async $setActiveComment(g,v){const b=this.b.get(g);b&&b.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(g,v,b){const S=this.b.get(g);S&&S.$updateCommentThreadTemplate(v,b)}$deleteCommentThread(g,v){this.b.get(g)?.$deleteCommentThread(v)}async $updateCommentThread(g,v,b){this.b.get(g)?.$updateCommentThread(v,b)}async $provideCommentingRanges(g,v,b){const S=this.b.get(g);if(!S||!S.commentingRangeProvider)return Promise.resolve(void 0);const E=await i.ensureDocumentData(y.revive(v));return di(async()=>{const $=await S.commentingRangeProvider?.provideCommentingRanges(E.document,b);let U;return Array.isArray($)?U={ranges:$,fileComments:!1}:$?U={ranges:$.ranges||[],fileComments:$.enableFileComments||!1}:U=$??void 0,U}).then($=>{let U;return $&&(U={ranges:$.ranges.map(O=>j.from(O)),fileComments:$.fileComments}),U})}$toggleReaction(g,v,b,S,E){const $=this.b.get(g);return!$||!$.reactionHandler?Promise.resolve(void 0):di(()=>{const U=$.getCommentThread(v);if(U){const O=U.getCommentByUniqueId(S.uniqueIdInThread);if($!==void 0&&O&&$.reactionHandler)return $.reactionHandler(O,l(E))}return Promise.resolve(void 0)})}}class n{static{this.a=0}set threadId(g){this.n=g}get threadId(){return this.n}get id(){return this.n}get resource(){return this.o}get uri(){return this.o}set range(g){(g===void 0!=(this.p===void 0)||!g||!this.p||!g.isEqual(this.p))&&(this.p=g,this.b.range=g,this.c.fire())}get range(){return this.p}set canReply(g){this.d!==g&&(this.d=g,this.b.canReply=g,this.c.fire())}get canReply(){return this.d}get label(){return this.e}set label(g){this.e=g,this.b.label=g,this.c.fire()}get contextValue(){return this.f}set contextValue(g){this.f=g,this.b.contextValue=g,this.c.fire()}get comments(){return this.q}set comments(g){this.q=g,this.b.comments=g,this.c.fire()}get collapsibleState(){return this.g}set collapsibleState(g){this.g!==g&&(this.g=g,this.b.collapsibleState=g,this.c.fire())}get state(){return this.h}set state(g){this.h=g,typeof g=="object"?(T(this.extensionDescription,"commentThreadApplicability"),this.b.state=g.resolved,this.b.applicability=g.applicability):this.b.state=g,this.c.fire()}get isDisposed(){return this.j}constructor(g,v,b,S,E,$,U,O,J){this.m=v,this.n=b,this.o=S,this.p=E,this.q=$,this.extensionDescription=U,this.r=O,this.handle=n.a++,this.commentHandle=0,this.b=Object.create(null),this.c=new I,this.onDidUpdateCommentThread=this.c.event,this.d=!0,this.k=new Map,this.l=new Br,this.l.value=new ie,this.n===void 0&&(this.n=`${g}.${this.handle}`),r.$createCommentThread(v,this.handle,this.n,this.o,j.from(this.p),this.q.map(V=>a(this,V,this.k,this.extensionDescription)),U.identifier,this.r,J),this.i=[],this.j=!1,this.i.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()})),this.i.push({dispose:()=>{r.$deleteCommentThread(v,this.handle)}});const F=this;this.value={get uri(){return F.uri},get range(){return F.range},set range(V){F.range=V},get comments(){return F.comments},set comments(V){F.comments=V},get collapsibleState(){return F.collapsibleState},set collapsibleState(V){F.collapsibleState=V},get canReply(){return F.canReply},set canReply(V){F.canReply=V},get contextValue(){return F.contextValue},set contextValue(V){F.contextValue=V},get label(){return F.label},set label(V){F.label=V},get state(){return F.state},set state(V){F.state=V},reveal:(V,z)=>F.reveal(V,z),hide:()=>F.hide(),dispose:()=>{F.dispose()}}}s(){this.r&&(this.r=!1,this.b.isTemplate=!1)}eventuallyUpdateCommentThread(){if(this.j)return;this.s(),this.l.value||(this.l.value=new ie);const g=b=>Object.prototype.hasOwnProperty.call(this.b,b),v={};g("range")&&(v.range=j.from(this.p)),g("label")&&(v.label=this.label),g("contextValue")&&(v.contextValue=this.contextValue??null),g("comments")&&(v.comments=this.q.map(b=>a(this,b,this.k,this.extensionDescription))),g("collapsibleState")&&(v.collapseState=u(this.g)),g("canReply")&&(v.canReply=this.canReply),g("state")&&(v.state=h(this.h)),g("applicability")&&(v.applicability=f(this.h)),g("isTemplate")&&(v.isTemplate=this.r),this.b={},r.$updateCommentThread(this.m,this.handle,this.n,this.o,v)}getCommentByUniqueId(g){for(const v of this.k){const b=v[0],S=v[1];if(g===S)return b}}async reveal(g,v){T(this.extensionDescription,"commentReveal");let b;g&&g.body!==void 0?b=g:v=v??g;let S=b?this.k.get(b):void 0;S??=this.k.get(this.q[0]);let E=!0,$=!1;return v?.focus===ah.Reply?($=!0,E=!1):v?.focus===ah.Comment&&(E=!1),r.$revealCommentThread(this.m,this.handle,S,{preserveFocus:E,focusReply:$})}async hide(){return r.$hideCommentThread(this.m,this.handle)}dispose(){this.j=!0,this.l.dispose(),this.i.forEach(g=>g.dispose())}}__decorate([mf(100)],n.prototype,"eventuallyUpdateCommentThread",null);class o{get id(){return this.j}get label(){return this.k}get handle(){return this.i}get commentingRangeProvider(){return this.b}set commentingRangeProvider(g){this.b=g,g?.resourceHints&&T(this.h,"commentingRangeHint"),r.$updateCommentingRanges(this.handle,g?.resourceHints)}get reactionHandler(){return this.c}set reactionHandler(g){this.c=g,r.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!g})}get options(){return this.d}set options(g){this.d=g,r.$updateCommentControllerFeatures(this.handle,{options:this.d})}get activeComment(){return T(this.h,"activeComment"),this.e}get activeCommentThread(){return T(this.h,"activeComment"),this.f?.value}constructor(g,v,b,S){this.h=g,this.i=v,this.j=b,this.k=S,this.a=new Map,r.$registerCommentController(this.handle,b,S,this.h.identifier.value);const E=this;this.value=Object.freeze({id:E.id,label:E.label,get options(){return E.options},set options($){E.options=$},get commentingRangeProvider(){return E.commentingRangeProvider},set commentingRangeProvider($){E.commentingRangeProvider=$},get reactionHandler(){return E.reactionHandler},set reactionHandler($){E.reactionHandler=$},get activeCommentThread(){return E.activeCommentThread},createCommentThread($,U,O){return E.createCommentThread($,U,O).value},dispose:()=>{E.dispose()}}),this.g=[],this.g.push({dispose:()=>{r.$unregisterCommentController(this.handle)}})}createCommentThread(g,v,b){const S=new n(this.id,this.handle,void 0,g,v,b,this.h,!1);return this.a.set(S.handle,S),S}$setActiveComment(g){if(!g){this.e=void 0,this.f=void 0;return}const v=this.a.get(g.commentThreadHandle);v&&(this.e=g.uniqueIdInThread?v.getCommentByUniqueId(g.uniqueIdInThread):void 0,this.f=v)}$createCommentThreadTemplate(g,v,b){const S=new n(this.id,this.handle,void 0,y.revive(g),j.to(v),[],this.h,!0,b);return S.collapsibleState=wc.Expanded,this.a.set(S.handle,S),S}$updateCommentThreadTemplate(g,v){const b=this.a.get(g);b&&(b.range=j.to(v))}$updateCommentThread(g,v){const b=this.a.get(g);if(!b)return;(E=>Object.prototype.hasOwnProperty.call(v,E))("collapseState")&&(b.collapsibleState=u(v.collapseState))}$deleteCommentThread(g){this.a.get(g)?.dispose(),this.a.delete(g)}getCommentThread(g){return this.a.get(g)}dispose(){this.a.forEach(g=>{g.dispose()}),this.g.forEach(g=>g.dispose())}}function a(p,g,v,b){let S=v.get(g);return S||(S=++p.commentHandle,v.set(g,S)),g.state!==void 0&&T(b,"commentsDraftState"),g.reactions?.some(E=>E.reactors!==void 0)&&T(b,"commentReactor"),{mode:g.mode,contextValue:g.contextValue,uniqueIdInThread:S,body:typeof g.body=="string"?g.body:ge.from(g.body),userName:g.author.name,userIconPath:g.author.iconPath,label:g.label,commentReactions:g.reactions?g.reactions.map(E=>c(E)):void 0,state:g.state,timestamp:g.timestamp?.toJSON()}}function c(p){return{label:p.label,iconPath:p.iconPath?wg(p.iconPath):void 0,count:p.count,hasReacted:p.authorHasReacted,reactors:p.reactors&&p.reactors.length>0&&typeof p.reactors[0]!="string"?p.reactors.map(g=>g.name):p.reactors}}function l(p){return{label:p.label||"",count:p.count||0,iconPath:p.iconPath?y.revive(p.iconPath):"",authorHasReacted:p.hasReacted||!1,reactors:p.reactors?.map(g=>({name:g}))}}function u(p){if(p!==void 0)switch(p){case sh.Expanded:return wc.Expanded;case sh.Collapsed:return wc.Collapsed}return wc.Collapsed}function h(p){let g;if(typeof p=="object"?g=p.resolved:g=p,g!==void 0)switch(g){case nh.Unresolved:return Cu.Unresolved;case nh.Resolved:return Cu.Resolved}return Cu.Unresolved}function f(p){let g;if(typeof p=="object"&&(g=p.applicability),g!==void 0)switch(g){case oh.Current:return $u.Current;case oh.Outdated:return $u.Outdated}return $u.Current}return new s}var i1={},qe={exports:i1};(function(e,t){if(typeof i1=="object"&&typeof qe=="object")qe.exports=t();else if(typeof define=="function"&&define.amd)define([],t);else{var i=t();for(var r in i)(typeof i1=="object"?i1:e)[r]=i[r]}})(typeof self<"u"?self:void 0,function(){return function(e){var t={};function i(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(r,s,n){i.o(r,s)||Object.defineProperty(r,s,{enumerable:!0,get:n})},i.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},i.t=function(r,s){if(1&s&&(r=i(r)),8&s||4&s&&typeof r=="object"&&r&&r.__esModule)return r;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&s&&typeof r!="string")for(var o in r)i.d(n,o,function(a){return r[a]}.bind(null,o));return n},i.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return i.d(s,"a",s),s},i.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},i.p="",i(i.s=0)}([function(e,t,i){(function(r){var s;t=e.exports=Je,s=typeof r=="object"&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?function(){var P=Array.prototype.slice.call(arguments,0);P.unshift("SEMVER"),console.log.apply(console,P)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,a=t.re=[],c=t.src=[],l=0,u=l++;c[u]="0|[1-9]\\d*";var h=l++;c[h]="[0-9]+";var f=l++;c[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var p=l++;c[p]="("+c[u]+")\\.("+c[u]+")\\.("+c[u]+")";var g=l++;c[g]="("+c[h]+")\\.("+c[h]+")\\.("+c[h]+")";var v=l++;c[v]="(?:"+c[u]+"|"+c[f]+")";var b=l++;c[b]="(?:"+c[h]+"|"+c[f]+")";var S=l++;c[S]="(?:-("+c[v]+"(?:\\."+c[v]+")*))";var E=l++;c[E]="(?:-?("+c[b]+"(?:\\."+c[b]+")*))";var $=l++;c[$]="[0-9A-Za-z-]+";var U=l++;c[U]="(?:\\+("+c[$]+"(?:\\."+c[$]+")*))";var O=l++,J="v?"+c[p]+c[S]+"?"+c[U]+"?";c[O]="^"+J+"$";var F="[v=\\s]*"+c[g]+c[E]+"?"+c[U]+"?",V=l++;c[V]="^"+F+"$";var z=l++;c[z]="((?:<|>)?=?)";var ue=l++;c[ue]=c[h]+"|x|X|\\*";var Re=l++;c[Re]=c[u]+"|x|X|\\*";var ae=l++;c[ae]="[v=\\s]*("+c[Re]+")(?:\\.("+c[Re]+")(?:\\.("+c[Re]+")(?:"+c[S]+")?"+c[U]+"?)?)?";var Z=l++;c[Z]="[v=\\s]*("+c[ue]+")(?:\\.("+c[ue]+")(?:\\.("+c[ue]+")(?:"+c[E]+")?"+c[U]+"?)?)?";var _=l++;c[_]="^"+c[z]+"\\s*"+c[ae]+"$";var G=l++;c[G]="^"+c[z]+"\\s*"+c[Z]+"$";var K=l++;c[K]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var re=l++;c[re]="(?:~>?)";var Ae=l++;c[Ae]="(\\s*)"+c[re]+"\\s+",a[Ae]=new RegExp(c[Ae],"g");var Me=l++;c[Me]="^"+c[re]+c[ae]+"$";var Ne=l++;c[Ne]="^"+c[re]+c[Z]+"$";var mt=l++;c[mt]="(?:\\^)";var _t=l++;c[_t]="(\\s*)"+c[mt]+"\\s+",a[_t]=new RegExp(c[_t],"g");var tt=l++;c[tt]="^"+c[mt]+c[ae]+"$";var Rt=l++;c[Rt]="^"+c[mt]+c[Z]+"$";var Si=l++;c[Si]="^"+c[z]+"\\s*("+F+")$|^$";var ti=l++;c[ti]="^"+c[z]+"\\s*("+J+")$|^$";var br=l++;c[br]="(\\s*)"+c[z]+"\\s*("+F+"|"+c[ae]+")",a[br]=new RegExp(c[br],"g");var kn=l++;c[kn]="^\\s*("+c[ae]+")\\s+-\\s+("+c[ae]+")\\s*$";var vi=l++;c[vi]="^\\s*("+c[Z]+")\\s+-\\s+("+c[Z]+")\\s*$";var ql=l++;c[ql]="(<|>)?=?\\s*\\*";for(var Bs=0;Bs<35;Bs++)s(Bs,c[Bs]),a[Bs]||(a[Bs]=new RegExp(c[Bs]));function lr(P,R){if(P instanceof Je)return P;if(typeof P!="string"||P.length>n||!(R?a[V]:a[O]).test(P))return null;try{return new Je(P,R)}catch{return null}}function Je(P,R){if(P instanceof Je){if(P.loose===R)return P;P=P.version}else if(typeof P!="string")throw new TypeError("Invalid Version: "+P);if(P.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof Je))return new Je(P,R);s("SemVer",P,R),this.loose=R;var L=P.trim().match(R?a[V]:a[O]);if(!L)throw new TypeError("Invalid Version: "+P);if(this.raw=P,this.major=+L[1],this.minor=+L[2],this.patch=+L[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");L[4]?this.prerelease=L[4].split(".").map(function(de){if(/^[0-9]+$/.test(de)){var we=+de;if(we>=0&&we<o)return we}return de}):this.prerelease=[],this.build=L[5]?L[5].split("."):[],this.format()}t.parse=lr,t.valid=function(P,R){var L=lr(P,R);return L?L.version:null},t.clean=function(P,R){var L=lr(P.trim().replace(/^[=v]+/,""),R);return L?L.version:null},t.SemVer=Je,Je.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Je.prototype.toString=function(){return this.version},Je.prototype.compare=function(P){return s("SemVer.compare",this.version,this.loose,P),P instanceof Je||(P=new Je(P,this.loose)),this.compareMain(P)||this.comparePre(P)},Je.prototype.compareMain=function(P){return P instanceof Je||(P=new Je(P,this.loose)),Cn(this.major,P.major)||Cn(this.minor,P.minor)||Cn(this.patch,P.patch)},Je.prototype.comparePre=function(P){if(P instanceof Je||(P=new Je(P,this.loose)),this.prerelease.length&&!P.prerelease.length)return-1;if(!this.prerelease.length&&P.prerelease.length)return 1;if(!this.prerelease.length&&!P.prerelease.length)return 0;var R=0;do{var L=this.prerelease[R],de=P.prerelease[R];if(s("prerelease compare",R,L,de),L===void 0&&de===void 0)return 0;if(de===void 0)return 1;if(L===void 0)return-1;if(L!==de)return Cn(L,de)}while(++R)},Je.prototype.inc=function(P,R){switch(P){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",R);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",R);break;case"prepatch":this.prerelease.length=0,this.inc("patch",R),this.inc("pre",R);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",R),this.inc("pre",R);break;case"major":this.minor===0&&this.patch===0&&this.prerelease.length!==0||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":this.patch===0&&this.prerelease.length!==0||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var L=this.prerelease.length;--L>=0;)typeof this.prerelease[L]=="number"&&(this.prerelease[L]++,L=-2);L===-1&&this.prerelease.push(0)}R&&(this.prerelease[0]===R?isNaN(this.prerelease[1])&&(this.prerelease=[R,0]):this.prerelease=[R,0]);break;default:throw new Error("invalid increment argument: "+P)}return this.format(),this.raw=this.version,this},t.inc=function(P,R,L,de){typeof L=="string"&&(de=L,L=void 0);try{return new Je(P,L).inc(R,de).version}catch{return null}},t.diff=function(P,R){if(Ga(P,R))return null;var L=lr(P),de=lr(R);if(L.prerelease.length||de.prerelease.length){for(var we in L)if((we==="major"||we==="minor"||we==="patch")&&L[we]!==de[we])return"pre"+we;return"prerelease"}for(var we in L)if((we==="major"||we==="minor"||we==="patch")&&L[we]!==de[we])return we},t.compareIdentifiers=Cn;var Le=/^[0-9]+$/;function Cn(P,R){var L=Le.test(P),de=Le.test(R);return L&&de&&(P=+P,R=+R),L&&!de?-1:de&&!L?1:P<R?-1:P>R?1:0}function zr(P,R,L){return new Je(P,L).compare(new Je(R,L))}function yr(P,R,L){return zr(P,R,L)>0}function gs(P,R,L){return zr(P,R,L)<0}function Ga(P,R,L){return zr(P,R,L)===0}function Ud(P,R,L){return zr(P,R,L)!==0}function Gl(P,R,L){return zr(P,R,L)>=0}function Zl(P,R,L){return zr(P,R,L)<=0}function Za(P,R,L,de){var we;switch(R){case"===":typeof P=="object"&&(P=P.version),typeof L=="object"&&(L=L.version),we=P===L;break;case"!==":typeof P=="object"&&(P=P.version),typeof L=="object"&&(L=L.version),we=P!==L;break;case"":case"=":case"==":we=Ga(P,L,de);break;case"!=":we=Ud(P,L,de);break;case">":we=yr(P,L,de);break;case">=":we=Gl(P,L,de);break;case"<":we=gs(P,L,de);break;case"<=":we=Zl(P,L,de);break;default:throw new TypeError("Invalid operator: "+R)}return we}function Pi(P,R){if(P instanceof Pi){if(P.loose===R)return P;P=P.value}if(!(this instanceof Pi))return new Pi(P,R);s("comparator",P,R),this.loose=R,this.parse(P),this.semver===Io?this.value="":this.value=this.operator+this.semver.version,s("comp",this)}t.rcompareIdentifiers=function(P,R){return Cn(R,P)},t.major=function(P,R){return new Je(P,R).major},t.minor=function(P,R){return new Je(P,R).minor},t.patch=function(P,R){return new Je(P,R).patch},t.compare=zr,t.compareLoose=function(P,R){return zr(P,R,!0)},t.rcompare=function(P,R,L){return zr(R,P,L)},t.sort=function(P,R){return P.sort(function(L,de){return t.compare(L,de,R)})},t.rsort=function(P,R){return P.sort(function(L,de){return t.rcompare(L,de,R)})},t.gt=yr,t.lt=gs,t.eq=Ga,t.neq=Ud,t.gte=Gl,t.lte=Zl,t.cmp=Za,t.Comparator=Pi;var Io={};function wt(P,R){if(P instanceof wt)return P.loose===R?P:new wt(P.raw,R);if(P instanceof Pi)return new wt(P.value,R);if(!(this instanceof wt))return new wt(P,R);if(this.loose=R,this.raw=P,this.set=P.split(/\s*\|\|\s*/).map(function(L){return this.parseRange(L.trim())},this).filter(function(L){return L.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+P);this.format()}function ni(P){return!P||P.toLowerCase()==="x"||P==="*"}function nv(P,R,L,de,we,ii,it,Ei,jt,oi,Ar,bt,ai){return((R=ni(L)?"":ni(de)?">="+L+".0.0":ni(we)?">="+L+"."+de+".0":">="+R)+" "+(Ei=ni(jt)?"":ni(oi)?"<"+(+jt+1)+".0.0":ni(Ar)?"<"+jt+"."+(+oi+1)+".0":bt?"<="+jt+"."+oi+"."+Ar+"-"+bt:"<="+Ei)).trim()}function ov(P,R){for(var L=0;L<P.length;L++)if(!P[L].test(R))return!1;if(R.prerelease.length){for(L=0;L<P.length;L++)if(s(P[L].semver),P[L].semver!==Io&&P[L].semver.prerelease.length>0){var de=P[L].semver;if(de.major===R.major&&de.minor===R.minor&&de.patch===R.patch)return!0}return!1}return!0}function Hr(P,R,L){try{R=new wt(R,L)}catch{return!1}return R.test(P)}function Jl(P,R,L,de){var we,ii,it,Ei,jt;switch(P=new Je(P,de),R=new wt(R,de),L){case">":we=yr,ii=Zl,it=gs,Ei=">",jt=">=";break;case"<":we=gs,ii=Gl,it=yr,Ei="<",jt="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Hr(P,R,de))return!1;for(var oi=0;oi<R.set.length;++oi){var Ar=R.set[oi],bt=null,ai=null;if(Ar.forEach(function(xi){xi.semver===Io&&(xi=new Pi(">=0.0.0")),bt=bt||xi,ai=ai||xi,we(xi.semver,bt.semver,de)?bt=xi:it(xi.semver,ai.semver,de)&&(ai=xi)}),bt.operator===Ei||bt.operator===jt||(!ai.operator||ai.operator===Ei)&&ii(P,ai.semver)||ai.operator===jt&&it(P,ai.semver))return!1}return!0}Pi.prototype.parse=function(P){var R=this.loose?a[Si]:a[ti],L=P.match(R);if(!L)throw new TypeError("Invalid comparator: "+P);this.operator=L[1],this.operator==="="&&(this.operator=""),L[2]?this.semver=new Je(L[2],this.loose):this.semver=Io},Pi.prototype.toString=function(){return this.value},Pi.prototype.test=function(P){return s("Comparator.test",P,this.loose),this.semver===Io||(typeof P=="string"&&(P=new Je(P,this.loose)),Za(P,this.operator,this.semver,this.loose))},Pi.prototype.intersects=function(P,R){if(!(P instanceof Pi))throw new TypeError("a Comparator is required");var L;if(this.operator==="")return L=new wt(P.value,R),Hr(this.value,L,R);if(P.operator==="")return L=new wt(this.value,R),Hr(P.semver,L,R);var de=!(this.operator!==">="&&this.operator!==">"||P.operator!==">="&&P.operator!==">"),we=!(this.operator!=="<="&&this.operator!=="<"||P.operator!=="<="&&P.operator!=="<"),ii=this.semver.version===P.semver.version,it=!(this.operator!==">="&&this.operator!=="<="||P.operator!==">="&&P.operator!=="<="),Ei=Za(this.semver,"<",P.semver,R)&&(this.operator===">="||this.operator===">")&&(P.operator==="<="||P.operator==="<"),jt=Za(this.semver,">",P.semver,R)&&(this.operator==="<="||this.operator==="<")&&(P.operator===">="||P.operator===">");return de||we||ii&&it||Ei||jt},t.Range=wt,wt.prototype.format=function(){return this.range=this.set.map(function(P){return P.join(" ").trim()}).join("||").trim(),this.range},wt.prototype.toString=function(){return this.range},wt.prototype.parseRange=function(P){var R=this.loose;P=P.trim(),s("range",P,R);var L=R?a[vi]:a[kn];P=P.replace(L,nv),s("hyphen replace",P),P=P.replace(a[br],"$1$2$3"),s("comparator trim",P,a[br]),P=(P=(P=P.replace(a[Ae],"$1~")).replace(a[_t],"$1^")).split(/\s+/).join(" ");var de=R?a[Si]:a[ti],we=P.split(" ").map(function(ii){return function(it,Ei){return s("comp",it),it=function(jt,oi){return jt.trim().split(/\s+/).map(function(Ar){return function(bt,ai){s("caret",bt,ai);var xi=ai?a[Rt]:a[tt];return bt.replace(xi,function(ur,Ee,je,pt,x){var Ct;return s("caret",bt,ur,Ee,je,pt,x),ni(Ee)?Ct="":ni(je)?Ct=">="+Ee+".0.0 <"+(+Ee+1)+".0.0":ni(pt)?Ct=Ee==="0"?">="+Ee+"."+je+".0 <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+".0 <"+(+Ee+1)+".0.0":x?(s("replaceCaret pr",x),x.charAt(0)!=="-"&&(x="-"+x),Ct=Ee==="0"?je==="0"?">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+je+"."+(+pt+1):">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+"."+pt+x+" <"+(+Ee+1)+".0.0"):(s("no pr"),Ct=Ee==="0"?je==="0"?">="+Ee+"."+je+"."+pt+" <"+Ee+"."+je+"."+(+pt+1):">="+Ee+"."+je+"."+pt+" <"+Ee+"."+(+je+1)+".0":">="+Ee+"."+je+"."+pt+" <"+(+Ee+1)+".0.0"),s("caret return",Ct),Ct})}(Ar,oi)}).join(" ")}(it,Ei),s("caret",it),it=function(jt,oi){return jt.trim().split(/\s+/).map(function(Ar){return function(bt,ai){var xi=ai?a[Ne]:a[Me];return bt.replace(xi,function(ur,Ee,je,pt,x){var Ct;return s("tilde",bt,ur,Ee,je,pt,x),ni(Ee)?Ct="":ni(je)?Ct=">="+Ee+".0.0 <"+(+Ee+1)+".0.0":ni(pt)?Ct=">="+Ee+"."+je+".0 <"+Ee+"."+(+je+1)+".0":x?(s("replaceTilde pr",x),x.charAt(0)!=="-"&&(x="-"+x),Ct=">="+Ee+"."+je+"."+pt+x+" <"+Ee+"."+(+je+1)+".0"):Ct=">="+Ee+"."+je+"."+pt+" <"+Ee+"."+(+je+1)+".0",s("tilde return",Ct),Ct})}(Ar,oi)}).join(" ")}(it,Ei),s("tildes",it),it=function(jt,oi){return s("replaceXRanges",jt,oi),jt.split(/\s+/).map(function(Ar){return function(bt,ai){bt=bt.trim();var xi=ai?a[G]:a[_];return bt.replace(xi,function(ur,Ee,je,pt,x,Ct){s("xRange",bt,ur,Ee,je,pt,x,Ct);var Ja=ni(je),se=Ja||ni(pt),Ge=se||ni(x);return Ee==="="&&Ge&&(Ee=""),Ja?ur=Ee===">"||Ee==="<"?"<0.0.0":"*":Ee&&Ge?(se&&(pt=0),Ge&&(x=0),Ee===">"?(Ee=">=",se?(je=+je+1,pt=0,x=0):Ge&&(pt=+pt+1,x=0)):Ee==="<="&&(Ee="<",se?je=+je+1:pt=+pt+1),ur=Ee+je+"."+pt+"."+x):se?ur=">="+je+".0.0 <"+(+je+1)+".0.0":Ge&&(ur=">="+je+"."+pt+".0 <"+je+"."+(+pt+1)+".0"),s("xRange return",ur),ur})}(Ar,oi)}).join(" ")}(it,Ei),s("xrange",it),it=function(jt,oi){return s("replaceStars",jt,oi),jt.trim().replace(a[ql],"")}(it,Ei),s("stars",it),it}(ii,R)}).join(" ").split(/\s+/);return this.loose&&(we=we.filter(function(ii){return!!ii.match(de)})),we=we.map(function(ii){return new Pi(ii,R)})},wt.prototype.intersects=function(P,R){if(!(P instanceof wt))throw new TypeError("a Range is required");return this.set.some(function(L){return L.every(function(de){return P.set.some(function(we){return we.every(function(ii){return de.intersects(ii,R)})})})})},t.toComparators=function(P,R){return new wt(P,R).set.map(function(L){return L.map(function(de){return de.value}).join(" ").trim().split(" ")})},wt.prototype.test=function(P){if(!P)return!1;typeof P=="string"&&(P=new Je(P,this.loose));for(var R=0;R<this.set.length;R++)if(ov(this.set[R],P))return!0;return!1},t.satisfies=Hr,t.maxSatisfying=function(P,R,L){var de=null,we=null;try{var ii=new wt(R,L)}catch{return null}return P.forEach(function(it){ii.test(it)&&(de&&we.compare(it)!==-1||(we=new Je(de=it,L)))}),de},t.minSatisfying=function(P,R,L){var de=null,we=null;try{var ii=new wt(R,L)}catch{return null}return P.forEach(function(it){ii.test(it)&&(de&&we.compare(it)!==1||(we=new Je(de=it,L)))}),de},t.validRange=function(P,R){try{return new wt(P,R).range||"*"}catch{return null}},t.ltr=function(P,R,L){return Jl(P,R,"<",L)},t.gtr=function(P,R,L){return Jl(P,R,">",L)},t.outside=Jl,t.prerelease=function(P,R){var L=lr(P,R);return L&&L.prerelease.length?L.prerelease:null},t.intersects=function(P,R,L){return P=new wt(P,L),R=new wt(R,L),P.intersects(R)},t.coerce=function(P){if(P instanceof Je)return P;if(typeof P!="string")return null;var R=P.match(a[K]);return R==null?null:lr((R[1]||"0")+"."+(R[2]||"0")+"."+(R[3]||"0"))}}).call(this,i(1))},function(e,t){var i,r,s=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(b){if(i===setTimeout)return setTimeout(b,0);if((i===n||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:n}catch{i=n}try{r=typeof clearTimeout=="function"?clearTimeout:o}catch{r=o}})();var c,l=[],u=!1,h=-1;function f(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&p())}function p(){if(!u){var b=a(f);u=!0;for(var S=l.length;S;){for(c=l,l=[];++h<S;)c&&c[h].run();h=-1,S=l.length}c=null,u=!1,function(E){if(r===clearTimeout)return clearTimeout(E);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(E);try{r(E)}catch{try{return r.call(null,E)}catch{return r.call(this,E)}}}(b)}}function g(b,S){this.fun=b,this.array=S}function v(){}s.nextTick=function(b){var S=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)S[E-1]=arguments[E];l.push(new g(b,S)),l.length!==1||u||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=v,s.addListener=v,s.once=v,s.off=v,s.removeListener=v,s.removeAllListeners=v,s.emit=v,s.prependListener=v,s.prependOnceListener=v,s.listeners=function(b){return[]},s.binding=function(b){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(b){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}}])});var voe=qe.exports.SEMVER_SPEC_VERSION,woe=qe.exports.parse,boe=qe.exports.valid,yoe=qe.exports.coerce,Aoe=qe.exports.clean,Soe=qe.exports.inc,Eoe=qe.exports.major,xoe=qe.exports.minor,koe=qe.exports.patch,Coe=qe.exports.prerelease,$oe=qe.exports.gt,Ioe=qe.exports.gte,Doe=qe.exports.lt,Poe=qe.exports.lte,Toe=qe.exports.eq,Moe=qe.exports.neq,Noe=qe.exports.cmp,Roe=qe.exports.compare,Loe=qe.exports.rcompare,Ooe=qe.exports.compareIdentifiers,Foe=qe.exports.rcompareIdentifiers,Uoe=qe.exports.compareBuild,joe=qe.exports.sort,zoe=qe.exports.rsort,Hoe=qe.exports.diff,Woe=qe.exports.validRange,Boe=qe.exports.satisfies,_oe=qe.exports.maxSatisfying,Voe=qe.exports.minSatisfying,qoe=qe.exports.minVersion,Goe=qe.exports.gtr,Zoe=qe.exports.ltr,Joe=qe.exports.outside,Qoe=qe.exports.intersects,Yoe=qe.exports.SemVer,Xoe=qe.exports.Comparator,Koe=qe.exports.Range,IP=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/,PZ=/^-(\d{4})(\d{2})(\d{2})$/;function TZ(e){return e=e.trim(),e==="*"||IP.test(e)}function DP(e){if(!TZ(e))return null;if(e=e.trim(),e==="*")return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};const t=e.match(IP);return t?{hasCaret:t[1]==="^",hasGreaterEquals:t[1]===">=",majorBase:t[2]==="x"?0:parseInt(t[2],10),majorMustEqual:t[2]!=="x",minorBase:t[4]==="x"?0:parseInt(t[4],10),minorMustEqual:t[4]!=="x",patchBase:t[6]==="x"?0:parseInt(t[6],10),patchMustEqual:t[6]!=="x",preRelease:t[8]||null}:null}function PP(e){if(!e)return null;const t=e.majorBase,i=e.majorMustEqual,r=e.minorBase;let s=e.minorMustEqual;const n=e.patchBase;let o=e.patchMustEqual;e.hasCaret&&(t===0||(s=!1),o=!1);let a=0;if(e.preRelease){const c=PZ.exec(e.preRelease);if(c){const[,l,u,h]=c;a=Date.UTC(Number(l),Number(u)-1,Number(h))}}return{majorBase:t,majorMustEqual:i,minorBase:r,minorMustEqual:s,patchBase:n,patchMustEqual:o,isMinimum:e.hasGreaterEquals,notBefore:a}}var MZ=class{constructor(){this.buffers=[]}add(e){let t=this.buffers.indexOf(e);return t<0&&(t=this.buffers.length,this.buffers.push(e)),t}};function NZ(e,t){if(t.serializeBuffersForPostMessage){const i=new MZ,s=JSON.stringify(e,(o,a)=>{if(a instanceof ArrayBuffer)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a)};if(ArrayBuffer.isView(a)){const c=RZ(a);if(c)return{$$vscode_array_buffer_reference$$:!0,index:i.add(a.buffer),view:{type:c,byteLength:a.byteLength,byteOffset:a.byteOffset}}}return a}),n=i.buffers.map(o=>{const a=new Uint8Array(o);return W.wrap(a)});return{message:s,buffers:n}}else return{message:JSON.stringify(e),buffers:[]}}function RZ(e){switch(e.constructor.name){case"Int8Array":return 1;case"Uint8Array":return 2;case"Uint8ClampedArray":return 3;case"Int16Array":return 4;case"Uint16Array":return 5;case"Int32Array":return 6;case"Uint32Array":return 7;case"Float32Array":return 8;case"Float64Array":return 9;case"BigInt64Array":return 10;case"BigUint64Array":return 11}}function LZ(e,t){const i=t.map(n=>{const o=new ArrayBuffer(n.byteLength);return new Uint8Array(o).set(n.buffer),o}),r=t.length?(n,o)=>{if(o&&typeof o=="object"&&o.$$vscode_array_buffer_reference$$){const a=o,{index:c}=a,l=i[c];if(a.view)switch(a.view.type){case 1:return new Int8Array(l,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case 2:return new Uint8Array(l,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case 3:return new Uint8ClampedArray(l,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case 4:return new Int16Array(l,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case 5:return new Uint16Array(l,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case 6:return new Int32Array(l,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case 7:return new Uint32Array(l,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case 8:return new Float32Array(l,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case 9:return new Float64Array(l,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case 10:return new BigInt64Array(l,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case 11:return new BigUint64Array(l,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}return l}return o}:void 0;return{message:JSON.parse(e,r),arrayBuffers:i}}var OZ=class{#e;#t;#i;#r;#n;#s;#a;#o;#c;#l;#u;#d;constructor(e,t,i,r,s,n,o){this.#a="",this.#c=!1,this.#l=!1,this._onMessageEmitter=new I,this.onDidReceiveMessage=this._onMessageEmitter.event,this.#h=new I,this._onDidDispose=this.#h.event,this.#e=e,this.#t=t,this.#o=i,this.#r=r,this.#n=s,this.#s=n,this.#u=Dl(n),this.#d=FZ(n),this.#i=o}#h;dispose(){this.#c=!0,this.#h.fire(),this.#h.dispose(),this._onMessageEmitter.dispose()}asWebviewUri(e){return this.#l=!0,nd(e,this.#r)}get cspSource(){const e=this.#s.extensionLocation;if(e.scheme===q.https||e.scheme===q.http){let t=e.toString();return t.endsWith("/")||(t+="/"),t+" "+z4}return z4}get html(){return this.a(),this.#a}set html(e){this.a(),this.#a!==e&&(this.#a=e,this.#d&&!this.#l&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)&&(this.#l=!0,this.#i.report("Webview vscode-resource: uris",this.#s,"Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri")),this.#t.$setHtml(this.#e,this.b(e)))}get options(){return this.a(),this.#o}set options(e){this.a(),Li(this.#o,e)||this.#t.$setOptions(this.#e,TP(this.#s,this.#n,e)),this.#o=e}async postMessage(e){if(this.#c)return!1;const t=NZ(e,{serializeBuffersForPostMessage:this.#u});return this.#t.$postMessage(this.#e,t.message,...t.buffers)}a(){if(this.#c)throw new Error("Webview is disposed")}b(e){if(!this.#d)return e;const t=this.#s.extensionLocation?.scheme===q.vscodeRemote,i=this.#s.extensionLocation.scheme===q.vscodeRemote?this.#s.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(r,s,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=nd(l,{isRemote:t,authority:i}).toString();return`${s}${u}${c}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(r,s,n,o,a,c)=>{const l=y.from({scheme:o||"file",path:decodeURIComponent(a)}),u=nd(l,{isRemote:t,authority:i}).toString();return`${s}${u}${c}`})}};function Dl(e){try{const t=PP(DP(e.engines.vscode));return!!t&&t.majorBase>=1&&t.minorBase>=57}catch{return!1}}function FZ(e){try{const t=PP(DP(e.engines.vscode));return t?t.majorBase<1||t.majorBase===1&&t.minorBase<60:!1}catch{return!1}}var UZ=class extends Q{constructor(e,t,i,r,s){super(),this.c=t,this.f=i,this.g=r,this.h=s,this.b=new Map,this.a=e.getProxy(X.MainThreadWebviews)}dispose(){super.dispose();for(const e of this.b.values())e.dispose();this.b.clear()}$onMessage(e,t,i){const r=this.j(e);if(r){const{message:s}=LZ(t,i.value);r._onMessageEmitter.fire(s)}}$onMissingCsp(e,t){this.g.warn(`${t} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,t,i){const r=new OZ(e,this.a,jZ(t),this.c,this.f,i,this.h);this.b.set(e,r);const s=r._onDidDispose(()=>{s.dispose(),this.deleteWebview(e)});return r}deleteWebview(e){this.b.delete(e)}j(e){return this.b.get(e)}};function r1(e){return{id:e.identifier,location:e.extensionLocation}}function TP(e,t,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||zZ(e,t)}}function jZ(e){return{enableCommandUris:e.enableCommandUris,enableScripts:e.enableScripts,enableForms:e.enableForms,portMapping:e.portMapping,localResourceRoots:e.localResourceRoots?.map(t=>y.from(t))}}function zZ(e,t){return[...(t?.getWorkspaceFolders()||[]).map(i=>i.uri),e.extensionLocation]}var ls=class PN{static{this.a=!1}constructor(t){this.d=t,this.b=new Map,this.c=1}add(t){const i=this.c++;return this.b.set(i,t),this.e(),i}get(t,i){return this.b.has(t)?this.b.get(t)[i]:void 0}delete(t){this.b.delete(t),this.e()}e(){PN.a&&console.log(`${this.d} cache size - ${this.b.size}`)}},HZ=class{constructor(e,t){this.document=e,this.b=t,this.a=1,this.c=new ls("custom documents")}addEdit(e){return this.c.add([e])}async undo(e,t){await this.f(e).undo(),t||this.disposeBackup()}async redo(e,t){await this.f(e).redo(),t||this.disposeBackup()}disposeEdits(e){for(const t of e)this.c.delete(t)}getNewBackupUri(){if(!this.b)throw new Error("Backup requires a valid storage path");const e=GZ(this.document.uri)+this.a++;return It(this.b,e)}updateBackup(e){this.d?.delete(),this.d=e}disposeBackup(){this.d?.delete(),this.d=void 0}f(e){const t=this.c.get(e,0);if(!t)throw new Error("No edit found");return t}},WZ=class{constructor(){this.a=new Map}get(e,t){return this.a.get(this.b(e,t))}add(e,t,i){const r=this.b(e,t.uri);if(this.a.has(r))throw new Error(`Document already exists for viewType:${e} resource:${t.uri}`);const s=new HZ(t,i);return this.a.set(r,s),s}delete(e,t){const i=this.b(e,t.uri);this.a.delete(i)}b(e,t){return`${e}@@@${t}`}},MP;(function(e){e[e.Text=0]="Text",e[e.Custom=1]="Custom"})(MP||(MP={}));var BZ=class{constructor(){this.a=new Map}addTextProvider(e,t,i){return this.b(e,{type:0,extension:t,provider:i})}addCustomProvider(e,t,i){return this.b(e,{type:1,extension:t,provider:i})}get(e){return this.a.get(e)}b(e,t){if(this.a.has(e))throw new Error(`Provider for viewType:${e} already registered`);return this.a.set(e,t),new ke(()=>this.a.delete(e))}},_Z=class{constructor(e,t,i,r,s){this.d=t,this.f=i,this.g=r,this.h=s,this.b=new BZ,this.c=new WZ,this.a=e.getProxy(X.MainThreadCustomEditors)}registerCustomEditorProvider(e,t,i,r){const s=new ie;return VZ(i)?(s.add(this.b.addTextProvider(t,e,i)),this.a.$registerTextEditorProvider(r1(e),t,r.webviewOptions||{},{supportsMove:!!i.moveCustomTextEditor},Dl(e))):(s.add(this.b.addCustomProvider(t,e,i)),s1(i)&&s.add(i.onDidChangeCustomDocument(n=>{const o=this.i(t,n.document.uri);if(qZ(n)){const a=o.addEdit(n);this.a.$onDidEdit(n.document.uri,t,a,n.label)}else this.a.$onContentChange(n.document.uri,t)})),this.a.$registerCustomEditorProvider(r1(e),t,r.webviewOptions||{},!!r.supportsMultipleEditorsPerDocument,Dl(e))),ke.from(s,new ke(()=>{this.a.$unregisterEditorProvider(t)}))}async $createCustomDocument(e,t,i,r,s){const n=this.b.get(t);if(!n)throw new Error(`No provider found for '${t}'`);if(n.type!==1)throw new Error(`Invalid provide type for '${t}'`);const o=y.revive(e),a=await n.provider.openCustomDocument(o,{backupId:i,untitledDocumentData:r?.buffer},s);let c;return s1(n.provider)&&this.f&&(c=this.f.workspaceValue(n.extension)??this.f.globalValue(n.extension)),this.c.add(t,a,c),{editable:s1(n.provider)}}async $disposeCustomDocument(e,t){const i=this.b.get(t);if(!i)throw new Error(`No provider found for '${t}'`);if(i.type!==1)throw new Error(`Invalid provider type for '${t}'`);const r=y.revive(e),{document:s}=this.i(t,r);this.c.delete(t,s),s.dispose()}async $resolveCustomEditor(e,t,i,r,s,n){const o=this.b.get(i);if(!o)throw new Error(`No provider found for '${i}'`);const a=Xt.to(s),c=this.g.createNewWebview(t,r.contentOptions,o.extension),l=this.h.createNewWebviewPanel(t,i,r.title,a,r.options,c,r.active),u=y.revive(e);switch(o.type){case 1:{const{document:h}=this.i(i,u);return o.provider.resolveCustomEditor(h,l,n)}case 0:{const h=this.d.getDocument(u);return o.provider.resolveCustomTextEditor(h,l,n)}default:throw new Error("Unknown webview provider type")}}$disposeEdits(e,t,i){this.i(t,e).disposeEdits(i)}async $onMoveCustomEditor(e,t,i){const r=this.b.get(i);if(!r)throw new Error(`No provider found for '${i}'`);if(!r.provider.moveCustomTextEditor)throw new Error(`Provider does not implement move '${i}'`);const s=this.h.getWebviewPanel(e);if(!s)throw new Error("No webview found");const n=y.revive(t),o=this.d.getDocument(n);await r.provider.moveCustomTextEditor(o,s,Fe.None)}async $undo(e,t,i,r){return this.i(t,e).undo(i,r)}async $redo(e,t,i,r){return this.i(t,e).redo(i,r)}async $revert(e,t,i){const r=this.i(t,e);await this.j(t).revertCustomDocument(r.document,i),r.disposeBackup()}async $onSave(e,t,i){const r=this.i(t,e);await this.j(t).saveCustomDocument(r.document,i),r.disposeBackup()}async $onSaveAs(e,t,i,r){const s=this.i(t,e);return this.j(t).saveCustomDocumentAs(s.document,y.revive(i),r)}async $backup(e,t,i){const r=this.i(t,e),n=await this.j(t).backupCustomDocument(r.document,{destination:r.getNewBackupUri()},i);return r.updateBackup(n),n.id}i(e,t){const i=this.c.get(e,y.revive(t));if(!i)throw new Error("No custom document found");return i}j(e){const i=this.b.get(e)?.provider;if(!i||!s1(i))throw new Error("Custom document is not editable");return i}};function s1(e){return!!e.onDidChangeCustomDocument}function VZ(e){return typeof e.resolveCustomTextEditor=="function"}function qZ(e){return typeof e.undo=="function"&&typeof e.redo=="function"}function GZ(e){const t=e.scheme===q.file||e.scheme===q.untitled?e.fsPath:e.toString();return Xs(t)+""}var Fa,NP=class TN{#e;#t;#i;constructor(t,i,r,s,n,o,a,c){this.d=t,this.e=i,this.f=r,this.g=s,this.h=n,this.c=!1,this.f=Math.max(s,r),this.#i=new zt(l=>o.getComparisonKey(l)),this.#e=a,this.#t=c}dispose(){this.c||(this.#t.fire([...this.#i.keys()]),this.#e?.$clear(this.e),this.#i.clear(),this.c=!0)}get name(){return this.j(),this.d}set(t,i){if(!t){this.clear();return}this.j();let r=[];if(y.isUri(t)){if(!i){this.delete(t);return}this.#i.set(t,gt(i)),r=[t]}else if(Array.isArray(t)){r=[];let o;t=[...t].sort(TN.k);for(const a of t){const[c,l]=a;if((!o||c.toString()!==o.toString())&&(o&&this.#i.get(o).length===0&&this.#i.delete(o),o=c,r.push(c),this.#i.set(c,[])),l)this.#i.get(c)?.push(...gt(l));else{const u=this.#i.get(c);u&&(u.length=0)}}}if(this.#t.fire(r),!this.#e)return;const s=[];let n=0;for(const o of r){let a=[];const c=this.#i.get(o);if(c)if(c.length>this.g){a=[];const l=[pi.Error,pi.Warning,pi.Information,pi.Hint];e:for(let u=0;u<4;u++)for(const h of c)if(h.severity===l[u]&&a.push({...Ea.from(h),modelVersionId:this.h(o)})===this.g)break e;a.push({severity:Fi.Info,message:d(3017,null,c.length-this.g),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else a=c.map(l=>({...Ea.from(l),modelVersionId:this.h(o)}));if(s.push([o,a]),n+=a.length,n>this.f)break}this.#e.$changeMany(this.e,s)}delete(t){this.j(),this.#t.fire([t]),this.#i.delete(t),this.#e?.$changeMany(this.e,[[t,void 0]])}clear(){this.j(),this.#t.fire([...this.#i.keys()]),this.#i.clear(),this.#e?.$clear(this.e)}forEach(t,i){this.j();for(const[r,s]of this)t.call(i,r,s,this)}*[Symbol.iterator](){this.j();for(const t of this.#i.keys())yield[t,this.get(t)]}get(t){this.j();const i=this.#i.get(t);return Array.isArray(i)?Object.freeze(i.slice(0)):[]}has(t){return this.j(),Array.isArray(this.#i.get(t))}j(){if(this.c)throw new Error("illegal state - object is disposed")}static k(t,i){return t[0].toString()<i[0].toString()?-1:t[0].toString()>i[0].toString()?1:0}},H4=class{static{Fa=this}static{this.c=0}static{this.d=1e3}static{this.e=1.1*this.d}static _mapper(t){const i=new zt;for(const r of t)i.set(r,r);return{uris:Object.freeze(Array.from(i.values()))}}constructor(t,i,r,s){this.j=i,this.k=r,this.l=s,this.g=new Map,this.h=new wL({merge:n=>n.flat(),delay:50}),this.onDidChangeDiagnostics=Ie.map(this.h.event,Fa._mapper),this.f=t.getProxy(X.MainThreadDiagnostics)}createDiagnosticCollection(t,i){const{g:r,f:s,h:n,j:o,k:a,l:c}=this,l=new class{$changeMany(f,p){s.$changeMany(f,p),o.trace("[DiagnosticCollection] change many (extension, owner, uris)",t.value,f,p.length===0?"CLEARING":p)}$clear(f){s.$clear(f),o.trace("[DiagnosticCollection] remove all (extension, owner)",t.value,f)}dispose(){s.dispose()}};let u;if(!i)i="_generated_diagnostic_collection_name_#"+Fa.c++,u=i;else if(!r.has(i))u=i;else{this.j.warn(`DiagnosticCollection with name '${i}' does already exist.`);do u=i+Fa.c++;while(r.has(u))}return new class extends NP{constructor(){super(i,u,Fa.e,Fa.d,f=>c.getDocument(f)?.version,a.extUri,l,n),r.set(u,this)}dispose(){super.dispose(),r.delete(u)}}}getDiagnostics(t){if(t)return this.m(t);{const i=new Map,r=[];for(const s of this.g.values())s.forEach((n,o)=>{let a=i.get(n.toString());typeof a>"u"&&(a=r.length,i.set(n.toString(),a),r.push([n,[]])),r[a][1]=r[a][1].concat(...o)});return r}}m(t){let i=[];for(const r of this.g.values())r.has(t)&&(i=i.concat(r.get(t)));return i}$acceptMarkersChange(t){if(!this.n){const i="_generated_mirror",r=new NP(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,s=>{},this.k.extUri,void 0,this.h);this.g.set(i,r),this.n=r}for(const[i,r]of t)this.n.set(y.revive(i),r.map(Ea.to))}};H4=Fa=__decorate([__param(1,Se),__param(2,pc)],H4);var ZZ=class{constructor(e){this.a=e.getProxy(X.MainThreadDialogs)}showOpenDialog(e){return this.a.$showOpenDialog(e).then(t=>t?t.map(i=>y.revive(i)):void 0)}showSaveDialog(e){return this.a.$showSaveDialog(e).then(t=>t?y.revive(t):void 0)}},JZ=class MN{static{this.a=0}constructor(t,i,r){this.d=i,this.e=r,this.b=new Map,this.c=t.getProxy(X.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(t,i){if(Object.keys(q).indexOf(t)>=0)throw new Error(`scheme '${t}' already registered`);const r=MN.a++;this.b.set(r,i),this.c.$registerTextContentProvider(r,t);let s;if(typeof i.onDidChange=="function"){let n;s=i.onDidChange(async o=>{if(o.scheme!==t){this.e.warn(`Provider for scheme '${t}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this.d.getDocument(o))return;n&&await n;const a=this.$provideTextDocumentContent(r,o).then(async c=>{if(!c&&typeof c!="string")return;const l=this.d.getDocument(o);if(!l)return;const u=PE(c);if(!l.equalLines(u))return this.c.$onVirtualDocumentChange(o,c)}).catch(lt).finally(()=>{n===a&&(n=void 0)});n=a})}return new ke(()=>{this.b.delete(r)&&this.c.$unregisterTextContentProvider(r),s&&(s.dispose(),s=void 0)})}$provideTextDocumentContent(t,i){const r=this.b.get(t);return r?Promise.resolve(r.provideTextDocumentContent(y.revive(i),Fe.None)):Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}},QZ=class{constructor(e,t,i,r={timeout:1500,errors:3}){this.c=e,this.d=t,this.f=i,this.g=r,this.a=new Dn,this.b=new WeakMap}dispose(){this.a.clear()}getOnWillSaveTextDocumentEvent(e){return(t,i,r)=>{const n={dispose:this.a.push([t,i,e])};return Array.isArray(r)&&r.push(n),n}}async $participateInSave(e,t){const i=y.revive(e);let r=!1;const s=setTimeout(()=>r=!0,this.g.timeout),n=[];try{for(const o of[...this.a]){if(r)break;const a=this.d.getDocument(i),c=await this.h(o,{document:a,reason:Ig.to(t)});n.push(c)}}finally{clearTimeout(s)}return n}h([e,t,i],r){const s=this.b.get(e);return typeof s=="number"&&s>this.g.errors?Promise.resolve(!1):this.i(i,e,t,r).then(()=>!0,n=>{if(this.c.error(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' threw ERROR`),this.c.error(n),!(n instanceof Error)||n.message!=="concurrent_edits"){const o=this.b.get(e);this.b.set(e,o?o+1:1),typeof o=="number"&&o>this.g.errors&&this.c.info(`onWillSaveTextDocument-listener from extension '${i.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}return!1})}i(e,t,i,r){const s=[],n=Date.now(),{document:o,reason:a}=r,{version:c}=o,l=Object.freeze({document:o,reason:a,waitUntil(u){if(Object.isFrozen(s))throw dv("waitUntil can not be called async");s.push(Promise.resolve(u))}});try{t.apply(i,[l])}catch(u){return Promise.reject(u)}return Object.freeze(s),new Promise((u,h)=>{const f=setTimeout(()=>h(new Error("timeout")),this.g.timeout);return Promise.all(s).then(p=>{this.c.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-n}ms`),clearTimeout(f),u(p)}).catch(p=>{clearTimeout(f),h(p)})}).then(u=>{const h={edits:[]};for(const f of u)if(Array.isArray(f)&&f.every(p=>p instanceof so))for(const{newText:p,newEol:g,range:v}of f)h.edits.push({resource:o.uri,versionId:void 0,textEdit:{range:v&&j.from(v),text:p,eol:g&&nl.from(g)}});if(h.edits.length!==0)return c===o.version?this.f.$tryApplyWorkspaceEdit(new fi(h)):Promise.reject(new Error("concurrent_edits"))})}},YZ=class{constructor(e,t){this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.e=new I,this.onDidAddDocument=this.a.event,this.onDidRemoveDocument=this.b.event,this.onDidChangeDocument=this.c.event,this.onDidChangeDocumentWithReason=this.d.event,this.onDidSaveDocument=this.e.event,this.f=new ie,this.i=new Map,this.g=e.getProxy(X.MainThreadDocuments),this.h=t,this.h.onDidRemoveDocuments(i=>{for(const r of i)this.b.fire(r.document)},void 0,this.f),this.h.onDidAddDocuments(i=>{for(const r of i)this.a.fire(r.document)},void 0,this.f)}dispose(){this.f.dispose()}getAllDocumentData(){return[...this.h.allDocuments()]}getDocumentData(e){if(!e)return;const t=this.h.getDocument(e);if(t)return t}getDocument(e){const t=this.getDocumentData(e);if(!t?.document)throw new Error(`Unable to retrieve document from URI '${e}'`);return t.document}ensureDocumentData(e,t){const i=this.h.getDocument(e);if(i&&(!t?.encoding||i.document.encoding===t.encoding))return Promise.resolve(i);let r=this.i.get(e.toString());return r?t?.encoding&&(r=r.then(s=>s.document.encoding!==t.encoding?this.ensureDocumentData(e,t):s)):(r=this.g.$tryOpenDocument(e,t).then(s=>{this.i.delete(e.toString());const n=y.revive(s);return Xa(this.h.getDocument(n))},s=>(this.i.delete(e.toString()),Promise.reject(s))),this.i.set(e.toString(),r)),r}createDocumentData(e){return this.g.$tryCreateDocument(e).then(t=>y.revive(t))}$acceptModelLanguageChanged(e,t){const i=y.revive(e),r=this.h.getDocument(i);if(!r)throw new Error("unknown document");this.b.fire(r.document),r._acceptLanguageId(t),this.a.fire(r.document)}$acceptModelSaved(e){const t=y.revive(e),i=this.h.getDocument(t);if(!i)throw new Error("unknown document");this.$acceptDirtyStateChanged(e,!1),this.e.fire(i.document)}$acceptDirtyStateChanged(e,t){const i=y.revive(e),r=this.h.getDocument(i);if(!r)throw new Error("unknown document");r._acceptIsDirty(t),this.c.fire({document:r.document,contentChanges:[],reason:void 0}),this.d.fire({document:r.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptEncodingChanged(e,t){const i=y.revive(e),r=this.h.getDocument(i);if(!r)throw new Error("unknown document");r._acceptEncoding(t),this.c.fire({document:r.document,contentChanges:[],reason:void 0}),this.d.fire({document:r.document,contentChanges:[],reason:void 0,detailedReason:void 0})}$acceptModelChanged(e,t,i){const r=y.revive(e),s=this.h.getDocument(r);if(!s)throw new Error("unknown document");s._acceptIsDirty(i),s.onEvents(t);let n;t.isUndoing?n=Qu.Undo:t.isRedoing&&(n=Qu.Redo),this.c.fire(s0({document:s.document,contentChanges:t.changes.map(o=>({range:j.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n})),this.d.fire(s0({document:s.document,contentChanges:t.changes.map(o=>({range:j.to(o.range),rangeOffset:o.rangeOffset,rangeLength:o.rangeLength,text:o.text})),reason:n,detailedReason:t.detailedReason?{source:t.detailedReason.source,metadata:t.detailedReason}:void 0}))}setWordDefinitionFor(e,t){xV(e,t)}},XZ=class{constructor(e){this.b=new Map,this.c=new I,this.onDidChange=this.c.event,this.d=new Set,this.e=0,this.a=e.getProxy(X.MainThreadEmbeddings)}registerEmbeddingsProvider(e,t,i){if(this.d.has(t))throw new Error("An embeddings provider for this model is already registered");const r=this.e++;return this.a.$registerEmbeddingProvider(r,t),this.b.set(r,{id:t,provider:i}),te(()=>{this.d.delete(t),this.a.$unregisterEmbeddingProvider(r),this.b.delete(r)})}async computeEmbeddings(e,t,i){i??=Fe.None;let r=!1;typeof t=="string"&&(t=[t],r=!0);const s=await this.a.$computeEmbeddings(e,t,i);if(s.length!==t.length)throw new Error;if(r){if(s.length!==1)throw new Error;return s[0]}return s}async $provideEmbeddings(e,t,i){const r=this.b.get(e);if(!r)return[];const s=await r.provider.provideEmbeddings(t,i);return s||[]}get embeddingsModels(){return Array.from(this.d)}$acceptEmbeddingModels(e){this.d=new Set(e),this.c.fire()}},KZ=class{constructor(e){this.a=new Map,this.b=0,this.c=e.getProxy(X.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,t,i){if(this.a.size===0)throw new Error("No embedding vector providers registered");const r=this.a.get(e);if(!r)throw new Error("Embedding vector provider not found");const s=await r.provideEmbeddingVector(t,i);if(!s)throw new Error("Embedding vector provider returned undefined");return s}registerEmbeddingVectorProvider(e,t,i){const r=this.b;return this.b++,this.a.set(r,i),this.c.$registerAiEmbeddingVectorProvider(t,r),new ke(()=>{this.c.$unregisterAiEmbeddingVectorProvider(r),this.a.delete(r)})}},RP;(function(e){e[e.Invalid=0]="Invalid",e[e.Start=1]="Start",e[e.H=2]="H",e[e.HT=3]="HT",e[e.HTT=4]="HTT",e[e.HTTP=5]="HTTP",e[e.F=6]="F",e[e.FI=7]="FI",e[e.FIL=8]="FIL",e[e.BeforeColon=9]="BeforeColon",e[e.AfterColon=10]="AfterColon",e[e.AlmostThere=11]="AlmostThere",e[e.End=12]="End",e[e.Accept=13]="Accept",e[e.LastKnownState=14]="LastKnownState"})(RP||(RP={}));var eJ=class{constructor(e,t,i){const r=new Uint8Array(e*t);for(let s=0,n=e*t;s<n;s++)r[s]=i;this.a=r,this.rows=e,this.cols=t}get(e,t){return this.a[e*this.cols+t]}set(e,t,i){this.a[e*this.cols+t]=i}},LP=class{constructor(e){let t=0,i=0;for(let s=0,n=e.length;s<n;s++){const[o,a,c]=e[s];a>t&&(t=a),o>i&&(i=o),c>i&&(i=c)}t++,i++;const r=new eJ(i,t,0);for(let s=0,n=e.length;s<n;s++){const[o,a,c]=e[s];r.set(o,a,c)}this.a=r,this.b=t}nextState(e,t){return t<0||t>=this.b?0:this.a.get(e,t)}},W4=null;function tJ(){return W4===null&&(W4=new LP([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),W4}var OP;(function(e){e[e.None=0]="None",e[e.ForceTermination=1]="ForceTermination",e[e.CannotEndIn=2]="CannotEndIn"})(OP||(OP={}));var od=null;function iJ(){if(od===null){od=new V9(0);const e=` 	<>'"\u3001\u3002\uFF61\uFF64\uFF0C\uFF0E\uFF1A\uFF1B\u2018\u3008\u300C\u300E\u3014\uFF08\uFF3B\uFF5B\uFF62\uFF63\uFF5D\uFF3D\uFF09\u3015\u300F\u300D\u3009\u2019\uFF40\uFF5E\u2026|`;for(let i=0;i<e.length;i++)od.set(e.charCodeAt(i),1);const t=".,;:";for(let i=0;i<t.length;i++)od.set(t.charCodeAt(i),2)}return od}var rJ=class P5{static a(t,i,r,s,n){let o=n-1;do{const a=i.charCodeAt(o);if(t.get(a)!==2)break;o--}while(o>s);if(s>0){const a=i.charCodeAt(s-1),c=i.charCodeAt(o);(a===40&&c===41||a===91&&c===93||a===123&&c===125)&&o--}return{range:{startLineNumber:r,startColumn:s+1,endLineNumber:r,endColumn:o+2},url:i.substring(s,o+1)}}static computeLinks(t,i=tJ()){const r=iJ(),s=[];for(let n=1,o=t.getLineCount();n<=o;n++){const a=t.getLineContent(n),c=a.length;let l=0,u=0,h=0,f=1,p=!1,g=!1,v=!1,b=!1;for(;l<c;){let S=!1;const E=a.charCodeAt(l);if(f===13){let $;switch(E){case 40:p=!0,$=0;break;case 41:$=p?0:1;break;case 91:v=!0,g=!0,$=0;break;case 93:v=!1,$=g?0:1;break;case 123:b=!0,$=0;break;case 125:$=b?0:1;break;case 39:case 34:case 96:h===E?$=1:h===39||h===34||h===96?$=0:$=1;break;case 42:$=h===42?1:0;break;case 32:$=v?0:1;break;default:$=r.get(E)}$===1&&(s.push(P5.a(r,a,n,u,l)),S=!0)}else if(f===12){let $;E===91?(g=!0,$=0):$=r.get(E),$===1?S=!0:f=13}else f=i.nextState(f,E),f===0&&(S=!0);S&&(f=1,p=!1,g=!1,b=!1,u=l+1,h=E),l++}f===13&&s.push(P5.a(r,a,n,u,c))}return s}},sJ=class{constructor(){this.a=[]}add(e){this.b=void 0,this.a.push(e)}delete(e){const t=this.a.indexOf(e);t>=0&&(this.a.splice(t,1),this.b=void 0)}c(){if(!this.b){const e=this.a.sort(),t=[];let i,r,s=14,n=14;for(const o of e){let a=i?KL(i,o):0;for(a===0?r=1:r=n;a<o.length;a++)a+1===o.length?(s=n,n=9):n+=1,t.push([r,o.toUpperCase().charCodeAt(a),n]),t.push([r,o.toLowerCase().charCodeAt(a),n]),r=n;i=o,n=s}t.push([9,58,10]),t.push([10,47,12]),this.b=new LP(t)}}provideDocumentLinks(e){this.c();const t=[],i=rJ.computeLinks({getLineContent(r){return e.lineAt(r-1).text},getLineCount(){return e.lineCount}},this.b);for(const r of i){const s=Ca.to(r);s.target&&t.push(s)}return t}},nJ=class T5{constructor(t,i){this.i=i,this.b=new sJ,this.c=new Map,this.d=new Set,this.f=new Map,this.h=0,this.a=t.getProxy(X.MainThreadFileSystem)}dispose(){this.g?.dispose()}registerFileSystemProvider(t,i,r,s={}){if(T5.j(r),this.d.has(i))throw new Error(`a provider for the scheme '${i}' is already registered`);this.g||(this.g=this.i.registerDocumentLinkProvider(t,"*",this.b));const n=this.h++;this.b.add(i),this.d.add(i),this.c.set(n,r);let o=2;s.isCaseSensitive&&(o+=1024),s.isReadonly&&(o+=2048),typeof r.copy=="function"&&(o+=8),typeof r.open=="function"&&typeof r.close=="function"&&typeof r.read=="function"&&typeof r.write=="function"&&(T(t,"fsChunks"),o+=4);let a;s.isReadonly&&Gn(s.isReadonly)&&s.isReadonly.value!==""&&(a={value:s.isReadonly.value,isTrusted:s.isReadonly.isTrusted,supportThemeIcons:s.isReadonly.supportThemeIcons,supportHtml:s.isReadonly.supportHtml,baseUri:s.isReadonly.baseUri,uris:s.isReadonly.uris}),this.a.$registerFileSystemProvider(n,i,o,a).catch(l=>{console.error(`FAILED to register filesystem provider of ${t.identifier.value}-extension for the scheme ${i}`),console.error(l)});const c=r.onDidChangeFile(l=>{const u=[];for(const h of l){const{uri:f,type:p}=h;if(f.scheme!==i)continue;let g;switch(p){case Gc.Changed:g=0;break;case Gc.Created:g=1;break;case Gc.Deleted:g=2;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:f,type:g})}this.a.$onFileSystemChange(n,u)});return te(()=>{c.dispose(),this.b.delete(i),this.d.delete(i),this.c.delete(n),this.a.$unregisterProvider(n)})}static j(t){if(!t)throw new Error("MISSING provider");if(typeof t.watch!="function")throw new Error("Provider does NOT implement watch");if(typeof t.stat!="function")throw new Error("Provider does NOT implement stat");if(typeof t.readDirectory!="function")throw new Error("Provider does NOT implement readDirectory");if(typeof t.createDirectory!="function")throw new Error("Provider does NOT implement createDirectory");if(typeof t.readFile!="function")throw new Error("Provider does NOT implement readFile");if(typeof t.writeFile!="function")throw new Error("Provider does NOT implement writeFile");if(typeof t.delete!="function")throw new Error("Provider does NOT implement delete");if(typeof t.rename!="function")throw new Error("Provider does NOT implement rename")}static k(t){const{type:i,ctime:r,mtime:s,size:n,permissions:o}=t;return{type:i,ctime:r,mtime:s,size:n,permissions:o}}$stat(t,i){return Promise.resolve(this.l(t).stat(y.revive(i))).then(r=>T5.k(r))}$readdir(t,i){return Promise.resolve(this.l(t).readDirectory(y.revive(i)))}$readFile(t,i){return Promise.resolve(this.l(t).readFile(y.revive(i))).then(r=>W.wrap(r))}$writeFile(t,i,r,s){return Promise.resolve(this.l(t).writeFile(y.revive(i),r.buffer,s))}$delete(t,i,r){return Promise.resolve(this.l(t).delete(y.revive(i),r))}$rename(t,i,r,s){return Promise.resolve(this.l(t).rename(y.revive(i),y.revive(r),s))}$copy(t,i,r,s){const n=this.l(t);if(!n.copy)throw new Error('FileSystemProvider does not implement "copy"');return Promise.resolve(n.copy(y.revive(i),y.revive(r),s))}$mkdir(t,i){return Promise.resolve(this.l(t).createDirectory(y.revive(i)))}$watch(t,i,r,s){const n=this.l(t).watch(y.revive(r),s);this.f.set(i,n)}$unwatch(t,i){const r=this.f.get(i);r&&(r.dispose(),this.f.delete(i))}$open(t,i,r){const s=this.l(t);if(!s.open)throw new Error('FileSystemProvider does not implement "open"');return Promise.resolve(s.open(y.revive(i),r))}$close(t,i){const r=this.l(t);if(!r.close)throw new Error('FileSystemProvider does not implement "close"');return Promise.resolve(r.close(i))}$read(t,i,r,s){const n=this.l(t);if(!n.read)throw new Error('FileSystemProvider does not implement "read"');const o=W.alloc(s);return Promise.resolve(n.read(i,r,o.buffer,0,s)).then(a=>o.slice(0,a))}$write(t,i,r,s){const n=this.l(t);if(!n.write)throw new Error('FileSystemProvider does not implement "write"');return Promise.resolve(n.write(i,r,s.buffer,0,s.byteLength))}l(t){const i=this.c.get(t);if(!i){const r=new Error;throw r.name="ENOPRO",r.message="no provider",r}return i}};function FP(e){return typeof e.correlationId=="number"}function oJ(e){return e.recursive===!0}var UP=class NN extends Q{static{this.a=5}constructor(t,i,r,s){super(),this.h=t,this.j=i,this.m=r,this.n=s,this.c=this.D(new Br),this.f=void 0,this.g=0}r(){const t=new ie;this.c.value=t,this.b=this.q(t),this.b.setVerboseLogging(this.m),t.add(this.b.onDidChangeFile(i=>this.h(i))),t.add(this.b.onDidLogMessage(i=>this.j(i))),t.add(this.b.onDidError(i=>this.s(i.error,i.request)))}s(t,i){this.t(t,i)?this.g<NN.a&&this.f?(this.w(`restarting watcher after unexpected error: ${t}`),this.u(this.f)):this.w(`gave up attempting to restart watcher after unexpected error: ${t}`):this.w(t)}t(t,i){return!(!this.n.restartOnError||i||t.indexOf("No space left on device")!==-1||t.indexOf("EMFILE")!==-1)}u(t){this.g++,this.r(),this.watch(t)}async watch(t){this.f=t,await this.b?.watch(t)}async setVerboseLogging(t){this.m=t,await this.b?.setVerboseLogging(t)}w(t){this.j({type:"error",message:`[File Watcher (${this.n.type})] ${t}`})}y(t){this.j({type:"trace",message:`[File Watcher (${this.n.type})] ${t}`})}dispose(){return this.b=void 0,super.dispose()}},aJ=class extends UP{constructor(e,t,i){super(e,t,i,{type:"node.js",restartOnError:!1})}},cJ=class extends UP{constructor(e,t,i){super(e,t,i,{type:"universal",restartOnError:!0})}};function jP(e){return e.map(t=>({type:t.type,resource:y.revive(t.resource),cId:t.cId}))}function lJ(e){const t=new uJ;for(const i of e)t.processEvent(i);return t.coalesce()}function zP(e,t){return typeof t=="string"&&!t.startsWith(sa)&&!xr(t)?{base:e,pattern:t}:t}function HP(e,t,i){const r=[];for(const s of t)r.push(Kr(zP(e,s),{ignoreCase:i}));return r}var uJ=class{constructor(){this.a=new Set,this.b=new Map}c(e){return $t?e.resource.fsPath:e.resource.fsPath.toLowerCase()}processEvent(e){const t=this.b.get(this.c(e));let i=!1;if(t){const r=t.type,s=e.type;t.resource.fsPath!==e.resource.fsPath&&(e.type===2||e.type===1)?i=!0:r===1&&s===2?(this.b.delete(this.c(e)),this.a.delete(t)):r===2&&s===1?t.type=0:r===1&&s===0||(t.type=s)}else i=!0;i&&(this.a.add(e),this.b.set(this.c(e),e))}coalesce(){const e=[],t=[];return Array.from(this.a).filter(i=>i.type!==2?(e.push(i),!1):!0).sort((i,r)=>i.resource.fsPath.length-r.resource.fsPath.length).filter(i=>t.some(r=>vz(i.resource.fsPath,r,!$t))?!1:(t.push(i.resource.fsPath),!0)).concat(e)}};function hJ(e,t){if(typeof t=="number")switch(e.type){case 1:return(t&4)===0;case 2:return(t&8)===0;case 0:return(t&2)===0}return!1}function dJ(e){if(typeof e=="number"){const t=[];return e&4&&t.push("Added"),e&8&&t.push("Deleted"),e&2&&t.push("Updated"),t.length===0?"<all>":`[${t.join(", ")}]`}return"<none>"}var fJ=class{get ignoreCreateEvents(){return!!(this.h&1)}get ignoreChangeEvents(){return!!(this.h&2)}get ignoreDeleteEvents(){return!!(this.h&4)}constructor(e,t,i,r,s,n,o,a){this.a=Math.random(),this.b=new I,this.c=new I,this.d=new I,this.h=0,a.ignoreCreateEvents&&(this.h+=1),a.ignoreChangeEvents&&(this.h+=2),a.ignoreDeleteEvents&&(this.h+=4);const c=typeof o=="string"?!((i.getCapabilities(q.file)??0)&1024):i.extUri.ignorePathCasing(y.revive(o.baseUri)),l=Kr(o,{ignoreCase:c}),u=typeof o=="string",h=!1,f=n(p=>{if(!(typeof p.session=="number"&&p.session!==this.a)&&!(h&&typeof p.session>"u")){if(!a.ignoreCreateEvents)for(const g of p.created){const v=y.revive(g);l(v.fsPath)&&(!u||r.getWorkspaceFolder(v))&&this.b.fire(v)}if(!a.ignoreChangeEvents)for(const g of p.changed){const v=y.revive(g);l(v.fsPath)&&(!u||r.getWorkspaceFolder(v))&&this.c.fire(v)}if(!a.ignoreDeleteEvents)for(const g of p.deleted){const v=y.revive(g);l(v.fsPath)&&(!u||r.getWorkspaceFolder(v))&&this.d.fire(v)}}});this.g=ke.from(this.i(e,r,t,s,o,a,!1),this.b,this.c,this.d,f)}i(e,t,i,r,s,n,o){const a=ke.from();if(typeof s=="string"||n.ignoreChangeEvents&&n.ignoreCreateEvents&&n.ignoreDeleteEvents)return a;const c=e.getProxy(X.MainThreadFileSystemEventService);let l=!1;(s.pattern.includes(sa)||s.pattern.includes(pw))&&(l=!0);const u=[];let h,f;if(o)(n.ignoreChangeEvents||n.ignoreCreateEvents||n.ignoreDeleteEvents)&&(f=14,n.ignoreChangeEvents&&(f&=-3),n.ignoreCreateEvents&&(f&=-5),n.ignoreDeleteEvents&&(f&=-9));else if(l&&u.length===0){const p=t.getWorkspaceFolder(y.revive(s.baseUri)),g=i.getConfiguration("files",p).get("watcherExclude");if(g)for(const v in g)v&&g[v]===!0&&u.push(v)}else if(!l){const p=t.getWorkspaceFolder(y.revive(s.baseUri));if(p){const g=i.getConfiguration("files",p).get("watcherExclude");if(g){for(const v in g)if(v&&g[v]===!0){const b=`${Ln(v,"/")}/${sa}`;h||(h=[]),h.push(zP(p.uri.fsPath,b))}}if(!h||h.length===0)return a}}return c.$watch(r.identifier.value,this.a,s.baseUri,{recursive:l,excludes:u,includes:h,filter:f},!!o),ke.from({dispose:()=>c.$unwatch(this.a)})}dispose(){this.g.dispose()}get onDidCreate(){return this.b.event}get onDidChange(){return this.c.event}get onDidDelete(){return this.d.event}},pJ=class{get created(){return this.a.value}get changed(){return this.b.value}get deleted(){return this.c.value}constructor(e){this.d=e,this.a=new Pt(()=>this.d.created.map(y.revive)),this.b=new Pt(()=>this.d.changed.map(y.revive)),this.c=new Pt(()=>this.d.deleted.map(y.revive)),this.session=this.d.session}},gJ=class{constructor(e,t,i){this.j=e,this.k=t,this.l=i,this.a=new I,this.b=new I,this.c=new I,this.d=new I,this.g=new eu,this.h=new eu,this.i=new eu,this.onDidRenameFile=this.b.event,this.onDidCreateFile=this.c.event,this.onDidDeleteFile=this.d.event}createFileSystemWatcher(e,t,i,r,s,n){return new fJ(this.j,t,i,e,r,this.a.event,Wi.from(s),n)}$onFileEvent(e){this.a.fire(new pJ(e))}$onDidRunFileOperation(e,t){switch(e){case 2:this.b.fire(Object.freeze({files:t.map(i=>({oldUri:y.revive(i.source),newUri:y.revive(i.target)}))}));break;case 1:this.d.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;case 0:case 3:this.c.fire(Object.freeze({files:t.map(i=>y.revive(i.target))}));break;default:}}getOnWillRenameFileEvent(e){return this.m(e,this.g)}getOnWillCreateFileEvent(e){return this.m(e,this.h)}getOnWillDeleteFileEvent(e){return this.m(e,this.i)}m(e,t){return(i,r,s)=>{const n=function(a){i.call(r,a)};return n.extension=e,t.event(n,void 0,s)}}async $onWillRunFileOperation(e,t,i,r){switch(e){case 2:return await this.n(this.g,{files:t.map(s=>({oldUri:y.revive(s.source),newUri:y.revive(s.target)}))},i,r);case 1:return await this.n(this.i,{files:t.map(s=>y.revive(s.target))},i,r);case 0:case 3:return await this.n(this.h,{files:t.map(s=>y.revive(s.target))},i,r)}}async n(e,t,i,r){const s=new Set,n=[];if(await e.fireAsync(t,r,async(a,c)=>{const l=Date.now(),u=await Promise.resolve(a);u instanceof da&&(n.push([c.extension,u]),s.add(c.extension.displayName??c.extension.identifier.value)),Date.now()-l>i&&this.k.warn("SLOW file-participant",c.extension.identifier)}),r.isCancellationRequested||n.length===0)return;const o={edits:[]};for(const[,a]of n){const{edits:c}=nr.from(a,{getTextDocumentVersion:l=>this.l.getDocument(l)?.version,getNotebookDocumentVersion:()=>{}});o.edits=o.edits.concat(c)}return{edit:o,extensionNames:Array.from(s)}}},mJ=class{constructor(e,t,i,r,s){this.a=t,this.b=i,this.c=r;const n=new ye("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new B("showOptions","Show Options",o=>!0,o=>o),new B("resource","Interactive resource Uri",o=>!0,o=>o),new B("controllerId","Notebook controller Id",o=>!0,o=>o),new B("title","Interactive editor title",o=>!0,o=>o)],new be("Notebook and input URI",o=>{if(s.debug("[ExtHostInteractive] open iw with notebook editor id",o.notebookEditorId),o.notebookEditorId!==void 0){const a=this.a.getEditorById(o.notebookEditorId);return s.debug("[ExtHostInteractive] notebook editor found",a.id),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri),notebookEditor:a.apiEditor}}return s.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",o.notebookUri,o.inputUri),{notebookUri:y.revive(o.notebookUri),inputUri:y.revive(o.inputUri)}}));this.c.registerApiCommand(n)}$willAddInteractiveDocument(e,t,i,r){this.b.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:t,lines:[""],languageId:i,uri:e,isDirty:!1,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,t){this.b.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}},vJ=class{constructor(e){this.b=0,this.a=e.getProxy(X.MainThreadLabelService)}$registerResourceLabelFormatter(e){const t=this.b++;return this.a.$registerResourceLabelFormatter(t,e),te(()=>{this.a.$unregisterResourceLabelFormatter(t)})}},WP;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(WP||(WP={}));var wJ=class jr extends st{constructor(t,i,r,s){super(t,i,r,s),this.selectionStartLineNumber=t,this.selectionStartColumn=i,this.positionLineNumber=r,this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(t){return jr.selectionsEqual(this,t)}static selectionsEqual(t,i){return t.selectionStartLineNumber===i.selectionStartLineNumber&&t.selectionStartColumn===i.selectionStartColumn&&t.positionLineNumber===i.positionLineNumber&&t.positionColumn===i.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(t,i){return this.getDirection()===0?new jr(this.startLineNumber,this.startColumn,t,i):new jr(t,i,this.startLineNumber,this.startColumn)}getPosition(){return new gr(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new gr(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(t,i){return this.getDirection()===0?new jr(t,i,this.endLineNumber,this.endColumn):new jr(this.endLineNumber,this.endColumn,t,i)}static fromPositions(t,i=t){return new jr(t.lineNumber,t.column,i.lineNumber,i.column)}static fromRange(t,i){return i===0?new jr(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn):new jr(t.endLineNumber,t.endColumn,t.startLineNumber,t.startColumn)}static liftSelection(t){return new jr(t.selectionStartLineNumber,t.selectionStartColumn,t.positionLineNumber,t.positionColumn)}static selectionsArrEqual(t,i){if(t&&!i||!t&&i)return!1;if(!t&&!i)return!0;if(t.length!==i.length)return!1;for(let r=0,s=t.length;r<s;r++)if(!this.selectionsEqual(t[r],i[r]))return!1;return!0}static isISelection(t){return!!t&&typeof t.selectionStartLineNumber=="number"&&typeof t.selectionStartColumn=="number"&&typeof t.positionLineNumber=="number"&&typeof t.positionColumn=="number"}static createWithDirection(t,i,r,s,n){return n===0?new jr(t,i,r,s):new jr(r,s,t,i)}},BP=class RN{constructor(t,i){this.d=t,this.e=i}async provideDocumentSymbols(t,i){const r=this.d.getDocument(t),s=await this.e.provideDocumentSymbols(r,i);if(!gv(s))return s[0]instanceof _u?s.map(Jb.from):RN.f(s)}static f(t){t=t.slice(0).sort((s,n)=>{let o=s.location.range.start.compareTo(n.location.range.start);return o===0&&(o=n.location.range.end.compareTo(s.location.range.end)),o});const i=[],r=[];for(const s of t){const n={name:s.name||"!!MISSING: name!!",kind:Mr.from(s.kind),tags:s.tags?.map(cn.from)||[],detail:"",containerName:s.containerName,range:j.from(s.location.range),selectionRange:j.from(s.location.range),children:[]};for(;;){if(r.length===0){r.push(n),i.push(n);break}const o=r[r.length-1];if(st.containsRange(o.range,n.range)&&!st.equalsRange(o.range,n.range)){o.children?.push(n),r.push(n);break}r.pop()}}return i}},n1=class{constructor(e,t,i,r,s,n){this.f=e,this.g=t,this.h=i,this.j=r,this.k=s,this.l=n,this.d=new ls("CodeLens"),this.e=new Map}async provideCodeLenses(e,t){const i=this.f.getDocument(e),r=await this.h.provideCodeLenses(i,t);if(!r||t.isCancellationRequested)return;const s=this.d.add(r),n=new ie;this.e.set(s,n);const o={cacheId:s,lenses:[]};for(let a=0;a<r.length;a++){if(!xe.isRange(r[a].range)){console.warn("INVALID code lens, range is not defined",this.j.identifier.value);continue}o.lenses.push({cacheId:[s,a],range:j.from(r[a].range),command:this.g.toInternal(r[a].command,n)})}return o}async resolveCodeLens(e,t){const i=e.cacheId&&this.d.get(...e.cacheId);if(!i)return;let r;if(typeof this.h.resolveCodeLens!="function"||i.isResolved?r=i:r=await this.h.resolveCodeLens(i,t),r||(r=i),t.isCancellationRequested)return;const s=e.cacheId&&this.e.get(e.cacheId[0]);if(s){if(!r.command){const n=new Error("INVALID code lens resolved, lacks command: "+this.j.identifier.value);this.k.onExtensionError(this.j.identifier,n),this.l.error(n);return}return e.command=this.g.toInternal(r.command,s),e}}releaseCodeLenses(e){this.e.get(e)?.dispose(),this.e.delete(e),this.d.delete(e)}};function o1(e){return Array.isArray(e)?e.map(bh.from):e?[bh.from(e)]:[]}var _P=class{constructor(e,t){this.d=e,this.e=t}async provideDefinition(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideDefinition(r,s,i);return o1(n)}},VP=class{constructor(e,t){this.d=e,this.e=t}async provideDeclaration(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideDeclaration(r,s,i);return o1(n)}},qP=class{constructor(e,t){this.d=e,this.e=t}async provideImplementation(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideImplementation(r,s,i);return o1(n)}},GP=class{constructor(e,t){this.d=e,this.e=t}async provideTypeDefinition(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideTypeDefinition(r,s,i);return o1(n)}},B4=class LN{static{this.f=10}constructor(t,i){this.g=t,this.h=i,this.d=0,this.e=new Map}async provideHover(t,i,r,s){const n=this.g.getDocument(t),o=Xe.to(i);let a;if(r&&r.verbosityRequest){const h=r.verbosityRequest.previousHover.id,f=this.e.get(h);if(!f)throw new Error(`Hover with id ${h} not found`);const p={verbosityDelta:r.verbosityRequest.verbosityDelta,previousHover:f};a=await this.h.provideHover(n,o,s,p)}else a=await this.h.provideHover(n,o,s);if(!a||gv(a.contents))return;a.range||(a.range=n.getWordRangeAtPosition(o)),a.range||(a.range=new xe(o,o));const c=yh.from(a),l=this.d;if(this.e.size===LN.f){const h=Math.min(...this.e.keys());this.e.delete(h)}return this.e.set(l,a),this.d+=1,{...c,id:l}}releaseHover(t){this.e.delete(t)}},ZP=class{constructor(e,t){this.d=e,this.e=t}async provideEvaluatableExpression(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideEvaluatableExpression(r,s,i);if(n)return Xb.from(n)}},JP=class{constructor(e,t){this.d=e,this.e=t}async provideInlineValues(e,t,i,r){const s=this.d.getDocument(e),n=await this.e.provideInlineValues(s,j.to(t),Ag.to(i),r);if(Array.isArray(n))return n.map(o=>yg.from(o))}},QP=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentHighlights(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideDocumentHighlights(r,s,i);if(Array.isArray(n))return n.map(il.from)}},YP=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i}async provideMultiDocumentHighlights(e,t,i,r){const s=this.d.getDocument(e),n=i.map(c=>{try{return this.d.getDocument(c)}catch(l){this.f.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+l);return}}).filter(c=>c!==void 0),o=Xe.to(t),a=await this.e.provideMultiDocumentHighlights(s,o,n,r);if(Array.isArray(a))return a.map(Kb.from)}},XP=class{constructor(e,t){this.d=e,this.e=t}async provideLinkedEditingRanges(e,t,i){const r=this.d.getDocument(e),s=Xe.to(t),n=await this.e.provideLinkedEditingRanges(r,s,i);if(n&&Array.isArray(n.ranges))return{ranges:gt(n.ranges.map(j.from)),wordPattern:n.wordPattern}}},KP=class{constructor(e,t){this.d=e,this.e=t}async provideReferences(e,t,i,r){const s=this.d.getDocument(e),n=Xe.to(t),o=await this.e.provideReferences(s,n,i,r);if(Array.isArray(o))return o.map(Hi.from)}},a1=class ev{static{this.d=1e3}constructor(t,i,r,s,n,o,a){this.g=t,this.h=i,this.j=r,this.k=s,this.l=n,this.m=o,this.n=a,this.e=new ls("CodeAction"),this.f=new Map}async provideCodeActions(t,i,r,s){const n=this.g.getDocument(t),o=wJ.isISelection(i)?ss.to(i):j.to(i),a=[];for(const p of this.j.getDiagnostics(t))if(o.intersection(p.range)&&a.push(p)>ev.d)break;const c={diagnostics:a,only:r.only?new kt(r.only):void 0,triggerKind:fy.to(r.trigger)},l=await this.k.provideCodeActions(n,o,c,s);if(!Xl(l)||s.isCancellationRequested)return;const u=this.e.add(l),h=new ie;this.f.set(u,h);const f=[];for(let p=0;p<l.length;p++){const g=l[p];if(g)if(ev.o(g)&&!(g instanceof qu))this.n.report("CodeActionProvider.provideCodeActions - return commands",this.m,"Return 'CodeAction' instances instead."),f.push({_isSynthetic:!0,title:g.title,command:this.h.toInternal(g,h)});else{const v=g;c.only&&(v.kind?c.only.contains(v.kind)||this.l.warn(`${this.m.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action is of kind '${v.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`):this.l.warn(`${this.m.identifier.value} - Code actions of kind '${c.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`));const b=v.ranges??[];f.push({cacheId:[u,p],title:v.title,command:v.command&&this.h.toInternal(v.command,h),diagnostics:v.diagnostics&&v.diagnostics.map(Ea.from),edit:v.edit&&nr.from(v.edit,void 0),kind:v.kind&&v.kind.value,isPreferred:v.isPreferred,isAI:et(this.m,"codeActionAI")?v.isAI:!1,ranges:et(this.m,"codeActionRanges")?gt(b.map(j.from)):void 0,disabled:v.disabled?.reason})}}return{cacheId:u,actions:f}}async resolveCodeAction(t,i){const[r,s]=t,n=this.e.get(r,s);if(!n||ev.o(n))return{};if(!this.k.resolveCodeAction)return{};const o=await this.k.resolveCodeAction(n,i)??n;let a;o.edit&&(a=nr.from(o.edit,void 0));let c;if(o.command){const l=this.f.get(r);l&&(c=this.h.toInternal(o.command,l))}return{edit:a,command:c}}releaseCodeActions(t){this.f.get(t)?.dispose(),this.f.delete(t),this.e.delete(t)}static o(t){return typeof t.command=="string"&&typeof t.title=="string"}},ad=class{constructor(e,t,i,r,s){this.f=e,this.g=t,this.h=i,this.j=r,this.k=s,this.e=new ls("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,t,i,r){if(!this.h.prepareDocumentPaste)return;this.d=void 0;const s=this.g.getDocument(e),n=t.map(u=>j.to(u)),o=hl.toDataTransfer(i,()=>{throw new MR});if(await this.h.prepareDocumentPaste(s,n,o,r),r.isCancellationRequested)return;const a=Array.from(o).filter(([,u])=>!(u instanceof Op)),c=new Map,l=await Promise.all(Array.from(a,async([u,h])=>{const f=Tt();return c.set(f,h),[u,await Ia.from(u,h,f)]}));return this.d=c,{items:l}}async providePasteEdits(e,t,i,r,s,n){if(!this.h.provideDocumentPasteEdits)return[];const o=this.g.getDocument(t),a=i.map(f=>j.to(f)),c=r.items.map(([f,p])=>{const g=this.d?.get(p.id);return g?[f,g]:[f,Ia.to(f,p,async v=>(await this.f.$resolvePasteFileData(this.j,e,v)).buffer)]}),l=new Hc(c),u=await this.h.provideDocumentPasteEdits(o,a,l,{only:s.only?new co(s.only):void 0,triggerKind:s.triggerKind},n);if(!u||n.isCancellationRequested)return[];const h=this.e.add(u);return u.map((f,p)=>({_cacheId:[h,p],title:f.title??d(3020,null,this.k.displayName||this.k.name),kind:f.kind,yieldTo:f.yieldTo?.map(g=>g.value),insertText:typeof f.insertText=="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?nr.from(f.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,t){const[i,r]=e,s=this.e.get(i,r);if(!s||!this.h.resolveDocumentPasteEdit)return{};const n=await this.h.resolveDocumentPasteEdit(s,t)??s;return{insertText:n.insertText,additionalEdit:n.additionalEdit?nr.from(n.additionalEdit,void 0):void 0}}releasePasteEdits(e){this.e.delete(e)}},e3=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentFormattingEdits(e,t,i){const r=this.d.getDocument(e),s=await this.e.provideDocumentFormattingEdits(r,t,i);if(Array.isArray(s))return s.map(Kt.from)}},_4=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentRangeFormattingEdits(e,t,i,r){const s=this.d.getDocument(e),n=j.to(t),o=await this.e.provideDocumentRangeFormattingEdits(s,n,i,r);if(Array.isArray(o))return o.map(Kt.from)}async provideDocumentRangesFormattingEdits(e,t,i,r){bv(typeof this.e.provideDocumentRangesFormattingEdits=="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const s=this.d.getDocument(e),n=t.map(j.to),o=await this.e.provideDocumentRangesFormattingEdits(s,n,i,r);if(Array.isArray(o))return o.map(Kt.from)}},t3=class{constructor(e,t){this.d=e,this.e=t,this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,t,i,r,s){const n=this.d.getDocument(e),o=Xe.to(t),a=await this.e.provideOnTypeFormattingEdits(n,o,i,r,s);if(Array.isArray(a))return a.map(Kt.from)}},c1=class{constructor(e,t){this.e=e,this.f=t,this.d=new ls("WorkspaceSymbols")}async provideWorkspaceSymbols(e,t){const i=await this.e.provideWorkspaceSymbols(e,t);if(!Xl(i))return{symbols:[]};const r=this.d.add(i),s={cacheId:r,symbols:[]};for(let n=0;n<i.length;n++){const o=i[n];if(!o||!o.name){this.f.warn("INVALID SymbolInformation",o);continue}s.symbols.push({...xa.from(o),cacheId:[r,n]})}return s}async resolveWorkspaceSymbol(e,t){if(typeof this.e.resolveWorkspaceSymbol!="function"||!e.cacheId)return e;const i=this.d.get(...e.cacheId);if(i){const r=await this.e.resolveWorkspaceSymbol(i,t);return r&&Qs(e,xa.from(r),!0)}}releaseWorkspaceSymbols(e){this.d.delete(e)}},l1=class M5{static supportsResolving(t){return typeof t.prepareRename=="function"}constructor(t,i,r){this.d=t,this.e=i,this.f=r}async provideRenameEdits(t,i,r,s){const n=this.d.getDocument(t),o=Xe.to(i);try{const a=await this.e.provideRenameEdits(n,o,r,s);return a?nr.from(a):void 0}catch(a){const c=M5.g(a);return c?{rejectReason:c,edits:void 0}:Promise.reject(a)}}async resolveRenameLocation(t,i,r){if(typeof this.e.prepareRename!="function")return Promise.resolve(void 0);const s=this.d.getDocument(t),n=Xe.to(i);try{const o=await this.e.prepareRename(s,n,r);let a,c;if(xe.isRange(o)?(a=o,c=s.getText(o)):yt(o)&&(a=o.range,c=o.placeholder),!a||!c)return;if(a.start.line>n.line||a.end.line<n.line){this.f.warn("INVALID rename location: position line must be within range start/end lines");return}return{range:j.from(a),text:c}}catch(o){const a=M5.g(o);return a?{rejectReason:a,range:void 0,text:void 0}:Promise.reject(o)}}static g(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},V4=class N5{static{this.d={[Rf.Invoke]:rh.Invoke,[Rf.Automatic]:rh.Automatic}}constructor(t,i,r){this.e=t,this.f=i,this.g=r}async supportsAutomaticNewSymbolNamesTriggerKind(){return this.f.supportsAutomaticTriggerKind}async provideNewSymbolNames(t,i,r,s){const n=this.e.getDocument(t),o=j.to(i);try{const a=N5.d[r],c=await this.f.provideNewSymbolNames(n,o,a,s);return c?c.map(l=>typeof l=="string"?{newSymbolName:l}:{newSymbolName:l.newSymbolName,tags:l.tags}):void 0}catch(a){this.g.error(N5.h(a)??JSON.stringify(a,null,"	"));return}}static h(t){return typeof t=="string"?t:t instanceof Error&&typeof t.message=="string"?t.message:void 0}},q4=class{constructor(e,t){this.resultId=e,this.tokens=t}},G4=class fs{constructor(t,i){this.f=t,this.g=i,this.e=1,this.d=new Map}async provideDocumentSemanticTokens(t,i,r){const s=this.f.getDocument(t),n=i!==0?this.d.get(i):null;let o=typeof n?.resultId=="string"&&typeof this.g.provideDocumentSemanticTokensEdits=="function"?await this.g.provideDocumentSemanticTokensEdits(s,n.resultId,r):await this.g.provideDocumentSemanticTokens(s,r);return n&&this.d.delete(i),o?(o=fs.h(o),this.o(fs.n(n,o),o)):null}async releaseDocumentSemanticColoring(t){this.d.delete(t)}static h(t){return fs.j(t)?fs.k(t)?t:new Zc(new Uint32Array(t.data),t.resultId):fs.l(t)?fs.m(t)?t:new Wp(t.edits.map(i=>new u7(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),t.resultId):t}static j(t){return t&&!!t.data}static k(t){return t.data instanceof Uint32Array}static l(t){return t&&Array.isArray(t.edits)}static m(t){for(const i of t.edits)if(!(i.data instanceof Uint32Array))return!1;return!0}static n(t,i){if(!fs.j(i)||!t||!t.tokens)return i;const r=t.tokens,s=r.length,n=i.data,o=n.length;let a=0;const c=Math.min(s,o);for(;a<c&&r[a]===n[a];)a++;if(a===s&&a===o)return new Wp([],i.resultId);let l=0;const u=c-a;for(;l<u&&r[s-l-1]===n[o-l-1];)l++;return new Wp([{start:a,deleteCount:s-a-l,data:n.subarray(a,o-l)}],i.resultId)}o(t,i){if(fs.j(t)){const r=this.e++;return this.d.set(r,new q4(t.resultId,t.data)),L4({id:r,type:"full",data:t.data})}if(fs.l(t)){const r=this.e++;return fs.j(i)?this.d.set(r,new q4(i.resultId,i.data)):this.d.set(r,new q4(t.resultId)),L4({id:r,type:"delta",deltas:(t.edits||[]).map(s=>({start:s.start,deleteCount:s.deleteCount,data:s.data}))})}return null}},i3=class{constructor(e,t){this.d=e,this.e=t}async provideDocumentRangeSemanticTokens(e,t,i){const r=this.d.getDocument(e),s=await this.e.provideDocumentRangeSemanticTokens(r,j.to(t),i);return s?this.f(s):null}f(e){return L4({id:0,type:"full",data:e.data})}},cd=class ON{static supportsResolving(t){return typeof t.resolveCompletionItem=="function"}constructor(t,i,r,s,n){this.f=t,this.g=i,this.h=r,this.j=s,this.k=n,this.d=new ls("CompletionItem"),this.e=new Map}async provideCompletionItems(t,i,r,s){const n=this.f.getDocument(t),o=Xe.to(i),a=n.getWordRangeAtPosition(o)||new xe(o,o),c=a.with({end:o}),l=new Ji,u=await this.h.provideCompletionItems(n,o,s,ty.to(r));if(!u||s.isCancellationRequested)return;const h=Array.isArray(u)?new Tc(u):u,f=ON.supportsResolving(this.h)?this.d.add(h.items):this.d.add([]),p=new ie;this.e.set(f,p);const g=[],v={x:f,b:g,a:{replace:j.from(a),insert:j.from(c)},c:h.isIncomplete||void 0,d:l.elapsed()};for(let b=0;b<h.items.length;b++){const S=h.items[b],E=this.l(S,[f,b],c,a);g.push(E)}return v}async resolveCompletionItem(t,i){if(typeof this.h.resolveCompletionItem!="function")return;const r=this.d.get(...t);if(!r)return;const s=this.l(r,t),n=await this.h.resolveCompletionItem(r,i);if(!n)return;const o=this.l(n,t);return(s.h!==o.h||s.i!==o.i)&&this.j.report("CompletionItem.insertText",this.k,"extension MAY NOT change 'insertText' of a CompletionItem during resolve"),(s.n!==o.n||s.o!==o.o||!Li(s.p,o.p))&&this.j.report("CompletionItem.command",this.k,"extension MAY NOT change 'command' of a CompletionItem during resolve"),{...s,d:o.d,c:o.c,l:o.l,h:o.h,i:o.i,n:o.n,o:o.o,p:o.p}}releaseCompletionItems(t){this.e.get(t)?.dispose(),this.e.delete(t),this.d.delete(t)}l(t,i,r,s){const n=this.e.get(i[0]);if(!n)throw Error("DisposableStore is missing...");const o=this.g.toInternal(t.command,n),a={x:i,a:t.label,b:t.kind!==void 0?Eg.from(t.kind):void 0,m:t.tags&&t.tags.map(Sg.from),c:t.detail,d:typeof t.documentation>"u"?void 0:ge.fromStrict(t.documentation),e:t.sortText!==t.label?t.sortText:void 0,f:t.filterText!==t.label?t.filterText:void 0,g:t.preselect||void 0,i:t.keepWhitespace?1:0,k:t.commitCharacters?.join(""),l:t.additionalTextEdits&&t.additionalTextEdits.map(Kt.from),n:o?.$ident,o:o?.id,p:o?.$ident?void 0:o?.arguments};t.textEdit?(this.j.report("CompletionItem.textEdit",this.k,"Use 'CompletionItem.insertText' and 'CompletionItem.range' instead."),a.h=t.textEdit.newText):typeof t.insertText=="string"?a.h=t.insertText:t.insertText instanceof ua&&(a.h=t.insertText.value,a.i|=4);let c;return t.textEdit?c=t.textEdit.range:t.range&&(c=t.range),xe.isRange(c)?a.j=j.from(c):c&&(!r?.isEqual(c.inserting)||!s?.isEqual(c.replacing))&&(a.j={insert:j.from(c.inserting),replace:j.from(c.replacing)}),a}},Ao=class{constructor(e,t,i,r){this.f=e,this.g=t,this.h=i,this.j=r,this.d=new bJ,this.k={[Mf.Automatic]:ih.Automatic,[Mf.Explicit]:ih.Invoke},this.e=et(this.f,"inlineCompletionsAdditions")}get supportsHandleEvents(){return et(this.f,"inlineCompletionsAdditions")&&(typeof this.h.handleDidShowCompletionItem=="function"||typeof this.h.handleDidPartiallyAcceptCompletionItem=="function"||typeof this.h.handleDidRejectCompletionItem=="function"||typeof this.h.handleEndOfLifetime=="function")}get supportsSetModelId(){return et(this.f,"inlineCompletionsAdditions")&&typeof this.h.setCurrentModelId=="function"}get modelInfo(){if(this.e)return this.h.modelInfo?{models:this.h.modelInfo.models,currentModelId:this.h.modelInfo.currentModelId}:void 0}setCurrentModelId(e){this.e&&this.h.setCurrentModelId?.(e)}async provideInlineCompletions(e,t,i,r){const s=this.g.getDocument(e),n=Xe.to(t),o=await this.h.provideInlineCompletionItems(s,n,{selectedCompletionInfo:i.selectedSuggestionInfo?{range:j.to(i.selectedSuggestionInfo.range),text:i.selectedSuggestionInfo.text}:void 0,triggerKind:this.k[i.triggerKind],requestUuid:i.requestUuid,requestIssuedDateTime:i.requestIssuedDateTime,earliestShownDateTime:i.earliestShownDateTime},r);if(!o)return;const{resultItems:a,list:c}=Array.isArray(o)?{resultItems:o,list:void 0}:{resultItems:o.items,list:o},l=this.e?Array.isArray(o)?[]:o.commands||[]:[],u=this.e&&!Array.isArray(o)?o.enableForwardStability:void 0;let h;return{pid:this.d.createReferenceId({dispose(){h?.dispose()},items:a,list:c}),languageId:s.languageId,items:a.map((g,v)=>{let b;g.command&&(h||(h=new ie),b=this.j.toInternal(g.command,h));let S;g.action&&(h||(h=new ie),S=this.j.toInternal(g.action,h));const E=g.insertText;return{insertText:E===void 0?void 0:typeof E=="string"?E:{snippet:E.value},range:g.range?j.from(g.range):void 0,showRange:this.e&&g.showRange?j.from(g.showRange):void 0,command:b,gutterMenuLinkAction:S,idx:v,completeBracketPairs:this.e?g.completeBracketPairs:!1,isInlineEdit:this.e?g.isInlineEdit:!1,showInlineEditMenu:this.e?g.showInlineEditMenu:!1,hint:g.displayLocation&&this.e?{range:j.from(g.displayLocation.range),content:g.displayLocation.label,style:g.displayLocation.kind?Dy.from(g.displayLocation.kind):mc.Code}:void 0,warning:g.warning&&this.e?{message:ge.from(g.warning.message),icon:g.warning.icon?go.fromThemeIcon(g.warning.icon):void 0}:void 0,correlationId:this.e?g.correlationId:void 0,suggestionId:void 0,uri:this.e&&g.uri?g.uri:void 0,supportsRename:this.e?g.supportsRename:!1,jumpToPosition:this.e&&g.jumpToPosition?Xe.from(g.jumpToPosition):void 0}}),commands:l.map(g=>(h||(h=new ie),iy.from(g,this.j,h))),suppressSuggestions:!1,enableForwardStability:u}}disposeCompletions(e,t){const i=this.d.get(e);if(this.h.handleListEndOfLifetime&&this.e&&i?.list){let n=function(o){switch(o.kind){case"lostRace":return{kind:nn.LostRace};case"tokenCancellation":return{kind:nn.TokenCancellation};case"other":return{kind:nn.Other};case"empty":return{kind:nn.Empty};case"notTaken":return{kind:nn.NotTaken};default:return{kind:nn.Other}}};var r=n;this.h.handleListEndOfLifetime(i.list,n(t))}this.d.disposeReferenceId(e)?.dispose()}handleDidShowCompletionItem(e,t,i){const r=this.d.get(e)?.items[t];r&&this.h.handleDidShowCompletionItem&&this.e&&this.h.handleDidShowCompletionItem(r,i)}handlePartialAccept(e,t,i,r){const s=this.d.get(e)?.items[t];s&&this.h.handleDidPartiallyAcceptCompletionItem&&this.e&&(this.h.handleDidPartiallyAcceptCompletionItem(s,i),this.h.handleDidPartiallyAcceptCompletionItem(s,Cy.to(r)))}handleEndOfLifetime(e,t,i){const r=this.d.get(e)?.items[t];if(r&&this.h.handleEndOfLifetime&&this.e){const s=Iy.to(i,n=>this.d.get(n.pid)?.items[n.idx]);this.h.handleEndOfLifetime(r,s)}}handleRejection(e,t){const i=this.d.get(e)?.items[t];i&&this.h.handleDidRejectCompletionItem&&this.e&&this.h.handleDidRejectCompletionItem(i)}},bJ=class{constructor(){this.d=new Map,this.e=1}createReferenceId(e){const t=this.e++;return this.d.set(t,e),t}disposeReferenceId(e){const t=this.d.get(e);return this.d.delete(e),t}get(e){return this.d.get(e)}},Z4=class{constructor(e,t){this.e=e,this.f=t,this.d=new ls("SignatureHelp")}async provideSignatureHelp(e,t,i,r){const s=this.e.getDocument(e),n=Xe.to(t),o=this.g(i),a=await this.f.provideSignatureHelp(s,n,r,o);if(a){const c=this.d.add([a]);return{...Ah.from(a),id:c}}}g(e){let t;if(e.activeSignatureHelp){const i=Ah.to(e.activeSignatureHelp),r=this.d.get(e.activeSignatureHelp.id,0);r?(t=r,t.activeSignature=i.activeSignature,t.activeParameter=i.activeParameter):t=i}return{...e,activeSignatureHelp:t}}releaseSignatureHelp(e){this.d.delete(e)}},u1=class{constructor(e,t,i,r,s){this.f=e,this.g=t,this.h=i,this.j=r,this.k=s,this.d=new ls("InlayHints"),this.e=new Map}async provideInlayHints(e,t,i){const r=this.f.getDocument(e),s=j.to(t),n=await this.h.provideInlayHints(r,s,i);if(!Array.isArray(n)||n.length===0){this.j.trace(`[InlayHints] NO inlay hints from '${this.k.identifier.value}' for range ${JSON.stringify(t)}`);return}if(i.isCancellationRequested)return;const o=this.d.add(n);this.e.set(o,new ie);const a={hints:[],cacheId:o};for(let c=0;c<n.length;c++)this.l(n[c],s)&&a.hints.push(this.m(n[c],[o,c]));return this.j.trace(`[InlayHints] ${a.hints.length} inlay hints from '${this.k.identifier.value}' for range ${JSON.stringify(t)}`),a}async resolveInlayHint(e,t){if(typeof this.h.resolveInlayHint!="function")return;const i=this.d.get(...e);if(!i)return;const r=await this.h.resolveInlayHint(i,t);if(r&&this.l(r))return this.m(r,e)}releaseHints(e){this.e.get(e)?.dispose(),this.e.delete(e),this.d.delete(e)}l(e,t){return e.label.length===0||Array.isArray(e.label)&&e.label.every(i=>i.value.length===0)?(console.log("INVALID inlay hint, empty label",e),!1):!(t&&!t.contains(e.position))}m(e,t){const i=this.e.get(t[0]);if(!i)throw Error("DisposableStore is missing...");const r={label:"",cacheId:t,tooltip:ge.fromStrict(e.tooltip),position:Xe.from(e.position),textEdits:e.textEdits&&e.textEdits.map(Kt.from),kind:e.kind&&Cg.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label=="string")r.label=e.label;else{const s=[];r.label=s;for(const n of e.label){if(!n.value){console.warn("INVALID inlay hint, empty label part",this.k.identifier.value);continue}const o={label:n.value,tooltip:ge.fromStrict(n.tooltip)};rr.isLocation(n.location)&&(o.location=Hi.from(n.location)),n.command&&(o.command=this.g.toInternal(n.command,i)),s.push(o)}}return r}},h1=class tv{constructor(t,i){this.e=t,this.f=i,this.d=new ls("DocumentLink")}async provideLinks(t,i){const r=this.e.getDocument(t),s=await this.f.provideDocumentLinks(r,i);if(!(!Array.isArray(s)||s.length===0)&&!i.isCancellationRequested){if(typeof this.f.resolveDocumentLink!="function")return{links:s.filter(tv.g).map(Ca.from)};{const n=this.d.add(s),o={links:[],cacheId:n};for(let a=0;a<s.length;a++){if(!tv.g(s[a]))continue;const c=Ca.from(s[a]);c.cacheId=[n,a],o.links.push(c)}return o}}}static g(t){return t.target&&t.target.path.length>5e4?(console.warn("DROPPING link because it is too long"),!1):!0}async resolveLink(t,i){if(typeof this.f.resolveDocumentLink!="function")return;const r=this.d.get(...t);if(!r)return;const s=await this.f.resolveDocumentLink(r,i);if(!(!s||!tv.g(s)))return Ca.from(s)}releaseLinks(t){this.d.delete(t)}},J4=class{constructor(e,t){this.d=e,this.e=t}async provideColors(e,t){const i=this.d.getDocument(e),r=await this.e.provideDocumentColors(i,t);return Array.isArray(r)?r.map(n=>({color:rl.from(n.color),range:j.from(n.range)})):[]}async provideColorPresentations(e,t,i){const r=this.d.getDocument(e),s=j.to(t.range),n=rl.to(t.color),o=await this.e.provideColorPresentations(n,{document:r,range:s},i);if(Array.isArray(o))return o.map($g.from)}},r3=class{constructor(e,t){this.d=e,this.e=t}async provideFoldingRanges(e,t,i){const r=this.d.getDocument(e),s=await this.e.provideFoldingRanges(r,t,i);if(Array.isArray(s))return s.map(Pg.from)}},s3=class{constructor(e,t,i){this.d=e,this.e=t,this.f=i}async provideSelectionRanges(e,t,i){const r=this.d.getDocument(e),s=t.map(Xe.to),n=await this.e.provideSelectionRanges(r,s,i);if(!Xl(n))return[];if(n.length!==s.length)return this.f.warn("BAD selection ranges, provider must return ranges for each position"),[];const o=[];for(let a=0;a<s.length;a++){const c=[];o.push(c);let l=s[a],u=n[a];for(;;){if(!u.range.contains(l))throw new Error("INVALID selection range, must contain the previous range");if(c.push(oy.from(u)),!u.parent)break;l=u.range,u=u.parent}}return o}},ld=class{constructor(e,t){this.f=e,this.g=t,this.d=new km(""),this.e=new Map}async prepareSession(e,t,i){const r=this.f.getDocument(e),s=Xe.to(t),n=await this.g.prepareCallHierarchy(r,s,i);if(!n)return;const o=this.d.nextId();return this.e.set(o,new Map),Array.isArray(n)?n.map(a=>this.h(o,a)):[this.h(o,n)]}async provideCallsTo(e,t,i){const r=this.j(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this.g.provideCallHierarchyIncomingCalls(r,i);if(s)return s.map(n=>({from:this.h(e,n.from),fromRanges:n.fromRanges.map(o=>j.from(o))}))}async provideCallsFrom(e,t,i){const r=this.j(e,t);if(!r)throw new Error("missing call hierarchy item");const s=await this.g.provideCallHierarchyOutgoingCalls(r,i);if(s)return s.map(n=>({to:this.h(e,n.to),fromRanges:n.fromRanges.map(o=>j.from(o))}))}releaseSession(e){this.e.delete(e)}h(e,t){const i=this.e.get(e),r=ka.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}j(e,t){return this.e.get(e)?.get(t)}},ud=class{constructor(e,t){this.f=e,this.g=t,this.d=new km(""),this.e=new Map}async prepareSession(e,t,i){const r=this.f.getDocument(e),s=Xe.to(t),n=await this.g.prepareTypeHierarchy(r,s,i);if(!n)return;const o=this.d.nextId();return this.e.set(o,new Map),Array.isArray(n)?n.map(a=>this.h(o,a)):[this.h(o,n)]}async provideSupertypes(e,t,i){const r=this.j(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this.g.provideTypeHierarchySupertypes(r,i);if(s)return s.map(n=>this.h(e,n))}async provideSubtypes(e,t,i){const r=this.j(e,t);if(!r)throw new Error("missing type hierarchy item");const s=await this.g.provideTypeHierarchySubtypes(r,i);if(s)return s.map(n=>this.h(e,n))}releaseSession(e){this.e.delete(e)}h(e,t){const i=this.e.get(e),r=$a.from(t,e,i.size.toString(36));return i.set(r._itemId,t),r}j(e,t){return this.e.get(e)?.get(t)}},d1=class{constructor(e,t,i,r,s){this.e=e,this.f=t,this.g=i,this.h=r,this.j=s,this.d=new ls("DocumentDropEdit")}async provideDocumentOnDropEdits(e,t,i,r,s){const n=this.f.getDocument(t),o=Xe.to(i),a=hl.toDataTransfer(r,async h=>(await this.e.$resolveDocumentOnDropFileData(this.h,e,h)).buffer),c=await this.g.provideDocumentDropEdits(n,o,a,s);if(!c)return;const l=Sr(c),u=this.d.add(l);return l.map((h,f)=>({_cacheId:[u,f],title:h.title??d(3021,null,this.j.displayName||this.j.name),kind:h.kind?.value,yieldTo:h.yieldTo?.map(p=>p.value),insertText:typeof h.insertText=="string"?h.insertText:{snippet:h.insertText.value},additionalEdit:h.additionalEdit?nr.from(h.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,t){const[i,r]=e,s=this.d.get(i,r);if(!s||!this.g.resolveDocumentDropEdit)return{};const n=await this.g.resolveDocumentDropEdit(s,t)??s;return{additionalEdit:n.additionalEdit?nr.from(n.additionalEdit,void 0):void 0}}releaseDropEdits(e){this.d.delete(e)}},hd=class{constructor(e,t){this.adapter=e,this.extension=t}},yJ=class si extends Q{static{this.f=0}get inlineCompletionsUnificationState(){return this.j}constructor(t,i,r,s,n,o,a,c){super(),this.n=i,this.q=r,this.s=s,this.t=n,this.u=o,this.w=a,this.y=c,this.h=new Map,this.m=this.D(new I),this.onDidChangeInlineCompletionsUnificationState=this.m.event,this.g=t.getProxy(X.MainThreadLanguageFeatures),this.j={codeUnification:!1,modelUnification:!1,extensionUnification:!1,expAssignments:[]}}z(t,i){return Sa.from(t,this.n,i)}C(t){return new ke(()=>{this.h.delete(t),this.g.$unregister(t)})}F(){return si.f++}async G(t,i,r,s,n,o=!1){const a=this.h.get(t);if(!a||!(a.adapter instanceof i))return s;const c=Date.now();o||this.u.trace(`[${a.extension.identifier.value}] INVOKE provider '${r.toString().replace(/[\r\n]/g,"")}'`);const l=r(a.adapter,a.extension);return Promise.resolve(l).catch(u=>{Ti(u)||(this.u.error(`[${a.extension.identifier.value}] provider FAILED`),this.u.error(u),this.y.onExtensionError(a.extension.identifier,u))}).finally(()=>{o||this.u.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-c}ms`)}),Fe.isCancellationToken(n)?cf(l,n):l}H(t,i){const r=this.F();return this.h.set(r,new hd(t,i)),r}static I(t){return t.displayName||t.name}static J(t){return t.identifier.value}registerDocumentSymbolProvider(t,i,r,s){const n=this.H(new BP(this.q,r),t),o=s&&s.label||si.I(t);return this.g.$registerDocumentSymbolProvider(n,this.z(i,t),o),this.C(n)}$provideDocumentSymbols(t,i,r){return this.G(t,BP,s=>s.provideDocumentSymbols(y.revive(i),r),void 0,r)}registerCodeLensProvider(t,i,r){const s=this.F(),n=typeof r.onDidChangeCodeLenses=="function"?this.F():void 0;this.h.set(s,new hd(new n1(this.q,this.s.converter,r,t,this.y,this.u),t)),this.g.$registerCodeLensSupport(s,this.z(i,t),n);let o=this.C(s);if(n!==void 0){const a=r.onDidChangeCodeLenses(c=>this.g.$emitCodeLensEvent(n));o=ke.from(o,a)}return o}$provideCodeLenses(t,i,r){return this.G(t,n1,s=>s.provideCodeLenses(y.revive(i),r),void 0,r,i.scheme==="output")}$resolveCodeLens(t,i,r){return this.G(t,n1,s=>s.resolveCodeLens(i,r),void 0,void 0,!0)}$releaseCodeLenses(t,i){this.G(t,n1,r=>Promise.resolve(r.releaseCodeLenses(i)),void 0,void 0,!0)}registerDefinitionProvider(t,i,r){const s=this.H(new _P(this.q,r),t);return this.g.$registerDefinitionSupport(s,this.z(i,t)),this.C(s)}$provideDefinition(t,i,r,s){return this.G(t,_P,n=>n.provideDefinition(y.revive(i),r,s),[],s)}registerDeclarationProvider(t,i,r){const s=this.H(new VP(this.q,r),t);return this.g.$registerDeclarationSupport(s,this.z(i,t)),this.C(s)}$provideDeclaration(t,i,r,s){return this.G(t,VP,n=>n.provideDeclaration(y.revive(i),r,s),[],s)}registerImplementationProvider(t,i,r){const s=this.H(new qP(this.q,r),t);return this.g.$registerImplementationSupport(s,this.z(i,t)),this.C(s)}$provideImplementation(t,i,r,s){return this.G(t,qP,n=>n.provideImplementation(y.revive(i),r,s),[],s)}registerTypeDefinitionProvider(t,i,r){const s=this.H(new GP(this.q,r),t);return this.g.$registerTypeDefinitionSupport(s,this.z(i,t)),this.C(s)}$provideTypeDefinition(t,i,r,s){return this.G(t,GP,n=>n.provideTypeDefinition(y.revive(i),r,s),[],s)}registerHoverProvider(t,i,r,s){const n=this.H(new B4(this.q,r),t);return this.g.$registerHoverProvider(n,this.z(i,t)),this.C(n)}$provideHover(t,i,r,s,n){return this.G(t,B4,o=>o.provideHover(y.revive(i),r,s,n),void 0,n)}$releaseHover(t,i){this.G(t,B4,r=>Promise.resolve(r.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(t,i,r,s){const n=this.H(new ZP(this.q,r),t);return this.g.$registerEvaluatableExpressionProvider(n,this.z(i,t)),this.C(n)}$provideEvaluatableExpression(t,i,r,s){return this.G(t,ZP,n=>n.provideEvaluatableExpression(y.revive(i),r,s),void 0,s)}registerInlineValuesProvider(t,i,r,s){const n=typeof r.onDidChangeInlineValues=="function"?this.F():void 0,o=this.H(new JP(this.q,r),t);this.g.$registerInlineValuesProvider(o,this.z(i,t),n);let a=this.C(o);if(n!==void 0){const c=r.onDidChangeInlineValues(l=>this.g.$emitInlineValuesEvent(n));a=ke.from(a,c)}return a}$provideInlineValues(t,i,r,s,n){return this.G(t,JP,o=>o.provideInlineValues(y.revive(i),r,s,n),void 0,n)}registerDocumentHighlightProvider(t,i,r){const s=this.H(new QP(this.q,r),t);return this.g.$registerDocumentHighlightProvider(s,this.z(i,t)),this.C(s)}registerMultiDocumentHighlightProvider(t,i,r){const s=this.H(new YP(this.q,r,this.u),t);return this.g.$registerMultiDocumentHighlightProvider(s,this.z(i,t)),this.C(s)}$provideDocumentHighlights(t,i,r,s){return this.G(t,QP,n=>n.provideDocumentHighlights(y.revive(i),r,s),void 0,s)}$provideMultiDocumentHighlights(t,i,r,s,n){return this.G(t,YP,o=>o.provideMultiDocumentHighlights(y.revive(i),r,s.map(a=>y.revive(a)),n),void 0,n)}registerLinkedEditingRangeProvider(t,i,r){const s=this.H(new XP(this.q,r),t);return this.g.$registerLinkedEditingRangeProvider(s,this.z(i,t)),this.C(s)}$provideLinkedEditingRanges(t,i,r,s){return this.G(t,XP,async n=>{const o=await n.provideLinkedEditingRanges(y.revive(i),r,s);if(o)return{ranges:o.ranges,wordPattern:o.wordPattern?si.L(o.wordPattern):void 0}},void 0,s)}registerReferenceProvider(t,i,r){const s=this.H(new KP(this.q,r),t);return this.g.$registerReferenceSupport(s,this.z(i,t)),this.C(s)}$provideReferences(t,i,r,s,n){return this.G(t,KP,o=>o.provideReferences(y.revive(i),r,s,n),void 0,n)}registerCodeActionProvider(t,i,r,s){const n=new ie,o=this.H(new a1(this.q,this.s.converter,this.t,r,this.u,t,this.w),t);return this.g.$registerCodeActionSupport(o,this.z(i,t),{providedKinds:s?.providedCodeActionKinds?.map(a=>a.value),documentation:s?.documentation?.map(a=>({kind:a.kind.value,command:this.s.converter.toInternal(a.command,n)}))},si.I(t),si.J(t),!!r.resolveCodeAction),n.add(this.C(o)),n}$provideCodeActions(t,i,r,s,n){return this.G(t,a1,o=>o.provideCodeActions(y.revive(i),r,s,n),void 0,n)}$resolveCodeAction(t,i,r){return this.G(t,a1,s=>s.resolveCodeAction(i,r),{},void 0)}$releaseCodeActions(t,i){this.G(t,a1,r=>Promise.resolve(r.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(t,i,r){const s=this.H(new e3(this.q,r),t);return this.g.$registerDocumentFormattingSupport(s,this.z(i,t),t.identifier,t.displayName||t.name),this.C(s)}$provideDocumentFormattingEdits(t,i,r,s){return this.G(t,e3,n=>n.provideDocumentFormattingEdits(y.revive(i),r,s),void 0,s)}registerDocumentRangeFormattingEditProvider(t,i,r){const s=typeof r.provideDocumentRangesFormattingEdits=="function",n=this.H(new _4(this.q,r),t);return this.g.$registerRangeFormattingSupport(n,this.z(i,t),t.identifier,t.displayName||t.name,s),this.C(n)}$provideDocumentRangeFormattingEdits(t,i,r,s,n){return this.G(t,_4,o=>o.provideDocumentRangeFormattingEdits(y.revive(i),r,s,n),void 0,n)}$provideDocumentRangesFormattingEdits(t,i,r,s,n){return this.G(t,_4,o=>o.provideDocumentRangesFormattingEdits(y.revive(i),r,s,n),void 0,n)}registerOnTypeFormattingEditProvider(t,i,r,s){const n=this.H(new t3(this.q,r),t);return this.g.$registerOnTypeFormattingSupport(n,this.z(i,t),s,t.identifier),this.C(n)}$provideOnTypeFormattingEdits(t,i,r,s,n,o){return this.G(t,t3,a=>a.provideOnTypeFormattingEdits(y.revive(i),r,s,n,o),void 0,o)}registerWorkspaceSymbolProvider(t,i){const r=this.H(new c1(i,this.u),t);return this.g.$registerNavigateTypeSupport(r,typeof i.resolveWorkspaceSymbol=="function"),this.C(r)}$provideWorkspaceSymbols(t,i,r){return this.G(t,c1,s=>s.provideWorkspaceSymbols(i,r),{symbols:[]},r)}$resolveWorkspaceSymbol(t,i,r){return this.G(t,c1,s=>s.resolveWorkspaceSymbol(i,r),void 0,void 0)}$releaseWorkspaceSymbols(t,i){this.G(t,c1,r=>r.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(t,i,r){const s=this.H(new l1(this.q,r,this.u),t);return this.g.$registerRenameSupport(s,this.z(i,t),l1.supportsResolving(r)),this.C(s)}$provideRenameEdits(t,i,r,s,n){return this.G(t,l1,o=>o.provideRenameEdits(y.revive(i),r,s,n),void 0,n)}$resolveRenameLocation(t,i,r,s){return this.G(t,l1,n=>n.resolveRenameLocation(y.revive(i),r,s),void 0,s)}registerNewSymbolNamesProvider(t,i,r){const s=this.H(new V4(this.q,r,this.u),t);return this.g.$registerNewSymbolNamesProvider(s,this.z(i,t)),this.C(s)}$supportsAutomaticNewSymbolNamesTriggerKind(t){return this.G(t,V4,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),!1,void 0)}$provideNewSymbolNames(t,i,r,s,n){return this.G(t,V4,o=>o.provideNewSymbolNames(y.revive(i),r,s,n),void 0,n)}registerDocumentSemanticTokensProvider(t,i,r,s){const n=this.H(new G4(this.q,r),t),o=typeof r.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentSemanticTokensProvider(n,this.z(i,t),s,o);let a=this.C(n);if(o){const c=r.onDidChangeSemanticTokens(l=>this.g.$emitDocumentSemanticTokensEvent(o));a=ke.from(a,c)}return a}$provideDocumentSemanticTokens(t,i,r,s){return this.G(t,G4,n=>n.provideDocumentSemanticTokens(y.revive(i),r,s),null,s)}$releaseDocumentSemanticTokens(t,i){this.G(t,G4,r=>r.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(t,i,r,s){const n=this.H(new i3(this.q,r),t),o=typeof r.onDidChangeSemanticTokens=="function"?this.F():void 0;this.g.$registerDocumentRangeSemanticTokensProvider(n,this.z(i,t),s,o);let a=this.C(n);if(o){const c=r.onDidChangeSemanticTokens(l=>this.g.$emitDocumentRangeSemanticTokensEvent(o));a=ke.from(a,c)}return a}$provideDocumentRangeSemanticTokens(t,i,r,s){return this.G(t,i3,n=>n.provideDocumentRangeSemanticTokens(y.revive(i),r,s),null,s)}registerCompletionItemProvider(t,i,r,s){const n=this.H(new cd(this.q,this.s.converter,r,this.w,t),t);return this.g.$registerCompletionsProvider(n,this.z(i,t),s,cd.supportsResolving(r),t.identifier),this.C(n)}$provideCompletionItems(t,i,r,s,n){return this.G(t,cd,o=>o.provideCompletionItems(y.revive(i),r,s,n),void 0,n)}$resolveCompletionItem(t,i,r){return this.G(t,cd,s=>s.resolveCompletionItem(i,r),void 0,r)}$releaseCompletionItems(t,i){this.G(t,cd,r=>r.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(t,i,r,s){const n=new Ao(t,this.q,r,this.s.converter),o=this.H(n,t);let a=this.C(o);const c=et(t,"inlineCompletionsAdditions")&&typeof r.onDidChange=="function";if(c){const u=r.onDidChange(h=>this.g.$emitInlineCompletionsChange(o));a=ke.from(a,u)}const l=et(t,"inlineCompletionsAdditions")&&typeof r.onDidChangeModelInfo=="function";if(l){const u=r.onDidChangeModelInfo(h=>this.g.$emitInlineCompletionModelInfoChange(o,n.modelInfo));a=ke.from(a,u)}return this.g.$registerInlineCompletionsSupport(o,this.z(i,t),n.supportsHandleEvents,Ye.toKey(t.identifier.value),t.version,s?.groupId?Ye.toKey(s.groupId):void 0,s?.yieldTo?.map(u=>Ye.toKey(u))||[],s?.displayName,s?.debounceDelayMs,s?.excludes?.map(u=>Ye.toKey(u))||[],c,n.supportsSetModelId,n.modelInfo,l),a}$provideInlineCompletions(t,i,r,s,n){return this.G(t,Ao,o=>o.provideInlineCompletions(y.revive(i),r,s,n),void 0,void 0)}$handleInlineCompletionDidShow(t,i,r,s){this.G(t,Ao,async n=>{n.handleDidShowCompletionItem(i,r,s)},void 0,void 0)}$handleInlineCompletionPartialAccept(t,i,r,s,n){this.G(t,Ao,async o=>{o.handlePartialAccept(i,r,s,n)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(t,i,r,s){this.G(t,Ao,async n=>{n.handleEndOfLifetime(i,r,s)},void 0,void 0)}$handleInlineCompletionRejection(t,i,r){this.G(t,Ao,async s=>{s.handleRejection(i,r)},void 0,void 0)}$freeInlineCompletionsList(t,i,r){this.G(t,Ao,async s=>{s.disposeCompletions(i,r)},void 0,void 0)}$acceptInlineCompletionsUnificationState(t){this.j=t,this.m.fire()}$handleInlineCompletionSetCurrentModelId(t,i){this.G(t,Ao,async r=>{r.setCurrentModelId(i)},void 0,void 0)}registerSignatureHelpProvider(t,i,r,s){const n=Array.isArray(s)?{triggerCharacters:s,retriggerCharacters:[]}:s,o=this.H(new Z4(this.q,r),t);return this.g.$registerSignatureHelpProvider(o,this.z(i,t),n),this.C(o)}$provideSignatureHelp(t,i,r,s,n){return this.G(t,Z4,o=>o.provideSignatureHelp(y.revive(i),r,s,n),void 0,n)}$releaseSignatureHelp(t,i){this.G(t,Z4,r=>r.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(t,i,r){const s=typeof r.onDidChangeInlayHints=="function"?this.F():void 0,n=this.H(new u1(this.q,this.s.converter,r,this.u,t),t);this.g.$registerInlayHintsProvider(n,this.z(i,t),typeof r.resolveInlayHint=="function",s,si.I(t));let o=this.C(n);if(s!==void 0){const a=r.onDidChangeInlayHints(c=>this.g.$emitInlayHintsEvent(s));o=ke.from(o,a)}return o}$provideInlayHints(t,i,r,s){return this.G(t,u1,n=>n.provideInlayHints(y.revive(i),r,s),void 0,s)}$resolveInlayHint(t,i,r){return this.G(t,u1,s=>s.resolveInlayHint(i,r),void 0,r)}$releaseInlayHints(t,i){this.G(t,u1,r=>r.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(t,i,r){const s=this.H(new h1(this.q,r),t);return this.g.$registerDocumentLinkProvider(s,this.z(i,t),typeof r.resolveDocumentLink=="function"),this.C(s)}$provideDocumentLinks(t,i,r){return this.G(t,h1,s=>s.provideLinks(y.revive(i),r),void 0,r,i.scheme==="output")}$resolveDocumentLink(t,i,r){return this.G(t,h1,s=>s.resolveLink(i,r),void 0,void 0,!0)}$releaseDocumentLinks(t,i){this.G(t,h1,r=>r.releaseLinks(i),void 0,void 0,!0)}registerColorProvider(t,i,r){const s=this.H(new J4(this.q,r),t);return this.g.$registerDocumentColorProvider(s,this.z(i,t)),this.C(s)}$provideDocumentColors(t,i,r){return this.G(t,J4,s=>s.provideColors(y.revive(i),r),[],r)}$provideColorPresentations(t,i,r,s){return this.G(t,J4,n=>n.provideColorPresentations(y.revive(i),r,s),void 0,s)}registerFoldingRangeProvider(t,i,r){const s=this.F(),n=typeof r.onDidChangeFoldingRanges=="function"?this.F():void 0;this.h.set(s,new hd(new r3(this.q,r),t)),this.g.$registerFoldingRangeProvider(s,this.z(i,t),t.identifier,n);let o=this.C(s);if(n!==void 0){const a=r.onDidChangeFoldingRanges(()=>this.g.$emitFoldingRangeEvent(n));o=ke.from(o,a)}return o}$provideFoldingRanges(t,i,r,s){return this.G(t,r3,n=>n.provideFoldingRanges(y.revive(i),r,s),void 0,s)}registerSelectionRangeProvider(t,i,r){const s=this.H(new s3(this.q,r,this.u),t);return this.g.$registerSelectionRangeProvider(s,this.z(i,t)),this.C(s)}$provideSelectionRanges(t,i,r,s){return this.G(t,s3,n=>n.provideSelectionRanges(y.revive(i),r,s),[],s)}registerCallHierarchyProvider(t,i,r){const s=this.H(new ld(this.q,r),t);return this.g.$registerCallHierarchyProvider(s,this.z(i,t)),this.C(s)}$prepareCallHierarchy(t,i,r,s){return this.G(t,ld,n=>Promise.resolve(n.prepareSession(y.revive(i),r,s)),void 0,s)}$provideCallHierarchyIncomingCalls(t,i,r,s){return this.G(t,ld,n=>n.provideCallsTo(i,r,s),void 0,s)}$provideCallHierarchyOutgoingCalls(t,i,r,s){return this.G(t,ld,n=>n.provideCallsFrom(i,r,s),void 0,s)}$releaseCallHierarchy(t,i){this.G(t,ld,r=>Promise.resolve(r.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(t,i,r){const s=this.H(new ud(this.q,r),t);return this.g.$registerTypeHierarchyProvider(s,this.z(i,t)),this.C(s)}$prepareTypeHierarchy(t,i,r,s){return this.G(t,ud,n=>Promise.resolve(n.prepareSession(y.revive(i),r,s)),void 0,s)}$provideTypeHierarchySupertypes(t,i,r,s){return this.G(t,ud,n=>n.provideSupertypes(i,r,s),void 0,s)}$provideTypeHierarchySubtypes(t,i,r,s){return this.G(t,ud,n=>n.provideSubtypes(i,r,s),void 0,s)}$releaseTypeHierarchy(t,i){this.G(t,ud,r=>Promise.resolve(r.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(t,i,r,s){const n=this.F();return this.h.set(n,new hd(new d1(this.g,this.q,r,n,t),t)),this.g.$registerDocumentOnDropEditProvider(n,this.z(i,t),s?{supportsResolve:!!r.resolveDocumentDropEdit,dropMimeTypes:s.dropMimeTypes,providedDropKinds:s.providedDropEditKinds?.map(o=>o.value)}:void 0),this.C(n)}$provideDocumentOnDropEdits(t,i,r,s,n,o){return this.G(t,d1,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,y.revive(r),s,n,o)),void 0,void 0)}$resolveDropEdit(t,i,r){return this.G(t,d1,s=>s.resolveDropEdit(i,r),{},void 0)}$releaseDocumentOnDropEdits(t,i){this.G(t,d1,r=>Promise.resolve(r.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(t,i,r,s){const n=this.F();return this.h.set(n,new hd(new ad(this.g,this.q,r,n,t),t)),this.g.$registerPasteEditProvider(n,this.z(i,t),{supportsCopy:!!r.prepareDocumentPaste,supportsPaste:!!r.provideDocumentPasteEdits,supportsResolve:!!r.resolveDocumentPasteEdit,providedPasteEditKinds:s.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:s.copyMimeTypes,pasteMimeTypes:s.pasteMimeTypes}),this.C(n)}$prepareDocumentPaste(t,i,r,s,n){return this.G(t,ad,o=>o.prepareDocumentPaste(y.revive(i),r,s,n),void 0,n)}$providePasteEdits(t,i,r,s,n,o,a){return this.G(t,ad,c=>c.providePasteEdits(i,y.revive(r),s,n,o,a),void 0,a)}$resolvePasteEdit(t,i,r){return this.G(t,ad,s=>s.resolvePasteEdit(i,r),{},void 0)}$releasePasteEdits(t,i){this.G(t,ad,r=>Promise.resolve(r.releasePasteEdits(i)),void 0,void 0)}static L(t){return{pattern:t.source,flags:t.flags}}static M(t){return{decreaseIndentPattern:si.L(t.decreaseIndentPattern),increaseIndentPattern:si.L(t.increaseIndentPattern),indentNextLinePattern:t.indentNextLinePattern?si.L(t.indentNextLinePattern):void 0,unIndentedLinePattern:t.unIndentedLinePattern?si.L(t.unIndentedLinePattern):void 0}}static N(t){return{beforeText:si.L(t.beforeText),afterText:t.afterText?si.L(t.afterText):void 0,previousLineText:t.previousLineText?si.L(t.previousLineText):void 0,action:t.action}}static O(t){return t.map(si.N)}static P(t){return{open:t.open,close:t.close,notIn:t.notIn?t.notIn.map(i=>Fc.toString(i)):void 0}}static Q(t){return t.map(si.P)}setLanguageConfiguration(t,i,r){const{wordPattern:s}=r;if(s&&DE(s))throw new Error(`Invalid language configuration: wordPattern '${s}' is not allowed to match the empty string.`);s?this.q.setWordDefinitionFor(i,s):this.q.setWordDefinitionFor(i,void 0),r.__electricCharacterSupport&&this.w.report("LanguageConfiguration.__electricCharacterSupport",t,"Do not use."),r.__characterPairSupport&&this.w.report("LanguageConfiguration.__characterPairSupport",t,"Do not use.");const n=this.F(),o={comments:r.comments,brackets:r.brackets,wordPattern:r.wordPattern?si.L(r.wordPattern):void 0,indentationRules:r.indentationRules?si.M(r.indentationRules):void 0,onEnterRules:r.onEnterRules?si.O(r.onEnterRules):void 0,__electricCharacterSupport:r.__electricCharacterSupport,__characterPairSupport:r.__characterPairSupport,autoClosingPairs:r.autoClosingPairs?si.Q(r.autoClosingPairs):void 0};return this.g.$setLanguageConfiguration(n,i,o),this.C(n)}$setWordDefinitions(t){for(const i of t)this.q.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}},AJ=H("notebookService"),SJ=H("codeMapperService"),n3="vscode_editFile",Q4="vscode_editFile_internal",EJ={id:Q4,displayName:"",modelDescription:"",source:Xr.Internal},Y4=class{constructor(t,i,r){this.a=t,this.b=i,this.c=r}async invoke(t,i,r,s){if(!t.context)throw new Error("toolInvocationToken is required for this tool");const n=t.parameters,o=y.revive(n.uri),a=bw.parse(o)?.notebook||o,c=this.a.getSession(Ss.forSession(t.context?.sessionId)),l=c.getRequests().at(-1);c.acceptResponseProgress(l,{kind:"markdownContent",content:new qn("\n````\n")}),c.acceptResponseProgress(l,{kind:"codeblockUri",uri:a,isEdit:!0}),c.acceptResponseProgress(l,{kind:"markdownContent",content:new qn("\n````\n")}),this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",edits:[],uri:a}):c.acceptResponseProgress(l,{kind:"textEdit",edits:[],uri:a});const u=c.editingSession;if(!u)throw new Error("This tool must be called from within an editing session");const h=await this.b.mapCode({codeBlocks:[{code:n.code,resource:a,markdownBeforeBlock:n.explanation}],location:"tool",chatRequestId:t.chatRequestId,chatRequestModel:t.modelId,chatSessionResource:t.context.sessionResource},{textEdit:(p,g)=>{c.acceptResponseProgress(l,{kind:"textEdit",uri:p,edits:g})},notebookEdit(p,g){c.acceptResponseProgress(l,{kind:"notebookEdit",uri:p,edits:g})}},s);if(this.c.hasSupportedNotebooks(a)&&this.c.getNotebookTextModel(a)?c.acceptResponseProgress(l,{kind:"notebookEdit",uri:a,edits:[],done:!0}):c.acceptResponseProgress(l,{kind:"textEdit",uri:a,edits:[],done:!0}),h?.errorMessage)throw new Error(h.errorMessage);let f;return await new Promise(p=>{let g=!1;f=zf(v=>{const S=u.entries.read(v)?.find(E=>E.modifiedURI.toString()===a.toString());S&&(S.isCurrentlyBeingModifiedBy.read(v)?g=!0:g&&p(!0))})}).finally(()=>{f.dispose()}),{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(t,i){return{presentation:Sc.Hidden}}};Y4=__decorate([__param(0,kP),__param(1,SJ),__param(2,AJ)],Y4);var xJ="vscode_get_confirmation",kJ={id:xJ,displayName:"Confirmation Tool",modelDescription:"A tool that demonstrates different types of confirmations. Takes a title, message, and confirmation type (basic or terminal).",source:Xr.Internal,inputSchema:{type:"object",properties:{title:{type:"string",description:"Title for the confirmation dialog"},message:{type:"string",description:"Message to show in the confirmation dialog"},confirmationType:{type:"string",enum:["basic","terminal"],description:"Type of confirmation to show - basic for simple confirmation, terminal for terminal command confirmation"},terminalCommand:{type:"string",description:'Terminal command to show (only used when confirmationType is "terminal")'}},required:["title","message","confirmationType"],additionalProperties:!1}},CJ=class{async prepareToolInvocation(e,t){const i=e.parameters;if(!i.title||!i.message)throw new Error("Missing required parameters for ConfirmationTool");const r=i.confirmationType??"basic";let s;return r==="terminal"?s={kind:"terminal",commandLine:{original:i.terminalCommand??""},language:"bash"}:s=void 0,{confirmationMessages:{title:i.title,message:new qn(i.message),allowAutoConfirm:!0},toolSpecificData:s,presentation:Sc.HiddenAfterComplete}}async invoke(e,t,i,r){return{content:[{kind:"text",value:"yes"}]}}},dd;(function(e){e[e.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",e[e.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(dd||(dd={}));var us;(function(e){e[e.None=0]="None",e[e.Initialized=1]="Initialized",e[e.Closed=2]="Closed"})(us||(us={}));var iae=class FN extends Q{static{this.a=100}constructor(t,i=Object.create(null)){super(),this.q=t,this.r=i,this.b=this.D(new tu),this.onDidChangeStorage=this.b.event,this.c=us.None,this.f=new Map,this.g=this.D(new au(FN.a)),this.h=new Set,this.j=new Map,this.m=void 0,this.n=[],this.s()}s(){this.D(this.q.onDidChangeItemsExternal(t=>this.t(t)))}t(t){this.b.pause();try{t.changed?.forEach((i,r)=>this.u(r,i)),t.deleted?.forEach(i=>this.u(i,void 0))}finally{this.b.resume()}}u(t,i){if(this.c===us.Closed)return;let r=!1;Ht(i)?r=this.f.delete(t):this.f.get(t)!==i&&(this.f.set(t,i),r=!0),r&&this.b.fire({key:t,external:!0})}get items(){return this.f}get size(){return this.f.size}async init(){this.c===us.None&&(this.c=us.Initialized,this.r.hint!==dd.STORAGE_DOES_NOT_EXIST&&(this.f=await this.q.getItems()))}get(t,i){const r=this.f.get(t);return Ht(r)?i:r}getBoolean(t,i){const r=this.get(t);return Ht(r)?i:r==="true"}getNumber(t,i){const r=this.get(t);return Ht(r)?i:parseInt(r,10)}getObject(t,i){const r=this.get(t);return Ht(r)?i:Lx(r)}async set(t,i,r=!1){if(this.c===us.Closed)return;if(Ht(i))return this.delete(t,r);const s=yt(i)||Array.isArray(i)?WO(i):String(i);if(this.f.get(t)!==s)return this.f.set(t,s),this.j.set(t,s),this.h.delete(t),this.b.fire({key:t,external:r}),this.C()}async delete(t,i=!1){if(!(this.c===us.Closed||!this.f.delete(t)))return this.h.has(t)||this.h.add(t),this.j.delete(t),this.b.fire({key:t,external:i}),this.C()}async optimize(){if(this.c!==us.Closed)return await this.flush(0),this.q.optimize()}async close(){return this.m||(this.m=this.w()),this.m}async w(){this.c=us.Closed;try{await this.C(0)}catch{}await this.q.close(()=>this.f)}get y(){return this.j.size>0||this.h.size>0}async z(){if(!this.y)return;const t={insert:this.j,delete:this.h};return this.h=new Set,this.j=new Map,this.q.updateItems(t).finally(()=>{if(!this.y)for(;this.n.length;)this.n.pop()?.()})}async flush(t){if(!(this.c===us.Closed||this.m))return this.C(t)}async C(t){return this.r.hint===dd.STORAGE_IN_MEMORY?this.z():this.g.trigger(()=>this.z(),t)}async whenFlushed(){if(this.y)return new Promise(t=>this.n.push(t))}isInMemory(){return this.r.hint===dd.STORAGE_IN_MEMORY}},o3;(function(e){e.Settings="settings",e.Keybindings="keybindings",e.Snippets="snippets",e.Prompts="prompts",e.Tasks="tasks",e.Extensions="extensions",e.GlobalState="globalState",e.Mcp="mcp"})(o3||(o3={}));function $J(e){const t=e;return!!(t&&typeof t=="object"&&typeof t.id=="string"&&typeof t.isDefault=="boolean"&&typeof t.name=="string"&&y.isUri(t.location)&&y.isUri(t.globalStorageHome)&&y.isUri(t.settingsResource)&&y.isUri(t.keybindingsResource)&&y.isUri(t.tasksResource)&&y.isUri(t.snippetsHome)&&y.isUri(t.promptsHome)&&y.isUri(t.extensionsResource)&&y.isUri(t.mcpResource))}var IJ=H("IUserDataProfilesService");function f1(e,t,i,r,s,n){return{id:e,name:t,location:i,isDefault:!1,icon:s?.icon,globalStorageHome:n&&s?.useDefaultFlags?.globalState?n.globalStorageHome:It(i,"globalStorage"),settingsResource:n&&s?.useDefaultFlags?.settings?n.settingsResource:It(i,"settings.json"),keybindingsResource:n&&s?.useDefaultFlags?.keybindings?n.keybindingsResource:It(i,"keybindings.json"),tasksResource:n&&s?.useDefaultFlags?.tasks?n.tasksResource:It(i,"tasks.json"),snippetsHome:n&&s?.useDefaultFlags?.snippets?n.snippetsHome:It(i,"snippets"),promptsHome:n&&s?.useDefaultFlags?.prompts?n.promptsHome:It(i,"prompts"),extensionsResource:n&&s?.useDefaultFlags?.extensions?n.extensionsResource:It(i,"extensions.json"),mcpResource:n&&s?.useDefaultFlags?.mcp?n.mcpResource:It(i,"mcp.json"),cacheHome:It(r,e),useDefaultFlags:s?.useDefaultFlags,isTransient:s?.transient,workspaces:s?.workspaces}}var a3=class extends Q{static{this.b="userDataProfiles"}static{this.c="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.z.profiles,...this.q.profiles]}constructor(t,i,r,s){super(),this.r=t,this.s=i,this.t=r,this.u=s,this.g=this.D(new I),this.onDidChangeProfiles=this.g.event,this.h=this.D(new I),this.onWillCreateProfile=this.h.event,this.j=this.D(new I),this.onWillRemoveProfile=this.j.event,this.m=this.D(new I),this.onDidResetWorkspaces=this.m.event,this.n=new Map,this.q={profiles:[],emptyWindows:new Map},this.profilesHome=It(this.r.userRoamingDataHome,"profiles"),this.f=It(this.r.cacheHome,"CachedProfilesData")}init(){this.y=void 0}get z(){if(!this.y){const t=this.C(),i=[t];try{for(const s of this.N()){if(!s.name||!Oe(s.name)||!s.location){this.u.warn("Skipping the invalid stored profile",s.location||s.name);continue}i.push(f1(dr(s.location),s.name,s.location,this.f,{icon:s.icon,useDefaultFlags:s.useDefaultFlags},t))}}catch(s){this.u.error(s)}const r=new Map;if(i.length)try{const s=this.P();if(s.workspaces)for(const[n,o]of Object.entries(s.workspaces)){const a=y.parse(n),c=i.find(l=>l.id===o);if(c){const l=c.workspaces?c.workspaces.slice(0):[];l.push(a),c.workspaces=l}}if(s.emptyWindows)for(const[n,o]of Object.entries(s.emptyWindows)){const a=i.find(c=>c.id===o);a&&r.set(n,a)}}catch(s){this.u.error(s)}this.y={profiles:i,emptyWindows:r}}return this.y}C(){const t=f1("__default__profile__",d(2713,null),this.r.userRoamingDataHome,this.f);return{...t,extensionsResource:this.R()??t.extensionsResource,isDefault:!0}}async createTransientProfile(t){const i="Temp",r=new RegExp(`${Rn(i)}\\s(\\d+)`);let s=0;for(const o of this.profiles){const a=r.exec(o.name),c=a?parseInt(a[1]):0;s=c>s?c:s}const n=`${i} ${s+1}`;return this.createProfile(Xs(Tt()).toString(16),n,{transient:!0},t)}async createNamedProfile(t,i,r){return this.createProfile(Xs(Tt()).toString(16),t,i,r)}async createProfile(t,i,r,s){return await this.F(t,i,r,s)}async F(t,i,r,s){if(!Oe(i)||!i)throw new Error("Name of the profile is mandatory and must be of type `string`");let n=this.n.get(i);return n||(n=(async()=>{try{if(this.profiles.find(u=>u.id===t||!u.isTransient&&!r?.transient&&u.name===i))throw new Error(`Profile with ${i} name already exists`);const a=s?this.G(s):void 0;y.isUri(a)&&(r={...r,workspaces:[a]});const c=f1(t,i,It(this.profilesHome,t),this.f,r,this.defaultProfile);await this.s.createFolder(c.location);const l=[];return this.h.fire({profile:c,join(u){l.push(u)}}),await Un.settled(l),a&&!y.isUri(a)&&this.L(a,c,!!c.isTransient),this.I([c],[],[]),c}finally{this.n.delete(i)}})(),this.n.set(i,n)),n}async updateProfile(t,i){const r=[];for(const n of this.profiles){let o;if(t.id===n.id)n.isDefault?i.workspaces&&(o=n,o.workspaces=i.workspaces):o=f1(n.id,i.name??n.name,n.location,this.f,{icon:i.icon===null?void 0:i.icon??n.icon,transient:i.transient??n.isTransient,useDefaultFlags:i.useDefaultFlags??n.useDefaultFlags,workspaces:i.workspaces??n.workspaces},this.defaultProfile);else if(i.workspaces){const a=n.workspaces?.filter(c=>!i.workspaces?.some(l=>this.t.extUri.isEqual(c,l)));n.workspaces?.length!==a?.length&&(o=n,o.workspaces=a)}o&&r.push(o)}if(!r.length)throw t.isDefault?new Error("Cannot update default profile"):new Error(`Profile '${t.name}' does not exist`);this.I([],[],r);const s=this.profiles.find(n=>n.id===t.id);if(!s)throw new Error(`Profile '${t.name}' was not updated`);return s}async removeProfile(t){if(t.isDefault)throw new Error("Cannot remove default profile");const i=this.profiles.find(s=>s.id===t.id);if(!i)throw new Error(`Profile '${t.name}' does not exist`);const r=[];this.j.fire({profile:i,join(s){r.push(s)}});try{await Promise.allSettled(r)}catch(s){this.u.error(s)}this.I([],[i],[]);try{await this.s.del(i.cacheHome,{recursive:!0})}catch(s){mz(s)!==1&&this.u.error(s)}}async setProfileForWorkspace(t,i){const r=this.profiles.find(n=>n.id===i.id);if(!r)throw new Error(`Profile '${i.name}' does not exist`);const s=this.G(t);if(y.isUri(s)){const n=r.workspaces?[...r.workspaces]:[];n.some(o=>this.t.extUri.isEqual(o,s))||(n.push(s),await this.updateProfile(r,{workspaces:n}))}else this.L(s,r,!1),this.M(this.profiles)}unsetWorkspace(t,i=!1){const r=this.G(t);if(y.isUri(r)){const s=this.getProfileForWorkspace(t);s&&this.updateProfile(s,{workspaces:s.workspaces?.filter(n=>!this.t.extUri.isEqual(n,r))})}else this.L(r,void 0,i),this.M(this.profiles)}async resetWorkspaces(){this.q.emptyWindows.clear(),this.z.emptyWindows.clear();for(const t of this.profiles)t.workspaces=void 0;this.I([],[],this.profiles),this.m.fire()}async cleanUp(){if(await this.s.exists(this.profilesHome)){const t=await this.s.resolve(this.profilesHome);await Promise.all((t.children||[]).filter(i=>i.isDirectory&&this.profiles.every(r=>!this.t.extUri.isEqual(r.location,i.resource))).map(i=>this.s.del(i.resource,{recursive:!0})))}}async cleanUpTransientProfiles(){const t=this.q.profiles.filter(i=>!this.H(i));await Promise.allSettled(t.map(i=>this.removeProfile(i)))}getProfileForWorkspace(t){const i=this.G(t);return y.isUri(i)?this.profiles.find(r=>r.workspaces?.some(s=>this.t.extUri.isEqual(s,i))):this.z.emptyWindows.get(i)??this.q.emptyWindows.get(i)}G(t){return aj(t)?t.uri:cj(t)?t.configPath:t.id}H(t){return!!(t.workspaces?.length||[...this.z.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location))||[...this.q.emptyWindows.values()].some(i=>this.t.extUri.isEqual(i.location,t.location)))}I(t,i,r){const s=[...this.profiles,...t],n=this.q.profiles;this.q.profiles=[];const o=[];for(let a of s){if(i.some(c=>a.id===c.id)){for(const c of[...this.z.emptyWindows.keys()])a.id===this.z.emptyWindows.get(c)?.id&&this.z.emptyWindows.delete(c);continue}if(!a.isDefault){a=r.find(l=>a.id===l.id)??a;const c=n.find(l=>a.id===l.id);if(a.isTransient)this.q.profiles.push(a);else if(c){for(const[l,u]of this.q.emptyWindows.entries())if(a.id===u.id){this.q.emptyWindows.delete(l),this.z.emptyWindows.set(l,a);break}}}a.workspaces?.length===0&&(a.workspaces=void 0),o.push(a)}this.M(o),this.J(t,i,r)}J(t,i,r){this.g.fire({added:t,removed:i,updated:r,all:this.profiles})}L(t,i,r){r=i?.isTransient?!0:r,r?i?this.q.emptyWindows.set(t,i):this.q.emptyWindows.delete(t):(this.q.emptyWindows.delete(t),i?this.z.emptyWindows.set(t,i):this.z.emptyWindows.delete(t))}M(t){const i=[],r={},s={};for(const n of t)if(!n.isTransient&&(n.isDefault||i.push({location:n.location,name:n.name,icon:n.icon,useDefaultFlags:n.useDefaultFlags}),n.workspaces))for(const o of n.workspaces)r[o.toString()]=n.id;for(const[n,o]of this.z.emptyWindows.entries())s[n.toString()]=o.id;this.Q({workspaces:r,emptyWindows:s}),this.O(i),this.y=void 0}N(){return[]}O(t){throw new Error("not implemented")}P(){return{}}Q(t){throw new Error("not implemented")}R(){}};a3=__decorate([__param(0,DA),__param(1,m$),__param(2,uD),__param(3,Se)],a3);var DJ="__$__isNewStorageMarker",p1="__$__targetStorageMarker",Ua=H("storageService"),Pl;(function(e){e[e.NONE=0]="NONE",e[e.SHUTDOWN=1]="SHUTDOWN"})(Pl||(Pl={}));var c3;(function(e){e[e.APPLICATION=-1]="APPLICATION",e[e.PROFILE=0]="PROFILE",e[e.WORKSPACE=1]="WORKSPACE"})(c3||(c3={}));var l3;(function(e){e[e.USER=0]="USER",e[e.MACHINE=1]="MACHINE"})(l3||(l3={}));function PJ(e){const t=e.get(p1);if(t)try{return JSON.parse(t)}catch{}return Object.create(null)}var sae=class UN extends Q{static{this.a=60*1e3}constructor(t={flushInterval:UN.a}){super(),this.b=this.D(new tu),this.f=this.D(new tu),this.onDidChangeTarget=this.f.event,this.g=this.D(new I),this.onWillSaveState=this.g.event,this.m=this.D(new Br),this.z=void 0,this.F=void 0,this.H=void 0,this.j=this.D(new vs(()=>this.n(),t.flushInterval))}onDidChangeValue(t,i,r){return Ie.filter(this.b.event,s=>s.scope===t&&(i===void 0||s.key===i),r)}n(){this.m.value=fx(()=>{this.q()&&this.flush(),this.j.schedule()})}q(){return!0}r(){Zi([this.m,this.j])}initialize(){return this.h||(this.h=(async()=>{Ot("code/willInitStorage");try{await this.O()}finally{Ot("code/didInitStorage")}this.j.schedule()})()),this.h}t(t,i){const{key:r,external:s}=i;if(r===p1){switch(t){case-1:this.H=void 0;break;case 0:this.F=void 0;break;case 1:this.z=void 0;break}this.f.fire({scope:t})}else this.b.fire({scope:t,key:r,target:this.J(t)[r],external:s})}u(t){this.g.fire({reason:t})}get(t,i,r){return this.P(i)?.get(t,r)}getBoolean(t,i,r){return this.P(i)?.getBoolean(t,r)}getNumber(t,i,r){return this.P(i)?.getNumber(t,r)}getObject(t,i,r){return this.P(i)?.getObject(t,r)}storeAll(t,i){this.w(()=>{for(const r of t)this.store(r.key,r.value,r.scope,r.target,i)})}store(t,i,r,s,n=!1){if(Ht(i)){this.remove(t,r,n);return}this.w(()=>{this.y(t,r,s),this.P(r)?.set(t,i,n)})}remove(t,i,r=!1){this.w(()=>{this.y(t,i,void 0),this.P(i)?.delete(t,r)})}w(t){this.b.pause(),this.f.pause();try{t()}finally{this.b.resume(),this.f.resume()}}keys(t,i){const r=[],s=this.J(t);for(const n of Object.keys(s))s[n]===i&&r.push(n);return r}y(t,i,r,s=!1){const n=this.J(i);typeof r=="number"?n[t]!==r&&(n[t]=r,this.P(i)?.set(p1,JSON.stringify(n),s)):typeof n[t]=="number"&&(delete n[t],this.P(i)?.set(p1,JSON.stringify(n),s))}get C(){return this.z||(this.z=this.L(1)),this.z}get G(){return this.F||(this.F=this.L(0)),this.F}get I(){return this.H||(this.H=this.L(-1)),this.H}J(t){switch(t){case-1:return this.I;case 0:return this.G;default:return this.C}}L(t){const i=this.P(t);return i?PJ(i):Object.create(null)}isNew(t){return this.getBoolean(DJ,t)===!0}async flush(t=Pl.NONE){this.g.fire({reason:t});const i=this.P(-1),r=this.P(0),s=this.P(1);switch(t){case Pl.NONE:await Un.settled([i?.whenFlushed()??Promise.resolve(),r?.whenFlushed()??Promise.resolve(),s?.whenFlushed()??Promise.resolve()]);break;case Pl.SHUTDOWN:await Un.settled([i?.flush(0)??Promise.resolve(),r?.flush(0)??Promise.resolve(),s?.flush(0)??Promise.resolve()]);break}}async log(){const t=this.P(-1)?.items??new Map,i=this.P(0)?.items??new Map,r=this.P(1)?.items??new Map;return TJ(t,i,r,this.Q(-1)??"",this.Q(0)??"",this.Q(1)??"")}async optimize(t){return await this.flush(),this.P(t)?.optimize()}async switch(t,i){return this.u(Pl.NONE),$J(t)?this.R(t,i):this.S(t,i)}M(t,i){return!(t.id===i.id||u3(i)&&u3(t))}N(t,i,r){this.w(()=>{const s=new Set;for(const[n,o]of t)s.add(n),i.get(n)!==o&&this.t(r,{key:n,external:!0});for(const[n]of i.items)s.has(n)||this.t(r,{key:n,external:!0})})}};function u3(e){return e.isDefault||!!e.useDefaultFlags?.globalState}async function TJ(e,t,i,r,s,n){const o=v=>{try{return JSON.parse(v)}catch{return v}},a=new Map,c=new Map;e.forEach((v,b)=>{a.set(b,v),c.set(b,o(v))});const l=new Map,u=new Map;t.forEach((v,b)=>{l.set(b,v),u.set(b,o(v))});const h=new Map,f=new Map;i.forEach((v,b)=>{h.set(b,v),f.set(b,o(v))}),console.group(r!==s?`Storage: Application (path: ${r})`:`Storage: Application & Profile (path: ${r}, default profile)`);const p=[];if(a.forEach((v,b)=>{p.push({key:b,value:v})}),console.table(p),console.groupEnd(),console.log(c),r!==s){console.group(`Storage: Profile (path: ${s}, profile specific)`);const v=[];l.forEach((b,S)=>{v.push({key:S,value:b})}),console.table(v),console.groupEnd(),console.log(u)}console.group(`Storage: Workspace (path: ${n})`);const g=[];h.forEach((v,b)=>{g.push({key:b,value:v})}),console.table(g),console.groupEnd(),console.log(f)}var MJ=class Ai{static{this.a=new Map}static{this.b=new Map}static{this.c=new Map}static{this.d="memento/"}constructor(t,i){this.f=i,this.e=Ai.d+t}getMemento(t,i){switch(t){case 1:{let r=Ai.c.get(this.e);return r||(r=new X4(this.e,t,i,this.f),Ai.c.set(this.e,r)),r.getMemento()}case 0:{let r=Ai.b.get(this.e);return r||(r=new X4(this.e,t,i,this.f),Ai.b.set(this.e,r)),r.getMemento()}case-1:{let r=Ai.a.get(this.e);return r||(r=new X4(this.e,t,i,this.f),Ai.a.set(this.e,r)),r.getMemento()}}}onDidChangeValue(t,i){return this.f.onDidChangeValue(t,this.e,i)}saveMemento(){Ai.c.get(this.e)?.save(),Ai.b.get(this.e)?.save(),Ai.a.get(this.e)?.save()}reloadMemento(t){let i;switch(t){case-1:i=Ai.a.get(this.e);break;case 0:i=Ai.b.get(this.e);break;case 1:i=Ai.c.get(this.e);break}i?.reload()}static clear(t){switch(t){case 1:Ai.c.clear();break;case 0:Ai.b.clear();break;case-1:Ai.a.clear();break}}},X4=class{constructor(e,t,i,r){this.b=e,this.c=t,this.d=i,this.e=r,this.a=this.f()}f(){try{return this.e.getObject(this.b,this.c,{})}catch(e){lt(`[memento]: failed to parse contents: ${e} (id: ${this.b}, scope: ${this.c}, contents: ${this.e.get(this.b,this.c)})`)}return{}}getMemento(){return this.a}reload(){for(const e of Object.getOwnPropertyNames(this.a))delete this.a[e];Object.assign(this.a,this.f())}save(){yv(this.a)?this.e.remove(this.b,this.c):this.e.store(this.b,this.a,this.c,this.d)}},NJ=H("chatTodoListService"),K4=class{constructor(t){this.a=new MJ("chat-todo-list",t)}b(t){return this.a.getMemento(1,1)[this.d(t)]||[]}c(t,i){const r=this.a.getMemento(1,1);r[this.d(t)]=i,this.a.saveMemento()}getTodoList(t){return this.b(t)}setTodoList(t,i){this.c(t,i)}d(t){return X0(t)}};K4=__decorate([__param(0,Ua)],K4);var h3=class extends Q{constructor(t){super(),this.a=this.D(new I),this.onDidUpdateTodos=this.a.event,this.b=new K4(t)}getTodos(t){return this.b.getTodoList(t)}setTodos(t,i){this.b.setTodoList(t,i),this.a.fire(t)}};h3=__decorate([__param(0,Ua)],h3);var RJ="chat.todoListTool.writeOnly",LJ="chat.todoListTool.descriptionField",d3="manage_todo_list";function f3(e,t=!0){const i={todoList:{type:"array",description:e?"Complete array of all todo items. Must include ALL items - both existing and new.":"Complete array of all todo items (required for write operation, ignored for read). Must include ALL items - both existing and new.",items:{type:"object",properties:{id:{type:"number",description:"Unique identifier for the todo. Use sequential numbers starting from 1."},title:{type:"string",description:"Concise action-oriented todo label (3-7 words). Displayed in UI."},...t&&{description:{type:"string",description:"Detailed context, requirements, or implementation notes. Include file paths, specific methods, or acceptance criteria."}},status:{type:"string",enum:["not-started","in-progress","completed"],description:"not-started: Not begun | in-progress: Currently working (max 1) | completed: Fully finished with no blockers"}},required:t?["id","title","description","status"]:["id","title","status"]}}},r=e?["todoList"]:[];return e||(i.operation={type:"string",enum:["write","read"],description:"write: Replace entire todo list with new content. read: Retrieve current todo list. ALWAYS provide complete list when writing - partial updates not supported."},r.unshift("operation")),{id:d3,toolReferenceName:"todo",legacyToolReferenceFullNames:["todos"],canBeReferencedInPrompt:!0,icon:Nt.fromId(oe.checklist.id),displayName:d(6677,null),userDescription:d(6678,null),modelDescription:`Manage a structured todo list to track progress and plan tasks throughout your coding session. Use this tool VERY frequently to ensure task visibility and proper planning.

When to use this tool:
- Complex multi-step work requiring planning and tracking
- When user provides multiple tasks or requests (numbered/comma-separated)
- After receiving new instructions that require multiple steps
- BEFORE starting work on any todo (mark as in-progress)
- IMMEDIATELY after completing each todo (mark completed individually)
- When breaking down larger tasks into smaller actionable steps
- To give users visibility into your progress and planning

When NOT to use:
- Single, trivial tasks that can be completed in one step
- Purely conversational/informational requests
- When just reading files or performing simple searches

CRITICAL workflow:
1. Plan tasks by writing todo list with specific, actionable items
2. Mark ONE todo as in-progress before starting work
3. Complete the work for that specific todo
4. Mark that todo as completed IMMEDIATELY
5. Move to next todo and repeat

Todo states:
- not-started: Todo not yet begun
- in-progress: Currently working (limit ONE at a time)
- completed: Finished successfully

IMPORTANT: Mark todos completed as soon as they are done. Do not batch completions.`,source:Xr.Internal,inputSchema:{type:"object",properties:i,required:r}}}var aae=f3(!1),eS=class extends Q{constructor(t,i,r,s,n){super(),this.a=t,this.b=i,this.c=r,this.f=s,this.g=n}async invoke(t,i,r,s){const n=t.parameters,a=t.context?.sessionId??n.chatSessionId??"default";this.f.debug(`ManageTodoListTool: Invoking with options ${JSON.stringify(n)}`);try{const c=this.a?"write":n.operation;return c?c==="read"?this.m(Ss.forSession(a)):c==="write"?this.q(n,Ss.forSession(a)):{content:[{kind:"text",value:"Error: Unknown operation"}]}:{content:[{kind:"text",value:"Error: operation parameter is required"}]}}catch(c){return{content:[{kind:"text",value:`Error: ${c instanceof Error?c.message:"Unknown error"}`}]}}}async prepareToolInvocation(t,i){const r=t.parameters,n=t.chatSessionId??r.chatSessionId??"default",o=this.c.getTodos(Ss.forSession(n));let a;switch(this.a?"write":r.operation){case"write":{r.todoList&&(a=this.h(o,r.todoList));break}case"read":{a=d(6679,null);break}default:break}const u=(r.todoList??o).map(h=>({id:h.id.toString(),title:h.title,description:h.description||"",status:h.status}));return{pastTenseMessage:new qn(a??d(6680,null)),toolSpecificData:{kind:"todoList",sessionId:n,todoList:u}}}h(t,i){if(t.length===0)return i.length===1?d(6681,null):d(6682,null,i.length);const r=new Map(t.map(a=>[a.id,a])),s=i.filter(a=>{const c=r.get(a.id);return c&&c.status!=="in-progress"&&a.status==="in-progress"});if(s.length>0){const a=s[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(6683,null,a.title,l,c)}const n=i.filter(a=>{const c=r.get(a.id);return c&&c.status!=="completed"&&a.status==="completed"});if(n.length>0){const a=n[0],c=i.length,l=i.findIndex(u=>u.id===a.id)+1;return d(6684,null,a.title,l,c)}const o=i.filter(a=>!r.has(a.id));return o.length>0?o.length===1?d(6685,null):d(6686,null,o.length):d(6687,null)}j(t,i){return t.length===0?"No todo list found.":`# Todo List

${this.s(t)}`}m(t){const i=this.c.getTodos(t),r=this.j(i,t),s=this.r(i);return this.g.publicLog2("todoListToolInvoked",{operation:"read",notStartedCount:s.notStartedCount,inProgressCount:s.inProgressCount,completedCount:s.completedCount,chatSessionId:X0(t)}),{content:[{kind:"text",value:r}]}}q(t,i){if(!t.todoList)return{content:[{kind:"text",value:"Error: todoList is required for write operation"}]};const r=t.todoList.map(c=>({id:c.id,title:c.title,description:c.description||"",status:c.status})),s=this.c.getTodos(i),n=this.t(s,r);this.c.setTodos(i,r);const o=this.r(r),a=[];return r.length<3?a.push("Warning: Small todo list (<3 items). This task might not need a todo list."):r.length>10&&a.push("Warning: Large todo list (>10 items). Consider keeping the list focused and actionable."),n>3&&a.push("Warning: Did you mean to update so many todos at the same time? Consider working on them one by one."),this.g.publicLog2("todoListToolInvoked",{operation:"write",notStartedCount:o.notStartedCount,inProgressCount:o.inProgressCount,completedCount:o.completedCount,chatSessionId:X0(i)}),{content:[{kind:"text",value:`Successfully wrote todo list${a.length?`

`+a.join(`
`):""}`}],toolMetadata:{warnings:a}}}r(t){const i=t.filter(n=>n.status==="not-started").length,r=t.filter(n=>n.status==="in-progress").length,s=t.filter(n=>n.status==="completed").length;return{notStartedCount:i,inProgressCount:r,completedCount:s}}s(t){return t.length===0?"":t.map(i=>{let r;switch(i.status){case"completed":r="[x]";break;case"in-progress":r="[-]";break;case"not-started":default:r="[ ]";break}const s=[`- ${r} ${i.title}`];return this.b&&i.description&&i.description.trim()&&s.push(`  - ${i.description.trim()}`),s.join(`
`)}).join(`
`)}t(t,i){let r=0;const s=Math.min(t.length,i.length);for(let c=0;c<s;c++){const l=t[c],u=i[c];(l.title!==u.title||(l.description??"")!==(u.description??"")||l.status!==u.status)&&r++}const n=Math.max(0,i.length-t.length),o=Math.max(0,t.length-i.length);return n+o+r}};eS=__decorate([__param(2,NJ),__param(3,Se),__param(4,dp)],eS);var p3=H("requestService"),OJ=class{constructor(e){this.b=e}toJSON(){if(!this.a){const e=Object.create(null);for(const t in this.b)t.toLowerCase()==="authorization"||t.toLowerCase()==="proxy-authorization"?e[t]="*****":e[t]=this.b[t];this.a=e}return this.a}},FJ=class extends Q{constructor(e){super(),this.b=e,this.a=0}async c(e,t){const i=`#${++this.a}: ${e.url}`;this.b.trace(`${i} - begin`,e.type,new OJ(e.headers??{}));try{const r=await t();return this.b.trace(`${i} - end`,e.type,r.res.statusCode,r.res.headers),r}catch(r){throw this.b.error(`${i} - error`,e.type,W5(r)),r}}};function UJ(e){return e.res.statusCode&&e.res.statusCode>=200&&e.res.statusCode<300||e.res.statusCode===1223}function g3(e){return e.res.statusCode===204}async function tS(e){return g3(e)?null:(await bx(e.stream)).toString()}async function jJ(e){if(!UJ(e))throw new Error("Server returned "+e.res.statusCode);if(g3(e))return null;const i=(await bx(e.stream)).toString();try{return JSON.parse(i)}catch(r){throw r.message+=`:
`+i,r}}var g1=!1,iS=[],m3=void 0,v3=void 0;function zJ(e=!0,t=!0){if(m3===e&&v3===t)return;m3=e,v3=t;const i=Zt.as(to.Configuration),r=iS;iS=[{id:"http",order:15,title:d(2290,null),type:"object",scope:2,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:t,markdownDescription:d(2291,null),restricted:!0}}},{id:"http",order:15,title:d(2292,null),type:"object",scope:1,properties:{"http.electronFetch":{type:"boolean",default:!1,description:d(2293,null),restricted:!0}}},{id:"http",order:15,title:d(2294,null),type:"object",scope:e?1:2,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:d(2295,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyStrictSSL":{type:"boolean",default:!0,markdownDescription:d(2296,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:d(2297,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:d(2298,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:d(2299,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[d(2300,null),d(2301,null),d(2302,null),d(2303,null)],default:"override",markdownDescription:d(2304,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificates":{type:"boolean",default:!0,markdownDescription:d(2305,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.systemCertificatesNode":{type:"boolean",tags:["experimental"],default:g1,markdownDescription:d(2306,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:!1,markdownDescription:d(2307,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0},"http.fetchAdditionalSupport":{type:"boolean",default:!0,markdownDescription:d(2308,null,"`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:!0},"http.experimental.networkInterfaceCheckInterval":{type:"number",default:300,minimum:-1,tags:["experimental"],markdownDescription:d(2309,null,"`#http.useLocalProxyConfiguration#`"),restricted:!0,experiment:{mode:"auto"}}}}],i.updateConfigurations({add:iS,remove:r})}zJ();var lae=new k("isMac",Dt,d(1861,null)),uae=new k("isLinux",$t,d(1862,null)),hae=new k("isWindows",ze,d(1863,null)),HJ=new k("isWeb",No,d(1864,null)),dae=new k("isMacNative",Dt&&!No,d(1865,null)),fae=new k("isIOS",PL,d(1866,null)),pae=new k("isMobile",TL,d(1867,null)),gae=new k("isDevelopment",!1,!0),mae=new k("productQualityType","",d(1868,null)),WJ="inputFocus",vae=new k(WJ,!1,d(1869,null)),w3=H("languageService"),b3=H("modelService"),y3=class extends T${constructor(){super(...arguments),this.f=this.D(new I),this.g=this.D(new I),this.j=this.D(new I),this.n=this.D(new I),this.onDidChangeDirty=this.f.event,this.onDidChangeLabel=this.g.event,this.onDidChangeCapabilities=this.j.event,this.onWillDispose=this.n.event}get editorId(){}get capabilities(){return 2}hasCapability(e){return e===0?this.capabilities===0:(this.capabilities&e)!==0}isReadonly(){return this.hasCapability(2)}getName(){return`Editor ${this.typeId}`}getDescription(e){}getTitle(e){return this.getName()}getLabelExtraClasses(){return[]}getAriaLabel(){return this.getTitle(0)}getIcon(){}getTelemetryDescriptor(){return{typeId:this.typeId}}isDirty(){return!1}isModified(){return this.isDirty()}isSaving(){return!1}async resolve(){return null}async save(e,t){return this}async saveAs(e,t){return this}async revert(e,t){}async rename(e,t){}copy(){return this}canMove(e,t){return!0}matches(e){if(Jr(e))return this===e;const t=e.options?.override;return this.editorId!==t&&t!==void 0&&this.editorId!==void 0?!1:nc(this.resource,Y0.getCanonicalUri(e))}prefersEditorPane(e){return e.at(0)}toUntyped(e){}isDisposed(){return this.B.isDisposed}dispose(){this.isDisposed()||this.n.fire(),super.dispose()}},Tl,rS=class extends y3{static{Tl=this}static{this.ID="workbench.editorinputs.sidebysideEditorInput"}get typeId(){return Tl.ID}get capabilities(){let t=this.primary.capabilities;return t&=-33,this.secondary.hasCapability(16)&&(t|=16),this.secondary.hasCapability(8)&&(t|=8),t|=256,t}get resource(){if(this.a)return this.primary.resource}constructor(t,i,r,s,n){super(),this.b=t,this.c=i,this.secondary=r,this.primary=s,this.h=n,this.a=this.primary.matches(this.secondary),this.m()}m(){this.D(Ie.once(Ie.any(this.primary.onWillDispose,this.secondary.onWillDispose))(()=>{this.isDisposed()||this.dispose()})),this.D(this.primary.onDidChangeDirty(()=>this.f.fire())),this.D(this.primary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.secondary.onDidChangeCapabilities(()=>this.j.fire())),this.D(this.primary.onDidChangeLabel(()=>this.g.fire())),this.D(this.secondary.onDidChangeLabel(()=>this.g.fire()))}getName(){const t=this.getPreferredName();return t||(this.a?this.primary.getName():d(4465,null,this.secondary.getName(),this.primary.getName()))}getPreferredName(){return this.b}getDescription(t){const i=this.getPreferredDescription();return i||(this.a?this.primary.getDescription(t):super.getDescription(t))}getPreferredDescription(){return this.c}getTitle(t){let i;this.a?i=this.primary.getTitle(t)??this.getName():i=super.getTitle(t);const r=this.q();return r&&(i=`${r} (${i})`),i}q(){if(this.b&&this.c)return`${this.b} ${this.c}`;if(this.b||this.c)return this.b??this.c}getLabelExtraClasses(){return this.a?this.primary.getLabelExtraClasses():super.getLabelExtraClasses()}getAriaLabel(){return this.a?this.primary.getAriaLabel():super.getAriaLabel()}getTelemetryDescriptor(){return{...this.primary.getTelemetryDescriptor(),...super.getTelemetryDescriptor()}}isDirty(){return this.primary.isDirty()}isSaving(){return this.primary.isSaving()}async save(t,i){const r=await this.primary.save(t,i);return this.r(r)}async saveAs(t,i){const r=await this.primary.saveAs(t,i);return this.r(r)}r(t){if(!t||!this.a)return t;if(this.primary.matches(t))return this;if(t instanceof y3)return new Tl(this.b,this.c,t,t,this.h);if(!tn(t)&&!Iu(t)&&!ea(t)&&!ta(t))return{primary:t,secondary:t,label:this.b,description:this.c}}revert(t,i){return this.primary.revert(t,i)}async rename(t,i){if(!this.a)return;const r=await this.primary.rename(t,i);if(r){if(Jr(r.editor))return{editor:new Tl(this.b,this.c,r.editor,r.editor,this.h),options:{...r.options,viewState:Q0(this,t,this.h)}};if(xz(r.editor))return{editor:{label:this.b,description:this.c,primary:r.editor,secondary:r.editor,options:{...r.options,viewState:Q0(this,t,this.h)}}}}}isReadonly(){return this.primary.isReadonly()}toUntyped(t){const i=this.primary.toUntyped(t),r=this.secondary.toUntyped(t);if(i&&r&&!tn(i)&&!tn(r)&&!Iu(i)&&!Iu(r)&&!ea(i)&&!ea(r)&&!ta(i)&&!ta(r)){const s={label:this.b,description:this.c,primary:i,secondary:r};return typeof t?.preserveViewState=="number"&&(s.options={viewState:Q0(this,t.preserveViewState,this.h)}),s}}matches(t){return this===t?!0:M$(t)||tn(t)?!1:t instanceof Tl?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):ea(t)?this.primary.matches(t.primary)&&this.secondary.matches(t.secondary):!1}};rS=Tl=__decorate([__param(4,A6)],rS);var A3=class extends Q{constructor(){super(...arguments),this.f=this.D(new I),this.onWillDispose=this.f.event,this.h=!1}async resolve(){this.h=!0}isResolved(){return this.h}isDisposed(){return this.B.isDisposed}dispose(){this.f.fire(),super.dispose()}},BJ={ModesRegistry:"editor.modesRegistry"},_J=class extends Q{constructor(){super(),this.b=this.D(new I),this.onDidChangeLanguages=this.b.event,this.a=[]}registerLanguage(e){return this.a.push(e),this.b.fire(void 0),{dispose:()=>{for(let t=0,i=this.a.length;t<i;t++)if(this.a[t]===e){this.a.splice(t,1);return}}}}getLanguages(){return this.a}},S3=new _J;Zt.add(BJ.ModesRegistry,S3);var m1="plaintext",VJ=".txt";S3.registerLanguage({id:m1,extensions:[VJ],aliases:[d(903,null),"text"],mimetypes:[Zr.text]}),Zt.as(to.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1},"[go]":{"editor.insertSpaces":!1},"[makefile]":{"editor.insertSpaces":!1},"[shellscript]":{"files.eol":`
`},"[yaml]":{"editor.insertSpaces":!0,"editor.tabSize":2}}}]);var qJ=H("ILanguageDetectionService"),E3="languageDetection",GJ=H("accessibilityService"),x3;(function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Enabled=2]="Enabled"})(x3||(x3={}));var bae=new k("accessibilityModeEnabled",!1),sS,v1=class extends A3{static{sS=this}static{this.a=600}constructor(t,i,r,s,n){super(),this.n=t,this.q=i,this.r=r,this.s=s,this.b=void 0,this.j=this.D(new Br),this.m=this.D(new au(sS.a)),this.w=!1,this.y=void 0,n&&this.t(n)}t(t){const i=this.n.getModel(t);if(!i)throw new Error(`Document with resource ${t.toString(!0)} does not exist`);this.b=t,this.u(i)}u(t){this.j.value=t.onWillDispose(()=>{this.b=void 0,this.dispose()})}get textEditorModel(){return this.b?this.n.getModel(this.b):null}isReadonly(){return!0}get languageChangeSource(){return this.y}get hasLanguageSetExplicitly(){return typeof this.y=="string"}setLanguageId(t,i){this.y="user",this.z(t,i)}z(t,i){if(this.isResolved()&&!(!t||t===this.textEditorModel.getLanguageId())){this.w=!0;try{this.textEditorModel.setLanguage(this.q.createById(t),i)}finally{this.w=!1}}}C(t){const i=this.D(t.onDidChangeLanguage(r=>{r.source===E3||this.w||(this.y="api",i.dispose())}))}getLanguageId(){return this.textEditorModel?.getLanguageId()}F(){return this.m.trigger(()=>this.G())}async G(){if(this.hasLanguageSetExplicitly||!this.b||!this.r.isEnabledForLanguage(this.getLanguageId()??m1))return;const t=await this.r.detectLanguage(this.b),i=this.getLanguageId();if(t&&t!==i&&!this.isDisposed()){this.z(t,E3);const r=this.q.getLanguageName(t);this.s.alert(d(4466,null,r??t))}}H(t,i,r){const s=this.J(t),n=this.L(i,this.q,r,s);return this.I(t,n,i)}I(t,i,r){let s=r&&this.n.getModel(r);return s?this.updateTextEditorModel(t,i.languageId):(s=this.n.createModel(t,i,r),this.g=!0,this.u(s)),this.b=s.uri,s}J(t){const i=t;return typeof i.getFirstLineText=="function"?i.getFirstLineText(1e3):t.getLineContent(1).substr(0,1e3)}L(t,i,r,s){return!r||r===m1?i.createByFilepathOrFirstLine(t??null,s):i.createById(r)}updateTextEditorModel(t,i,r){this.isResolved()&&(t&&this.n.updateModel(this.textEditorModel,t,r),i&&i!==m1&&this.textEditorModel.getLanguageId()!==i&&this.textEditorModel.setLanguage(this.q.createById(i)))}createSnapshot(){return this.textEditorModel?this.textEditorModel.createSnapshot(!0):null}isResolved(){return!!this.b}dispose(){this.j.dispose(),this.b&&this.g&&this.n.destroyModel(this.b),this.b=void 0,this.g=!1,super.dispose()}};v1=sS=__decorate([__param(0,b3),__param(1,w3),__param(2,qJ),__param(3,GJ)],v1);var k3=class extends A3{get originalModel(){return this.a}get modifiedModel(){return this.b}constructor(e,t){super(),this.a=e,this.b=t}async resolve(){await Promise.all([this.a?.resolve(),this.b?.resolve()])}isResolved(){return!!(this.a?.isResolved()&&this.b?.isResolved())}dispose(){super.dispose()}},ZJ=class extends k3{get originalModel(){return this.a}get modifiedModel(){return this.b}get textDiffEditorModel(){return this.j}constructor(e,t){super(e,t),this.j=void 0,this.a=e,this.b=t,this.m()}async resolve(){await super.resolve(),this.m()}m(){this.originalModel?.isResolved()&&this.modifiedModel?.isResolved()&&(this.j?(this.j.original=this.originalModel.textEditorModel,this.j.modified=this.modifiedModel.textEditorModel):this.j={original:this.originalModel.textEditorModel,modified:this.modifiedModel.textEditorModel})}isResolved(){return!!this.j}isReadonly(){return!!this.modifiedModel&&this.modifiedModel.isReadonly()}dispose(){this.j=void 0,super.dispose()}};function C3(e){const t=e;return typeof t?.resolve=="function"&&typeof t?.isResolved=="function"}var $3;(function(e){e[e.ACTIVATE=1]="ACTIVATE",e[e.RESTORE=2]="RESTORE",e[e.PRESERVE=3]="PRESERVE"})($3||($3={}));var I3;(function(e){e[e.PICK=0]="PICK",e[e.EXCLUSIVE_ONLY=1]="EXCLUSIVE_ONLY"})(I3||(I3={}));var D3;(function(e){e[e.API=0]="API",e[e.USER=1]="USER"})(D3||(D3={}));var P3;(function(e){e[e.Center=0]="Center",e[e.CenterIfOutsideViewport=1]="CenterIfOutsideViewport",e[e.NearTop=2]="NearTop",e[e.NearTopIfOutsideViewport=3]="NearTopIfOutsideViewport"})(P3||(P3={}));var T3;(function(e){e.PROGRAMMATIC="api",e.NAVIGATION="code.navigation",e.JUMP="code.jump"})(T3||(T3={}));var w1,M3=class extends rS{static{w1=this}static{this.ID="workbench.editors.diffEditorInput"}get typeId(){return w1.ID}get editorId(){return this.modified.editorId===this.original.editorId?this.modified.editorId:void 0}get capabilities(){let t=super.capabilities;return this.t.forceDescription&&(t|=64),t}constructor(t,i,r,s,n,o){super(t,i,r,s,o),this.original=r,this.modified=s,this.u=n,this.s=void 0,this.t=this.w()}w(){let t,i=!1;if(this.b)t=this.b;else{const u=this.original.getName(),h=this.modified.getName();t=d(4464,null,u,h),i=u===h}let r,s,n;if(this.c)r=this.c,s=this.c,n=this.c;else{r=this.y(this.original.getDescription(0),this.modified.getDescription(0)),n=this.y(this.original.getDescription(2),this.modified.getDescription(2));const u=this.original.getDescription(1),h=this.modified.getDescription(1);if(typeof u=="string"&&typeof h=="string"&&(u||h)){const[f,p]=U_([u,h]);s=this.y(f,p)}}let o=this.y(this.original.getTitle(0)??this.original.getName(),this.modified.getTitle(0)??this.modified.getName()," \u2194 "),a=this.y(this.original.getTitle(1)??this.original.getName(),this.modified.getTitle(1)??this.modified.getName()," \u2194 "),c=this.y(this.original.getTitle(2)??this.original.getName(),this.modified.getTitle(2)??this.modified.getName()," \u2194 ");const l=this.q();return l&&(o=`${l} (${o})`,a=`${l} (${a})`,c=`${l} (${c})`),{name:t,shortDescription:r,mediumDescription:s,longDescription:n,forceDescription:i,shortTitle:o,mediumTitle:a,longTitle:c}}y(t,i,r=" - "){if(!(!t||!i))return t===i?i:`${t}${r}${i}`}getName(){return this.t.name}getDescription(t=1){switch(t){case 0:return this.t.shortDescription;case 2:return this.t.longDescription;case 1:default:return this.t.mediumDescription}}getTitle(t){switch(t){case 0:return this.t.shortTitle;case 2:return this.t.longTitle;default:case 1:return this.t.mediumTitle}}async resolve(){const t=await this.z();return this.s?.dispose(),this.s=t,this.s}prefersEditorPane(t){return this.u?t.find(i=>i.typeId===Ez):t.find(i=>i.typeId===Sz)}async z(){const[t,i]=await Promise.all([this.original.resolve(),this.modified.resolve()]);return i instanceof v1&&t instanceof v1?new ZJ(t,i):new k3(C3(t)?t:void 0,C3(i)?i:void 0)}toUntyped(t){const i=super.toUntyped(t);if(i)return{...i,modified:i.primary,original:i.secondary}}matches(t){return this===t?!0:t instanceof w1?this.modified.matches(t.modified)&&this.original.matches(t.original)&&t.u===this.u:tn(t)?this.modified.matches(t.modified)&&this.original.matches(t.original):!1}dispose(){this.s&&(this.s.dispose(),this.s=void 0),super.dispose()}};M3=w1=__decorate([__param(5,A6)],M3);var hs,Sae=new k("workbenchState",void 0,{type:"string",description:d(4386,null)}),Eae=new k("workspaceFolderCount",0,d(4387,null)),xae=new k("openFolderWorkspaceSupport",!0,!0),kae=new k("enterMultiRootWorkspaceSupport",!0,!0),Cae=new k("emptyWorkspaceSupport",!0,!0),$ae=new k("dirtyWorkingCopies",!1,d(4388,null)),JJ=new k("remoteName","",d(4389,null)),Iae=new k("virtualWorkspace","",d(4390,null)),Dae=new k("temporaryWorkspace",!1,d(4391,null)),Pae=new k("hasWebFileSystemAccess",!1,!0),Tae=new k("embedderIdentifier",void 0,d(4392,null)),Mae=new k("inAutomation",!1,d(4393,null)),Nae=new k("isFullscreen",!1,d(4394,null)),Rae=new k("isAuxiliaryWindowFocusedContext",!1,d(4395,null)),Lae=new k("isWindowAlwaysOnTop",!1,d(4396,null)),Oae=new k("isAuxiliaryWindow",!1,d(4397,null)),Fae=new k("activeEditorIsDirty",!1,d(4398,null)),Uae=new k("activeEditorIsNotPreview",!1,d(4399,null)),jae=new k("activeEditorIsFirstInGroup",!1,d(4400,null)),zae=new k("activeEditorIsLastInGroup",!1,d(4401,null)),Hae=new k("activeEditorIsPinned",!1,d(4402,null)),Wae=new k("activeEditorIsReadonly",!1,d(4403,null)),Bae=new k("activeCompareEditorCanSwap",!1,d(4404,null)),_ae=new k("activeEditorCanToggleReadonly",!0,d(4405,null)),Vae=new k("activeEditorCanRevert",!1,d(4406,null)),qae=new k("activeEditorCanSplitInGroup",!0),Gae=new k("activeEditor",null,{type:"string",description:d(4407,null)}),Zae=new k("activeEditorAvailableEditorIds","",d(4408,null)),Jae=new k("textCompareEditorVisible",!1,d(4409,null)),Qae=new k("textCompareEditorActive",!1,d(4410,null)),Yae=new k("sideBySideEditorActive",!1,d(4411,null)),Xae=new k("groupEditorsCount",0,d(4412,null)),Kae=new k("activeEditorGroupEmpty",!1,d(4413,null)),ece=new k("activeEditorGroupIndex",0,d(4414,null)),tce=new k("activeEditorGroupLast",!1,d(4415,null)),ice=new k("activeEditorGroupLocked",!1,d(4416,null)),QJ=new k("multipleEditorGroups",!1,d(4417,null)),rce=QJ.toNegated(),sce=new k("multipleEditorsSelectedInGroup",!1,d(4418,null)),nce=new k("twoEditorsSelectedInGroup",!1,d(4419,null)),oce=new k("SelectedEditorsInGroupFileOrUntitledResourceContextKey",!0,d(4420,null)),YJ=new k("editorPartMultipleEditorGroups",!1,d(4421,null)),ace=YJ.toNegated(),cce=new k("editorPartMaximizedEditorGroup",!1,d(4422,null)),lce=new k("editorIsOpen",!1,d(4423,null)),uce=new k("inZenMode",!1,d(4424,null)),hce=new k("isCenteredLayout",!1,d(4425,null)),dce=new k("splitEditorsVertically",!1,d(4426,null)),fce=new k("mainEditorAreaVisible",!0,d(4427,null)),pce=new k("editorTabsVisible",!0,d(4428,null)),gce=new k("sideBarVisible",!1,d(4429,null)),mce=new k("sideBarFocus",!1,d(4430,null)),vce=new k("activeViewlet","",d(4431,null)),wce=new k("statusBarFocused",!1,d(4432,null)),bce=new k("titleBarStyle","custom",d(4433,null)),yce=new k("titleBarVisible",!1,d(4434,null)),Ace=new k("isCompactTitleBar",!1,d(4435,null)),Sce=new k("bannerFocused",!1,d(4436,null)),Ece=new k("notificationFocus",!0,d(4437,null)),xce=new k("notificationCenterVisible",!1,d(4438,null)),kce=new k("notificationToastsVisible",!1,d(4439,null)),Cce=new k("activeAuxiliary","",d(4440,null)),$ce=new k("auxiliaryBarFocus",!1,d(4441,null)),Ice=new k("auxiliaryBarVisible",!1,d(4442,null)),Dce=new k("auxiliaryBarMaximized",!1,d(4443,null)),Pce=new k("activePanel","",d(4444,null)),Tce=new k("panelFocus",!1,d(4445,null)),Mce=new k("panelPosition","bottom",d(4446,null)),Nce=new k("panelAlignment","center",d(4447,null)),Rce=new k("panelVisible",!1,d(4448,null)),Lce=new k("panelMaximized",!1,d(4449,null)),Oce=new k("focusedView","",d(4450,null)),N3=class{static{hs=this}static{this.Scheme=new k("resourceScheme",void 0,{type:"string",description:d(4451,null)})}static{this.Filename=new k("resourceFilename",void 0,{type:"string",description:d(4452,null)})}static{this.Dirname=new k("resourceDirname",void 0,{type:"string",description:d(4453,null)})}static{this.Path=new k("resourcePath",void 0,{type:"string",description:d(4454,null)})}static{this.LangId=new k("resourceLangId",void 0,{type:"string",description:d(4455,null)})}static{this.Resource=new k("resource",void 0,{type:"URI",description:d(4456,null)})}static{this.Extension=new k("resourceExtname",void 0,{type:"string",description:d(4457,null)})}static{this.HasResource=new k("resourceSet",void 0,{type:"boolean",description:d(4458,null)})}static{this.IsFileSystemResource=new k("isFileSystemResource",void 0,{type:"boolean",description:d(4459,null)})}constructor(t,i,r,s){this.m=t,this.n=i,this.o=r,this.p=s,this.a=new ie,this.d=hs.Scheme.bindTo(this.m),this.f=hs.Filename.bindTo(this.m),this.g=hs.Dirname.bindTo(this.m),this.h=hs.Path.bindTo(this.m),this.i=hs.LangId.bindTo(this.m),this.c=hs.Resource.bindTo(this.m),this.j=hs.Extension.bindTo(this.m),this.k=hs.HasResource.bindTo(this.m),this.l=hs.IsFileSystemResource.bindTo(this.m),this.a.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const n=this.get();this.l.set(!!(n&&i.hasProvider(n)))})),this.a.add(s.onModelAdded(n=>{nc(n.uri,this.get())&&this.q()})),this.a.add(s.onModelLanguageChanged(n=>{nc(n.model.uri,this.get())&&this.q()}))}dispose(){this.a.dispose()}q(){const t=this.get();if(!t){this.i.set(null);return}const i=this.p.getModel(t)?.getLanguageId()??this.o.guessLanguageIdByFilepathOrFirstLine(t);this.i.set(i)}set(t){t=t??void 0,!nc(this.b,t)&&(this.b=t,this.m.bufferChangeEvents(()=>{this.c.set(t?t.toString():null),this.d.set(t?t.scheme:null),this.f.set(t?dr(t):null),this.g.set(t?this.r(ou(t)):null),this.h.set(t?this.r(t):null),this.q(),this.j.set(t?ex(t):null),this.k.set(!!t),this.l.set(t?this.n.hasProvider(t):!1)}))}r(t){return t.scheme===q.file?t.fsPath:t.path}reset(){this.b=void 0,this.m.bufferChangeEvents(()=>{this.c.reset(),this.d.reset(),this.f.reset(),this.g.reset(),this.h.reset(),this.i.reset(),this.j.reset(),this.k.reset(),this.l.reset()})}get(){return this.b}};N3=hs=__decorate([__param(0,Bn),__param(1,m$),__param(2,w3),__param(3,b3)],N3);var R3=H("dialogService"),L3;(function(e){e[e.Confirmation=1]="Confirmation",e[e.Prompt=2]="Prompt",e[e.Input=3]="Input"})(L3||(L3={}));var Uce=H("fileDialogService"),O3;(function(e){e[e.SAVE=0]="SAVE",e[e.DONT_SAVE=1]="DONT_SAVE",e[e.CANCEL=2]="CANCEL"})(O3||(O3={}));var XJ=H("openerService"),F3=H("lifecycleService"),U3;(function(e){e[e.Default=1]="Default",e[e.Last=2]="Last"})(U3||(U3={}));var j3;(function(e){e[e.CLOSE=1]="CLOSE",e[e.QUIT=2]="QUIT",e[e.RELOAD=3]="RELOAD",e[e.LOAD=4]="LOAD"})(j3||(j3={}));var z3;(function(e){e[e.NewWindow=1]="NewWindow",e[e.ReloadedWindow=3]="ReloadedWindow",e[e.ReopenedWindow=4]="ReopenedWindow"})(z3||(z3={}));var H3;(function(e){e[e.Starting=1]="Starting",e[e.Ready=2]="Ready",e[e.Restored=3]="Restored",e[e.Eventually=4]="Eventually"})(H3||(H3={}));var So,Ml,me;(function(e){e.Setup={hidden:new k("chatSetupHidden",!1,!0),installed:new k("chatSetupInstalled",!1,!0),disabled:new k("chatSetupDisabled",!1,!0),untrusted:new k("chatSetupUntrusted",!1,!0),later:new k("chatSetupLater",!1,!0),registered:new k("chatSetupRegistered",!1,!0)},e.Entitlement={signedOut:new k("chatEntitlementSignedOut",!1,!0),canSignUp:new k("chatPlanCanSignUp",!1,!0),planFree:new k("chatPlanFree",!1,!0),planPro:new k("chatPlanPro",!1,!0),planProPlus:new k("chatPlanProPlus",!1,!0),planBusiness:new k("chatPlanBusiness",!1,!0),planEnterprise:new k("chatPlanEnterprise",!1,!0),organisations:new k("chatEntitlementOrganisations",void 0,!0),internal:new k("chatEntitlementInternal",!1,!0),sku:new k("chatEntitlementSku",void 0,!0)},e.chatQuotaExceeded=new k("chatQuotaExceeded",!1,!0),e.completionsQuotaExceeded=new k("completionsQuotaExceeded",!1,!0),e.chatAnonymous=new k("chatAnonymous",!1,!0)})(me||(me={}));var W3=H("chatEntitlementService"),Te;(function(e){e[e.Unknown=1]="Unknown",e[e.Unresolved=2]="Unresolved",e[e.Available=3]="Available",e[e.Unavailable=4]="Unavailable",e[e.Free=5]="Free",e[e.Pro=6]="Pro",e[e.ProPlus=7]="ProPlus",e[e.Business=8]="Business",e[e.Enterprise=9]="Enterprise"})(Te||(Te={}));function KJ(e){return e===Te.Pro||e===Te.ProPlus||e===Te.Business||e===Te.Enterprise}var mi={extensionId:bi.defaultChatAgent?.extensionId??"",chatExtensionId:bi.defaultChatAgent?.chatExtensionId??"",upgradePlanUrl:bi.defaultChatAgent?.upgradePlanUrl??"",provider:bi.defaultChatAgent?.provider??{default:{id:""},enterprise:{id:""}},providerUriSetting:bi.defaultChatAgent?.providerUriSetting??"",providerScopes:bi.defaultChatAgent?.providerScopes??[[]],entitlementUrl:bi.defaultChatAgent?.entitlementUrl??"",entitlementSignupLimitedUrl:bi.defaultChatAgent?.entitlementSignupLimitedUrl??"",completionsAdvancedSetting:bi.defaultChatAgent?.completionsAdvancedSetting??"",chatQuotaExceededContext:bi.defaultChatAgent?.chatQuotaExceededContext??"",completionsQuotaExceededContext:bi.defaultChatAgent?.completionsQuotaExceededContext??""},B3="chat.allowAnonymousAccess";function _3(e,t,i){return!(e.getValue(B3)!==!0||t!==Te.Unknown||i.hidden||i.disabled)}function nS(e,t,i){i.publicLog2("chatEntitlements",{chatHidden:!!e.hidden,chatDisabled:!!e.disabled,chatEntitlement:e.entitlement,chatRegistered:!!e.registered,chatAnonymous:_3(t,e.entitlement,e)})}var oS=class extends Q{constructor(t,i,r,s,n,o,a){if(super(),this.a=s,this.b=n,this.c=o,this.f=a,this.g=this.D(new I),this.onDidChangeQuotaExceeded=this.g.event,this.h=this.D(new I),this.onDidChangeQuotaRemaining=this.h.event,this.j={},this.q={chatQuotaExceeded:mi.chatQuotaExceededContext,completionsQuotaExceeded:mi.completionsQuotaExceededContext},this.w=this.D(new I),this.onDidChangeAnonymous=this.w.event,this.anonymousObs=Pu(this.onDidChangeAnonymous,()=>this.anonymous),this.m=me.chatQuotaExceeded.bindTo(this.a),this.n=me.completionsQuotaExceeded.bindTo(this.a),this.u=me.chatAnonymous.bindTo(this.a),this.u.set(this.anonymous),this.onDidChangeEntitlement=Ie.map(Ie.filter(this.a.onDidChangeContext,l=>l.affectsSome(new Set([me.Entitlement.planPro.key,me.Entitlement.planBusiness.key,me.Entitlement.planEnterprise.key,me.Entitlement.planProPlus.key,me.Entitlement.planFree.key,me.Entitlement.canSignUp.key,me.Entitlement.signedOut.key,me.Entitlement.organisations.key,me.Entitlement.internal.key,me.Entitlement.sku.key])),this.B),()=>{},this.B),this.entitlementObs=Pu(this.onDidChangeEntitlement,()=>this.entitlement),this.onDidChangeSentiment=Ie.map(Ie.filter(this.a.onDidChangeContext,l=>l.affectsSome(new Set([me.Setup.hidden.key,me.Setup.disabled.key,me.Setup.untrusted.key,me.Setup.installed.key,me.Setup.later.key,me.Setup.registered.key])),this.B),()=>{},this.B),this.sentimentObs=Pu(this.onDidChangeSentiment,()=>this.sentiment),No&&!r.remoteAuthority&&!n.getValue("chat.experimental.serverlessWebEnabled")){me.Setup.hidden.bindTo(this.a).set(!0);return}if(!i.defaultChatAgent)return;const c=this.context=new Pt(()=>this.D(t.createInstance(cS)));this.requests=new Pt(()=>this.D(t.createInstance(aS,c.value,{clearQuotas:()=>this.clearQuotas(),acceptQuotas:l=>this.acceptQuotas(l)}))),this.r()}get entitlement(){return this.a.getContextKeyValue(me.Entitlement.planPro.key)===!0?Te.Pro:this.a.getContextKeyValue(me.Entitlement.planBusiness.key)===!0?Te.Business:this.a.getContextKeyValue(me.Entitlement.planEnterprise.key)===!0?Te.Enterprise:this.a.getContextKeyValue(me.Entitlement.planProPlus.key)===!0?Te.ProPlus:this.a.getContextKeyValue(me.Entitlement.planFree.key)===!0?Te.Free:this.a.getContextKeyValue(me.Entitlement.canSignUp.key)===!0?Te.Available:this.a.getContextKeyValue(me.Entitlement.signedOut.key)===!0?Te.Unknown:Te.Unresolved}get isInternal(){return this.a.getContextKeyValue(me.Entitlement.internal.key)===!0}get organisations(){return this.a.getContextKeyValue(me.Entitlement.organisations.key)}get sku(){return this.a.getContextKeyValue(me.Entitlement.sku.key)}get quotas(){return this.j}r(){const t=new Set([this.q.chatQuotaExceeded,this.q.completionsQuotaExceeded]),i=this.D(new Br);this.D(this.a.onDidChangeContext(n=>{n.affectsSome(t)&&(i.value&&i.value.cancel(),i.value=new Qe,this.update(i.value.token))}));let r=this.anonymous;const s=()=>{const n=this.anonymous;n!==r&&(r=n,this.u.set(n),this.context?.hasValue&&nS(this.context.value.state,this.b,this.c),this.w.fire())};this.D(this.b.onDidChangeConfiguration(n=>{n.affectsConfiguration(B3)&&s()})),this.D(this.onDidChangeEntitlement(()=>s())),this.D(this.onDidChangeSentiment(()=>s())),this.f.when(4).then(()=>{this.context?.hasValue&&nS(this.context.value.state,this.b,this.c)})}acceptQuotas(t){const i=this.j;this.j=t,this.t();const{changed:r}=this.s(i.chat,t.chat),{changed:s}=this.s(i.completions,t.completions),{changed:n}=this.s(i.premiumChat,t.premiumChat);(r.exceeded||s.exceeded||n.exceeded)&&this.g.fire(),(r.remaining||s.remaining||n.remaining)&&this.h.fire()}s(t,i){return{changed:{exceeded:t?.percentRemaining===0!=(i?.percentRemaining===0),remaining:t?.percentRemaining!==i?.percentRemaining}}}clearQuotas(){this.acceptQuotas({})}t(){this.m.set(this.j.chat?.percentRemaining===0),this.n.set(this.j.completions?.percentRemaining===0)}get sentiment(){return{installed:this.a.getContextKeyValue(me.Setup.installed.key)===!0,hidden:this.a.getContextKeyValue(me.Setup.hidden.key)===!0,disabled:this.a.getContextKeyValue(me.Setup.disabled.key)===!0,untrusted:this.a.getContextKeyValue(me.Setup.untrusted.key)===!0,later:this.a.getContextKeyValue(me.Setup.later.key)===!0,registered:this.a.getContextKeyValue(me.Setup.registered.key)===!0}}get anonymous(){return _3(this.b,this.entitlement,this.sentiment)}async update(t){await this.requests?.value.forceResolveEntitlement(void 0,t)}};oS=__decorate([__param(0,dc),__param(1,Zh),__param(2,PA),__param(3,Bn),__param(4,yi),__param(5,dp),__param(6,F3)],oS);var aS=So=class extends Q{static providerId(t){return t.getValue(`${mi.completionsAdvancedSetting}.authProvider`)===mi.provider.enterprise.id?mi.provider.enterprise.id:mi.provider.default.id}constructor(t,i,r,s,n,o,a,c,l,u,h){super(),this.f=t,this.g=i,this.h=r,this.j=s,this.m=n,this.n=o,this.q=a,this.r=c,this.s=l,this.t=u,this.u=h,this.b=new Qe,this.c=!1,this.a={entitlement:this.f.state.entitlement},this.w(),this.y()}w(){this.D(this.j.onDidChangeDeclaredProviders(()=>this.y())),this.D(this.j.onDidChangeSessions(t=>{t.providerId===So.providerId(this.s)&&this.y()})),this.D(this.j.onDidRegisterAuthenticationProvider(t=>{t.id===So.providerId(this.s)&&this.y()})),this.D(this.j.onDidUnregisterAuthenticationProvider(t=>{t.id===So.providerId(this.s)&&this.y()})),this.D(this.f.onDidChange(()=>{(!this.f.state.installed||this.f.state.disabled||this.f.state.entitlement===Te.Unknown)&&(this.a={entitlement:this.a.entitlement,quotas:void 0},this.g.clearQuotas())}))}async y(){this.b.dispose(!0);const t=this.b=new Qe,i=await this.z(t.token);if(t.token.isCancellationRequested)return;let r;i?this.a.entitlement===Te.Unknown&&(r={entitlement:Te.Unresolved}):(this.c=!1,r={entitlement:Te.Unknown}),r&&this.M(r),i&&!this.c&&await this.G(i,t.token)}async z(t){const i=await this.C(So.providerId(this.s));if(t.isCancellationRequested)return;const r=new Set;for(const s of i)for(const n of mi.providerScopes)this.F(s.scopes,n)&&r.add(s);return r.size>0?Array.from(r):void 0}async C(t){const i=this.t.getAccountPreference(mi.chatExtensionId,t)??this.t.getAccountPreference(mi.extensionId,t);let r;for(const s of await this.j.getAccounts(t))if(s.label===i){r=s;break}try{return await this.j.getSessions(t,void 0,{account:r})}catch{}return[]}F(t,i){return i.every(r=>t.includes(r))}async G(t,i){const r=await this.H(t,i);return typeof r?.entitlement=="number"&&!i.isCancellationRequested&&(this.c=!0,this.M(r)),r}async H(t,i){if(i.isCancellationRequested)return;const r=await this.L(this.I(),"GET",void 0,t,i);if(i.isCancellationRequested)return;if(!r)return this.m.trace("[chat entitlement]: no response"),{entitlement:Te.Unresolved};if(r.res.statusCode&&r.res.statusCode!==200)return this.m.trace(`[chat entitlement]: unexpected status code ${r.res.statusCode}`),r.res.statusCode===401||r.res.statusCode===404?{entitlement:Te.Unknown}:{entitlement:Te.Unresolved};let s=null;try{s=await tS(r)}catch{}if(i.isCancellationRequested)return;if(!s)return this.m.trace("[chat entitlement]: response has no content"),{entitlement:Te.Unresolved};let n;try{n=JSON.parse(s),this.m.trace(`[chat entitlement]: parsed result is ${JSON.stringify(n)}`)}catch(c){return this.m.trace(`[chat entitlement]: error parsing response (${c})`),{entitlement:Te.Unresolved}}let o;n.access_type_sku==="free_limited_copilot"?o=Te.Free:n.can_signup_for_limited?o=Te.Available:n.copilot_plan==="individual"?o=Te.Pro:n.copilot_plan==="individual_pro"?o=Te.ProPlus:n.copilot_plan==="business"?o=Te.Business:n.copilot_plan==="enterprise"?o=Te.Enterprise:n.chat_enabled?o=Te.Pro:o=Te.Unavailable;const a={entitlement:o,organisations:n.organization_login_list,quotas:this.J(n),sku:n.access_type_sku};return this.m.trace(`[chat entitlement]: resolved to ${a.entitlement}, quotas: ${JSON.stringify(a.quotas)}`),this.h.publicLog2("chatInstallEntitlement",{entitlement:a.entitlement,tid:n.analytics_tracking_id,sku:a.sku,quotaChat:a.quotas?.chat?.remaining,quotaPremiumChat:a.quotas?.premiumChat?.remaining,quotaCompletions:a.quotas?.completions?.remaining,quotaResetDate:a.quotas?.resetDate}),a}I(){if(So.providerId(this.s)===mi.provider.enterprise.id)try{const t=new URL(this.s.getValue(mi.providerUriSetting));return`${t.protocol}//api.${t.hostname}${t.port?":"+t.port:""}/copilot_internal/user`}catch(t){this.m.error(t)}return mi.entitlementUrl}J(t){const i={resetDate:t.quota_reset_date_utc??t.quota_reset_date??t.limited_user_reset_date,resetDateHasTime:typeof t.quota_reset_date_utc=="string"};if(t.monthly_quotas?.chat&&typeof t.limited_user_quotas?.chat=="number"&&(i.chat={total:t.monthly_quotas.chat,remaining:t.limited_user_quotas.chat,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.chat/t.monthly_quotas.chat*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.monthly_quotas?.completions&&typeof t.limited_user_quotas?.completions=="number"&&(i.completions={total:t.monthly_quotas.completions,remaining:t.limited_user_quotas.completions,percentRemaining:Math.min(100,Math.max(0,t.limited_user_quotas.completions/t.monthly_quotas.completions*100)),overageEnabled:!1,overageCount:0,unlimited:!1}),t.quota_snapshots)for(const r of["chat","completions","premium_interactions"]){const s=t.quota_snapshots[r];if(!s)continue;const n={total:s.entitlement,remaining:s.remaining,percentRemaining:Math.min(100,Math.max(0,s.percent_remaining)),overageEnabled:s.overage_permitted,overageCount:s.overage_count,unlimited:s.unlimited};switch(r){case"chat":i.chat=n;break;case"completions":i.completions=n;break;case"premium_interactions":i.premiumChat=n;break}}return i}async L(t,i,r,s,n){let o;for(const a of s){if(n.isCancellationRequested)return o;try{const c=await this.n.request({type:i,url:t,data:i==="POST"?JSON.stringify(r):void 0,disableCache:!0,headers:{Authorization:`Bearer ${a.accessToken}`}},n),l=c.res.statusCode;if(l&&l!==200){o=c;continue}return c}catch(c){n.isCancellationRequested||this.m.error(`[chat entitlement] request: error ${c}`)}}return o}M(t){this.a=t,this.f.update({entitlement:this.a.entitlement,organisations:this.a.organisations,sku:this.a.sku}),t.quotas&&this.g.acceptQuotas(t.quotas)}async forceResolveEntitlement(t,i=Fe.None){if(t||(t=await this.z(i)),!(!t||t.length===0))return this.G(t,i)}async signUpFree(t){const i={restricted_telemetry:this.h.telemetryLevel===0?"disabled":"enabled",public_code_suggestions:"enabled"},r=await this.L(mi.entitlementSignupLimitedUrl,"POST",i,t,Fe.None);if(!r)return await this.N(d(15200,null),"[chat entitlement] sign-up: no response")?this.signUpFree(t):{errorCode:1};if(r.res.statusCode&&r.res.statusCode!==200){if(r.res.statusCode===422)try{const a=await tS(r);if(a){const c=JSON.parse(a);if(typeof c.message=="string"&&c.message)return this.O(`[chat entitlement] sign-up: unprocessable entity (${c.message})`,c.message),{errorCode:r.res.statusCode}}}catch{}return await this.N(d(15201,null,r.res.statusCode),`[chat entitlement] sign-up: unexpected status code ${r.res.statusCode}`)?this.signUpFree(t):{errorCode:r.res.statusCode}}let s=null;try{s=await tS(r)}catch{}if(!s)return await this.N(d(15202,null),"[chat entitlement] sign-up: response has no content")?this.signUpFree(t):{errorCode:2};let n;try{n=JSON.parse(s),this.m.trace(`[chat entitlement] sign-up: response is ${s}`)}catch(o){return await this.N(d(15203,null),`[chat entitlement] sign-up: error parsing response (${o})`)?this.signUpFree(t):{errorCode:3}}return this.M({entitlement:Te.Free}),!!n?.subscribed}async N(t,i){if(this.m.error(i),!this.u.willShutdown){const{confirmed:r}=await this.q.confirm({type:Mt.Error,message:d(15204,null),detail:t,primaryButton:d(15205,null)});return r}return!1}O(t,i){this.m.error(t),this.u.willShutdown||this.q.prompt({type:Mt.Error,message:d(15206,null),detail:i,buttons:[{label:d(15207,null),run:()=>{}},{label:d(15208,null),run:()=>this.r.open(y.parse(mi.upgradePlanUrl))}]})}async signIn(t){const i=So.providerId(this.s),r=t?.additionalScopes?$n([...mi.providerScopes[0],...t.additionalScopes]):mi.providerScopes[0],s=await this.j.createSession(i,r,{extraAuthorizeParameters:{get_started_with:"copilot-vscode"},provider:t?.useSocialProvider});this.t.updateAccountPreference(mi.extensionId,i,s.account),this.t.updateAccountPreference(mi.chatExtensionId,i,s.account);const n=await this.forceResolveEntitlement([s]);return{session:s,entitlements:n}}dispose(){this.b.dispose(!0),super.dispose()}};aS=So=__decorate([__param(2,dp),__param(3,w_),__param(4,Se),__param(5,p3),__param(6,R3),__param(7,XJ),__param(8,yi),__param(9,b_),__param(10,F3)],aS);var cS=class extends Q{static{Ml=this}static{this.a="chat.setupContext"}static{this.b="chat.disableAIFeatures"}get state(){return this.P(this.G??this.F)}constructor(t,i,r,s,n){super(),this.J=i,this.L=r,this.M=s,this.N=n,this.G=void 0,this.H=this.D(new I),this.onDidChange=this.H.event,this.I=void 0,this.c=me.Entitlement.canSignUp.bindTo(t),this.f=me.Entitlement.signedOut.bindTo(t),this.g=me.Entitlement.planFree.bindTo(t),this.h=me.Entitlement.planPro.bindTo(t),this.j=me.Entitlement.planProPlus.bindTo(t),this.m=me.Entitlement.planBusiness.bindTo(t),this.n=me.Entitlement.planEnterprise.bindTo(t),this.q=me.Entitlement.organisations.bindTo(t),this.r=me.Entitlement.internal.bindTo(t),this.s=me.Entitlement.sku.bindTo(t),this.t=me.Setup.hidden.bindTo(t),this.u=me.Setup.later.bindTo(t),this.w=me.Setup.installed.bindTo(t),this.y=me.Setup.disabled.bindTo(t),this.z=me.Setup.untrusted.bindTo(t),this.C=me.Setup.registered.bindTo(t),this.F=this.J.getObject(Ml.a,0)??{entitlement:Te.Unknown,organisations:void 0,sku:void 0},this.R(),this.O()}O(){this.D(this.M.onDidChangeConfiguration(t=>{t.affectsConfiguration(Ml.b)&&this.Q()}))}P(t){return this.M.getValue(Ml.b)===!0?{...t,hidden:!0}:t}async update(t){this.L.trace(`[chat entitlement context] update(): ${JSON.stringify(t)}`);const i=JSON.stringify(this.F);if(typeof t.installed=="boolean"&&typeof t.disabled=="boolean"&&typeof t.untrusted=="boolean"&&(this.F.installed=t.installed,this.F.disabled=t.disabled,this.F.untrusted=t.untrusted,t.installed&&!t.disabled&&(t.hidden=!1)),typeof t.hidden=="boolean"&&(this.F.hidden=t.hidden),typeof t.later=="boolean"&&(this.F.later=t.later),typeof t.entitlement=="number"&&(this.F.entitlement=t.entitlement,this.F.organisations=t.organisations,this.F.sku=t.sku,this.F.entitlement===Te.Free||KJ(this.F.entitlement)?this.F.registered=!0:this.F.entitlement===Te.Available&&(this.F.registered=!1)),i!==JSON.stringify(this.F))return this.J.store(Ml.a,{...this.F,later:void 0},0,1),this.Q()}async Q(){await this.I?.wait(),this.R()}R(){const t=this.P(this.F);this.f.set(t.entitlement===Te.Unknown),this.c.set(t.entitlement===Te.Available),this.g.set(t.entitlement===Te.Free),this.h.set(t.entitlement===Te.Pro),this.j.set(t.entitlement===Te.ProPlus),this.m.set(t.entitlement===Te.Business),this.n.set(t.entitlement===Te.Enterprise),this.q.set(t.organisations),this.r.set(!!t.organisations?.some(i=>i==="github"||i==="microsoft"||i==="ms-copilot"||i==="MicrosoftCopilot")),this.s.set(t.sku),this.t.set(!!t.hidden),this.u.set(!!t.later),this.w.set(!!t.installed),this.y.set(!!t.disabled),this.z.set(!!t.untrusted),this.C.set(!!t.registered),this.L.trace(`[chat entitlement context] updateContext(): ${JSON.stringify(t)}`),nS(t,this.M,this.N),this.H.fire()}suspend(){this.G={...this.F},this.I=new fr}resume(){this.G=void 0,this.I?.open(),this.I=void 0}};cS=Ml=__decorate([__param(0,Bn),__param(1,Ua),__param(2,Se),__param(3,yi),__param(4,dp)],cS),De(W3,oS,0);var Lr;(function(e){e.responseVote=new k("chatSessionResponseVote","",{type:"string",description:d(6439,null)}),e.responseDetectedAgentCommand=new k("chatSessionResponseDetectedAgentOrCommand",!1,{type:"boolean",description:d(6440,null)}),e.responseSupportsIssueReporting=new k("chatResponseSupportsIssueReporting",!1,{type:"boolean",description:d(6441,null)}),e.responseIsFiltered=new k("chatSessionResponseFiltered",!1,{type:"boolean",description:d(6442,null)}),e.responseHasError=new k("chatSessionResponseError",!1,{type:"boolean",description:d(6443,null)}),e.requestInProgress=new k("chatSessionRequestInProgress",!1,{type:"boolean",description:d(6444,null)}),e.currentlyEditing=new k("chatSessionCurrentlyEditing",!1,{type:"boolean",description:d(6445,null)}),e.currentlyEditingInput=new k("chatSessionCurrentlyEditingInput",!1,{type:"boolean",description:d(6446,null)}),e.isResponse=new k("chatResponse",!1,{type:"boolean",description:d(6447,null)}),e.isRequest=new k("chatRequest",!1,{type:"boolean",description:d(6448,null)}),e.itemId=new k("chatItemId","",{type:"string",description:d(6449,null)}),e.lastItemId=new k("chatLastItemId",[],{type:"string",description:d(6450,null)}),e.editApplied=new k("chatEditApplied",!1,{type:"boolean",description:d(6451,null)}),e.inputHasText=new k("chatInputHasText",!1,{type:"boolean",description:d(6452,null)}),e.inputHasFocus=new k("chatInputHasFocus",!1,{type:"boolean",description:d(6453,null)}),e.inChatInput=new k("inChatInput",!1,{type:"boolean",description:d(6454,null)}),e.inChatSession=new k("inChat",!1,{type:"boolean",description:d(6455,null)}),e.inChatEditor=new k("inChatEditor",!1,{type:"boolean",description:d(6456,null)}),e.inChatTerminalToolOutput=new k("inChatTerminalToolOutput",!1,{type:"boolean",description:d(6457,null)}),e.chatModeKind=new k("chatAgentKind",Dr.Ask,{type:"string",description:d(6458,null)}),e.chatToolCount=new k("chatToolCount",0,{type:"number",description:d(6459,null)}),e.chatToolGroupingThreshold=new k("chat.toolGroupingThreshold",0,{type:"number",description:d(6460,null)}),e.supported=xt.or(HJ.negate(),JJ.notEqualsTo(""),xt.has("config.chat.experimental.serverlessWebEnabled")),e.enabled=new k("chatIsEnabled",!1,{type:"boolean",description:d(6461,null)}),e.lockedToCodingAgent=new k("lockedToCodingAgent",!1,{type:"boolean",description:d(6462,null)}),e.agentSupportsAttachments=new k("agentSupportsAttachments",!1,{type:"boolean",description:d(6463,null)}),e.withinEditSessionDiff=new k("withinEditSessionDiff",!1,{type:"boolean",description:d(6464,null)}),e.filePartOfEditSession=new k("filePartOfEditSession",!1,{type:"boolean",description:d(6465,null)}),e.extensionParticipantRegistered=new k("chatPanelExtensionParticipantRegistered",!1,{type:"boolean",description:d(6466,null)}),e.panelParticipantRegistered=new k("chatPanelParticipantRegistered",!1,{type:"boolean",description:d(6467,null)}),e.chatEditingCanUndo=new k("chatEditingCanUndo",!1,{type:"boolean",description:d(6468,null)}),e.chatEditingCanRedo=new k("chatEditingCanRedo",!1,{type:"boolean",description:d(6469,null)}),e.languageModelsAreUserSelectable=new k("chatModelsAreUserSelectable",!1,{type:"boolean",description:d(6470,null)}),e.chatSessionHasModels=new k("chatSessionHasModels",!1,{type:"boolean",description:d(6471,null)}),e.extensionInvalid=new k("chatExtensionInvalid",!1,{type:"boolean",description:d(6472,null)}),e.inputCursorAtTop=new k("chatCursorAtTop",!1),e.inputHasAgent=new k("chatInputHasAgent",!1),e.location=new k("chatLocation",void 0),e.inQuickChat=new k("quickChatHasFocus",!1,{type:"boolean",description:d(6473,null)}),e.hasFileAttachments=new k("chatHasFileAttachments",!1,{type:"boolean",description:d(6474,null)}),e.chatSessionIsEmpty=new k("chatSessionIsEmpty",!0,{type:"boolean",description:d(6475,null)}),e.remoteJobCreating=new k("chatRemoteJobCreating",!1,{type:"boolean",description:d(6476,null)}),e.hasRemoteCodingAgent=new k("hasRemoteCodingAgent",!1,d(6477,null)),e.enableRemoteCodingAgentPromptFileOverlay=new k("enableRemoteCodingAgentPromptFileOverlay",!1,d(6478,null)),e.skipChatRequestInProgressMessage=new k("chatSkipRequestInProgressMessage",!1,{type:"boolean",description:d(6479,null)}),e.Setup=me.Setup,e.Entitlement=me.Entitlement,e.chatQuotaExceeded=me.chatQuotaExceeded,e.completionsQuotaExceeded=me.completionsQuotaExceeded,e.Editing={hasToolConfirmation:new k("chatHasToolConfirmation",!1,{type:"boolean",description:d(6480,null)}),hasElicitationRequest:new k("chatHasElicitationRequest",!1,{type:"boolean",description:d(6481,null)})},e.Tools={toolsCount:new k("toolsCount",0,{type:"number",description:d(6482,null)})},e.Modes={hasCustomChatModes:new k("chatHasCustomAgents",!1,{type:"boolean",description:d(6483,null)}),agentModeDisabledByPolicy:new k("chatAgentModeDisabledByPolicy",!1,{type:"boolean",description:d(6484,null)})},e.panelLocation=new k("chatPanelLocation",void 0,{type:"number",description:d(6485,null)}),e.isCombinedAgentSessionsViewer=new k("chatIsCombinedSessionViewer",!1,{type:"boolean",description:d(6486,null)}),e.agentSessionsViewerLimited=new k("agentSessionsViewerLimited",void 0,{type:"boolean",description:d(6487,null)}),e.agentSessionsViewerOrientation=new k("agentSessionsViewerOrientation",void 0,{type:"number",description:d(6488,null)}),e.agentSessionsViewerPosition=new k("agentSessionsViewerPosition",void 0,{type:"number",description:d(6489,null)}),e.agentSessionType=new k("chatSessionType","",{type:"string",description:d(6490,null)}),e.hasAgentSessionChanges=new k("agentSessionHasChanges",!1,{type:"boolean",description:d(6491,null)}),e.isArchivedAgentSession=new k("agentSessionIsArchived",!1,{type:"boolean",description:d(6492,null)}),e.isReadAgentSession=new k("agentSessionIsRead",!1,{type:"boolean",description:d(6493,null)}),e.isActiveAgentSession=new k("agentSessionIsActive",!1,{type:"boolean",description:d(6494,null)}),e.isKatexMathElement=new k("chatIsKatexMathElement",!1,{type:"boolean",description:d(6495,null)})})(Lr||(Lr={}));var V3;(function(e){e.inEditingMode=xt.or(Lr.chatModeKind.isEqualTo(Dr.Edit),Lr.chatModeKind.isEqualTo(Dr.Agent)),e.chatSetupTriggerContext=xt.or(Lr.Setup.installed.negate(),Lr.Entitlement.canSignUp),e.agentViewWhen=xt.and(me.Setup.hidden.negate(),me.Setup.disabled.negate(),xt.equals(`config.${Qn.AgentSessionsViewLocation}`,"view"))})(V3||(V3={}));var fd,q3=H("chatAgentService"),G3=class extends Q{static{this.AGENT_LEADER="@"}constructor(t,i){super(),this.r=t,this.s=i,this.b=new Map,this.f=new I,this.onDidChangeAgents=this.f.event,this.g=new Set,this.n=!1,this.q=new Map,this.w=new Map,this.h=Lr.enabled.bindTo(this.r),this.j=Lr.extensionParticipantRegistered.bindTo(this.r),this.m=Lr.panelParticipantRegistered.bindTo(this.r),this.D(t.onDidChangeContext(r=>{r.affectsSome(this.g)&&this.u()}))}registerAgent(t,i){if(this.getAgent(t))throw new Error(`Agent already registered: ${JSON.stringify(t)}`);const s=this,n=i.slashCommands;i={...i,get slashCommands(){return n.filter(a=>!a.when||s.r.contextMatchesRules(xt.deserialize(a.when)))}};const o={data:i};return this.b.set(t,o),this.t(),this.u(),this.f.fire(void 0),te(()=>{this.b.delete(t),this.t(),this.u(),this.f.fire(void 0)})}t(){this.g.clear();for(const t of this.b.values())if(t.data.when){const i=xt.deserialize(t.data.when);for(const r of i?.keys()||[])this.g.add(r)}}u(){let t=!1,i=!1,r=!1;for(const s of this.getAgents())s.isDefault&&(s.isCore||(t=!0),s.id==="chat.setup"||s.id==="github.copilot.editsAgent"?r=!0:i=!0);this.m.set(i),this.j.set(t),r!==this.n&&(this.n=r,this.f.fire(this.getDefaultAgent(li.Chat,Dr.Agent)))}registerAgentImplementation(t,i){const r=this.b.get(t);if(!r)throw new Error(`Unknown agent: ${JSON.stringify(t)}`);if(r.impl)throw new Error(`Agent already has implementation: ${JSON.stringify(t)}`);return r.data.isDefault&&this.h.set(!0),r.impl=i,this.f.fire(new b1(r.data,i)),te(()=>{r.impl=void 0,this.f.fire(void 0),r.data.isDefault&&this.h.set(Wt.some(this.b.values(),s=>s.data.isDefault))})}registerDynamicAgent(t,i){t.isDynamic=!0;const r={data:t,impl:i};return this.b.set(t.id,r),this.f.fire(new b1(t,i)),te(()=>{this.b.delete(t.id),this.f.fire(void 0)})}registerAgentCompletionProvider(t,i){return this.w.set(t,i),{dispose:()=>{this.w.delete(t)}}}async getAgentCompletionItems(t,i,r){return await this.w.get(t)?.(i,r)??[]}updateAgent(t,i){const r=this.b.get(t);if(!r?.impl)throw new Error(`No activated agent with id ${JSON.stringify(t)} registered`);r.data.metadata={...r.data.metadata,...i},this.f.fire(new b1(r.data,r.impl))}getDefaultAgent(t,i=Dr.Ask){return this.y(this.getActivatedAgents().filter(r=>i&&!r.modes.includes(i)?!1:!!r.isDefault&&r.locations.includes(t)))}get hasToolsAgent(){return!!this.s.getValue(Qn.AgentEnabled)}getContributedDefaultAgent(t){return this.y(this.getAgents().filter(i=>!!i.isDefault&&i.locations.includes(t)))}y(t){return NR(t,i=>!i.isCore)??t.at(-1)}getAgent(t,i=!1){if(!(!this.z(t)&&!i))return this.b.get(t)?.data}z(t){const i=typeof t=="string"?this.b.get(t):t;return!i?.data.when||this.r.contextMatchesRules(xt.deserialize(i.data.when))}getAgentByFullyQualifiedId(t){const i=Wt.find(this.b.values(),r=>eQ(r.data)===t)?.data;if(!(i&&!this.z(i.id)))return i}getAgents(){return Array.from(this.b.values()).map(t=>t.data).filter(t=>this.z(t.id))}getActivatedAgents(){return Array.from(this.b.values()).filter(t=>!!t.impl).filter(t=>this.z(t.data.id)).map(t=>new b1(t.data,t.impl))}getAgentsByName(t){return this.C(this.getAgents().filter(i=>i.name===t))}C(t){const i=t.filter(r=>!r.isCore);return i.length>0?i:t}agentHasDupeName(t){const i=this.getAgent(t);return i?this.getAgentsByName(i.name).filter(r=>r.extensionId.value!==i.extensionId.value).length>0:!1}async invokeAgent(t,i,r,s,n){const o=this.b.get(t);if(!o?.impl)throw new Error(`No activated agent with id "${t}"`);return await o.impl.invoke(i,r,s,n)}setRequestTools(t,i,r){const s=this.b.get(t);if(!s?.impl)throw new Error(`No activated agent with id "${t}"`);s.impl.setRequestTools?.(i,r)}async getFollowups(t,i,r,s,n){const o=this.b.get(t);return o?.impl?.provideFollowups?o.impl.provideFollowups(i,r,s,n):[]}async getChatTitle(t,i,r){const s=this.b.get(t);if(s?.impl?.provideChatTitle)return s.impl.provideChatTitle(i,r)}async getChatSummary(t,i,r){const s=this.b.get(t);if(s?.impl?.provideChatSummary)return s.impl.provideChatSummary(i,r)}registerChatParticipantDetectionProvider(t,i){return this.q.set(t,i),te(()=>{this.q.delete(t)})}hasChatParticipantDetectionProviders(){return this.q.size>0}async detectAgentOrCommand(t,i,r,s){const n=Wt.first(this.q.values());if(!n)return;const o=this.getAgents().reduce((u,h)=>{if(h.locations.includes(r.location)){u.push({participant:h.id,disambiguation:h.disambiguation??[]});for(const f of h.slashCommands)u.push({participant:h.id,command:f.name,disambiguation:f.disambiguation??[]})}return u},[]),a=await n.provideParticipantDetection(t,i,{...r,participants:o},s);if(!a)return;const c=this.getAgent(a.participant);if(!c)return;if(!a.command)return{agent:c};const l=c?.slashCommands.find(u=>u.name===a.command);if(l)return{agent:c,command:l}}};G3=__decorate([__param(0,Bn),__param(1,yi)],G3);var b1=class{constructor(e,t){this.b=e,this.d=t}get id(){return this.b.id}get name(){return this.b.name??""}get fullName(){return this.b.fullName??""}get description(){return this.b.description??""}get extensionId(){return this.b.extensionId}get extensionVersion(){return this.b.extensionVersion}get extensionPublisherId(){return this.b.extensionPublisherId}get extensionPublisherDisplayName(){return this.b.publisherDisplayName}get extensionDisplayName(){return this.b.extensionDisplayName}get isDefault(){return this.b.isDefault}get isCore(){return this.b.isCore}get metadata(){return this.b.metadata}get slashCommands(){return this.b.slashCommands}get locations(){return this.b.locations}get modes(){return this.b.modes}get disambiguation(){return this.b.disambiguation}async invoke(e,t,i,r){return this.d.invoke(e,t,i,r)}setRequestTools(e,t){this.d.setRequestTools?.(e,t)}async provideFollowups(e,t,i,r){return this.d.provideFollowups?this.d.provideFollowups(e,t,i,r):[]}toJSON(){return this.b}},Bce=H("chatAgentNameService"),Z3=class{static{fd=this}static{this.b="chat.participantNameRegistry"}constructor(t,i,r,s){if(this.h=i,this.i=r,this.j=s,this.f=ir(this,Object.create(null)),this.g=!1,!t.chatParticipantRegistry)return;this.d=t.chatParticipantRegistry;const n=s.get(fd.b,-1);try{this.f.set(JSON.parse(n??"{}"),void 0)}catch{s.remove(fd.b,-1)}this.k()}k(){this.g||this.l().catch(t=>this.i.warn("Failed to fetch chat participant registry",t)).then(()=>ri(5*60*1e3)).then(()=>this.k())}async l(){const t=await this.h.request({type:"GET",url:this.d},Fe.None);if(t.res.statusCode!==200)throw new Error("Could not get extensions report.");const i=await jJ(t);if(!i||i.version!==1)throw new Error("Unexpected chat participant registry response.");const r=i.restrictedChatParticipants;this.f.set(r,void 0),this.j.store(fd.b,JSON.stringify(r),-1,1)}getAgentNameRestriction(t){if(t.isCore)return!0;const i=this.m(t.name,t).get(),r=!t.fullName||this.m(t.fullName.replace(/\s/g,""),t).get();return i&&r}m(t,i){return this.f.map(s=>s[t.toLowerCase()]).map(s=>s?s.some(n=>kr(n,n.includes(".")?i.extensionId.value:i.extensionPublisherId)):!0)}dispose(){this.g=!0}};Z3=fd=__decorate([__param(0,Zh),__param(1,p3),__param(2,Se),__param(3,Ua)],Z3);function eQ(e){return`${e.extensionId.value}.${e.id}`}var tQ=H("IPromptsService"),Os;(function(e){e.local="local",e.user="user",e.extension="extension"})(Os||(Os={}));var lS;(function(e){e.contribution="contribution",e.provider="provider"})(lS||(lS={}));var y1,iQ=H("chatModeService"),J3=class extends Q{static{y1=this}static{this.a="chat.customModes"}constructor(t,i,r,s,n,o){super(),this.h=t,this.j=i,this.m=s,this.n=n,this.q=o,this.f=new Map,this.g=new I,this.onDidChangeChatModes=this.g.event,this.b=Lr.Modes.hasCustomChatModes.bindTo(r),this.c=Lr.Modes.agentModeDisabledByPolicy.bindTo(r),this.z(),this.r(),this.u(!0),this.D(this.h.onDidChangeCustomAgents(()=>{this.u(!0)})),this.D(this.n.onWillSaveState(()=>this.t())),this.D(this.q.onDidChangeConfiguration(c=>{c.affectsConfiguration(Qn.AgentEnabled)&&(this.z(),this.g.fire())}));let a=this.j.hasToolsAgent;this.D(this.j.onDidChangeAgents(()=>{a!==this.j.hasToolsAgent&&(a=this.j.hasToolsAgent,this.g.fire())}))}r(){try{const t=this.n.getObject(y1.a,1);t&&this.s(t)}catch(t){this.m.error(t,"Failed to load cached custom agents")}}s(t){if(!Array.isArray(t)){this.m.error("Invalid cached custom modes data: expected array");return}for(const i of t)if(rQ(i)&&i.uri)try{const r=y.revive(i.uri),s={uri:r,name:i.name,description:i.description,tools:i.customTools,model:i.model,argumentHint:i.argumentHint,agentInstructions:i.modeInstructions??{content:i.body??"",toolReferences:[]},handOffs:i.handOffs,target:i.target,infer:i.infer,source:oQ(i.source)??{storage:Os.local}},n=new Q3(s);this.f.set(r.toString(),n)}catch(r){this.m.error(r,"Failed to revive cached custom agent")}this.b.set(this.f.size>0)}t(){try{const t=Array.from(this.f.values());this.n.store(y1.a,t,1,1)}catch(t){this.m.warn("Failed to save cached custom agents",t)}}async u(t){try{const i=await this.h.getCustomAgents(Fe.None),r=new Set;for(const s of i){const n=s.uri.toString();r.add(n);let o=this.f.get(n);o?o.updateData(s):(o=new Q3(s),this.f.set(n,o))}for(const[s]of this.f.entries())r.has(s)||this.f.delete(s);this.b.set(this.f.size>0)}catch(i){this.m.error(i,"Failed to load custom agents"),this.f.clear(),this.b.set(!1)}t&&this.g.fire()}getModes(){return{builtin:this.w(),custom:this.y()}}findModeById(t){return this.w().find(i=>i.id===t)??this.f.get(t)}findModeByName(t){return this.w().find(i=>i.name.get()===t)??this.y().find(i=>i.name.get()===t)}w(){const t=[Eo.Ask];return(this.j.hasToolsAgent||this.C())&&t.unshift(Eo.Agent),t.push(Eo.Edit),t}y(){return this.j.hasToolsAgent||this.C()?Array.from(this.f.values()):[]}z(){this.c.set(this.C())}C(){return this.q.inspect(Qn.AgentEnabled).policyValue===!1}};J3=y1=__decorate([__param(0,tQ),__param(1,q3),__param(2,Bn),__param(3,Se),__param(4,Ua),__param(5,yi)],J3);function rQ(e){if(typeof e!="object"||e===null)return!1;const t=e;return typeof t.id=="string"&&typeof t.name=="string"&&typeof t.kind=="string"&&(t.description===void 0||typeof t.description=="string")&&(t.customTools===void 0||Array.isArray(t.customTools))&&(t.modeInstructions===void 0||typeof t.modeInstructions=="object"&&t.modeInstructions!==null)&&(t.model===void 0||typeof t.model=="string")&&(t.argumentHint===void 0||typeof t.argumentHint=="string")&&(t.handOffs===void 0||Array.isArray(t.handOffs))&&(t.uri===void 0||typeof t.uri=="object"&&t.uri!==null)&&(t.source===void 0||sQ(t.source))&&(t.target===void 0||typeof t.target=="string")&&(t.infer===void 0||typeof t.infer=="boolean")}var Q3=class{get name(){return this.a}get description(){return this.b}get isBuiltin(){return Y3(this)}get customTools(){return this.c}get model(){return this.g}get argumentHint(){return this.h}get modeInstructions(){return this.d}get uri(){return this.f}get label(){return this.name}get handOffs(){return this.i}get source(){return this.l}get target(){return this.j}get infer(){return this.k}constructor(e){this.kind=Dr.Agent,this.id=e.uri.toString(),this.a=ir("name",e.name),this.b=ir("description",e.description),this.c=ir("customTools",e.tools),this.g=ir("model",e.model),this.h=ir("argumentHint",e.argumentHint),this.i=ir("handOffs",e.handOffs),this.j=ir("target",e.target),this.k=ir("infer",e.infer),this.d=ir("_modeInstructions",e.agentInstructions),this.f=ir("uri",e.uri),this.l=e.source}updateData(e){ow(t=>{this.a.set(e.name,t),this.b.set(e.description,t),this.c.set(e.tools,t),this.g.set(e.model,t),this.h.set(e.argumentHint,t),this.i.set(e.handOffs,t),this.j.set(e.target,t),this.k.set(e.infer,t),this.d.set(e.agentInstructions,t),this.f.set(e.uri,t),this.l=e.source})}toJSON(){return{id:this.id,name:this.name.get(),description:this.description.get(),kind:this.kind,customTools:this.customTools.get(),model:this.model.get(),argumentHint:this.argumentHint.get(),modeInstructions:this.modeInstructions.get(),uri:this.uri.get(),handOffs:this.handOffs.get(),source:nQ(this.l),target:this.target.get(),infer:this.infer.get()}}};function sQ(e){if(typeof e!="object"||e===null)return!1;const t=e;return t.storage===Os.extension?typeof t.extensionId=="string":t.storage===Os.local||t.storage===Os.user}function nQ(e){if(e)return e.storage===Os.extension?{storage:Os.extension,extensionId:e.extensionId.value,type:e.type}:{storage:e.storage}}function oQ(e){if(e)return e.storage===Os.extension?{storage:Os.extension,extensionId:new Ye(e.extensionId),type:e.type??lS.contribution}:{storage:e.storage}}var uS=class{constructor(e,t,i){this.kind=e,this.name=rI(e),this.label=rI(t),this.description=ir("description",i)}get isBuiltin(){return Y3(this)}get id(){return this.kind}get target(){return ir("target",void 0)}toJSON(){return{id:this.id,name:this.name.get(),description:this.description.get(),kind:this.kind}}},Eo;(function(e){e.Ask=new uS(Dr.Ask,"Ask",d(6504,null)),e.Edit=new uS(Dr.Edit,"Edit",d(6505,null)),e.Agent=new uS(Dr.Agent,"Agent",d(6506,null))})(Eo||(Eo={}));function Y3(e){return e.id===Eo.Ask.id||e.id===Eo.Edit.id||e.id===Eo.Agent.id}var X3;(function(e){e[e.System=0]="System",e[e.User=1]="User",e[e.Assistant=2]="Assistant"})(X3||(X3={}));var K3;(function(e){e[e.Assistant=0]="Assistant",e[e.User=1]="User",e[e.Extension=2]="Extension"})(K3||(K3={}));var eT;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e.WEBP="image/webp",e.BMP="image/bmp"})(eT||(eT={}));var tT;(function(e){e.Low="low",e.High="high"})(tT||(tT={}));var hS;(function(e){function t(s){return(typeof s.capabilities?.agentMode>"u"||s.capabilities.agentMode)&&!!s.capabilities?.toolCalling}e.suitableForAgentMode=t;function i(s){return`${s.name} (${s.vendor})`}e.asQualifiedName=i;function r(s,n){return n.vendor==="copilot"&&s===n.name?!0:s===i(n)}e.matchesQualifiedName=r})(hS||(hS={}));var aQ=H("ILanguageModelsService"),iT={type:"object",required:["vendor","displayName"],properties:{vendor:{type:"string",description:d(6530,null)},displayName:{type:"string",description:d(6531,null)},managementCommand:{type:"string",description:d(6532,null)},when:{type:"string",description:d(6533,null)}}},cQ=ID.registerExtensionPoint({extensionPoint:"languageModelChatProviders",jsonSchema:{description:d(6534,null),oneOf:[iT,{type:"array",items:iT}]},activationEventsGenerator:function*(e){for(const t of e)yield`onLanguageModelChatProvider:${t.vendor}`}}),rT=class{constructor(t,i,r,s,n,o){this.j=t,this.k=i,this.l=r,this.n=n,this.o=o,this.a=new ie,this.b=new Map,this.c=new Map,this.d=new Map,this.e=new ox,this.f={},this.i=this.a.add(new I),this.onDidChangeLanguageModels=this.i.event,this.g=Lr.languageModelsAreUserSelectable.bindTo(s),this.h=s,this.f=this.l.getObject("chatModelPickerPreferences",0,this.f);const a=()=>{(this.o.entitlement===Te.Business||this.o.entitlement===Te.Enterprise)&&!this.o.isInternal&&(this.f={},this.l.store("chatModelPickerPreferences",this.f,0,0))};a(),this.a.add(this.o.onDidChangeEntitlement(a)),this.a.add(this.onDidChangeLanguageModels(()=>{this.g.set(this.c.size>0&&Array.from(this.c.values()).some(c=>c.isUserSelectable))})),this.a.add(cQ.setHandler(c=>{this.d.clear();for(const l of c)for(const u of Wt.wrap(l.value)){if(this.d.has(u.vendor)){l.collector.error(d(6535,null,u.vendor));continue}if(nu(u.vendor)){l.collector.error(d(6536,null));continue}if(u.vendor.trim()!==u.vendor){l.collector.error(d(6537,null));continue}this.d.set(u.vendor,u),this.p(u.vendor)&&this.j.activateByEvent(`onLanguageModelChatProvider:${u.vendor}`)}for(const[l,u]of this.b)this.d.has(l)||this.b.delete(l)}))}p(t){return Object.keys(this.f).some(i=>i.startsWith(t))}dispose(){this.a.dispose(),this.b.clear()}updateModelPickerPreference(t,i){const r=this.c.get(t);if(!r){this.k.warn(`[LM] Cannot update model picker preference for unknown model ${t}`);return}this.f[t]=i,i===r.isUserSelectable?(delete this.f[t],this.l.store("chatModelPickerPreferences",this.f,0,0)):r.isUserSelectable!==i&&this.l.store("chatModelPickerPreferences",this.f,0,0),this.i.fire(r.vendor),this.k.trace(`[LM] Updated model picker preference for ${t} to ${i}`)}getVendors(){return Array.from(this.d.values()).filter(t=>{if(!t.when)return!0;const i=xt.deserialize(t.when);return i?this.h.contextMatchesRules(i):!1})}getLanguageModelIds(){return Array.from(this.c.keys())}lookupLanguageModel(t){const i=this.c.get(t);return i&&this.n.getValue("chat.experimentalShowAllModels")?{...i,isUserSelectable:!0}:i&&this.f[t]!==void 0?{...i,isUserSelectable:this.f[t]}:i}q(t){for(const[i,r]of this.c.entries())r.vendor===t&&this.c.delete(i)}async r(t,i){await this.j.activateByEvent(`onLanguageModelChatProvider:${t}`);const r=this.b.get(t);if(!r){this.k.warn(`[LM] No provider registered for vendor ${t}`);return}return this.e.queue(t,async()=>{try{let s=await r.provideLanguageModelChatInfo({silent:i},Fe.None);!i&&s.some(n=>n.metadata.isUserSelectable)&&(s=s.filter(n=>n.metadata.isUserSelectable||this.f[n.identifier]===!0)),this.q(t);for(const n of s){if(this.c.has(n.identifier)){this.k.warn(`[LM] Model ${n.identifier} is already registered. Skipping.`);continue}this.c.set(n.identifier,n.metadata)}this.k.trace(`[LM] Resolved language models for vendor ${t}`,s)}catch(s){this.k.error(`[LM] Error resolving language models for vendor ${t}:`,s)}this.i.fire(t)})}async selectLanguageModels(t,i){if(t.vendor)await this.r(t.vendor,!i);else{const s=Array.from(this.d.keys());await Promise.all(s.map(n=>this.r(n,!i)))}const r=[];for(const[s,n]of this.c)(t.vendor===void 0||n.vendor===t.vendor)&&(t.family===void 0||n.family===t.family)&&(t.version===void 0||n.version===t.version)&&(t.id===void 0||n.id===t.id)&&r.push(s);return this.k.trace("[LM] selected language models",t,r),r}registerLanguageModelProvider(t,i){if(this.k.trace("[LM] registering language model provider",t,i),!this.d.has(t))throw new Error(`Chat model provider uses UNKNOWN vendor ${t}.`);if(this.b.has(t))throw new Error(`Chat model provider for vendor ${t} is already registered.`);this.b.set(t,i),this.p(t)&&this.r(t,!0);const r=i.onDidChange(async()=>{await this.r(t,!0)});return te(()=>{this.k.trace("[LM] UNregistered language model provider",t),this.q(t),this.b.delete(t),r.dispose()})}async sendChatRequest(t,i,r,s,n){const o=this.b.get(this.c.get(t)?.vendor||"");if(!o)throw new Error(`Chat provider for model ${t} is not registered.`);return o.sendChatRequest(t,r,i,s,n)}computeTokenLength(t,i,r){const s=this.c.get(t);if(!s)throw new Error(`Chat model ${t} could not be found.`);const n=this.b.get(s.vendor);if(!n)throw new Error(`Chat provider for model ${t} is not registered.`);return n.provideTokenCount(t,i,r)}};rT=__decorate([__param(0,W6),__param(1,Se),__param(2,Ua),__param(3,Bn),__param(4,yi),__param(5,W3)],rT);function A1(e){return{content:[{kind:"text",value:e}]}}var sT="runSubagent",lQ=`Launch a new agent to handle complex, multi-step tasks autonomously. This tool is good at researching complex questions, searching for code, and executing multi-step tasks. When you are searching for a keyword or file and are not confident that you will find the right match in the first few tries, use this agent to perform the search for you.

- Agents do not run async or in the background, you will wait for the agent's result.
- When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.
- Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.
- The agent's outputs should generally be trusted
- Clearly tell the agent whether you expect it to write code or just to do research (search, file reads, web fetches, etc.), since it is not aware of the user's intent`,dS=class extends Q{constructor(t,i,r,s,n,o,a,c){super(),this.a=t,this.b=i,this.c=r,this.f=s,this.g=n,this.h=o,this.j=a,this.m=c,this.onDidUpdateToolData=Ie.filter(this.m.onDidChangeConfiguration,l=>l.affectsConfiguration(Qn.SubagentToolCustomAgents))}getToolData(){let t=lQ;const i={type:"object",properties:{prompt:{type:"string",description:"A detailed description of the task for the agent to perform"},description:{type:"string",description:"A short (3-5 word) description of the task"}},required:["prompt","description"]};return this.m.getValue(Qn.SubagentToolCustomAgents)&&(i.properties.agentName={type:"string",description:"Optional name of a specific agent to invoke. If not provided, uses the current agent."},t+=`
- If the user asks for a certain agent, you MUST provide that EXACT agent name (case-sensitive) to invoke that specific agent.`),{id:sT,toolReferenceName:dw.runSubagent,icon:Nt.fromId(oe.organization.id),displayName:d(6688,null),userDescription:d(6689,null),modelDescription:t,source:Xr.Internal,inputSchema:i}}async invoke(t,i,r,s){const n=t.parameters;if(this.h.debug(`RunSubagentTool: Invoking with prompt: ${n.prompt.substring(0,100)}...`),!t.context)throw new Error("toolInvocationToken is required for this tool");const o=this.b.getSession(t.context.sessionResource);if(!o)throw new Error("Chat model not found for session");const a=o.getRequests().at(-1);try{const c=this.a.getDefaultAgent(li.Chat,Dr.Agent);if(!c)return A1("Error: No default agent available");let l=t.modelId,u=t.userSelectedTools,h;if(n.agentName){const S=this.c.findModeByName(n.agentName);if(S){const E=S.model?.get();if(E){const O=this.g.getLanguageModelIds();for(const J of O){const F=this.g.lookupLanguageModel(J);if(F&&hS.matchesQualifiedName(E,F)){l=J;break}}}const $=S.customTools?.get();if($){const O=this.f.toToolAndToolSetEnablementMap($,S.target?.get());u={};for(const[J,F]of O)J instanceof gH||(u[J.id]=F)}const U=S.modeInstructions?.get();h=U&&{name:S.name.get(),content:U.content,toolReferences:this.j.toToolReferences(U.toolReferences),metadata:U.metadata}}else this.h.warn(`RunSubagentTool: Agent '${n.agentName}' not found, using current configuration`)}const f=[];let p=!1;const g=S=>{for(const E of S)E.kind==="prepareToolInvocation"||E.kind==="textEdit"||E.kind==="notebookEdit"||E.kind==="codeblockUri"?(E.kind==="codeblockUri"&&!p&&(p=!0,o.acceptResponseProgress(a,{kind:"markdownContent",content:new qn("```\n"),fromSubagent:!0})),o.acceptResponseProgress(a,E),E.kind==="prepareToolInvocation"&&(f.length=0)):E.kind==="markdownContent"&&(p&&(o.acceptResponseProgress(a,{kind:"markdownContent",content:new qn("\n```\n\n"),fromSubagent:!0}),p=!1),f.push(E.content.value))};u&&(u[sT]=!1,u[d3]=!1);const v={sessionResource:t.context.sessionResource,requestId:t.callId??`subagent-${Date.now()}`,agentId:c.id,message:n.prompt,variables:{variables:[]},location:li.Chat,isSubagent:!0,userSelectedModelId:l,userSelectedTools:u,modeInstructions:h},b=await this.a.invokeAgent(c.id,v,g,[],s);return b.errorDetails?A1(`Agent error: ${b.errorDetails.message}`):A1(f.join("")||"Agent completed with no output")}catch(c){const l=`Error invoking subagent: ${c instanceof Error?c.message:"Unknown error"}`;return this.h.error(l,c),A1(l)}}async prepareToolInvocation(t,i){return{invocationMessage:t.parameters.description}}};dS=__decorate([__param(0,q3),__param(1,kP),__param(2,iQ),__param(3,uw),__param(4,aQ),__param(5,Se),__param(6,uw),__param(7,yi)],dS);var nT=class extends Q{static{this.ID="chat.builtinTools"}constructor(t,i,r){super(),this.a=r;const s=i.createInstance(Y4);this.D(t.registerTool(EJ,s));const n=this.a.getValue(RJ)===!0,o=this.a.getValue(LJ)!==!1,a=f3(n,o),c=this.D(i.createInstance(eS,n,o));this.D(t.registerTool(a,c));const l=i.createInstance(CJ);this.D(t.registerTool(kJ,l));const u=this.D(i.createInstance(dS)),h=this.D(t.createToolSet(Xr.Internal,"custom-agent",hw.agent,{icon:Nt.fromId(oe.agent.id),description:d(6690,null)}));let f,p;const g=()=>{f?.dispose(),p?.dispose();const v=u.getToolData();f=t.registerTool(v,u),p=h.addTool(v)};g(),this.D(u.onDidUpdateToolData(g)),this.D({dispose:()=>{f?.dispose(),p?.dispose()}})}};nT=__decorate([__param(0,uw),__param(1,dc),__param(2,yi)],nT);var uQ="vscode_fetchWebPage_internal",oT=H("commandService"),fS=new class{constructor(){this.a=new Map,this.b=new I,this.onDidRegisterCommand=this.b.event}registerCommand(e,t){if(!e)throw new Error("invalid command");if(typeof e=="string"){if(!t)throw new Error("invalid command");return this.registerCommand({id:e,handler:t})}if(e.metadata&&Array.isArray(e.metadata.args)){const o=[];for(const c of e.metadata.args)o.push(c.constraint);const a=e.handler;e.handler=function(c,...l){return iL(l,o),a(c,...l)}}const{id:i}=e;let r=this.a.get(i);r||(r=new Dn,this.a.set(i,r));const s=r.unshift(e),n=te(()=>{s(),this.a.get(i)?.isEmpty()&&this.a.delete(i)});return this.b.fire(i),Av(n)}registerCommandAlias(e,t){return fS.registerCommand(e,(i,...r)=>i.get(oT).executeCommand(t,...r))}getCommand(e){const t=this.a.get(e);if(!(!t||t.isEmpty()))return Wt.first(t)}getCommands(){const e=new Map;for(const t of this.a.keys()){const i=this.getCommand(t);i&&e.set(t,i)}return e}};fS.registerCommand("noop",()=>{});var aT;(function(e){e[e.CtrlCmd=2048]="CtrlCmd",e[e.Shift=1024]="Shift",e[e.Alt=512]="Alt",e[e.WinCtrl=256]="WinCtrl",e[e.KeyCode=255]="KeyCode"})(aT||(aT={}));function cT(e,t){if(typeof e=="number"){if(e===0)return null;const i=(e&65535)>>>0,r=(e&4294901760)>>>16;return r!==0?new E1([S1(i,t),S1(r,t)]):new E1([S1(i,t)])}else{const i=[];for(let r=0;r<e.length;r++)i.push(S1(e[r],t));return new E1(i)}}function S1(e,t){const i=!!(e&2048),r=!!(e&256),s=t===2?r:i,n=!!(e&1024),o=!!(e&512),a=t===2?i:r,c=e&255;return new hQ(s,n,o,a,c)}var hQ=class jN{constructor(t,i,r,s,n){this.ctrlKey=t,this.shiftKey=i,this.altKey=r,this.metaKey=s,this.keyCode=n}equals(t){return t instanceof jN&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){const t=this.ctrlKey?"1":"0",i=this.shiftKey?"1":"0",r=this.altKey?"1":"0",s=this.metaKey?"1":"0";return`K${t}${i}${r}${s}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new E1([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},E1=class{constructor(e){if(e.length===0)throw $e("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}},lT;(function(e){e[e.EditorCore=0]="EditorCore",e[e.EditorContrib=100]="EditorContrib",e[e.WorkbenchContrib=200]="WorkbenchContrib",e[e.BuiltinExtension=300]="BuiltinExtension",e[e.ExternalExtension=400]="ExternalExtension"})(lT||(lT={}));var dQ=class zN{constructor(){this.c=new Dn,this.d=[],this.e=null}static f(t){if(Lo===1){if(t&&t.win)return t.win}else if(Lo===2){if(t&&t.mac)return t.mac}else if(t&&t.linux)return t.linux;return t}registerKeybindingRule(t){const i=zN.f(t),r=new ie;if(i&&i.primary){const s=cT(i.primary,Lo);s&&r.add(this.g(s,t.id,t.args,t.weight,0,t.when))}if(i&&Array.isArray(i.secondary))for(let s=0,n=i.secondary.length;s<n;s++){const o=i.secondary[s],a=cT(o,Lo);a&&r.add(this.g(a,t.id,t.args,t.weight,-s-1,t.when))}return r}setExtensionKeybindings(t){const i=[];let r=0;for(const s of t)s.keybinding&&(i[r++]={keybinding:s.keybinding,command:s.id,commandArgs:s.args,when:s.when,weight1:s.weight,weight2:0,extensionId:s.extensionId||null,isBuiltinExtension:s.isBuiltinExtension||!1});this.d=i,this.e=null}registerCommandAndKeybindingRule(t){return Sv(this.registerKeybindingRule(t),fS.registerCommand(t))}g(t,i,r,s,n,o){const a=this.c.push({keybinding:t,command:i,commandArgs:r,when:o,weight1:s,weight2:n,extensionId:null,isBuiltinExtension:!1});return this.e=null,te(()=>{a(),this.e=null})}getDefaultKeybindings(){return this.e||(this.e=Array.from(this.c).concat(this.d),this.e.sort(gQ)),this.e.slice(0)}},fQ=new dQ,pQ={EditorModes:"platform.keybindingsRegistry"};Zt.add(pQ.EditorModes,fQ);function gQ(e,t){if(e.weight1!==t.weight1)return e.weight1-t.weight1;if(e.command&&t.command){if(e.command<t.command)return-1;if(e.command>t.command)return 1}return e.weight2-t.weight2}var x1;function mQ(e){return e.command!==void 0}var pd=class D{static{this.a=new Map}static{this.CommandPalette=new D("CommandPalette")}static{this.DebugBreakpointsContext=new D("DebugBreakpointsContext")}static{this.DebugCallStackContext=new D("DebugCallStackContext")}static{this.DebugConsoleContext=new D("DebugConsoleContext")}static{this.DebugVariablesContext=new D("DebugVariablesContext")}static{this.NotebookVariablesContext=new D("NotebookVariablesContext")}static{this.DebugHoverContext=new D("DebugHoverContext")}static{this.DebugWatchContext=new D("DebugWatchContext")}static{this.DebugToolBar=new D("DebugToolBar")}static{this.DebugToolBarStop=new D("DebugToolBarStop")}static{this.DebugDisassemblyContext=new D("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new D("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new D("DebugCreateConfiguration")}static{this.DebugScopesContext=new D("DebugScopesContext")}static{this.EditorContext=new D("EditorContext")}static{this.SimpleEditorContext=new D("SimpleEditorContext")}static{this.EditorContent=new D("EditorContent")}static{this.EditorLineNumberContext=new D("EditorLineNumberContext")}static{this.EditorContextCopy=new D("EditorContextCopy")}static{this.EditorContextPeek=new D("EditorContextPeek")}static{this.EditorContextShare=new D("EditorContextShare")}static{this.EditorTitle=new D("EditorTitle")}static{this.CompactWindowEditorTitle=new D("CompactWindowEditorTitle")}static{this.EditorTitleRun=new D("EditorTitleRun")}static{this.EditorTitleContext=new D("EditorTitleContext")}static{this.EditorTitleContextShare=new D("EditorTitleContextShare")}static{this.EmptyEditorGroup=new D("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new D("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new D("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new D("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new D("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new D("EditorActionsPositionSubmenu")}static{this.EditorSplitMoveSubmenu=new D("EditorSplitMoveSubmenu")}static{this.ExplorerContext=new D("ExplorerContext")}static{this.ExplorerContextShare=new D("ExplorerContextShare")}static{this.ExtensionContext=new D("ExtensionContext")}static{this.ExtensionEditorContextMenu=new D("ExtensionEditorContextMenu")}static{this.GlobalActivity=new D("GlobalActivity")}static{this.CommandCenter=new D("CommandCenter")}static{this.CommandCenterCenter=new D("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new D("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new D("LayoutControlMenu")}static{this.MenubarMainMenu=new D("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new D("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new D("MenubarDebugMenu")}static{this.MenubarEditMenu=new D("MenubarEditMenu")}static{this.MenubarCopy=new D("MenubarCopy")}static{this.MenubarFileMenu=new D("MenubarFileMenu")}static{this.MenubarGoMenu=new D("MenubarGoMenu")}static{this.MenubarHelpMenu=new D("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new D("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new D("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new D("PanelAlignmentMenu")}static{this.PanelPositionMenu=new D("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new D("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new D("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new D("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new D("MenubarSelectionMenu")}static{this.MenubarShare=new D("MenubarShare")}static{this.MenubarSwitchEditorMenu=new D("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new D("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new D("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new D("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new D("MenubarViewMenu")}static{this.MenubarHomeMenu=new D("MenubarHomeMenu")}static{this.OpenEditorsContext=new D("OpenEditorsContext")}static{this.OpenEditorsContextShare=new D("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new D("ProblemsPanelContext")}static{this.SCMInputBox=new D("SCMInputBox")}static{this.SCMChangeContext=new D("SCMChangeContext")}static{this.SCMResourceContext=new D("SCMResourceContext")}static{this.SCMResourceContextShare=new D("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new D("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new D("SCMResourceGroupContext")}static{this.SCMSourceControl=new D("SCMSourceControl")}static{this.SCMSourceControlInline=new D("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new D("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new D("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new D("SCMHistoryItemContext")}static{this.SCMHistoryItemChangeContext=new D("SCMHistoryItemChangeContext")}static{this.SCMHistoryItemRefContext=new D("SCMHistoryItemRefContext")}static{this.SCMArtifactGroupContext=new D("SCMArtifactGroupContext")}static{this.SCMArtifactContext=new D("SCMArtifactContext")}static{this.SCMQuickDiffDecorations=new D("SCMQuickDiffDecorations")}static{this.SCMTitle=new D("SCMTitle")}static{this.SearchContext=new D("SearchContext")}static{this.SearchActionMenu=new D("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new D("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new D("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new D("StickyScrollContext")}static{this.TestItem=new D("TestItem")}static{this.TestItemGutter=new D("TestItemGutter")}static{this.TestProfilesContext=new D("TestProfilesContext")}static{this.TestMessageContext=new D("TestMessageContext")}static{this.TestMessageContent=new D("TestMessageContent")}static{this.TestPeekElement=new D("TestPeekElement")}static{this.TestPeekTitle=new D("TestPeekTitle")}static{this.TestCallStack=new D("TestCallStack")}static{this.TestCoverageFilterItem=new D("TestCoverageFilterItem")}static{this.TouchBarContext=new D("TouchBarContext")}static{this.TitleBar=new D("TitleBar")}static{this.TitleBarContext=new D("TitleBarContext")}static{this.TitleBarTitleContext=new D("TitleBarTitleContext")}static{this.TunnelContext=new D("TunnelContext")}static{this.TunnelPrivacy=new D("TunnelPrivacy")}static{this.TunnelProtocol=new D("TunnelProtocol")}static{this.TunnelPortInline=new D("TunnelInline")}static{this.TunnelTitle=new D("TunnelTitle")}static{this.TunnelLocalAddressInline=new D("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new D("TunnelOriginInline")}static{this.ViewItemContext=new D("ViewItemContext")}static{this.ViewContainerTitle=new D("ViewContainerTitle")}static{this.ViewContainerTitleContext=new D("ViewContainerTitleContext")}static{this.ViewTitle=new D("ViewTitle")}static{this.ViewTitleContext=new D("ViewTitleContext")}static{this.CommentEditorActions=new D("CommentEditorActions")}static{this.CommentThreadTitle=new D("CommentThreadTitle")}static{this.CommentThreadActions=new D("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new D("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new D("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new D("CommentThreadCommentContext")}static{this.CommentTitle=new D("CommentTitle")}static{this.CommentActions=new D("CommentActions")}static{this.CommentsViewThreadActions=new D("CommentsViewThreadActions")}static{this.InteractiveToolbar=new D("InteractiveToolbar")}static{this.InteractiveCellTitle=new D("InteractiveCellTitle")}static{this.InteractiveCellDelete=new D("InteractiveCellDelete")}static{this.InteractiveCellExecute=new D("InteractiveCellExecute")}static{this.InteractiveInputExecute=new D("InteractiveInputExecute")}static{this.InteractiveInputConfig=new D("InteractiveInputConfig")}static{this.ReplInputExecute=new D("ReplInputExecute")}static{this.IssueReporter=new D("IssueReporter")}static{this.NotebookToolbar=new D("NotebookToolbar")}static{this.NotebookToolbarContext=new D("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new D("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new D("NotebookCellTitle")}static{this.NotebookCellDelete=new D("NotebookCellDelete")}static{this.NotebookCellInsert=new D("NotebookCellInsert")}static{this.NotebookCellBetween=new D("NotebookCellBetween")}static{this.NotebookCellListTop=new D("NotebookCellTop")}static{this.NotebookCellExecute=new D("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new D("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new D("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new D("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new D("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new D("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new D("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new D("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new D("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new D("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new D("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new D("NotebookKernelSource")}static{this.BulkEditTitle=new D("BulkEditTitle")}static{this.BulkEditContext=new D("BulkEditContext")}static{this.TimelineItemContext=new D("TimelineItemContext")}static{this.TimelineTitle=new D("TimelineTitle")}static{this.TimelineTitleContext=new D("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new D("TimelineFilterSubMenu")}static{this.AccountsContext=new D("AccountsContext")}static{this.SidebarTitle=new D("SidebarTitle")}static{this.PanelTitle=new D("PanelTitle")}static{this.AuxiliaryBarTitle=new D("AuxiliaryBarTitle")}static{this.TerminalInstanceContext=new D("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new D("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new D("TerminalNewDropdownContext")}static{this.TerminalTabContext=new D("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new D("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new D("TerminalStickyScrollContext")}static{this.WebviewContext=new D("WebviewContext")}static{this.InlineCompletionsActions=new D("InlineCompletionsActions")}static{this.InlineEditsActions=new D("InlineEditsActions")}static{this.NewFile=new D("NewFile")}static{this.MergeInput1Toolbar=new D("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new D("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new D("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new D("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new D("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new D("InlineEditToolbar")}static{this.ChatContext=new D("ChatContext")}static{this.ChatCodeBlock=new D("ChatCodeblock")}static{this.ChatCompareBlock=new D("ChatCompareBlock")}static{this.ChatMessageTitle=new D("ChatMessageTitle")}static{this.ChatWelcomeContext=new D("ChatWelcomeContext")}static{this.ChatMessageFooter=new D("ChatMessageFooter")}static{this.ChatExecute=new D("ChatExecute")}static{this.ChatInput=new D("ChatInput")}static{this.ChatInputSide=new D("ChatInputSide")}static{this.ChatModePicker=new D("ChatModePicker")}static{this.ChatEditingWidgetToolbar=new D("ChatEditingWidgetToolbar")}static{this.ChatEditingSessionChangesToolbar=new D("ChatEditingSessionChangesToolbar")}static{this.ChatEditingEditorContent=new D("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new D("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new D("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new D("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new D("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new D("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new D("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new D("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new D("ChatInlineSymbolAnchorContext")}static{this.ChatMessageCheckpoint=new D("ChatMessageCheckpoint")}static{this.ChatMessageRestoreCheckpoint=new D("ChatMessageRestoreCheckpoint")}static{this.ChatNewMenu=new D("ChatNewMenu")}static{this.ChatEditingCodeBlockContext=new D("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new D("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new D("ChatAttachmentsContext")}static{this.ChatToolOutputResourceToolbar=new D("ChatToolOutputResourceToolbar")}static{this.ChatTextEditorMenu=new D("ChatTextEditorMenu")}static{this.ChatToolOutputResourceContext=new D("ChatToolOutputResourceContext")}static{this.ChatMultiDiffContext=new D("ChatMultiDiffContext")}static{this.ChatConfirmationMenu=new D("ChatConfirmationMenu")}static{this.ChatEditorInlineExecute=new D("ChatEditorInputExecute")}static{this.ChatEditorInlineInputSide=new D("ChatEditorInputSide")}static{this.AccessibleView=new D("AccessibleView")}static{this.MultiDiffEditorContent=new D("MultiDiffEditorContent")}static{this.MultiDiffEditorFileToolbar=new D("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new D("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new D("DiffEditorSelectionToolbar")}static{this.AgentSessionsViewerFilterSubMenu=new D("AgentSessionsViewerFilterSubMenu")}static{this.AgentSessionsInstallMenu=new D("AgentSessionsInstallMenu")}static{this.AgentSessionsContext=new D("AgentSessionsContext")}static{this.AgentSessionsCreateSubMenu=new D("AgentSessionsCreateSubMenu")}static{this.AgentSessionsToolbar=new D("AgentSessionsToolbar")}static{this.AgentSessionItemToolbar=new D("AgentSessionItemToolbar")}static{this.ChatViewSessionTitleNavigationToolbar=new D("ChatViewSessionTitleNavigationToolbar")}static{this.ChatViewSessionTitleToolbar=new D("ChatViewSessionTitleToolbar")}static{this.AgentSessionsViewTitle=new D("AgentSessionsViewTitle")}static{this.AgentSessionsFilterSubMenu=new D("AgentSessionsFilterSubMenu")}static for(t){return D.a.get(t)??new D(t)}constructor(t){if(D.a.has(t))throw new TypeError(`MenuId with identifier '${t}' already exists. Use MenuId.for(ident) or a unique identifier`);D.a.set(t,this),this.id=t}},Jce=H("menuService"),gd=class R5{static{this.a=new Map}static for(t){let i=this.a.get(t);return i||(i=new R5(t),this.a.set(t,i)),i}static merge(t){const i=new Set;for(const r of t)r instanceof R5&&i.add(r.b);return i}constructor(t){this.b=t,this.has=i=>i===t}},Qce=new class{constructor(){this.a=new Map,this.b=new Map,this.c=new bL({merge:gd.merge}),this.onDidChangeMenu=this.c.event}addCommand(e){return this.a.set(e.id,e),this.c.fire(gd.for(pd.CommandPalette)),Av(te(()=>{this.a.delete(e.id)&&this.c.fire(gd.for(pd.CommandPalette))}))}getCommand(e){return this.a.get(e)}getCommands(){const e=new Map;return this.a.forEach((t,i)=>e.set(i,t)),e}appendMenuItem(e,t){let i=this.b.get(e);i||(i=new Dn,this.b.set(e,i));const r=i.push(t);return this.c.fire(gd.for(e)),Av(te(()=>{r(),this.c.fire(gd.for(e))}))}appendMenuItems(e){const t=new ie;for(const{id:i,item:r}of e)t.add(this.appendMenuItem(i,r));return t}getMenuItems(e){let t;return this.b.has(e)?t=[...this.b.get(e)]:t=[],e===pd.CommandPalette&&this.d(t),t}d(e){const t=new Set;for(const i of e)mQ(i)&&(t.add(i.command.id),i.alt&&t.add(i.alt.id));this.a.forEach((i,r)=>{t.has(r)||e.push({command:i})})}},uT=x1=class{static label(t,i){return i?.renderShortTitle&&t.shortTitle?typeof t.shortTitle=="string"?t.shortTitle:t.shortTitle.value:typeof t.title=="string"?t.title:t.title.value}constructor(t,i,r,s,n,o,a){this.hideActions=s,this.menuKeybinding=n,this.b=a,this.id=t.id,this.label=x1.label(t,r),this.tooltip=(typeof t.tooltip=="string"?t.tooltip:t.tooltip?.value)??"",this.enabled=!t.precondition||o.contextMatchesRules(t.precondition),this.checked=void 0;let c;if(t.toggled){const l=t.toggled.condition?t.toggled:{condition:t.toggled};this.checked=o.contextMatchesRules(l.condition),this.checked&&l.tooltip&&(this.tooltip=typeof l.tooltip=="string"?l.tooltip:l.tooltip.value),this.checked&&Nt.isThemeIcon(l.icon)&&(c=l.icon),this.checked&&l.title&&(this.label=typeof l.title=="string"?l.title:l.title.value)}c||(c=Nt.isThemeIcon(t.icon)?t.icon:void 0),this.item=t,this.alt=i?new x1(i,void 0,r,s,void 0,o,a):void 0,this.a=r,this.class=c&&Nt.asClassName(c)}run(...t){let i=[];return this.a?.arg&&(i=[...i,this.a.arg]),this.a?.shouldForwardArgs&&(i=[...i,...t]),this.b.executeCommand(this.id,...i)}};uT=x1=__decorate([__param(5,Bn),__param(6,oT)],uT);var Xce=Gd(8633,"Extensions"),hT;(function(e){e[e.Installing=0]="Installing",e[e.Installed=1]="Installed",e[e.Uninstalling=2]="Uninstalling",e[e.Uninstalled=3]="Uninstalled"})(hT||(hT={}));var dT;(function(e){e.ReloadWindow="reloadWindow",e.RestartExtensions="restartExtensions",e.DownloadUpdate="downloadUpdate",e.ApplyUpdate="applyUpdate",e.QuitAndInstall="quitAndInstall"})(dT||(dT={}));var fT=H("extensionsWorkbenchService"),pT;(function(e){e.Readme="readme",e.Features="features",e.Changelog="changelog",e.Dependencies="dependencies",e.ExtensionPack="extensionPack"})(pT||(pT={}));var gT=class extends Q{constructor(t,i){super(),this.a=t,this.D(i.onChange(this.b,this))}set extension(t){this.a.forEach(i=>i.extension=t)}b(t){for(const i of this.a)t&&i.extension?mW(i.extension.identifier,t.identifier)&&(i.extension.server&&t.server&&i.extension.server!==t.server?i.updateWhenCounterExtensionChanges&&i.update():i.extension=t):i.update()}};gT=__decorate([__param(1,fT)],gT);var ele=new k("defaultExtensionViews",!0),tle=new k("hasOutdatedExtensions",!1),ile=new k("hasGallery",!1),rle=new k("extensionsGalleryStatus","unavailable"),sle=new k("extensionResultListFocused ",!0),nle=new k("searchMcpServers",!1),ole=new pd("extensionsSearchActionsMenu"),ale=new pd("extensionsFilterSubMenu"),mT="vscode_searchExtensions_internal",cle={id:mT,toolReferenceName:"extensions",legacyToolReferenceFullNames:["extensions"],icon:Nt.fromId(oe.extensions.id),displayName:d(8653,null),modelDescription:"This is a tool for browsing Visual Studio Code Extensions Marketplace. It allows the model to search for extensions and retrieve detailed information about them. The model should use this tool whenever it needs to discover extensions or resolve information about known ones. To use the tool, the model has to provide the category of the extensions, relevant search keywords, or known extension IDs. Note that search results may include false positives, so reviewing and filtering is recommended.",userDescription:d(8654,null),source:Xr.Internal,inputSchema:{type:"object",properties:{category:{type:"string",description:"The category of extensions to search for",enum:Hk},keywords:{type:"array",items:{type:"string"},description:"The keywords to search for"},ids:{type:"array",items:{type:"string"},description:"The ids of the extensions to search for"}}}},vT=class{constructor(t){this.a=t}async invoke(t,i,r,s){const n=t.parameters;if(!n.keywords?.length&&!n.category&&!n.ids?.length)return{content:[{kind:"text",value:d(8655,null)}]};const o=new Map,a=u=>{for(const h of u)h.deprecationInfo||h.isMalicious||o.set(h.identifier.id.toLowerCase(),{id:h.identifier.id,name:h.displayName,description:h.description,installed:h.state===1,installCount:h.installCount??0,rating:h.rating??0,categories:h.categories??[],tags:h.gallery?.tags??[]})},c=async u=>{const h=await this.a.queryGallery({text:u,pageSize:10,sortBy:"InstallCount"},s);h.firstPage.length&&a(h.firstPage)};if(n.ids?.length){const u=await this.a.getExtensions(n.ids.map(h=>({id:h})),s);a(u)}if(n.keywords?.length)for(const u of n.keywords??[])if(u==="featured")await c("featured");else{let h=n.category?`category:"${n.category}"`:"";h=u?`${h} ${u}`.trim():h,await c(h)}else await c(`category:"${n.category}"`);const l=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(l)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(n),output:[{type:"embed",isText:!0,value:JSON.stringify(l.map(u=>u.id))}]}}}};vT=__decorate([__param(0,fT)],vT);var wT=class{constructor(e){this.b=new Pt(()=>{const t=this;return Object.freeze({get name(){return t.a.id},get description(){return t.a.modelDescription},get inputSchema(){return t.a.inputSchema},get tags(){return t.a.tags??[]},get source(){}})}),this.c=new Pt(()=>{const t=this,i=Ty.to(t.a.source);return Object.freeze({get name(){return t.a.id},get description(){return t.a.modelDescription},get inputSchema(){return t.a.inputSchema},get tags(){return t.a.tags??[]},get source(){return i}})}),this.a=e}update(e){this.a=e}get data(){return this.a}get apiObject(){return this.b.value}get apiObjectWithChatParticipantAdditions(){return this.c.value}},vQ=class{constructor(e,t){this.e=t,this.a=new Map,this.c=new Map,this.d=new Map,this.b=e.getProxy(X.MainThreadLanguageModelTools),this.b.$getTools().then(i=>{for(const r of i)this.d.set(r.id,new wT(Gt(r)))})}async $countTokensForInvocation(e,t,i){const r=this.c.get(e);if(!r)throw new Error(`Tool invocation call ${e} not found`);return await r(t,i)}async invokeTool(e,t,i,r){const s=Tt();i.tokenizationOptions&&this.c.set(s,i.tokenizationOptions.countTokens);try{if(i.toolInvocationToken&&!pH(i.toolInvocationToken))throw new Error("Invalid tool invocation token");if((t===Q4||t===n3)&&!et(e,"chatParticipantPrivate"))throw new Error(`Invalid tool: ${t}`);const n=await this.b.$invokeTool({toolId:t,callId:s,parameters:i.input,tokenBudget:i.tokenizationOptions?.tokenBudget,context:i.toolInvocationToken,chatRequestId:et(e,"chatParticipantPrivate")?i.chatRequestId:void 0,chatInteractionId:et(e,"chatParticipantPrivate")?i.chatInteractionId:void 0,fromSubAgent:et(e,"chatParticipantPrivate")?i.fromSubAgent:void 0},r),o=n instanceof fi?n.value:n;return Qg.to(Gt(o))}finally{this.c.delete(s)}}$onDidChangeTools(e){const t=new Set(this.a.keys());for(const i of e){t.delete(i.id);const r=this.d.get(i.id);r?r.update(i):this.d.set(i.id,new wT(Gt(i)))}for(const i of t)this.d.delete(i)}getTools(e){const t=et(e,"chatParticipantPrivate");return Array.from(this.d.values()).map(i=>t?i.apiObjectWithChatParticipantAdditions:i.apiObject).filter(i=>{switch(i.name){case Q4:case n3:case uQ:case mT:return et(e,"chatParticipantPrivate");default:return!0}})}async $invokeTool(e,t){const i=this.a.get(e.toolId);if(!i)throw new Error(`Unknown tool ${e.toolId}`);const r={input:e.parameters,toolInvocationToken:Gt(e.context)};et(i.extension,"chatParticipantPrivate")&&(r.chatRequestId=e.chatRequestId,r.chatInteractionId=e.chatInteractionId,r.chatSessionId=e.context?.sessionId,r.fromSubAgent=e.fromSubAgent),et(i.extension,"chatParticipantAdditions")&&e.modelId&&(r.model=await this.f(e.modelId,i.extension)),e.tokenBudget!==void 0&&(r.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this.c.get(e.callId)||((o,a=Fe.None)=>this.b.$countTokensForInvocation(e.callId,o,a))});let s;if(et(i.extension,"toolProgress")){let o;s={report:a=>{a.increment!==void 0&&(o=(o??0)+a.increment),this.b.$acceptToolProgress(e.callId,{message:ge.fromStrict(a.message),progress:o===void 0?void 0:o/100})}}}const n=await B2(Promise.resolve(i.tool.invoke(r,t,s)),t);if(!n)throw new dt;return Qg.from(n,i.extension)}async f(e,t){let i;if(e&&(i=await this.e.getLanguageModelByIdentifier(t,e)),!i&&(i=await this.e.getDefaultLanguageModel(t),!i))throw new Error("Language model unavailable");return i}async $prepareToolInvocation(e,t,i){const r=this.a.get(e);if(!r)throw new Error(`Unknown tool ${e}`);const s={input:t.parameters,chatRequestId:t.chatRequestId,chatSessionId:t.chatSessionId,chatInteractionId:t.chatInteractionId};if(r.tool.prepareInvocation){const n=await r.tool.prepareInvocation(s,i);return n?((n.pastTenseMessage||n.presentation)&&T(r.extension,"chatParticipantPrivate"),{confirmationMessages:n.confirmationMessages?{title:typeof n.confirmationMessages.title=="string"?n.confirmationMessages.title:ge.from(n.confirmationMessages.title),message:typeof n.confirmationMessages.message=="string"?n.confirmationMessages.message:ge.from(n.confirmationMessages.message)}:void 0,invocationMessage:ge.fromStrict(n.invocationMessage),pastTenseMessage:ge.fromStrict(n.pastTenseMessage),presentation:n.presentation}):void 0}}registerTool(e,t,i){return this.a.set(t,{extension:e,tool:i}),this.b.$registerTool(t),te(()=>{this.a.delete(t),this.b.$unregisterTool(t)})}},wQ=class{constructor(e,t,i,r){this.c=t,this.d=i,this.e=r,this.b=[],this.f=0,this.g=new Set,this.a=e.getProxy(X.MainThreadLanguages)}$acceptLanguageIds(e){this.b=e}async getLanguages(){return this.b.slice(0)}async changeLanguage(e,t){await this.a.$changeLanguage(e,t);const i=this.c.getDocumentData(e);if(!i)throw new Error(`document '${e.toString()}' NOT found`);return i.document}async tokenAtPosition(e,t){const i=e.version,r=Xe.from(t),s=await this.a.$tokensAtPosition(e.uri,r),n={type:uo.Other,range:e.getWordRangeAtPosition(t)??new xe(t.line,t.character,t.line,t.character)};if(!s)return n;const o={range:j.to(s.range),type:qb.to(s.type)};return!o.range.contains(t)||i!==e.version?n:o}createLanguageStatusItem(e,t,i){const r=this.f++,s=this.a,n=this.g,o=`${e.identifier.value}/${t}`;if(n.has(o))throw new Error(`LanguageStatusItem with id '${t}' ALREADY exists`);n.add(o);const a={selector:i,id:t,name:e.displayName??e.name,severity:Dc.Information,command:void 0,text:"",detail:"",busy:!1};let c;const l=new ie,u=()=>{if(c?.dispose(),!n.has(o)){console.warn(`LanguageStatusItem (${t}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=Hv(()=>{l.clear(),this.a.$setLanguageStatus(r,{id:o,name:a.name??e.displayName??e.name,source:e.displayName??e.name,selector:Sa.from(a.selector,this.e),label:a.text,detail:a.detail??"",severity:a.severity===Dc.Error?Mt.Error:a.severity===Dc.Warning?Mt.Warning:Mt.Info,command:a.command&&this.d.toInternal(a.command,l),accessibilityInfo:a.accessibilityInformation,busy:a.busy})},0)},h={dispose(){l.dispose(),c?.dispose(),s.$removeLanguageStatus(r),n.delete(o)},get id(){return a.id},get name(){return a.name},set name(f){a.name=f,u()},get selector(){return a.selector},set selector(f){a.selector=f,u()},get text(){return a.text},set text(f){a.text=f,u()},set text2(f){T(e,"languageStatusText"),a.text=f,u()},get text2(){return T(e,"languageStatusText"),a.text},get detail(){return a.detail},set detail(f){a.detail=f,u()},get severity(){return a.severity},set severity(f){a.severity=f,u()},get accessibilityInformation(){return a.accessibilityInformation},set accessibilityInformation(f){a.accessibilityInformation=f,u()},get command(){return a.command},set command(f){a.command=f,u()},get busy(){return a.busy},set busy(f){a.busy=f,u()}};return u(),h}};function bQ(e){return e&&e.title}var pS=class{constructor(t,i){this.b=i,this.a=t.getProxy(X.MainThreadMessageService)}showMessage(t,i,r,s,n){const o={source:{identifier:t.identifier,label:t.displayName||t.name}};let a;typeof s=="string"||bQ(s)?a=[s,...n]:(o.modal=s?.modal,o.useCustom=s?.useCustom,o.detail=s?.detail,a=n),o.useCustom&&T(t,"resolvers");const c=[];let l=!1;for(let u=0;u<a.length;u++){const h=a[u];if(typeof h=="string")c.push({title:h,handle:u,isCloseAffordance:!1});else if(typeof h=="object"){const{title:f,isCloseAffordance:p}=h;c.push({title:f,isCloseAffordance:!!p,handle:u}),p&&(l?this.b.warn(`[${t.identifier}] Only one message item can have 'isCloseAffordance':`,h):l=!0)}else this.b.warn(`[${t.identifier}] Invalid message item:`,h)}return this.a.$showMessage(i,r,o,c).then(u=>{if(typeof u=="number")return a[u]})}};pS=__decorate([__param(1,Se)],pS);var gS=class{constructor(e,t,i,r){this.start=e,this.deletedCount=t,this.deletedItems=i,this.items=r}asApiEvent(){return{range:new ks(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}},mS=class{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:!1,versionId:1,encoding:"utf8"}}constructor(e,t,i){this.notebook=e,this.h=t,this.j=i,this.handle=i.handle,this.uri=y.revive(i.uri),this.cellKind=i.cellKind,this.a=i.outputs.map(fo.to),this.e=i.internalMetadata??{},this.b=Object.freeze(i.metadata??{}),this.d=Object.freeze(ol.to(i.internalMetadata??{}))}get internalMetadata(){return this.e}get apiCell(){if(!this.f){const e=this,t=this.h.getDocument(this.uri);if(!t)throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);const i={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Eh.to(this.j.cellKind),document:t.document,get mime(){return e.g},set mime(r){e.g=r},get outputs(){return e.a.slice(0)},get metadata(){return e.b},get executionSummary(){return e.d}};this.f=Object.freeze(i)}return this.f}setOutputs(e){this.a=e.map(fo.to)}setOutputItems(e,t,i){const r=i.map(cl.to),s=this.a.find(n=>n.id===e);if(s&&(t||(s.items.length=0),s.items.push(...r),s.items.length>1&&s.items.every(n=>ZC(n.mime)))){const n=new Map,o=[];s.items.forEach(a=>{let c;n.has(a.mime)?c=n.get(a.mime):(c=[],n.set(a.mime,c),o.push(a.mime)),c.push(a.data)}),s.items.length=0,o.forEach(a=>{const c=jH(n.get(a));s.items.push({mime:a,data:c.data.buffer})})}}setMetadata(e){this.b=Object.freeze(e)}setInternalMetadata(e){this.e=e,this.d=Object.freeze(ol.to(e))}setMime(e){}},yQ=class HN{static{this.a=0}constructor(t,i,r,s,n){this.k=t,this.l=i,this.m=r,this.uri=s,this.handle=HN.a++,this.b=[],this.g=0,this.h=!1,this.j=!1,this.d=n.viewType,this.f=Object.freeze(n.metadata??Object.create(null)),this.r([[0,0,n.cells]],!0,void 0),this.g=n.versionId}dispose(){this.j=!0}get versionId(){return this.g}get apiNotebook(){if(!this.e){const t=this,i={get uri(){return t.uri},get version(){return t.g},get notebookType(){return t.d},get isDirty(){return t.h},get isUntitled(){return t.uri.scheme===q.untitled},get isClosed(){return t.j},get metadata(){return t.f},get cellCount(){return t.b.length},cellAt(r){return r=t.n(r),t.b[r].apiCell},getCells(r){return(r?t.p(r):t.b).map(n=>n.apiCell)},save(){return t.q()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this.e=Object.freeze(i)}return this.e}acceptDocumentPropertiesChanged(t){t.metadata&&(this.f=Object.freeze({...this.f,...t.metadata}))}acceptDirty(t){this.h=t}acceptModelChanged(t,i,r){this.g=t.versionId,this.h=i,this.acceptDocumentPropertiesChanged({metadata:r});const s={notebook:this.apiNotebook,metadata:r,cellChanges:[],contentChanges:[]},n=[];for(const a of t.rawEvents)a.kind===es.ModelChange?this.r(a.changes,!1,s.contentChanges):a.kind===es.Move?this.s(a.index,a.length,a.newIdx,s.contentChanges):a.kind===es.Output?(this.t(a.index,a.outputs),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===es.OutputItem?(this.u(a.index,a.outputId,a.append,a.outputItems),n.push({cell:this.b[a.index].apiCell,outputs:this.b[a.index].apiCell.outputs})):a.kind===es.ChangeCellLanguage?(this.v(a.index,a.language),n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document})):a.kind===es.ChangeCellContent?n.push({cell:this.b[a.index].apiCell,document:this.b[a.index].apiCell.document}):a.kind===es.ChangeCellMime?this.w(a.index,a.mime):a.kind===es.ChangeCellMetadata?(this.x(a.index,a.metadata),n.push({cell:this.b[a.index].apiCell,metadata:this.b[a.index].apiCell.metadata})):a.kind===es.ChangeCellInternalMetadata&&(this.y(a.index,a.internalMetadata),n.push({cell:this.b[a.index].apiCell,executionSummary:this.b[a.index].apiCell.executionSummary}));const o=new Map;for(let a=0;a<n.length;a++){const c=n[a],l=o.get(c.cell);if(l===void 0){const u=s.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...c});o.set(c.cell,u-1)}else s.cellChanges[l]={...s.cellChanges[l],...c}}return Object.freeze(s),Object.freeze(s.cellChanges),Object.freeze(s.contentChanges),s}n(t){return t=t|0,t<0?0:t>=this.b.length?this.b.length-1:t}o(t){let i=t.start|0,r=t.end|0;return i<0&&(i=0),r>this.b.length&&(r=this.b.length),t.with({start:i,end:r})}p(t){t=this.o(t);const i=[];for(let r=t.start;r<t.end;r++)i.push(this.b[r]);return i}async q(){return this.j?Promise.reject(new Error("Notebook has been closed")):this.k.$trySaveNotebook(this.uri)}r(t,i,r){if(this.j)return;const s=[],n=[],o=[];if(t.reverse().forEach(a=>{const l=a[2].map(f=>{const p=new mS(this,this.l,f);return i||n.push(mS.asModelAddData(f)),p}),u=new gS(a[0],a[1],[],l),h=this.b.splice(a[0],a[1],...l);for(const f of h)o.push(f.uri),u.deletedItems.push(f.apiCell);s.push(u)}),this.l.acceptDocumentsAndEditorsDelta({addedDocuments:n,removedDocuments:o}),r)for(const a of s)r.push(a.asApiEvent())}s(t,i,r,s){const n=this.b.splice(t,i);this.b.splice(r,0,...n);const o=[new gS(t,i,n.map(a=>a.apiCell),[]),new gS(r,0,[],n)];for(const a of o)s.push(a.asApiEvent())}t(t,i){this.b[t].setOutputs(i)}u(t,i,r,s){this.b[t].setOutputItems(i,r,s)}v(t,i){const r=this.b[t];r.apiCell.document.languageId!==i&&this.m.$acceptModelLanguageChanged(r.uri,i)}w(t,i){const r=this.b[t];r.apiCell.mime=i}x(t,i){this.b[t].setMetadata(i)}y(t,i){this.b[t].setInternalMetadata(i)}getCellFromApiCell(t){return this.b.find(i=>i.apiCell===t)}getCellFromIndex(t){return this.b[t]}getCell(t){return this.b.find(i=>i.handle===t)}getCellIndex(t){return this.b.indexOf(t)}},vS=class WN{static{this.apiEditorsToExtHost=new WeakMap}constructor(t,i,r,s,n,o,a){this.id=t,this.c=i,this.notebookData=r,this.d=s,this.e=n,this.f=o,this.g=a,this.a=!1}get apiEditor(){if(!this.b){const t=this;this.b={get notebook(){return t.notebookData.apiNotebook},get selection(){return t.e[0]},set selection(i){this.selections=[i]},get selections(){return t.e},set selections(i){if(!Array.isArray(i)||!i.every(ks.isNotebookRange))throw $e("selections");t.e=i.length===0?[new ks(0,0)]:i,t.h(t.e)},get visibleRanges(){return t.d},revealRange(i,r){t.c.$tryRevealRange(t.id,Ms.from(i),r??Gp.Default)},get viewColumn(){return t.f},get replOptions(){if(t.g==="repl")return{appendIndex:this.notebook.cellCount-1}},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}},WN.apiEditorsToExtHost.set(this.b,this)}return this.b}get visible(){return this.a}_acceptVisibility(t){this.a=t}_acceptVisibleRanges(t){this.d=t}_acceptSelections(t){this.e=t}h(t){this.c.$trySetSelections(this.id,t.map(Ms.from))}_acceptViewColumn(t){this.f=t}},wS=class{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==ce)return bS(this.right);let e=this;for(;e.parent!==ce&&e.parent.left!==e;)e=e.parent;return e.parent===ce?ce:e.parent}prev(){if(this.left!==ce)return yT(this.left);let e=this;for(;e.parent!==ce&&e.parent.right!==e;)e=e.parent;return e.parent===ce?ce:e.parent}detach(){this.parent=null,this.left=null,this.right=null}},bT;(function(e){e[e.Black=0]="Black",e[e.Red=1]="Red"})(bT||(bT={}));var ce=new wS(null,0);ce.parent=ce,ce.left=ce,ce.right=ce,ce.color=0;function bS(e){for(;e.left!==ce;)e=e.left;return e}function yT(e){for(;e.right!==ce;)e=e.right;return e}function yS(e){return e===ce?0:e.size_left+e.piece.length+yS(e.right)}function AS(e){return e===ce?0:e.lf_left+e.piece.lineFeedCnt+AS(e.right)}function SS(){ce.parent=ce}function md(e,t){const i=t.right;i.size_left+=t.size_left+(t.piece?t.piece.length:0),i.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=i.left,i.left!==ce&&(i.left.parent=t),i.parent=t.parent,t.parent===ce?e.root=i:t.parent.left===t?t.parent.left=i:t.parent.right=i,i.left=t,t.parent=i}function vd(e,t){const i=t.left;t.left=i.right,i.right!==ce&&(i.right.parent=t),i.parent=t.parent,t.size_left-=i.size_left+(i.piece?i.piece.length:0),t.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0),t.parent===ce?e.root=i:t===t.parent.right?t.parent.right=i:t.parent.left=i,i.right=t,t.parent=i}function k1(e,t){let i,r;if(t.left===ce?(r=t,i=r.right):t.right===ce?(r=t,i=r.left):(r=bS(t.right),i=r.right),r===e.root){e.root=i,i.color=0,t.detach(),SS(),e.root.parent=ce;return}const s=r.color===1;if(r===r.parent.left?r.parent.left=i:r.parent.right=i,r===t?(i.parent=r.parent,wd(e,i)):(r.parent===t?i.parent=r:i.parent=r.parent,wd(e,i),r.left=t.left,r.right=t.right,r.parent=t.parent,r.color=t.color,t===e.root?e.root=r:t===t.parent.left?t.parent.left=r:t.parent.right=r,r.left!==ce&&(r.left.parent=r),r.right!==ce&&(r.right.parent=r),r.size_left=t.size_left,r.lf_left=t.lf_left,wd(e,r)),t.detach(),i.parent.left===i){const o=yS(i),a=AS(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const c=o-i.parent.size_left,l=a-i.parent.lf_left;i.parent.size_left=o,i.parent.lf_left=a,gn(e,i.parent,c,l)}}if(wd(e,i.parent),s){SS();return}let n;for(;i!==e.root&&i.color===0;)i===i.parent.left?(n=i.parent.right,n.color===1&&(n.color=0,i.parent.color=1,md(e,i.parent),n=i.parent.right),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.right.color===0&&(n.left.color=0,n.color=1,vd(e,n),n=i.parent.right),n.color=i.parent.color,i.parent.color=0,n.right.color=0,md(e,i.parent),i=e.root)):(n=i.parent.left,n.color===1&&(n.color=0,i.parent.color=1,vd(e,i.parent),n=i.parent.left),n.left.color===0&&n.right.color===0?(n.color=1,i=i.parent):(n.left.color===0&&(n.right.color=0,n.color=1,md(e,n),n=i.parent.left),n.color=i.parent.color,i.parent.color=0,n.left.color=0,vd(e,i.parent),i=e.root));i.color=0,SS()}function AT(e,t){for(wd(e,t);t!==e.root&&t.parent.color===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,md(e,t)),t.parent.color=0,t.parent.parent.color=1,vd(e,t.parent.parent))}else{const i=t.parent.parent.left;i.color===1?(t.parent.color=0,i.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,vd(e,t)),t.parent.color=0,t.parent.parent.color=1,md(e,t.parent.parent))}e.root.color=0}function gn(e,t,i,r){for(;t!==e.root&&t!==ce;)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=r),t=t.parent}function wd(e,t){let i=0,r=0;if(t!==e.root){for(;t!==e.root&&t===t.parent.right;)t=t.parent;if(t!==e.root)for(t=t.parent,i=yS(t.left)-t.size_left,r=AS(t.left)-t.lf_left,t.size_left+=i,t.lf_left+=r;t!==e.root&&(i!==0||r!==0);)t.parent.left===t&&(t.parent.size_left+=i,t.parent.lf_left+=r),t=t.parent}}var mn=65535;function ST(e){let t;return e[e.length-1]<65536?t=new Uint16Array(e.length):t=new Uint32Array(e.length),t.set(e,0),t}var AQ=class{constructor(e,t,i,r,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=r,this.isBasicASCII=s}};function vn(e,t=!0){const i=[0];let r=1;for(let s=0,n=e.length;s<n;s++){const o=e.charCodeAt(s);o===13?s+1<n&&e.charCodeAt(s+1)===10?(i[r++]=s+2,s++):i[r++]=s+1:o===10&&(i[r++]=s+1)}return t?ST(i):i}function SQ(e,t){e.length=0,e[0]=0;let i=1,r=0,s=0,n=0,o=!0;for(let c=0,l=t.length;c<l;c++){const u=t.charCodeAt(c);u===13?c+1<l&&t.charCodeAt(c+1)===10?(n++,e[i++]=c+2,c++):(r++,e[i++]=c+1):u===10?(s++,e[i++]=c+1):o&&u!==9&&(u<32||u>126)&&(o=!1)}const a=new AQ(ST(e),r,s,n,o);return e.length=0,a}var _i=class{constructor(e,t,i,r,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=r,this.length=s}},ja=class{constructor(e,t){this.buffer=e,this.lineStarts=t}},EQ=class{constructor(e,t){this.a=[],this.c=e,this.d=t,this.b=0,e.root!==ce&&e.iterate(e.root,i=>(i!==ce&&this.a.push(i.piece),!0))}read(){return this.a.length===0?this.b===0?(this.b++,this.d):null:this.b>this.a.length-1?null:this.b===0?this.d+this.c.getPieceContent(this.a[this.b++]):this.c.getPieceContent(this.a[this.b++])}},xQ=class{constructor(e){this.a=e,this.b=[]}get(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this.b.length-1;t>=0;t--){const i=this.b[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this.b.length>=this.a&&this.b.shift(),this.b.push(e)}validate(e){let t=!1;const i=this.b;for(let r=0;r<i.length;r++){const s=i[r];if(s.node.parent===null||s.nodeStartOffset>=e){i[r]=null,t=!0;continue}}if(t){const r=[];for(const s of i)s!==null&&r.push(s);this.b=r}}},kQ=class{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this.a=[new ja("",[0])],this.g={line:0,column:0},this.root=ce,this.b=1,this.c=0,this.d=t,this.e=t.length,this.f=i;let r=null;for(let s=0,n=e.length;s<n;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=vn(e[s].buffer));const o=new _i(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this.a.push(e[s]),r=this.S(r,o)}this.h=new xQ(1),this.j={lineNumber:0,value:""},this.y()}normalizeEOL(e){const t=mn,i=t-Math.floor(t/3),r=i*2;let s="",n=0;const o=[];if(this.iterate(this.root,a=>{const c=this.R(a),l=c.length;if(n<=i||n+l<r)return s+=c,n+=l,!0;const u=s.replace(/\r\n|\r|\n/g,e);return o.push(new ja(u,vn(u))),s=c,n=l,!0}),n>0){const a=s.replace(/\r\n|\r|\n/g,e);o.push(new ja(a,vn(a)))}this.create(o,e,!0)}getEOL(){return this.d}setEOL(e){this.d=e,this.e=this.d.length,this.normalizeEOL(e)}createSnapshot(e){return new EQ(this,e)}equal(e){if(this.getLength()!==e.getLength()||this.getLineCount()!==e.getLineCount())return!1;let t=0;return this.iterate(this.root,r=>{if(r===ce)return!0;const s=this.R(r),n=s.length,o=e.G(t),a=e.G(t+n),c=e.getValueInRange2(o,a);return t+=n,s===c})}getOffsetAt(e,t){let i=0,r=this.root;for(;r!==ce;)if(r.left!==ce&&r.lf_left+1>=e)r=r.left;else if(r.lf_left+r.piece.lineFeedCnt+1>=e){i+=r.size_left;const s=this.B(r,e-r.lf_left-2);return i+=s+t-1}else e-=r.lf_left+r.piece.lineFeedCnt,i+=r.size_left+r.piece.length,r=r.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const r=e;for(;t!==ce;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.A(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const n=this.getOffsetAt(i+1,1),o=r-n;return new gr(i+1,o+1)}return new gr(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===ce){const s=this.getOffsetAt(i+1,1),n=r-e-s;return new gr(i+1,n+1)}else t=t.right;return new gr(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.H(e.startLineNumber,e.startColumn),r=this.H(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,r);return t?t!==this.d||!this.f?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this.f?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const o=e.node,a=this.a[o.piece.bufferIndex].buffer,c=this.u(o.piece.bufferIndex,o.piece.start);return a.substring(c+e.remainder,c+t.remainder)}let i=e.node;const r=this.a[i.piece.bufferIndex].buffer,s=this.u(i.piece.bufferIndex,i.piece.start);let n=r.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==ce;){const o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(i===t.node){n+=o.substring(a,a+t.remainder);break}else n+=o.substr(a,i.piece.length);i=i.next()}return n}getLinesContent(){const e=[];let t=0,i="",r=!1;return this.iterate(this.root,s=>{if(s===ce)return!0;const n=s.piece;let o=n.length;if(o===0)return!0;const a=this.a[n.bufferIndex].buffer,c=this.a[n.bufferIndex].lineStarts,l=n.start.line,u=n.end.line;let h=c[l]+n.start.column;if(r&&(a.charCodeAt(h)===10&&(h++,o--),e[t++]=i,i="",r=!1,o===0))return!0;if(l===u)return!this.f&&a.charCodeAt(h+o-1)===13?(r=!0,i+=a.substr(h,o-1)):i+=a.substr(h,o),!0;i+=this.f?a.substring(h,Math.max(h,c[l+1]-this.e)):a.substring(h,c[l+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let f=l+1;f<u;f++)i=this.f?a.substring(c[f],c[f+1]-this.e):a.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this.f&&a.charCodeAt(c[u]+n.end.column-1)===13?(r=!0,n.end.column===0?t--:i=a.substr(c[u],n.end.column-1)):i=a.substr(c[u],n.end.column),!0}),r&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this.c}getLineCount(){return this.b}getLineContent(e){return this.j.lineNumber===e?this.j.value:(this.j.lineNumber=e,e===this.b?this.j.value=this.getLineRawContent(e):this.f?this.j.value=this.getLineRawContent(e,this.e):this.j.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this.j.value)}l(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this.a[t.piece.bufferIndex],r=this.u(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(r)}else{const t=this.a[e.node.piece.bufferIndex],r=this.u(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(r)}}getLineCharCode(e,t){const i=this.H(e,t+1);return this.l(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this.e}getCharCode(e){const t=this.G(e);return this.l(t)}getNearestChunk(e){const t=this.G(e);if(t.remainder===t.node.piece.length){const i=t.node.next();if(!i||i===ce)return"";const r=this.a[i.piece.bufferIndex],s=this.u(i.piece.bufferIndex,i.piece.start);return r.buffer.substring(s,s+i.piece.length)}else{const i=this.a[t.node.piece.bufferIndex],r=this.u(t.node.piece.bufferIndex,t.node.piece.start),s=r+t.remainder,n=r+t.node.piece.length;return i.buffer.substring(s,n)}}findMatchesInNode(e,t,i,r,s,n,o,a,c,l,u){const h=this.a[e.piece.bufferIndex],f=this.u(e.piece.bufferIndex,e.piece.start),p=this.u(e.piece.bufferIndex,s),g=this.u(e.piece.bufferIndex,n);let v;const b={line:0,column:0};let S,E;t._wordSeparators?(S=h.buffer.substring(p,g),E=$=>$+p,t.reset(0)):(S=h.buffer,E=$=>$,t.reset(p));do if(v=t.next(S),v){if(E(v.index)>=g)return l;this.s(e,E(v.index)-f,b);const $=this.t(e.piece.bufferIndex,s,b),U=b.line===s.line?b.column-s.column+r:b.column+1,O=U+v[0].length;if(u[l++]=cD(new st(i+$,U,i+$,O),v,a),E(v.index)+v[0].length>=g||l>=c)return l}while(v);return l}findMatchesLineByLine(e,t,i,r){const s=[];let n=0;const o=new Z_(t.wordSeparators,t.regex);let a=this.H(e.startLineNumber,e.startColumn);if(a===null)return[];const c=this.H(e.endLineNumber,e.endColumn);if(c===null)return[];let l=this.s(a.node,a.remainder);const u=this.s(c.node,c.remainder);if(a.node===c.node)return this.findMatchesInNode(a.node,o,e.startLineNumber,e.startColumn,l,u,t,i,r,n,s),s;let h=e.startLineNumber,f=a.node;for(;f!==c.node;){const g=this.t(f.piece.bufferIndex,l,f.piece.end);if(g>=1){const b=this.a[f.piece.bufferIndex].lineStarts,S=this.u(f.piece.bufferIndex,f.piece.start),E=b[l.line+g],$=h===e.startLineNumber?e.startColumn:1;if(n=this.findMatchesInNode(f,o,h,$,l,this.s(f,E-S),t,i,r,n,s),n>=r)return s;h+=g}const v=h===e.startLineNumber?e.startColumn-1:0;if(h===e.endLineNumber){const b=this.getLineContent(h).substring(v,e.endColumn-1);return n=this.n(t,o,b,e.endLineNumber,v,n,s,i,r),s}if(n=this.n(t,o,this.getLineContent(h).substr(v),h,v,n,s,i,r),n>=r)return s;h++,a=this.H(h,1),f=a.node,l=this.s(a.node,a.remainder)}if(h===e.endLineNumber){const g=h===e.startLineNumber?e.startColumn-1:0,v=this.getLineContent(h).substring(g,e.endColumn-1);return n=this.n(t,o,v,e.endLineNumber,g,n,s,i,r),s}const p=h===e.startLineNumber?e.startColumn:1;return n=this.findMatchesInNode(c.node,o,h,p,l,u,t,i,r,n,s),s}n(e,t,i,r,s,n,o,a,c){const l=e.wordSeparators;if(!a&&e.simpleSearch){const h=e.simpleSearch,f=h.length,p=i.length;let g=-f;for(;(g=i.indexOf(h,g+f))!==-1;)if((!l||lD(l,i,p,g,f))&&(o[n++]=new IA(new st(r,g+1+s,r,g+1+f+s),null),n>=c))return n;return n}let u;t.reset(0);do if(u=t.next(i),u&&(o[n++]=cD(new st(r,u.index+1+s,r,u.index+1+u[0].length+s),u,a),n>=c))return n;while(u);return n}insert(e,t,i=!1){if(this.f=this.f&&i,this.j.lineNumber=0,this.j.value="",this.root!==ce){const{node:r,remainder:s,nodeStartOffset:n}=this.G(e),o=r.piece,a=o.bufferIndex,c=this.s(r,s);if(r.piece.bufferIndex===0&&o.end.line===this.g.line&&o.end.column===this.g.column&&n+o.length===e&&t.length<mn){this.F(r,t),this.y();return}if(n===e)this.o(t,r),this.h.validate(e);else if(n+r.piece.length>e){const l=[];let u=new _i(o.bufferIndex,c,o.end,this.t(o.bufferIndex,c,o.end),this.u(a,o.end)-this.u(a,c));if(this.K()&&this.M(t)&&this.I(r,s)===10){const g={line:u.start.line+1,column:0};u=new _i(u.bufferIndex,g,u.end,this.t(u.bufferIndex,g,u.end),u.length-1),t+=`
`}if(this.K()&&this.L(t))if(this.I(r,s-1)===13){const g=this.s(r,s-1);this.C(r,g),t="\r"+t,r.piece.length===0&&l.push(r)}else this.C(r,c);else this.C(r,c);const h=this.w(t);u.length>0&&this.S(r,u);let f=r;for(let p=0;p<h.length;p++)f=this.S(f,h[p]);this.v(l)}else this.q(t,r)}else{const r=this.w(t);let s=this.T(null,r[0]);for(let n=1;n<r.length;n++)s=this.S(s,r[n])}this.y()}delete(e,t){if(this.j.lineNumber=0,this.j.value="",t<=0||this.root===ce)return;const i=this.G(e),r=this.G(e+t),s=i.node,n=r.node;if(s===n){const h=this.s(s,i.remainder),f=this.s(s,r.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const p=s.next();k1(this,s),this.N(p),this.y();return}this.D(s,f),this.h.validate(e),this.N(s),this.y();return}if(i.nodeStartOffset+s.piece.length===e+t){this.C(s,h),this.O(s),this.y();return}this.E(s,h,f),this.y();return}const o=[],a=this.s(s,i.remainder);this.C(s,a),this.h.validate(e),s.piece.length===0&&o.push(s);const c=this.s(n,r.remainder);this.D(n,c),n.piece.length===0&&o.push(n);const l=s.next();for(let h=l;h!==ce&&h!==n;h=h.next())o.push(h);const u=s.piece.length===0?s.prev():s;this.v(o),this.O(u),this.y()}o(e,t){const i=[];if(this.K()&&this.M(e)&&this.L(t)){const n=t.piece,o={line:n.start.line+1,column:0},a=new _i(n.bufferIndex,o,n.end,this.t(n.bufferIndex,o,n.end),n.length-1);t.piece=a,e+=`
`,gn(this,t,-1,-1),t.piece.length===0&&i.push(t)}const r=this.w(e);let s=this.T(t,r[r.length-1]);for(let n=r.length-2;n>=0;n--)s=this.T(s,r[n]);this.N(s),this.v(i)}q(e,t){this.Q(e,t)&&(e+=`
`);const i=this.w(e),r=this.S(t,i[0]);let s=r;for(let n=1;n<i.length;n++)s=this.S(s,i[n]);this.N(r)}s(e,t,i){const r=e.piece,s=e.piece.bufferIndex,n=this.a[s].lineStarts,a=n[r.start.line]+r.start.column+t;let c=r.start.line,l=r.end.line,u=0,h=0,f=0;for(;c<=l&&(u=c+(l-c)/2|0,f=n[u],u!==l);)if(h=n[u+1],a<f)l=u-1;else if(a>=h)c=u+1;else break;return i?(i.line=u,i.column=a-f,null):{line:u,column:a-f}}t(e,t,i){if(i.column===0)return i.line-t.line;const r=this.a[e].lineStarts;if(i.line===r.length-1)return i.line-t.line;const s=r[i.line+1],n=r[i.line]+i.column;if(s>n+1)return i.line-t.line;const o=n-1;return this.a[e].buffer.charCodeAt(o)===13?i.line-t.line+1:i.line-t.line}u(e,t){return this.a[e].lineStarts[t.line]+t.column}v(e){for(let t=0;t<e.length;t++)k1(this,e[t])}w(e){if(e.length>mn){const l=[];for(;e.length>mn;){const h=e.charCodeAt(mn-1);let f;h===13||h>=55296&&h<=56319?(f=e.substring(0,mn-1),e=e.substring(mn-1)):(f=e.substring(0,mn),e=e.substring(mn));const p=vn(f);l.push(new _i(this.a.length,{line:0,column:0},{line:p.length-1,column:f.length-p[p.length-1]},p.length-1,f.length)),this.a.push(new ja(f,p))}const u=vn(e);return l.push(new _i(this.a.length,{line:0,column:0},{line:u.length-1,column:e.length-u[u.length-1]},u.length-1,e.length)),this.a.push(new ja(e,u)),l}let t=this.a[0].buffer.length;const i=vn(e,!1);let r=this.g;if(this.a[0].lineStarts[this.a[0].lineStarts.length-1]===t&&t!==0&&this.L(e)&&this.M(this.a[0].buffer)){this.g={line:this.g.line,column:this.g.column+1},r=this.g;for(let l=0;l<i.length;l++)i[l]+=t+1;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let l=0;l<i.length;l++)i[l]+=t;this.a[0].lineStarts=this.a[0].lineStarts.concat(i.slice(1)),this.a[0].buffer+=e}const s=this.a[0].buffer.length,n=this.a[0].lineStarts.length-1,o=s-this.a[0].lineStarts[n],a={line:n,column:o},c=new _i(0,r,a,this.t(0,r,a),s-t);return this.g=a,[c]}getLinesRawContent(){return this.U(this.root)}getLineRawContent(e,t=0){let i=this.root,r="";const s=this.h.get2(e);if(s){i=s.node;const n=this.B(i,e-s.nodeStartLineNumber-1),o=this.a[i.piece.bufferIndex].buffer,a=this.u(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)r=o.substring(a+n,a+i.piece.length);else{const c=this.B(i,e-s.nodeStartLineNumber);return o.substring(a+n,a+c-t)}}else{let n=0;const o=e;for(;i!==ce;)if(i.left!==ce&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const a=this.B(i,e-i.lf_left-2),c=this.B(i,e-i.lf_left-1),l=this.a[i.piece.bufferIndex].buffer,u=this.u(i.piece.bufferIndex,i.piece.start);return n+=i.size_left,this.h.set({node:i,nodeStartOffset:n,nodeStartLineNumber:o-(e-1-i.lf_left)}),l.substring(u+a,u+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const a=this.B(i,e-i.lf_left-2),c=this.a[i.piece.bufferIndex].buffer,l=this.u(i.piece.bufferIndex,i.piece.start);r=c.substring(l+a,l+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==ce;){const n=this.a[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const o=this.B(i,0),a=this.u(i.piece.bufferIndex,i.piece.start);return r+=n.substring(a,a+o-t),r}else{const o=this.u(i.piece.bufferIndex,i.piece.start);r+=n.substr(o,i.piece.length)}i=i.next()}return r}y(){let e=this.root,t=1,i=0;for(;e!==ce;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this.b=t,this.c=i,this.h.validate(this.c)}A(e,t){const i=e.piece,r=this.s(e,t),s=r.line-i.start.line;if(this.u(i.bufferIndex,i.end)-this.u(i.bufferIndex,i.start)===t){const n=this.t(e.piece.bufferIndex,i.start,r);if(n!==s)return{index:n,remainder:0}}return{index:s,remainder:r.column}}B(e,t){if(t<0)return 0;const i=e.piece,r=this.a[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?r[i.end.line]+i.end.column-r[i.start.line]-i.start.column:r[s]-r[i.start.line]-i.start.column}C(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.u(i.bufferIndex,i.end),n=t,o=this.u(i.bufferIndex,n),a=this.t(i.bufferIndex,i.start,n),c=a-r,l=o-s,u=i.length+l;e.piece=new _i(i.bufferIndex,i.start,n,a,u),gn(this,e,l,c)}D(e,t){const i=e.piece,r=i.lineFeedCnt,s=this.u(i.bufferIndex,i.start),n=t,o=this.t(i.bufferIndex,n,i.end),a=this.u(i.bufferIndex,n),c=o-r,l=s-a,u=i.length+l;e.piece=new _i(i.bufferIndex,n,i.end,o,u),gn(this,e,l,c)}E(e,t,i){const r=e.piece,s=r.start,n=r.end,o=r.length,a=r.lineFeedCnt,c=t,l=this.t(r.bufferIndex,r.start,c),u=this.u(r.bufferIndex,t)-this.u(r.bufferIndex,s);e.piece=new _i(r.bufferIndex,r.start,c,l,u),gn(this,e,u-o,l-a);const h=new _i(r.bufferIndex,i,n,this.t(r.bufferIndex,i,n),this.u(r.bufferIndex,n)-this.u(r.bufferIndex,i)),f=this.S(e,h);this.N(f)}F(e,t){this.Q(t,e)&&(t+=`
`);const i=this.K()&&this.L(t)&&this.M(e),r=this.a[0].buffer.length;this.a[0].buffer+=t;const s=vn(t,!1);for(let f=0;f<s.length;f++)s[f]+=r;if(i){const f=this.a[0].lineStarts[this.a[0].lineStarts.length-2];this.a[0].lineStarts.pop(),this.g={line:this.g.line-1,column:r-f}}this.a[0].lineStarts=this.a[0].lineStarts.concat(s.slice(1));const n=this.a[0].lineStarts.length-1,o=this.a[0].buffer.length-this.a[0].lineStarts[n],a={line:n,column:o},c=e.piece.length+t.length,l=e.piece.lineFeedCnt,u=this.t(0,e.piece.start,a),h=u-l;e.piece=new _i(e.piece.bufferIndex,e.piece.start,a,u,c),this.g=a,gn(this,e,t.length,h)}G(e){let t=this.root;const i=this.h.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let r=0;for(;t!==ce;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){r+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:r};return this.h.set(s),s}else e-=t.size_left+t.piece.length,r+=t.size_left+t.piece.length,t=t.right;return null}H(e,t){let i=this.root,r=0;for(;i!==ce;)if(i.left!==ce&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.B(i,e-i.lf_left-2),n=this.B(i,e-i.lf_left-1);return r+=i.size_left,{node:i,remainder:Math.min(s+t-1,n),nodeStartOffset:r}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.B(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:r};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==ce;){if(i.piece.lineFeedCnt>0){const s=this.B(i,0),n=this.J(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:n}}else if(i.piece.length>=t-1){const s=this.J(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}I(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this.a[e.piece.bufferIndex],r=this.u(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(r)}J(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}K(){return!(this.f&&this.d===`
`)}L(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===ce||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this.a[t.bufferIndex].lineStarts,r=t.start.line,s=i[r]+t.start.column;return r===i.length-1||i[r+1]>s+1?!1:this.a[t.bufferIndex].buffer.charCodeAt(s)===10}M(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===ce||e.piece.lineFeedCnt===0?!1:this.I(e,e.piece.length-1)===13}N(e){if(this.K()&&this.L(e)){const t=e.prev();this.M(t)&&this.P(t,e)}}O(e){if(this.K()&&this.M(e)){const t=e.next();this.L(t)&&this.P(e,t)}}P(e,t){const i=[],r=this.a[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:r[e.piece.end.line]-r[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const n=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new _i(e.piece.bufferIndex,e.piece.start,s,o,n),gn(this,e,-1,-1),e.piece.length===0&&i.push(e);const a={line:t.piece.start.line+1,column:0},c=t.piece.length-1,l=this.t(t.piece.bufferIndex,a,t.piece.end);t.piece=new _i(t.piece.bufferIndex,a,t.piece.end,l,c),gn(this,t,-1,-1),t.piece.length===0&&i.push(t);const u=this.w(`\r
`);this.S(e,u[0]);for(let h=0;h<i.length;h++)k1(this,i[h])}Q(e,t){if(this.K()&&this.M(e)){const i=t.next();if(this.L(i)){if(e+=`
`,i.piece.length===1)k1(this,i);else{const r=i.piece,s={line:r.start.line+1,column:0},n=r.length-1,o=this.t(r.bufferIndex,s,r.end);i.piece=new _i(r.bufferIndex,s,r.end,o,n),gn(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===ce)return t(ce);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}R(e){if(e===ce)return"";const t=this.a[e.piece.bufferIndex],i=e.piece,r=this.u(i.bufferIndex,i.start),s=this.u(i.bufferIndex,i.end);return t.buffer.substring(r,s)}getPieceContent(e){const t=this.a[e.bufferIndex],i=this.u(e.bufferIndex,e.start),r=this.u(e.bufferIndex,e.end);return t.buffer.substring(i,r)}S(e,t){const i=new wS(t,1);if(i.left=ce,i.right=ce,i.parent=ce,i.size_left=0,i.lf_left=0,this.root===ce)this.root=i,i.color=0;else if(e.right===ce)e.right=i,i.parent=e;else{const s=bS(e.right);s.left=i,i.parent=s}return AT(this,i),i}T(e,t){const i=new wS(t,1);if(i.left=ce,i.right=ce,i.parent=ce,i.size_left=0,i.lf_left=0,this.root===ce)this.root=i,i.color=0;else if(e.left===ce)e.left=i,i.parent=e;else{const r=yT(e.left);r.right=i,i.parent=r}return AT(this,i),i}U(e){let t="";return this.iterate(e,i=>(t+=this.R(i),!0)),t}},ET;(function(e){e[e.Unknown=0]="Unknown",e[e.Invalid=3]="Invalid",e[e.LF=1]="LF",e[e.CRLF=2]="CRLF"})(ET||(ET={}));function ES(e){let t=0,i=0,r=0,s=0;for(let n=0,o=e.length;n<o;n++){const a=e.charCodeAt(n);a===13?(t===0&&(i=n),t++,n+1<o&&e.charCodeAt(n+1)===10?(s|=2,n++):s|=3,r=n+1):a===10&&(s|=1,t===0&&(i=n),t++,r=n+1)}return t===0&&(i=e.length),[t,i,e.length-r,s]}var xS;function CQ(){return xS||(xS=new TextDecoder("UTF-16LE")),xS}function $Q(e,t,i){const r=new Uint16Array(e.buffer,t,i);return i>0&&(r[0]===65279||r[0]===65534)?IQ(e,t,i):CQ().decode(r)}function IQ(e,t,i){const r=[];let s=0;for(let n=0;n<i;n++){const o=cO(e,t);t+=2,r[s++]=String.fromCharCode(o)}return r.join("")}function C1(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}var DQ=class Ws{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(t,i,r,s){this.oldPosition=t,this.oldText=i,this.newPosition=r,this.newText=s}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${C1(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${C1(this.oldText)}")`:`(replace@${this.oldPosition} "${C1(this.oldText)}" with "${C1(this.newText)}")`}static a(t){return 4+2*t.length}static c(t,i,r){const s=i.length;df(t,s,r),r+=4;for(let n=0;n<s;n++)lO(t,i.charCodeAt(n),r),r+=2;return r}static d(t,i){const r=hf(t,i);return i+=4,$Q(t,i,r)}writeSize(){return 8+Ws.a(this.oldText)+Ws.a(this.newText)}write(t,i){return df(t,this.oldPosition,i),i+=4,df(t,this.newPosition,i),i+=4,i=Ws.c(t,this.oldText,i),i=Ws.c(t,this.newText,i),i}static read(t,i,r){const s=hf(t,i);i+=4;const n=hf(t,i);i+=4;const o=Ws.d(t,i);i+=Ws.a(o);const a=Ws.d(t,i);return i+=Ws.a(a),r.push(new Ws(s,o,n,a)),i}},PQ=class Ld extends Q{get onDidChangeContent(){return this.m.event}constructor(t,i,r,s,n,o,a){super(),this.m=this.D(new I),this.f=i,this.j=!o,this.g=s,this.h=n,this.c=new kQ(t,r,a)}equals(t){return!(t instanceof Ld)||this.f!==t.f||this.getEOL()!==t.getEOL()?!1:this.c.equal(t.c)}mightContainRTL(){return this.g}mightContainUnusualLineTerminators(){return this.h}resetMightContainUnusualLineTerminators(){this.h=!1}mightContainNonBasicASCII(){return this.j}getBOM(){return this.f}getEOL(){return this.c.getEOL()}createSnapshot(t){return this.c.createSnapshot(t?this.f:"")}getOffsetAt(t,i){return this.c.getOffsetAt(t,i)}getPositionAt(t){return this.c.getPositionAt(t)}getRangeAt(t,i){const r=t+i,s=this.getPositionAt(t),n=this.getPositionAt(r);return new st(s.lineNumber,s.column,n.lineNumber,n.column)}getValueInRange(t,i=0){if(t.isEmpty())return"";const r=this.n(i);return this.c.getValueInRange(t,r)}getValueLengthInRange(t,i=0){if(t.isEmpty())return 0;if(t.startLineNumber===t.endLineNumber)return t.endColumn-t.startColumn;const r=this.getOffsetAt(t.startLineNumber,t.startColumn),s=this.getOffsetAt(t.endLineNumber,t.endColumn);let n=0;const o=this.n(i),a=this.getEOL();if(o.length!==a.length){const c=o.length-a.length,l=t.endLineNumber-t.startLineNumber;n=c*l}return s-r+n}getCharacterCountInRange(t,i=0){if(this.j){let r=0;const s=t.startLineNumber,n=t.endLineNumber;for(let o=s;o<=n;o++){const a=this.getLineContent(o),c=o===s?t.startColumn-1:0,l=o===n?t.endColumn-1:a.length;for(let u=c;u<l;u++)ef(a.charCodeAt(u))?(r=r+1,u=u+1):r=r+1}return r+=this.n(i).length*(n-s),r}return this.getValueLengthInRange(t,i)}getNearestChunk(t){return this.c.getNearestChunk(t)}getLength(){return this.c.getLength()}getLineCount(){return this.c.getLineCount()}getLinesContent(){return this.c.getLinesContent()}getLineContent(t){return this.c.getLineContent(t)}getLineCharCode(t,i){return this.c.getLineCharCode(t,i)}getCharCode(t){return this.c.getCharCode(t)}getLineLength(t){return this.c.getLineLength(t)}getLineMinColumn(t){return 1}getLineMaxColumn(t){return this.getLineLength(t)+1}getLineFirstNonWhitespaceColumn(t){const i=Pv(this.getLineContent(t));return i===-1?0:i+1}getLineLastNonWhitespaceColumn(t){const i=YL(this.getLineContent(t));return i===-1?0:i+2}n(t){switch(t){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(t){this.c.setEOL(t)}applyEdits(t,i,r){let s=this.g,n=this.h,o=this.j,a=!0,c=[];for(let v=0;v<t.length;v++){const b=t[v];a&&b._isTracked&&(a=!1);const S=b.range;if(b.text){let J=!0;o||(J=!n2(b.text),o=J),!s&&J&&(s=LE(b.text)),!n&&J&&(n=OE(b.text))}let E="",$=0,U=0,O=0;if(b.text){let J;[$,U,O,J]=ES(b.text);const F=this.getEOL();J===0||J===(F===`\r
`?2:1)?E=b.text:E=b.text.replace(/\r\n|\r|\n/g,F)}c[v]={sortIndex:v,identifier:b.identifier||null,range:S,rangeOffset:this.getOffsetAt(S.startLineNumber,S.startColumn),rangeLength:this.getValueLengthInRange(S),text:E,eolCount:$,firstLineLength:U,lastLineLength:O,forceMoveMarkers:!!b.forceMoveMarkers,isAutoWhitespaceEdit:b.isAutoWhitespaceEdit||!1}}c.sort(Ld.t);let l=!1;for(let v=0,b=c.length-1;v<b;v++){const S=c[v].range.getEndPosition(),E=c[v+1].range.getStartPosition();if(E.isBeforeOrEqual(S)){if(E.isBefore(S))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(c=this.q(c));const u=r||i?Ld._getInverseEditRanges(c):[],h=[];if(i)for(let v=0;v<c.length;v++){const b=c[v],S=u[v];if(b.isAutoWhitespaceEdit&&b.range.isEmpty())for(let E=S.startLineNumber;E<=S.endLineNumber;E++){let $="";E===S.startLineNumber&&($=this.getLineContent(b.range.startLineNumber),Pv($)!==-1)||h.push({lineNumber:E,oldContent:$})}}let f=null;if(r){let v=0;f=[];for(let b=0;b<c.length;b++){const S=c[b],E=u[b],$=this.getValueInRange(S.range),U=S.rangeOffset+v;v+=S.text.length-$.length,f[b]={sortIndex:S.sortIndex,identifier:S.identifier,range:E,text:$,textChange:new DQ(S.rangeOffset,$,U,S.text)}}l||f.sort((b,S)=>b.sortIndex-S.sortIndex)}this.g=s,this.h=n,this.j=o;const p=this.s(c);let g=null;if(i&&h.length>0){h.sort((v,b)=>b.lineNumber-v.lineNumber),g=[];for(let v=0,b=h.length;v<b;v++){const S=h[v].lineNumber;if(v>0&&h[v-1].lineNumber===S)continue;const E=h[v].oldContent,$=this.getLineContent(S);$.length===0||$===E||Pv($)!==-1||g.push(S)}}return this.m.fire(),new V_(f,p,g)}q(t){return t.length<1e3?t:[this._toSingleEditOperation(t)]}_toSingleEditOperation(t){let i=!1;const r=t[0].range,s=t[t.length-1].range,n=new st(r.startLineNumber,r.startColumn,s.endLineNumber,s.endColumn);let o=r.startLineNumber,a=r.startColumn;const c=[];for(let p=0,g=t.length;p<g;p++){const v=t[p],b=v.range;i=i||v.forceMoveMarkers,c.push(this.getValueInRange(new st(o,a,b.startLineNumber,b.startColumn))),v.text.length>0&&c.push(v.text),o=b.endLineNumber,a=b.endColumn}const l=c.join(""),[u,h,f]=ES(l);return{sortIndex:0,identifier:t[0].identifier,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n,0),text:l,eolCount:u,firstLineLength:h,lastLineLength:f,forceMoveMarkers:i,isAutoWhitespaceEdit:!1}}s(t){t.sort(Ld.u);const i=[];for(let r=0;r<t.length;r++){const s=t[r],n=s.range.startLineNumber,o=s.range.startColumn,a=s.range.endLineNumber,c=s.range.endColumn;if(n===a&&o===c&&s.text.length===0)continue;s.text?(this.c.delete(s.rangeOffset,s.rangeLength),this.c.insert(s.rangeOffset,s.text,!0)):this.c.delete(s.rangeOffset,s.rangeLength);const l=new st(n,o,a,c);i.push({range:l,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return i}findMatchesLineByLine(t,i,r,s){return this.c.findMatchesLineByLine(t,i,r,s)}getPieceTree(){return this.c}static _getInverseEditRange(t,i){const r=t.startLineNumber,s=t.startColumn,[n,o,a]=ES(i);let c;if(i.length>0){const l=n+1;l===1?c=new st(r,s,r,s+o):c=new st(r,s,r+l-1,a+1)}else c=new st(r,s,r,s);return c}static _getInverseEditRanges(t){const i=[];let r=0,s=0,n=null;for(let o=0,a=t.length;o<a;o++){const c=t[o];let l,u;n?n.range.endLineNumber===c.range.startLineNumber?(l=r,u=s+(c.range.startColumn-n.range.endColumn)):(l=r+(c.range.startLineNumber-n.range.endLineNumber),u=c.range.startColumn):(l=c.range.startLineNumber,u=c.range.startColumn);let h;if(c.text.length>0){const f=c.eolCount+1;f===1?h=new st(l,u,l,u+c.firstLineLength):h=new st(l,u,l+f-1,c.lastLineLength+1)}else h=new st(l,u,l,u);r=h.endLineNumber,s=h.endColumn,i.push(h),n=c}return i}static t(t,i){const r=st.compareRangesUsingEnds(t.range,i.range);return r===0?t.sortIndex-i.sortIndex:r}static u(t,i){const r=st.compareRangesUsingEnds(t.range,i.range);return r===0?i.sortIndex-t.sortIndex:-r}},TQ=class{constructor(e,t,i,r,s,n,o,a,c){this.a=e,this.b=t,this.c=i,this.d=r,this.e=s,this.f=n,this.g=o,this.h=a,this.j=c}k(e){const t=this.c+this.d+this.e,i=this.c+this.e;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this.k(e),i=this.a;if(this.j&&(t===`\r
`&&(this.c>0||this.d>0)||t===`
`&&(this.c>0||this.e>0)))for(let s=0,n=i.length;s<n;s++){const o=i[s].buffer.replace(/\r\n|\r|\n/g,t),a=vn(o);i[s]=new ja(o,a)}const r=new PQ(i,this.b,t,this.f,this.g,this.h,this.j);return{textBuffer:r,disposable:r}}getFirstLineText(e){return this.a[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}},xT=class{constructor(){this.a=[],this.b="",this.c=!1,this.d=0,this.e=[],this.f=0,this.g=0,this.h=0,this.j=!1,this.k=!1,this.l=!0}acceptChunk(e){if(e.length===0)return;this.a.length===0&&h2(e)&&(this.b=u2,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this.m(e.substr(0,e.length-1),!1),this.c=!0,this.d=t):(this.m(e,!1),this.c=!1,this.d=t)}m(e,t){!t&&e.length===0||(this.c?this.n(String.fromCharCode(this.d)+e):this.n(e))}n(e){const t=SQ(this.e,e);this.a.push(new ja(e,t.lineStarts)),this.f+=t.cr,this.g+=t.lf,this.h+=t.crlf,t.isBasicASCII||(this.l=!1,this.j||(this.j=LE(e)),this.k||(this.k=OE(e)))}finish(e=!0){return this.o(),new TQ(this.a,this.b,this.f,this.g,this.h,this.j,this.k,this.l,e)}o(){if(this.a.length===0&&this.m("",!0),this.c){this.c=!1;const e=this.a[this.a.length-1];e.buffer+=String.fromCharCode(this.d);const t=vn(e.buffer);e.lineStarts=t,this.d===13&&this.f++}}},MQ=class extends Q{constructor(e,t,i){super(),this._source=e,this.b=t,this.c=i,this.a=void 0}f(e){const t=e.getLineCount();return new st(1,1,t,this.g(e,t))}g(e,t){if(t<1||t>e.getLineCount())throw new Error("Illegal value for lineNumber");return e.getLineLength(t)+1}get inputTextBuffer(){if(!this.b){const e=new xT;e.acceptChunk(this._source);const t=e.finish(!0),{textBuffer:i,disposable:r}=t.create(1);this.b=i,this.D(r)}return this.b}get outputTextBuffers(){return this.a||(this.a=this.c.map(e=>{const t=new xT;t.acceptChunk(e);const i=t.finish(!0),{textBuffer:r,disposable:s}=i.create(1);return this.D(s),r})),this.a}findInInputs(e){const i=new oD(e,!1,!1,null).parseSearchRequest();if(!i)return[];const r=this.f(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(r,i,!0,5e3)}findInOutputs(e){const i=new oD(e,!1,!1,null).parseSearchRequest();return i?this.outputTextBuffers.map(r=>{const s=r.findMatchesLineByLine(this.f(r),i,!0,5e3);if(s.length!==0)return{textBuffer:r,matches:s}}).filter(r=>!!r):[]}};function kT(e,t){let i=-1;const r=[];let s=[];return e.forEach(o=>{o.range.startLineNumber!==i&&s.length>0&&(r.push([...s]),s=[]),s.push(o),i=o.range.endLineNumber}),s.length>0&&r.push([...s]),r.map(o=>{const a=[],c=o[0].range.startLineNumber,l=o[o.length-1].range.endLineNumber;for(let u=c;u<=l;u++)a.push(t.getLineContent(u));return new _7(a.join(`
`)+`
`,o.map(u=>new st(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))})}var hle=Object.freeze({id:"application",order:100,title:d(4376,null),type:"object"}),NQ=Object.freeze({id:"workbench",order:7,title:d(4377,null),type:"object"}),RQ=Object.freeze({id:"security",scope:1,title:d(4378,null),type:"object",order:7}),dle=Object.freeze({id:"problems",title:d(4379,null),type:"object",order:101}),LQ=Object.freeze({id:"window",order:8,title:d(4380,null),type:"object"}),OQ={ConfigurationMigration:"base.contributions.configuration.migration"},FQ=class{constructor(){this.migrations=[],this.a=new I,this.onDidRegisterConfigurationMigration=this.a.event}registerConfigurationMigrations(e){this.migrations.push(...e)}},$1=new FQ;Zt.add(OQ.ConfigurationMigration,$1);var CT=class extends Q{static{this.ID="workbench.contrib.configurationMigration"}constructor(t,i){super(),this.a=t,this.b=i,this.D(this.b.onDidChangeWorkspaceFolders(async r=>{for(const s of r.added)await this.f(s,$1.migrations)})),this.c($1.migrations),this.D($1.onDidRegisterConfigurationMigration(r=>this.c(r)))}async c(t){await this.f(void 0,t);for(const i of this.b.getWorkspace().folders)await this.f(i,t)}async f(t,i){await Promise.all([i.map(r=>this.g(r,t?.uri))])}async g(t,i){const r=this.a.inspect(t.key,{resource:i}),s=this.b.getWorkbenchState()===3?[["user",2],["userLocal",3],["userRemote",4],["workspace",5],["workspaceFolder",6]]:[["user",2],["userLocal",3],["userRemote",4],["workspace",5]];for(const[n,o]of s){const a=r[n];if(!a)continue;const c=[];if(a.value!==void 0){const l=await this.h(t,n,a.value,i,void 0);for(const u of l??[])c.push([u,[]])}for(const{identifiers:l,value:u}of a.overrides??[])if(u!==void 0){const h=await this.h(t,n,u,i,l);for(const f of h??[])c.push([f,l])}c.length&&await Promise.allSettled(c.map(async([[l,u],h])=>this.a.updateValue(l,u.value,{resource:i,overrideIdentifiers:h},o)))}}async h(t,i,r,s,n){const o=c=>{const u=this.a.inspect(c,{resource:s})[i];if(u)return n?u.overrides?.find(({identifiers:h})=>Li(h,n))?.value:u.value},a=await t.migrateFn(r,o);return Array.isArray(a)?a:[[t.key,a]]}};CT=__decorate([__param(0,yi),__param(1,xf)],CT);var $T=class extends Q{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(t){super(),this.b=t,this.a=new Ni,this.ready=this.a.p,this.c()}async c(){try{await this.f()}finally{this.a.complete()}}async f(){if(!ze&&(await this.b.getEnvironment())?.os!==1)return;Zt.as(to.Configuration).registerConfiguration({...RQ,properties:{"security.allowedUNCHosts":{type:"array",items:{type:"string",pattern:"^[^\\\\]+$",patternErrorMessage:d(4381,null)},default:[],markdownDescription:d(4382,null),scope:3},"security.restrictUNCAccess":{type:"boolean",default:!0,markdownDescription:d(4383,null),scope:3}}})}};$T=__decorate([__param(0,dD)],$T);var bd="window.newWindowProfile",IT=class extends Q{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(t,i){super(),this.c=t,this.f=i,this.g(),this.D(this.c.onDidChangeProfiles(r=>this.g())),this.h(),this.j(),this.D(i.onDidChangeConfiguration(r=>{r.source!==7&&r.affectsConfiguration(bd)&&this.h()})),this.D(this.c.onDidChangeProfiles(()=>this.j()))}g(){const t=Zt.as(to.Configuration),i={...LQ,properties:{[bd]:{type:["string","null"],default:null,enum:[...this.c.profiles.map(r=>r.name),null],enumItemLabels:[...this.c.profiles.map(()=>""),d(4384,null)],description:d(4385,null),scope:1}}};this.a?t.updateConfigurations({add:[i],remove:[this.a]}):t.registerConfiguration(i),this.a=i}h(){const t=this.f.getValue(bd);this.b=t?this.c.profiles.find(i=>i.name===t):void 0}j(){const t=this.f.getValue(bd);if(!t)return;const i=this.b?this.c.profiles.find(r=>r.id===this.b.id):void 0;t!==i?.name&&this.f.updateValue(bd,i?.name)}};IT=__decorate([__param(0,IJ),__param(1,yi)],IT);var mle=H("editorResolverService"),UQ=Zt.as(to.Configuration),jQ={...NQ,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:d(15356,null),additionalProperties:{type:"string"}}}};UQ.registerConfiguration(jQ);var kS;(function(e){e.builtin="builtin",e.option="option",e.exclusive="exclusive",e.default="default"})(kS||(kS={}));var DT;(function(e){e[e.ABORT=1]="ABORT",e[e.NONE=2]="NONE"})(DT||(DT={}));function zQ(e,t){if(new Set([q.extension,q.webviewPanel,q.vscodeWorkspaceTrust,q.vscodeSettings]).has(t.scheme))return!1;const s=typeof e=="string"&&e.indexOf(Be.sep)>=0?`${t.scheme}:${t.path}`:dr(t);return Ec(e,s,{ignoreCase:!0})}var HQ=class Od{static{this.a=0}get activeNotebookEditor(){return this.k?.apiEditor}get visibleNotebookEditors(){return this.l.map(t=>t.apiEditor)}constructor(t,i,r,s,n,o,a){this.q=r,this.r=s,this.s=n,this.t=o,this.u=a,this.f=new Map,this.g=new zt,this.h=new Map,this.j=new I,this.onDidChangeActiveNotebookEditor=this.j.event,this.l=[],this.m=new I,this.onDidOpenNotebookDocument=this.m.event,this.n=new I,this.onDidCloseNotebookDocument=this.n.event,this.o=new I,this.onDidChangeVisibleNotebookEditors=this.o.event,this.p=new ls("NotebookCellStatusBarCache"),this.x=0,this.y=new Map,this.b=t.getProxy(X.MainThreadNotebook),this.c=t.getProxy(X.MainThreadNotebookDocuments),this.d=t.getProxy(X.MainThreadNotebookEditors),this.i=i.converter,i.registerArgumentProcessor({processArgument:c=>{if(c&&c.$mid===13){const l=c.notebookEditor?.notebookUri,u=c.cell.handle,f=this.g.get(l)?.getCell(u);if(f)return f.apiCell}if(c&&c.$mid===14){const l=c.uri,u=this.g.get(l);if(u)return u.apiNotebook}return c}}),Od.C(i)}getEditorById(t){const i=this.h.get(t);if(!i)throw new Error(`unknown text editor: ${t}. known editors: ${[...this.h.keys()]} `);return i}getIdByEditor(t){for(const[i,r]of this.h)if(r.apiEditor===t)return i}get notebookDocuments(){return[...this.g.values()]}getNotebookDocument(t,i){const r=this.g.get(t);if(!r&&!i)throw new Error(`NO notebook document for '${t}'`);return r}static w(t,i){if(!i)return;const r=i.filenamePattern.map(s=>Mg.from(s)).filter(s=>s!==void 0);if(i.filenamePattern&&!r){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return}return{extension:t.identifier,providerDisplayName:t.displayName||t.name,displayName:i.displayName,filenamePattern:r,priority:i.exclusive?kS.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(t,i,r){const s=Od.a++,n=typeof r.onDidChangeCellStatusBarItems=="function"?Od.a++:void 0;this.f.set(s,r),this.b.$registerNotebookCellStatusBarItemProvider(s,n,i);let o;return n!==void 0&&(o=r.onDidChangeCellStatusBarItems(a=>this.b.$emitCellStatusBarEvent(n))),new ke(()=>{this.f.delete(s),this.b.$unregisterNotebookCellStatusBarItemProvider(s,n),o?.dispose()})}async createNotebookDocument(t){const i=await this.c.$tryCreateNotebook({viewType:t.viewType,content:t.content&&ho.from(t.content)});return y.revive(i)}async openNotebookDocument(t){const i=this.g.get(t);if(i)return i.apiNotebook;const r=await this.c.$tryOpenNotebook(t),s=this.g.get(y.revive(r));return Xa(s?.apiNotebook)}async showNotebookDocument(t,i){let r;typeof i=="object"?r={position:Xt.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(Ms.from),pinned:typeof i.preview=="boolean"?!i.preview:void 0,label:typeof i.asRepl=="string"?i.asRepl:typeof i.asRepl=="object"?i.asRepl.label:void 0}:r={preserveFocus:!1,pinned:!0};const s=i?.asRepl?"repl":t.notebookType,n=await this.d.$tryShowNotebookDocument(t.uri,s,r),o=n&&this.h.get(n)?.apiEditor;if(o)return o;throw n?new Error(`Could NOT open editor for "${t.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${t.uri.toString()}".`)}async $provideNotebookCellStatusBarItems(t,i,r,s){const n=this.f.get(t),o=y.revive(i),a=this.g.get(o);if(!a||!n)return;const c=a.getCellFromIndex(r);if(!c)return;const l=await n.provideCellStatusBarItems(c.apiCell,s);if(!l)return;const u=new ie,h=this.p.add([u]),p=(Array.isArray(l)?l:[l]).map(g=>cy.from(g,this.i,u));return{cacheId:h,items:p}}$releaseNotebookCellStatusBarItems(t){this.p.delete(t)}registerNotebookSerializer(t,i,r,s,n){if(nu(i))throw new Error("viewType cannot be empty or just whitespace");const o=this.x++;return this.y.set(o,{viewType:i,serializer:r,options:s}),this.b.$registerNotebookSerializer(o,{id:t.identifier,location:t.extensionLocation},i,uy.from(s),Od.w(t,n)),te(()=>{this.b.$unregisterNotebookSerializer(o)})}async $dataToNotebook(t,i,r){const s=this.y.get(t);if(!s)throw new Error("NO serializer found");const n=await s.serializer.deserializeNotebook(i.buffer,r);return new fi(ho.from(n))}async $notebookToData(t,i,r){const s=this.y.get(t);if(!s)throw new Error("NO serializer found");const n=await s.serializer.serializeNotebook(ho.to(i.value),r);return W.wrap(n)}async $saveNotebook(t,i,r,s,n){const o=y.revive(i),a=this.y.get(t);this.D(`enter saveNotebook(versionId: ${r}, ${o.toString()})`);try{if(!a)throw new CS("NO serializer found");const c=this.g.get(o);if(!c)throw new CS("Document NOT found");if(c.versionId!==r)throw new CS("Document version mismatch, expected: "+r+", actual: "+c.versionId);if(!this.s.value.isWritableFileSystem(o.scheme))throw new Ff(d(3026,null,this.A(o)),6);const l={metadata:tk(c.apiNotebook.metadata,g=>!(a.options?.transientDocumentMetadata??{})[g]),cells:[]};for(const g of c.apiNotebook.getCells()){const v=new mp(g.kind,g.document.getText(),g.document.languageId,g.mime,a.options?.transientOutputs?[]:[...g.outputs],g.metadata,g.executionSummary);v.metadata=tk(g.metadata,b=>!(a.options?.transientCellMetadata??{})[b]),l.cells.push(v)}if(await this.z(o,s),n.isCancellationRequested)throw new dt;const u=await a.serializer.serializeNotebook(l,n);if(n.isCancellationRequested)throw new dt;this.D(`serialized versionId: ${r} ${o.toString()}`),await this.s.value.writeFile(o,u),this.D(`Finished write versionId: ${r} ${o.toString()}`);const h=this.s.getFileSystemProviderExtUri(o.scheme),f=await this.s.value.stat(o),p={name:h.basename(o),isFile:(f.type&tr.File)!==0,isDirectory:(f.type&tr.Directory)!==0,isSymbolicLink:(f.type&tr.SymbolicLink)!==0,mtime:f.mtime,ctime:f.ctime,size:f.size,readonly:!!((f.permissions??0)&Zn.Readonly)||!this.s.value.isWritableFileSystem(o.scheme),locked:!!((f.permissions??0)&Zn.Locked),etag:x$({mtime:f.mtime,size:f.size}),children:void 0};return this.D(`exit saveNotebook(versionId: ${r}, ${o.toString()})`),p}catch(c){if(c instanceof Ff)return{...c,message:c.message};throw c}}async $searchInNotebooks(t,i,r,s,n){const o=this.y.get(t)?.serializer;if(!o)return{limitHit:!1,results:[]};const a=new J5;await(async(f,p,g)=>{await Promise.all(f.map(async v=>await Promise.all(v.filenamePatterns.map(b=>{const S={_reason:g._reason,folderQueries:g.folderQueries,includePattern:g.includePattern,excludePattern:g.excludePattern,maxResults:g.maxResults,type:1,filePattern:b};return this.t.doInternalFileSearchWithCustomCallback(S,p,E=>{E.forEach($=>{a.has($)||s.some(O=>v.isFromSettings&&!O.isFromSettings?!1:O.filenamePatterns.some(J=>zQ(J,$)))||a.add($)})}).catch(E=>{if(E.code==="ENOENT")return console.warn("Could not find notebook search results, ignoring notebook results."),{limitHit:!1,messages:[]};throw E})}))))})(r,n,i);const l=new zt;let u=!1;const h=Array.from(a).map(async f=>{const p=[];try{if(n.isCancellationRequested)return;if(i.maxResults&&[...l.values()].reduce((S,E)=>S+E.cellResults.length,0)>i.maxResults){u=!0;return}const g=[],v=this.g.get(f);if(v)v.apiNotebook.getCells().forEach(E=>g.push({input:E.document.getText(),outputs:E.outputs.flatMap($=>$.items.map(U=>U.data.toString()))}));else{const S=await this.s.value.readFile(f),E=W.fromString(S.toString()),$=await o.deserializeNotebook(E.buffer,n);if(n.isCancellationRequested)return;ho.from($).cells.forEach(O=>g.push({input:O.source,outputs:O.outputs.flatMap(J=>J.items.map(F=>F.valueBytes.toString()))}))}if(n.isCancellationRequested)return;g.forEach((S,E)=>{const $=i.contentPattern.pattern,U=new MQ(S.input,void 0,S.outputs),O=U.findInInputs($),J=U.findInOutputs($),F=J.flatMap(V=>kT(V.matches,V.textBuffer)).map((V,z)=>(V.webviewIndex=z,V));if(O.length>0||J.length>0){const V={index:E,contentResults:kT(O,U.inputTextBuffer),webviewResults:F};p.push(V)}});const b={resource:f,cellResults:p};l.set(f,b);return}catch{return}});return await Promise.all(h),{limitHit:u,results:[...l.values()]}}async z(t,i){const r=await this.s.value.stat(t);if(typeof i?.mtime=="number"&&typeof i.etag=="string"&&i.etag!==wz&&typeof r.mtime=="number"&&typeof r.size=="number"&&i.mtime<r.mtime&&i.etag!==x$({mtime:i.mtime,size:r.size}))throw new Ff(d(3027,null),3,i)}A(t){return t.scheme===q.file?t.fsPath:t.toString()}B(t,i,r){if(this.h.has(i))throw new Error(`editor with id ALREADY EXSIST: ${i}`);const s=new vS(i,this.d,t,r.visibleRanges.map(Ms.to),r.selections.map(Ms.to),typeof r.viewColumn=="number"?Xt.to(r.viewColumn):void 0,r.viewType);this.h.set(i,s)}$acceptDocumentAndEditorsDelta(t){if(t.value.removedDocuments)for(const r of t.value.removedDocuments){const s=y.revive(r),n=this.g.get(s);n&&(n.dispose(),this.g.delete(s),this.q.$acceptDocumentsAndEditorsDelta({removedDocuments:n.apiNotebook.getCells().map(o=>o.document.uri)}),this.n.fire(n.apiNotebook));for(const o of this.h.values())o.notebookData.uri.toString()===s.toString()&&this.h.delete(o.id)}if(t.value.addedDocuments){const r=[];for(const s of t.value.addedDocuments){const n=y.revive(s.uri);if(this.g.has(n))throw new Error(`adding EXISTING notebook ${n} `);const o=new yQ(this.c,this.q,this.r,n,s);r.push(...s.cells.map(a=>mS.asModelAddData(a))),this.g.get(n)?.dispose(),this.g.set(n,o),this.q.$acceptDocumentsAndEditorsDelta({addedDocuments:r}),this.m.fire(o.apiNotebook)}}if(t.value.addedEditors)for(const r of t.value.addedEditors){if(this.h.has(r.id))return;const s=y.revive(r.documentUri),n=this.g.get(s);n&&this.B(n,r.id,r)}const i=[];if(t.value.removedEditors)for(const r of t.value.removedEditors){const s=this.h.get(r);s&&(this.h.delete(r),this.k?.id===s.id&&(this.k=void 0),i.push(s))}if(t.value.visibleEditors){this.l=t.value.visibleEditors.map(s=>this.h.get(s)).filter(s=>!!s);const r=new Set;this.l.forEach(s=>r.add(s.id));for(const s of this.h.values()){const n=r.has(s.id);s._acceptVisibility(n)}this.l=[...this.h.values()].map(s=>s).filter(s=>s.visible),this.o.fire(this.visibleNotebookEditors)}t.value.newActiveEditor===null?this.k=void 0:t.value.newActiveEditor&&(this.h.get(t.value.newActiveEditor)||console.error(`FAILED to find active notebook editor ${t.value.newActiveEditor}`),this.k=this.h.get(t.value.newActiveEditor)),t.value.newActiveEditor!==void 0&&this.j.fire(this.k?.apiEditor)}static C(t){const i=B.String.with("notebookType","A notebook type"),r=new ye("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new B("data","Bytes to convert to data",n=>n instanceof Uint8Array,n=>W.wrap(n))],new be("Notebook Data",n=>ho.to(n.value))),s=new ye("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new B("NotebookData","Notebook data to convert to bytes",n=>!0,n=>new fi(ho.from(n)))],new be("Bytes",n=>n.buffer));t.registerApiCommand(r),t.registerApiCommand(s)}D(t){this.u.trace(`[Extension Host Notebook] ${t}`)}},CS=class extends Error{constructor(e){super(e),this.name="NotebookSaveError"}},WQ=class{constructor(e,t,i,r={timeout:1500,errors:3}){this.b=e,this.c=t,this.d=i,this.f=r,this.a=new eu}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(t,i,r)=>{const s=function(o){t.call(i,o)};return s.extension=e,this.a.event(s,void 0,r)}}async $participateInSave(e,t,i){const r=y.revive(e),s=this.c.getNotebookDocument(r);if(!s)throw new Error("Unable to resolve notebook document");const n=[];if(await this.a.fireAsync({notebook:s.apiNotebook,reason:Ig.to(t)},i,async(a,c)=>{const l=Date.now(),u=await await Promise.resolve(a);Date.now()-l>this.f.timeout&&this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier),!i.isCancellationRequested&&u&&(u instanceof da?n.push(u):this.b.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data"))}),i.isCancellationRequested)return!1;if(n.length===0)return!0;const o={edits:[]};for(const a of n){const{edits:c}=nr.from(a);o.edits=o.edits.concat(c)}return this.d.$tryApplyWorkspaceEdit(new fi(o))}},BQ=class{constructor(e){this.c=e,this.a=new I,this.onDidSaveNotebookDocument=this.a.event,this.b=new I,this.onDidChangeNotebookDocument=this.b.event}$acceptModelChanged(e,t,i,r){const n=this.c.getNotebookDocument(y.revive(e)).acceptModelChanged(t.value,i,r);this.b.fire(n)}$acceptDirtyStateChanged(e,t){this.c.getNotebookDocument(y.revive(e)).acceptDirty(t)}$acceptModelSaved(e){const t=this.c.getNotebookDocument(y.revive(e));this.a.fire(t.apiNotebook)}},$S=class{constructor(t,i){this.c=t,this.d=i,this.a=new I,this.b=new I,this.onDidChangeNotebookEditorSelection=this.a.event,this.onDidChangeNotebookEditorVisibleRanges=this.b.event}$acceptEditorPropertiesChanged(t,i){this.c.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",t,i);const r=this.d.getEditorById(t);i.visibleRanges&&r._acceptVisibleRanges(i.visibleRanges.ranges.map(Ms.to)),i.selections&&r._acceptSelections(i.selections.selections.map(Ms.to)),i.visibleRanges&&this.b.fire({notebookEditor:r.apiEditor,visibleRanges:r.apiEditor.visibleRanges}),i.selections&&this.a.fire(Object.freeze({notebookEditor:r.apiEditor,selections:r.apiEditor.selections}))}$acceptEditorViewColumns(t){for(const i in t)this.d.getEditorById(i)._acceptViewColumn(Xt.to(t[i]))}};$S=__decorate([__param(0,Se)],$S);var Nl;(function(e){e[e.Output=1]="Output",e[e.OutputItems=2]="OutputItems",e[e.ExecutionState=3]="ExecutionState"})(Nl||(Nl={}));var wle=H("INotebookExecutionService"),_Q=100,PT;(function(e){e[e.Disconnected=1]="Disconnected",e[e.Connected=2]="Connected",e[e.Initializing=3]="Initializing"})(PT||(PT={}));var ble=H("INotebookKernelService"),yle=H("INotebookKernelHistoryService"),IS=class{constructor(t,i,r,s,n){this.l=i,this.m=r,this.n=s,this.o=n,this.b=new zt,this.c=new zt,this.f=new Map,this.g=0,this.h=new Map,this.i=0,this.j=new Map,this.k=0,this.q=0,this.r={},this.a=t.getProxy(X.MainThreadNotebookKernels);const o=new ye("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new B("options","Select kernel options",c=>!0,c=>{if(c&&"notebookEditor"in c&&"id"in c){const l=this.m.getIdByEditor(c.notebookEditor);return{id:c.id,extension:c.extension,notebookEditorId:l}}else if(c&&"notebookEditor"in c){const l=this.m.getIdByEditor(c.notebookEditor);if(l===void 0)throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${c.notebookEditor.notebook.uri.toString()}`);return"skipIfAlreadySelected"in c?{notebookEditorId:l,skipIfAlreadySelected:c.skipIfAlreadySelected}:{notebookEditorId:l}}return c})],be.Void),a=new ye("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[B.Uri],new be("A promise that resolves to an array of variables",(c,l)=>c.map(u=>({variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}))));this.n.registerApiCommand(o),this.n.registerApiCommand(a)}createNotebookController(t,i,r,s,n,o){for(const O of this.j.values())if(O.controller.id===i&&Ye.equals(t.identifier,O.extensionId))throw new Error(`notebook controller with id '${i}' ALREADY exist`);const a=this.k++,c=this;this.o.trace(`NotebookController[${a}], CREATED by ${t.identifier.value}, ${i}`);const l=()=>console.warn(`NO execute handler from notebook controller '${p.id}' of extension: '${t.identifier}'`);let u=!1;const h=new I,f=new I,p={id:I1(t.identifier,i),notebookType:r,extensionId:t.identifier,extensionLocation:t.extensionLocation,label:s||t.identifier.value,preloads:o?o.map(Ng.from):[]};let g=n??l,v,b;this.a.$addKernel(a,p).catch(O=>{console.log(O),u=!0});let S=0;const E=()=>{if(u)return;const O=++S;Promise.resolve().then(()=>{O===S&&this.a.$updateKernel(a,p)})},$=new zt,U={get id(){return i},get notebookType(){return p.notebookType},onDidChangeSelectedNotebooks:h.event,get label(){return p.label},set label(O){p.label=O??t.displayName??t.name,E()},get detail(){return p.detail??""},set detail(O){p.detail=O,E()},get description(){return p.description??""},set description(O){p.description=O,E()},get supportedLanguages(){return p.supportedLanguages},set supportedLanguages(O){p.supportedLanguages=O,E()},get supportsExecutionOrder(){return p.supportsExecutionOrder??!1},set supportsExecutionOrder(O){p.supportsExecutionOrder=O,E()},get rendererScripts(){return p.preloads?p.preloads.map(Ng.to):[]},get executeHandler(){return g},set executeHandler(O){g=O??l},get interruptHandler(){return v},set interruptHandler(O){v=O,p.supportsInterrupt=!!O,E()},set variableProvider(O){T(t,"notebookVariableProvider"),b=O,p.hasVariableProvider=!!O,O?.onDidChangeVariables(J=>c.a.$variablesUpdated(J.uri)),E()},get variableProvider(){return b},createNotebookCellExecution(O){if(u)throw new Error("notebook controller is DISPOSED");if(!$.has(O.notebook.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from($.keys()).map(J=>J.toString())),new Error(`notebook controller is NOT associated to notebook: ${O.notebook.uri.toString()}`);return c._createNotebookCellExecution(O,I1(t.identifier,this.id))},createNotebookExecution(O){if(T(t,"notebookExecution"),u)throw new Error("notebook controller is DISPOSED");if(!$.has(O.uri))throw c.o.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from($.keys()).map(J=>J.toString())),new Error(`notebook controller is NOT associated to notebook: ${O.uri.toString()}`);return c._createNotebookExecution(O,I1(t.identifier,this.id))},dispose:()=>{u||(this.o.trace(`NotebookController[${a}], DISPOSED`),u=!0,this.j.delete(a),h.dispose(),f.dispose(),this.a.$removeKernel(a))},updateNotebookAffinity(O,J){J===Zp.Hidden&&T(t,"notebookControllerAffinityHidden"),c.a.$updateNotebookPriority(a,O.uri,J)},onDidReceiveMessage:f.event,postMessage(O,J){return T(t,"notebookMessaging"),c.a.$postMessage(a,J&&c.m.getIdByEditor(J),O)},asWebviewUri(O){return T(t,"notebookMessaging"),nd(O,c.l.remote)}};return this.j.set(a,{extensionId:t.identifier,controller:U,onDidReceiveMessage:f,onDidChangeSelection:h,associatedNotebooks:$}),U}getIdByController(t){for(const[i,r]of this.j)if(r.controller===t)return I1(r.extensionId,t.id);return null}createNotebookControllerDetectionTask(t,i){const r=this.g++,s=this;this.o.trace(`NotebookControllerDetectionTask[${r}], CREATED by ${t.identifier.value}`),this.a.$addKernelDetectionTask(r,i);const n={dispose:()=>{this.f.delete(r),s.a.$removeKernelDetectionTask(r)}};return this.f.set(r,n),n}registerKernelSourceActionProvider(t,i,r){const s=this.i++,n=typeof r.onDidChangeNotebookKernelSourceActions=="function"?s:void 0,o=this;this.h.set(s,r),this.o.trace(`NotebookKernelSourceActionProvider[${s}], CREATED by ${t.identifier.value}`),this.a.$addKernelSourceActionProvider(s,s,i);let a;return n!==void 0&&(a=r.onDidChangeNotebookKernelSourceActions(c=>this.a.$emitNotebookKernelSourceActionsChangeEvent(n))),{dispose:()=>{this.h.delete(s),o.a.$removeKernelSourceActionProvider(s,s),a?.dispose()}}}async $provideKernelSourceActions(t,i){const r=this.h.get(t);if(r){const s=new ie;return(await r.provideNotebookKernelSourceActions(i)??[]).map(o=>ly.from(o,this.n.converter,s))}return[]}$acceptNotebookAssociation(t,i,r){const s=this.j.get(t);if(s){const n=this.m.getNotebookDocument(y.revive(i));r?s.associatedNotebooks.set(n.uri,!0):s.associatedNotebooks.delete(n.uri),this.o.trace(`NotebookController[${t}] ASSOCIATE notebook`,n.uri.toString(),r),s.onDidChangeSelection.fire({selected:r,notebook:n.apiNotebook})}}async $executeCells(t,i,r){const s=this.j.get(t);if(!s)return;const n=this.m.getNotebookDocument(y.revive(i)),o=[];for(const a of r){const c=n.getCell(a);c&&o.push(c.apiCell)}try{this.o.trace(`NotebookController[${t}] EXECUTE cells`,n.uri.toString(),o.length),await s.controller.executeHandler.call(s.controller,o,n.apiNotebook,s.controller)}catch(a){this.o.error(`NotebookController[${t}] execute cells FAILED`,a),console.error(a)}}async $cancelCells(t,i,r){const s=this.j.get(t);if(!s)return;const n=this.m.getNotebookDocument(y.revive(i));if(s.controller.interruptHandler)await s.controller.interruptHandler.call(s.controller,n.apiNotebook);else for(const o of r){const a=n.getCell(o);a&&this.b.get(a.uri)?.cancel()}if(s.controller.interruptHandler){const o=this.c.get(n.uri);this.c.delete(n.uri),r.length&&Array.isArray(o)&&o.length&&o.forEach(a=>a.dispose())}}async $provideVariables(t,i,r,s,n,o,a){const c=this.j.get(t);if(!c)return;const l=this.m.getNotebookDocument(y.revive(r)),u=c.controller.variableProvider;if(!u)return;let h;if(s!==void 0){if(h=this.r[s],!h)return}else this.r={};const f=n==="named"?uh.Named:uh.Indexed,p=u.provideVariables(l.apiNotebook,h,f,o,a);let g=0;for await(const v of p){if(a.isCancellationRequested)return;const b={id:this.q++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:c.extensionId.value};if(this.r[b.id]=v.variable,this.a.$receiveVariable(i,b),g++>=_Q)return}}$acceptKernelMessageFromRenderer(t,i,r){const s=this.j.get(t);if(!s)return;const n=this.m.getEditorById(i);s.onDidReceiveMessage.fire(Object.freeze({editor:n.apiEditor,message:r}))}_createNotebookCellExecution(t,i){if(t.index<0)throw new Error("CANNOT execute cell that has been REMOVED from notebook");const s=this.m.getNotebookDocument(t.notebook.uri).getCellFromApiCell(t);if(!s)throw new Error("invalid cell");if(this.b.has(s.uri))throw new Error(`duplicate execution for ${s.uri}`);const n=new VQ(i,s,this.a);this.b.set(s.uri,n);const o=n.onDidChangeState(()=>{n.state===ds.Resolved&&(n.dispose(),o.dispose(),this.b.delete(s.uri))});return n.asApiObject()}_createNotebookExecution(t,i){const r=this.m.getNotebookDocument(t.uri),s=t.getCells().find(a=>{const c=r.getCellFromApiCell(a);return c&&this.b.has(c.uri)});if(s)throw new Error(`duplicate cell execution for ${s.document.uri}`);if(this.c.has(r.uri))throw new Error(`duplicate notebook execution for ${r.uri}`);const n=new GQ(i,r,this.a),o=n.onDidChangeState(()=>{n.state===wn.Resolved&&(n.dispose(),o.dispose(),this.c.delete(r.uri))});return this.c.set(r.uri,[n,o]),n.asApiObject()}};IS=__decorate([__param(4,Se)],IS);var ds;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(ds||(ds={}));var VQ=class BN extends Q{static{this.a=0}get state(){return this.f}constructor(t,i,r){super(),this.m=i,this.n=r,this.b=BN.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=ds.Init,this.g=this.D(new Qe),this.h=new ZQ(10,s=>this.r(s)),this.j=i.internalMetadata.executionOrder,this.n.$createExecution(this.b,t,this.m.notebook.uri,this.m.handle)}cancel(){this.g.cancel()}async q(t){await this.h.addItem(t)}async r(t){const i=Array.isArray(t)?t:[t];return this.n.$updateExecution(this.b,new fi(i))}s(){if(this.f===ds.Init)throw new Error("Must call start before modifying cell output");if(this.f===ds.Resolved)throw new Error("Cannot modify cell output after calling resolve")}t(t){let i=this.m;if(t&&(i=this.m.notebook.getCellFromApiCell(t)),!i)throw new Error("INVALID cell");return i.handle}w(t){return t.map(i=>{const r=wp.ensureUniqueMimeTypes(i.items,!0);return r===i.items?fo.from(i):fo.from({items:r,id:i.id,metadata:i.metadata})})}async y(t,i,r){const s=this.t(i),n=this.w(Sr(t));return this.q({editType:Nl.Output,cellHandle:s,append:r,outputs:n})}async z(t,i,r){return t=wp.ensureUniqueMimeTypes(Sr(t),!0),this.q({editType:Nl.OutputItems,items:t.map(cl.from),outputId:i.id,append:r})}asApiObject(){const t=this;return Object.freeze({get token(){return t.g.token},get cell(){return t.m.apiCell},get executionOrder(){return t.j},set executionOrder(r){t.j=r,t.r([{editType:Nl.ExecutionState,executionOrder:t.j}])},start(r){if(t.f===ds.Resolved||t.f===ds.Started)throw new Error("Cannot call start again");t.f=ds.Started,t.c.fire(),t.r({editType:Nl.ExecutionState,runStartTime:r})},end(r,s,n){if(t.f===ds.Resolved)throw new Error("Cannot call resolve twice");t.f=ds.Resolved,t.c.fire(),t.h.flush();const o=qQ(n);t.n.$completeExecution(t.b,new fi({runEndTime:s,lastRunSuccess:r,error:o}))},clearOutput(r){return t.s(),t.y([],r,!1)},appendOutput(r,s){return t.s(),t.y(r,s,!0)},replaceOutput(r,s){return t.s(),t.y(r,s,!1)},appendOutputItems(r,s){return t.s(),t.z(r,s,!0)},replaceOutputItems(r,s){return t.s(),t.z(r,s,!1)}})}};function qQ(e){const t=s=>s?{startLineNumber:s.start.line,startColumn:s.start.character,endLineNumber:s.end.line,endColumn:s.end.character}:void 0,i=s=>({uri:s.uri,position:s.position,label:s.label});return e?{name:e.name,message:e.message,stack:e.stack instanceof Array?e.stack.map(s=>i(s)):e.stack,location:t(e.location),uri:e.uri}:void 0}var wn;(function(e){e[e.Init=0]="Init",e[e.Started=1]="Started",e[e.Resolved=2]="Resolved"})(wn||(wn={}));var GQ=class _N extends Q{static{this.a=0}get state(){return this.f}constructor(t,i,r){super(),this.h=i,this.j=r,this.b=_N.a++,this.c=new I,this.onDidChangeState=this.c.event,this.f=wn.Init,this.g=this.D(new Qe),this.j.$createNotebookExecution(this.b,t,this.h.uri)}cancel(){this.g.cancel()}asApiObject(){return Object.freeze({start:()=>{if(this.f===wn.Resolved||this.f===wn.Started)throw new Error("Cannot call start again");this.f=wn.Started,this.c.fire(),this.j.$beginNotebookExecution(this.b)},end:()=>{if(this.f===wn.Resolved)throw new Error("Cannot call resolve twice");this.f=wn.Resolved,this.c.fire(),this.j.$completeNotebookExecution(this.b)}})}},ZQ=class{constructor(e,t){this.f=e,this.g=t,this.a=[],this.b=Date.now()}addItem(e){return this.a.push(e),this.c||(this.c=new Ni,this.b=Date.now(),ri(this.f).then(()=>this.flush())),Date.now()-this.b>this.f?this.flush():this.c.p}flush(){if(this.a.length===0||!this.c)return Promise.resolve();const e=this.c;this.c=void 0;const t=this.a;return this.a=[],this.g(t).finally(()=>e.complete())}};function I1(e,t){return`${e.value}/${t}`}var JQ=class{constructor(e,t){this.c=t,this.a=new Map,this.b=e.getProxy(X.MainThreadNotebookRenderers)}$postRendererMessage(e,t,i){const r=this.c.getEditorById(e);this.a.get(t)?.fire({editor:r.apiEditor,message:i})}createRendererMessaging(e,t){if(!e.contributes?.notebookRenderer?.some(r=>r.id===t))throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${t})`);return{onDidReceiveMessage:(r,s,n)=>this.d(t).event(r,s,n),postMessage:(r,s)=>{vS.apiEditorsToExtHost.has(r)&&([r,s]=[s,r]);const n=s&&vS.apiEditorsToExtHost.get(s);return this.b.$postMessage(n?.id,t,r)}}}d(e){let t=this.a.get(e);return t||(t=new I({onDidRemoveLastListener:()=>{t?.dispose(),this.a.delete(e)}}),this.a.set(e,t),t)}},QQ=class{constructor(e){this.b=new Map,this.a=e.getProxy(X.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,t,i){if(T(e,"profileContentHandlers"),this.b.has(t))throw new Error(`Handler with id '${t}' already registered`);return this.b.set(t,i),this.a.$registerProfileContentHandler(t,i.name,i.description,e.identifier.value),te(()=>{this.b.delete(t),this.a.$unregisterProfileContentHandler(t)})}async $saveProfile(e,t,i,r){const s=this.b.get(e);if(!s)throw new Error(`Unknown handler with id: ${e}`);return s.saveProfile(t,i,r)}async $readProfile(e,t,i){const r=this.b.get(e);if(!r)throw new Error(`Unknown handler with id: ${e}`);return r.readProfile(Oe(t)?t:y.revive(t),i)}},YQ=class VN{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(X.MainThreadQuickDiff)}$provideOriginalResource(t,i,r){const s=y.revive(i),n=this.c.get(t);return n?di(()=>n.provideOriginalResource(s,r)).then(o=>o||null):Promise.resolve(null)}registerQuickDiffProvider(t,i,r,s,n,o){const a=VN.a++;this.c.set(a,r);const c=Ye.toKey(t.identifier);return this.b.$registerQuickDiffProvider(a,Sa.from(i,this.d),`${c}.${s}`,n,o),{dispose:()=>{this.b.$unregisterQuickDiffProvider(a),this.c.delete(a)}}}};function XQ(e,t,i){const r=e.getProxy(X.MainThreadQuickOpen);class s{constructor(l,u){this.e=new Map,this.f=0,this.a=l,this.b=u}showQuickPick(l,u,h,f=Fe.None){this.c=void 0;const p=Promise.resolve(u),g=++this.f;h?.prompt&&T(l,"quickPickPrompt");const v=r.$show(g,{title:h?.title,placeHolder:h?.placeHolder,prompt:h?.prompt,matchOnDescription:h?.matchOnDescription,matchOnDetail:h?.matchOnDetail,ignoreFocusLost:h?.ignoreFocusOut,canPickMany:h?.canPickMany},f),b={},S=v.then(()=>b);return Promise.race([S,p]).then(E=>{if(E!==b)return p.then($=>{const U=[];for(let O=0;O<$.length;O++){const J=$[O];typeof J=="string"?U.push({label:J,handle:O}):J.kind===lh.Separator?U.push({type:"separator",label:J.label}):(J.tooltip&&T(l,"quickPickItemTooltip"),J.resourceUri&&T(l,"quickPickItemResource"),U.push({label:J.label,iconPathDto:go.from(J.iconPath),description:J.description,detail:J.detail,picked:J.picked,alwaysShow:J.alwaysShow,tooltip:ge.fromStrict(J.tooltip),resourceUri:J.resourceUri,handle:O}))}return h&&typeof h.onDidSelectItem=="function"&&(this.c=O=>{h.onDidSelectItem($[O])}),r.$setItems(g,U),v.then(O=>{if(typeof O=="number")return $[O];if(Array.isArray(O))return O.map(J=>$[J])})})}).then(void 0,E=>{if(!Ti(E))return r.$setError(g,E),Promise.reject(E)})}$onItemSelected(l){this.c?.(l)}showInput(l,u=Fe.None){return this.d=l?.validateInput,r.$input(l,typeof this.d=="function",u).then(void 0,h=>{if(!Ti(h))return Promise.reject(h)})}async $validateInput(l){if(!this.d)return;const u=await this.d(l);if(!u||typeof u=="string")return u;let h;switch(u.severity){case Jc.Info:h=Mt.Info;break;case Jc.Warning:h=Mt.Warning;break;case Jc.Error:h=Mt.Error;break;default:h=u.message?Mt.Error:Mt.Ignore;break}return{content:u.message,severity:h}}async showWorkspaceFolderPick(l,u=Fe.None){const h=await this.b.executeCommand("_workbench.pickWorkspaceFolder",[l]);if(!h)return;const f=await this.a.getWorkspaceFolders2();if(f)return f.find(p=>p.uri.toString()===h.uri.toString())}createQuickPick(l){const u=new o(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}createInputBox(l){const u=new a(l,()=>this.e.delete(u._id));return this.e.set(u._id,u),u}$onDidChangeValue(l,u){this.e.get(l)?._fireDidChangeValue(u)}$onDidAccept(l){this.e.get(l)?._fireDidAccept()}$onDidChangeActive(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeActive(u)}$onDidChangeSelection(l,u){const h=this.e.get(l);h instanceof o&&h._fireDidChangeSelection(u)}$onDidTriggerButton(l,u,h){this.e.get(l)?._fireDidTriggerButton(u,h)}$onDidTriggerItemButton(l,u,h){const f=this.e.get(l);f instanceof o&&f._fireDidTriggerItemButton(u,h)}$onDidHide(l){this.e.get(l)?._fireDidHide()}}class n{static{this.a=1}constructor(l,u){this.y=l,this.z=u,this._id=o.a++,this.e=!1,this.f=!1,this.g=!0,this.j=!1,this.k=!0,this.l="",this.m=void 0,this.o=[],this.p=new Map,this.q=new I,this.r=new I,this.s=new I,this.t=new I,this.v={id:this._id},this.w=!1,this.x=[this.s,this.t,this.q,this.r],this.onDidChangeValue=this.r.event,this.onDidAccept=this.q.event,this.onDidTriggerButton=this.s.event,this.onDidHide=this.t.event}get title(){return this.b}set title(l){this.b=l,this.A({title:l})}get step(){return this.c}set step(l){this.c=l,this.A({step:l})}get totalSteps(){return this.d}set totalSteps(l){this.d=l,this.A({totalSteps:l})}get enabled(){return this.g}set enabled(l){this.g=l,this.A({enabled:l})}get busy(){return this.j}set busy(l){this.j=l,this.A({busy:l})}get ignoreFocusOut(){return this.k}set ignoreFocusOut(l){this.k=l,this.A({ignoreFocusOut:l})}get value(){return this.l}set value(l){this.l=l,this.A({value:l})}get valueSelection(){return this.m}set valueSelection(l){this.m=l,this.A({valueSelection:l})}get placeholder(){return this.n}set placeholder(l){this.n=l,this.A({placeholder:l})}get buttons(){return this.o}set buttons(l){if(l.some(u=>typeof u.location=="number"||typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean")&&T(this.y,"quickInputButtonLocation"),l.some(u=>typeof u.location=="number"&&u.location!==_p.Input&&typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean"))throw new Error("QuickInputButtons with toggle set are only supported in the Input location.");this.o=l.slice(),this.p.clear(),l.forEach((u,h)=>{const f=u===ch.Back?-1:h;this.p.set(f,u)}),this.A({buttons:l.map((u,h)=>({iconPathDto:go.from(u.iconPath),tooltip:u.tooltip,handle:u===ch.Back?-1:h,location:typeof u.location=="number"?u.location:void 0,checked:typeof u.toggle=="object"&&typeof u.toggle.checked=="boolean"?u.toggle.checked:void 0}))})}show(){this.e=!0,this.f=!0,this.A({visible:!0})}hide(){this.e=!1,this.A({visible:!1})}_fireDidAccept(){this.q.fire()}_fireDidChangeValue(l){this.l=l,this.r.fire(l)}_fireDidTriggerButton(l,u){const h=this.p.get(l);h&&(u!==void 0&&h.toggle&&(h.toggle.checked=u),this.s.fire(h))}_fireDidHide(){this.f&&(this.f=this.e,this.t.fire())}dispose(){this.w||(this.w=!0,this._fireDidHide(),this.x=Zi(this.x),this.u&&(clearTimeout(this.u),this.u=void 0),this.z(),r.$dispose(this._id))}A(l){if(!this.w){for(const u of Object.keys(l)){const h=l[u];this.v[u]=h===void 0?null:h}"visible"in this.v?(this.u&&(clearTimeout(this.u),this.u=void 0),this.B()):this.e&&!this.u&&(this.u=setTimeout(()=>{this.u=void 0,this.B()},0))}}B(){r.$createOrUpdate(this.v),this.v={id:this._id}}}class o extends n{constructor(l,u){super(l,u),this.C=[],this.D=new Map,this.E=new Map,this.F=!1,this.G=!0,this.H=!0,this.I=!0,this.J=!1,this.K=[],this.M=new I,this.N=[],this.O=new I,this.P=new I,this.onDidChangeActive=this.M.event,this.onDidChangeSelection=this.O.event,this.onDidTriggerItemButton=this.P.event,this.x.push(this.M,this.O,this.P),this.A({type:"quickPick"})}get items(){return this.C}set items(l){this.C=l.slice(),this.D.clear(),this.E.clear(),l.forEach((h,f)=>{this.D.set(f,h),this.E.set(h,f)});const u=[];for(let h=0;h<l.length;h++){const f=l[h];f.kind===lh.Separator?u.push({type:"separator",label:f.label}):(f.tooltip&&T(this.y,"quickPickItemTooltip"),f.resourceUri&&T(this.y,"quickPickItemResource"),u.push({handle:h,label:f.label,iconPathDto:go.from(f.iconPath),description:f.description,detail:f.detail,picked:f.picked,alwaysShow:f.alwaysShow,tooltip:ge.fromStrict(f.tooltip),resourceUri:f.resourceUri,buttons:f.buttons?.map((p,g)=>({iconPathDto:go.from(p.iconPath),tooltip:p.tooltip,handle:g}))}))}this.A({items:u})}get canSelectMany(){return this.F}set canSelectMany(l){this.F=l,this.A({canSelectMany:l})}get matchOnDescription(){return this.G}set matchOnDescription(l){this.G=l,this.A({matchOnDescription:l})}get matchOnDetail(){return this.H}set matchOnDetail(l){this.H=l,this.A({matchOnDetail:l})}get sortByLabel(){return this.I}set sortByLabel(l){this.I=l,this.A({sortByLabel:l})}get keepScrollPosition(){return this.J}set keepScrollPosition(l){this.J=l,this.A({keepScrollPosition:l})}get prompt(){return this.L}set prompt(l){T(this.y,"quickPickPrompt"),this.L=l,this.A({prompt:l})}get activeItems(){return this.K}set activeItems(l){this.K=l.filter(u=>this.E.has(u)),this.A({activeItems:this.K.map(u=>this.E.get(u))})}get selectedItems(){return this.N}set selectedItems(l){this.N=l.filter(u=>this.E.has(u)),this.A({selectedItems:this.N.map(u=>this.E.get(u))})}_fireDidChangeActive(l){const u=gt(l.map(h=>this.D.get(h)));this.K=u,this.M.fire(u)}_fireDidChangeSelection(l){const u=gt(l.map(h=>this.D.get(h)));this.N=u,this.O.fire(u)}_fireDidTriggerItemButton(l,u){const h=this.D.get(l);if(!h||!h.buttons||!h.buttons.length)return;const f=h.buttons[u];f&&this.P.fire({button:f,item:h})}}class a extends n{constructor(l,u){super(l,u),this.C=!1,this.A({type:"inputBox"})}get password(){return this.C}set password(l){this.C=l,this.A({password:l})}get prompt(){return this.D}set prompt(l){this.D=l,this.A({prompt:l})}get validationMessage(){return this.E}set validationMessage(l){this.E=l,l?typeof l=="string"?this.A({validationMessage:l,severity:Mt.Error}):this.A({validationMessage:l.message,severity:l.severity??Mt.Error}):this.A({validationMessage:void 0,severity:Mt.Ignore})}}return new s(t,i)}function TT(e){return e instanceof y}function KQ(e,t){return e.scheme===q.file&&t.scheme===q.file&&$t?e.toString()===t.toString():e.toString().toLowerCase()===t.toString().toLowerCase()}function DS(e){if(e)return typeof e.iconPath=="string"?y.file(e.iconPath):y.isUri(e.iconPath)||Nt.isThemeIcon(e.iconPath)?e.iconPath:void 0}function Fs(e){if(e){if(y.isUri(e))return e;if(Nt.isThemeIcon(e))return e;{const t=e;return{light:t.light,dark:t.dark}}}else return}function MT(e){const t=Fs(e.authorIcon),i=Array.isArray(e.tooltip)?ge.fromMany(e.tooltip):e.tooltip?ge.from(e.tooltip):void 0,r=e.references?.map(s=>({...s,icon:Fs(s.icon)}));return{...e,authorIcon:t,references:r,tooltip:i}}function PS(e){return e?{...e,icon:Fs(e.icon)}:void 0}function TS(e,t){if(!e.iconPath&&!t.iconPath)return 0;if(e.iconPath){if(!t.iconPath)return 1}else return-1;const i=typeof e.iconPath=="string"?e.iconPath:y.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id,r=typeof t.iconPath=="string"?t.iconPath:y.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;return Gm(i,r)}function eY(e,t){let i=0;if(e.strikeThrough!==t.strikeThrough)return e.strikeThrough?1:-1;if(e.faded!==t.faded)return e.faded?1:-1;if(e.tooltip!==t.tooltip)return(e.tooltip||"").localeCompare(t.tooltip||"");if(i=TS(e,t),i!==0)return i;if(e.light&&t.light)i=TS(e.light,t.light);else{if(e.light)return 1;if(t.light)return-1}if(i!==0)return i;if(e.dark&&t.dark)i=TS(e.dark,t.dark);else{if(e.dark)return 1;if(t.dark)return-1}return i}function tY(e,t){if(e.command!==t.command)return e.command<t.command?-1:1;if(e.title!==t.title)return e.title<t.title?-1:1;if(e.tooltip!==t.tooltip){if(e.tooltip!==void 0&&t.tooltip!==void 0)return e.tooltip<t.tooltip?-1:1;if(e.tooltip!==void 0)return 1;if(t.tooltip!==void 0)return-1}if(e.arguments===t.arguments)return 0;if(e.arguments)if(t.arguments){if(e.arguments.length!==t.arguments.length)return e.arguments.length-t.arguments.length}else return 1;else return-1;for(let i=0;i<e.arguments.length;i++){const r=e.arguments[i],s=t.arguments[i];if(r!==s&&!(TT(r)&&TT(s)&&KQ(r,s)))return r<s?-1:1}return 0}function NT(e,t){let i=Gm(e.resourceUri.fsPath,t.resourceUri.fsPath,!0);if(i!==0)return i;if(e.command&&t.command)i=tY(e.command,t.command);else{if(e.command)return 1;if(t.command)return-1}if(i!==0)return i;if(e.decorations&&t.decorations)i=eY(e.decorations,t.decorations);else{if(e.decorations)return 1;if(t.decorations)return-1}if(i!==0)return i;if(e.multiFileDiffEditorModifiedUri&&t.multiFileDiffEditorModifiedUri)i=Gm(e.multiFileDiffEditorModifiedUri.fsPath,t.multiFileDiffEditorModifiedUri.fsPath,!0);else{if(e.multiFileDiffEditorModifiedUri)return 1;if(t.multiFileDiffEditorModifiedUri)return-1}if(i!==0)return i;if(e.multiDiffEditorOriginalUri&&t.multiDiffEditorOriginalUri)i=Gm(e.multiDiffEditorOriginalUri.fsPath,t.multiDiffEditorOriginalUri.fsPath,!0);else{if(e.multiDiffEditorOriginalUri)return 1;if(t.multiDiffEditorOriginalUri)return-1}return i}function iY(e,t){for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function rY(e,t){return e.command===t.command&&e.title===t.title&&e.tooltip===t.tooltip&&(e.arguments&&t.arguments?iY(e.arguments,t.arguments):e.arguments===t.arguments)}function sY(e,t){return Gi(e,t,rY)}var nY=class{#e;#t;get value(){return this.d}set value(e){e=e??"",this.#e.$setInputBoxValue(this.m,e),this.o(e)}get onDidChange(){return this.f.event}get placeholder(){return this.g}set placeholder(e){this.#e.$setInputBoxPlaceholder(this.m,e),this.g=e}get validateInput(){return T(this.l,"scmValidation"),this.h}set validateInput(e){if(T(this.l,"scmValidation"),e&&typeof e!="function")throw new Error(`[${this.l.identifier.value}]: Invalid SCM input box validation function`);this.h=e,this.#e.$setValidationProviderIsEnabled(this.m,!!e)}get enabled(){return this.j}set enabled(e){e=!!e,this.j!==e&&(this.j=e,this.#e.$setInputBoxEnablement(this.m,e))}get visible(){return this.k}set visible(e){e=!!e,this.k!==e&&(this.k=e,this.#e.$setInputBoxVisibility(this.m,e))}get document(){return T(this.l,"scmTextDocument"),this.#t.getDocument(this.n)}constructor(e,t,i,r,s){this.l=e,this.m=r,this.n=s,this.d="",this.f=new I,this.g="",this.j=!0,this.k=!0,this.#t=t,this.#e=i}showValidationMessage(e,t){T(this.l,"scmValidation"),this.#e.$showValidationMessage(this.m,e,Ny.from(t))}$onInputBoxValueChange(e){this.o(e)}o(e){this.d=e,this.f.fire(e)}},oY=class qN{static{this.d=0}get disposed(){return this.m}get id(){return this.x}get label(){return this.y}set label(t){this.y=t,this.u.$updateGroupLabel(this.w,this.handle,t)}get contextValue(){return this.q}set contextValue(t){this.q=t,this.u.$updateGroup(this.w,this.handle,this.features)}get hideWhenEmpty(){return this.t}set hideWhenEmpty(t){this.t=t,this.u.$updateGroup(this.w,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this.g]}set resourceStates(t){this.g=[...t],this.l.fire()}constructor(t,i,r,s,n,o,a){this.u=t,this.v=i,this.w=r,this.x=s,this.y=n,this.multiDiffEditorEnableViewChanges=o,this.z=a,this.f=0,this.g=[],this.h=new Map,this.j=new Map,this.k=new Map,this.l=new I,this.onDidUpdateResourceStates=this.l.event,this.m=!1,this.n=new I,this.onDidDispose=this.n.event,this.o=[],this.p=[],this.q=void 0,this.t=void 0,this.handle=qN.d++}getResourceState(t){return this.h.get(t)}$executeResourceCommand(t,i){const r=this.j.get(t);return r?di(()=>this.v.executeCommand(r.command,...r.arguments||[],i)):Promise.resolve(void 0)}_takeResourceStateSnapshot(){const t=[...this.g].sort(NT),r=B5(this.p,t,NT).map(o=>{const a=o.toInsert.map(c=>{const l=this.f++;this.h.set(l,c);const u=c.resourceUri;let h;if(c.command)if(c.command.command==="vscode.open"||c.command.command==="vscode.diff"||c.command.command==="vscode.changes"){const V=new ie;h=this.v.converter.toInternal(c.command,V),this.k.set(l,V)}else this.j.set(l,c.command);const f=et(this.z,"scmMultiDiffEditor"),p=f?c.multiDiffEditorOriginalUri:void 0,g=f?c.multiFileDiffEditorModifiedUri:void 0,v=DS(c.decorations),b=c.decorations&&DS(c.decorations.light)||v,S=c.decorations&&DS(c.decorations.dark)||v,E=[b,S],$=c.decorations&&c.decorations.tooltip||"",U=c.decorations&&!!c.decorations.strikeThrough,O=c.decorations&&!!c.decorations.faded,J=c.contextValue||"";return{rawResource:[l,u,E,$,U,O,J,h,p,g],handle:l}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}}),s=r.map(({start:o,deleteCount:a,toInsert:c})=>[o,a,c.map(l=>l.rawResource)]),n=r.reverse();for(const{start:o,deleteCount:a,toInsert:c}of n){const l=c.map(h=>h.handle),u=this.o.splice(o,a,...l);for(const h of u)this.h.delete(h),this.j.delete(h),this.k.get(h)?.dispose(),this.k.delete(h)}return this.p=t,s}dispose(){this.m=!0,this.n.fire()}},MS=class GN{static{this.d=0}#e;get id(){return this.F}get label(){return this.G}get rootUri(){return this.H}get contextValue(){return T(this.D,"scmProviderOptions"),this.h}set contextValue(t){T(this.D,"scmProviderOptions"),this.h!==t&&(this.h=t,this.#e.$updateSourceControl(this.handle,{contextValue:t}))}get inputBox(){return this.j}get count(){return this.k}set count(t){this.k!==t&&(this.k=t,this.#e.$updateSourceControl(this.handle,{count:t}))}get quickDiffProvider(){return this.l}set quickDiffProvider(t){this.l=t;let i;et(this.D,"quickDiffProvider")&&(i=t?.label),this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!t,quickDiffLabel:i})}get secondaryQuickDiffProvider(){return T(this.D,"quickDiffProvider"),this.m}set secondaryQuickDiffProvider(t){T(this.D,"quickDiffProvider"),this.m=t;const i=t?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!t,secondaryQuickDiffLabel:i})}get historyProvider(){return T(this.D,"scmHistoryProvider"),this.n}set historyProvider(t){T(this.D,"scmHistoryProvider"),this.n=t,this.o.value=new ie,this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!t}),t&&(this.o.value.add(t.onDidChangeCurrentHistoryItemRefs(()=>{const i=PS(t?.currentHistoryItemRef),r=PS(t?.currentHistoryItemRemoteRef),s=PS(t?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,r,s)})),this.o.value.add(t.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0)return;const r=i.added.map(o=>({...o,icon:Fs(o.icon)})),s=i.modified.map(o=>({...o,icon:Fs(o.icon)})),n=i.removed.map(o=>({...o,icon:Fs(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:r,modified:s,removed:n,silent:i.silent})})))}get artifactProvider(){return T(this.D,"scmArtifactProvider"),this.p}set artifactProvider(t){T(this.D,"scmArtifactProvider"),this.p=t,this.q.value=new ie,this.#e.$updateSourceControl(this.handle,{hasArtifactProvider:!!t}),t&&this.q.value.add(t.onDidChangeArtifacts(i=>{i.length!==0&&this.#e.$onDidChangeArtifacts(this.handle,i)}))}get commitTemplate(){return this.t}set commitTemplate(t){t!==this.t&&(this.t=t,this.#e.$updateSourceControl(this.handle,{commitTemplate:t}))}get acceptInputCommand(){return this.v}set acceptInputCommand(t){this.u.value=new ie,this.v=t;const i=this.E.converter.toInternal(t,this.u.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){return T(this.D,"scmActionButton"),this.x}set actionButton(t){if(T(this.D,"scmActionButton"),rw(this.x,t))return;const i=this.w;this.w=new ie,this.x=t;const r=t!==void 0?{command:{...this.E.converter.toInternal(t.command,this.w),shortTitle:t.command.shortTitle},secondaryCommands:t.secondaryCommands?.map(s=>s.map(n=>this.E.converter.toInternal(n,this.w))),enabled:t.enabled}:null;this.#e.$updateSourceControl(this.handle,{actionButton:r}).finally(()=>i.dispose())}get statusBarCommands(){return this.z}set statusBarCommands(t){if(this.z&&t&&sY(this.z,t))return;const i=this.y;this.y=new ie,this.z=t;const r=(t||[]).map(s=>this.E.converter.toInternal(s,this.y));this.#e.$updateSourceControl(this.handle,{statusBarCommands:r}).finally(()=>i.dispose())}get selected(){return this.A}constructor(t,i,r,s,n,o,a,c,l){this.D=t,this.E=s,this.F=n,this.G=o,this.H=a,this.f=new I,this.onDidDispose=this.f.event,this.g=new Map,this.h=void 0,this.k=void 0,this.l=void 0,this.m=void 0,this.o=new Br,this.q=new Br,this.t=void 0,this.u=new Br,this.v=void 0,this.w=new ie,this.y=new ie,this.z=void 0,this.A=!1,this.B=new I,this.onDidChangeSelection=this.B.event,this.C=new Mo,this.handle=GN.d++,this.I=new Map,this.J=new Set,this.#e=r;const u=y.from({scheme:q.vscodeSourceControl,path:`${n}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this.j=new nY(t,i,this.#e,this.handle,u),this.#e.$registerSourceControl(this.handle,l?.handle,n,o,a,Fs(c),u),this.onDidDisposeParent=l?l.onDidDispose:Ie.None}createResourceGroup(t,i,r){const s=et(this.D,"scmMultiDiffEditor")&&r?.multiDiffEditorEnableViewChanges===!0,n=new oY(this.#e,this.E,this.handle,t,i,s,this.D),o=Ie.once(n.onDidDispose)(()=>this.I.delete(n));return this.I.set(n,o),this.eventuallyAddResourceGroups(),n}eventuallyAddResourceGroups(){const t=[],i=[];for(const[r,s]of this.I){s.dispose();const n=r.onDidUpdateResourceStates(()=>{this.J.add(r),this.eventuallyUpdateResourceStates()});Ie.once(r.onDidDispose)(()=>{this.J.delete(r),n.dispose(),this.g.delete(r.handle),this.#e.$unregisterGroup(this.handle,r.handle)}),t.push([r.handle,r.id,r.label,r.features,r.multiDiffEditorEnableViewChanges]);const o=r._takeResourceStateSnapshot();o.length>0&&i.push([r.handle,o]),this.g.set(r.handle,r)}this.#e.$registerGroups(this.handle,t,i),this.I.clear()}eventuallyUpdateResourceStates(){const t=[];this.J.forEach(i=>{const r=i._takeResourceStateSnapshot();r.length!==0&&t.push([i.handle,r])}),t.length>0&&this.#e.$spliceResourceStates(this.handle,t),this.J.clear()}getResourceGroup(t){return this.g.get(t)}setSelectionState(t){this.A=t,this.B.fire(t)}async provideArtifacts(t,i){const r=new ie,n=(await this.artifactProvider?.provideArtifacts(t,i))?.map(o=>({...o,icon:Fs(o.icon),command:o.command?this.E.converter.toInternal(o.command,r):void 0}));return this.C.get(t)?.dispose(),this.C.set(t,r),n}dispose(){this.u.dispose(),this.w.dispose(),this.y.dispose(),this.o.dispose(),this.q.dispose(),this.C.dispose(),this.g.forEach(t=>t.dispose()),this.#e.$unregisterSourceControl(this.handle),this.f.fire(),this.f.dispose()}};__decorate([mf(100)],MS.prototype,"eventuallyAddResourceGroups",null),__decorate([mf(100)],MS.prototype,"eventuallyUpdateResourceStates",null);var NS=class{get onDidChangeActiveProvider(){return this.j.event}constructor(t,i,r,s){this.l=i,this.m=r,this.n=s,this.g=new Map,this.h=new Wn,this.j=new I,this.d=t.getProxy(X.MainThreadSCM),this.f=t.getProxy(X.MainThreadTelemetry),i.registerArgumentProcessor({processArgument:n=>{if(n&&n.$mid===3){const o=this.g.get(n.sourceControlHandle);if(!o)return n;const a=o.getResourceGroup(n.groupHandle);return a?a.getResourceState(n.handle):n}else if(n&&n.$mid===4){const o=this.g.get(n.sourceControlHandle);return o?o.getResourceGroup(n.groupHandle):n}else if(n&&n.$mid===5){const o=this.g.get(n.handle);return o||n}return n}})}createSourceControl(t,i,r,s,n,o){this.n.trace("ExtHostSCM#createSourceControl",t.identifier.value,i,r,s),this.f.$publicLog2("api/scm/createSourceControl",{extensionId:t.identifier.value});const a=o?Wt.find(this.g.values(),u=>u===o):void 0,c=new MS(t,this.m,this.d,this.l,i,r,s,n,a);this.g.set(c.handle,c);const l=this.h.get(t.identifier)||[];return l.push(c),this.h.set(t.identifier,l),c}getLastInputBox(t){this.n.trace("ExtHostSCM#getLastInputBox",t.identifier.value);const i=this.h.get(t.identifier),r=i&&i[i.length-1];return r&&r.inputBox}$provideOriginalResource(t,i,r){const s=y.revive(i);this.n.trace("ExtHostSCM#$provideOriginalResource",t,s.toString());const n=this.g.get(t);return!n||!n.quickDiffProvider||!n.quickDiffProvider.provideOriginalResource?Promise.resolve(null):di(()=>n.quickDiffProvider.provideOriginalResource(s,r)).then(o=>o||null)}$provideSecondaryOriginalResource(t,i,r){const s=y.revive(i);this.n.trace("ExtHostSCM#$provideSecondaryOriginalResource",t,s.toString());const n=this.g.get(t);return!n||!n.secondaryQuickDiffProvider||!n.secondaryQuickDiffProvider.provideOriginalResource?Promise.resolve(null):di(()=>n.secondaryQuickDiffProvider.provideOriginalResource(s,r)).then(o=>o||null)}$onInputBoxValueChange(t,i){this.n.trace("ExtHostSCM#$onInputBoxValueChange",t);const r=this.g.get(t);return r&&r.inputBox.$onInputBoxValueChange(i),Promise.resolve(void 0)}$executeResourceCommand(t,i,r,s){this.n.trace("ExtHostSCM#$executeResourceCommand",t,i,r);const n=this.g.get(t);if(!n)return Promise.resolve(void 0);const o=n.getResourceGroup(i);return o?o.$executeResourceCommand(r,s):Promise.resolve(void 0)}$validateInput(t,i,r){this.n.trace("ExtHostSCM#$validateInput",t);const s=this.g.get(t);return!s||!s.inputBox.validateInput?Promise.resolve(void 0):di(()=>s.inputBox.validateInput(i,r)).then(n=>{if(!n)return Promise.resolve(void 0);const o=ge.fromStrict(n.message);return o?Promise.resolve([o,n.type]):Promise.resolve(void 0)})}$setSelectedSourceControl(t){return this.n.trace("ExtHostSCM#$setSelectedSourceControl",t),t!==void 0&&this.g.get(t)?.setSelectionState(!0),this.k!==void 0&&this.g.get(this.k)?.setSelectionState(!1),this.k=t,Promise.resolve(void 0)}async $resolveHistoryItem(t,i,r){try{const n=await this.g.get(t)?.historyProvider?.resolveHistoryItem(i,r);return n?MT(n):void 0}catch(s){this.n.error("ExtHostSCM#$resolveHistoryItem",s);return}}async $resolveHistoryItemChatContext(t,i,r){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChatContext(i,r)??void 0}catch(s){this.n.error("ExtHostSCM#$resolveHistoryItemChatContext",s);return}}async $resolveHistoryItemChangeRangeChatContext(t,i,r,s,n){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemChangeRangeChatContext?.(i,r,s,n)??void 0}catch(o){this.n.error("ExtHostSCM#$resolveHistoryItemChangeRangeChatContext",o);return}}async $resolveHistoryItemRefsCommonAncestor(t,i,r){try{return await this.g.get(t)?.historyProvider?.resolveHistoryItemRefsCommonAncestor(i,r)??void 0}catch(s){this.n.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",s);return}}async $provideHistoryItemRefs(t,i,r){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItemRefs(i,r))?.map(o=>({...o,icon:Fs(o.icon)}))??void 0}catch(s){this.n.error("ExtHostSCM#$provideHistoryItemRefs",s);return}}async $provideHistoryItems(t,i,r){try{return(await this.g.get(t)?.historyProvider?.provideHistoryItems(i,r))?.map(o=>MT(o))??void 0}catch(s){this.n.error("ExtHostSCM#$provideHistoryItems",s);return}}async $provideHistoryItemChanges(t,i,r,s){try{return await this.g.get(t)?.historyProvider?.provideHistoryItemChanges(i,r,s)??void 0}catch(n){this.n.error("ExtHostSCM#$provideHistoryItemChanges",n);return}}async $provideArtifactGroups(t,i){try{return(await this.g.get(t)?.artifactProvider?.provideArtifactGroups(i))?.map(n=>({...n,icon:Fs(n.icon)}))}catch(r){this.n.error("ExtHostSCM#$provideArtifactGroups",r);return}}async $provideArtifacts(t,i,r){try{return this.g.get(t)?.provideArtifacts(i,r)}catch(s){this.n.error("ExtHostSCM#$provideArtifacts",s);return}}};NS=__decorate([__param(3,Se)],NS);var aY=class ZN{static{this.a=0}constructor(t,i){this.d=i,this.c=new Map,this.b=t.getProxy(X.MainThreadShare)}async $provideShare(t,i,r){return await this.c.get(t)?.provideShare({selection:j.to(i.selection),resourceUri:y.revive(i.resourceUri)},r)??void 0}registerShareProvider(t,i){const r=ZN.a++;return this.c.set(r,i),this.b.$registerShareProvider(r,Sa.from(t,this.d),i.id,i.label,i.priority),{dispose:()=>{this.b.$unregisterShareProvider(r),this.c.delete(r)}}}},cY=class JN{static{this.a=1}constructor(t){this.c=new Map,this.d=new Map,this.f=new Map,this.b=t.getProxy(X.MainThreadSpeech)}async $createSpeechToTextSession(t,i,r){const s=this.c.get(t);if(!s)return;const n=new ie,o=new Qe;this.d.set(i,o);const a=await s.provideSpeechToTextSession(o.token,r?{language:r}:void 0);a&&(n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitSpeechToTextEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $cancelSpeechToTextSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}async $createTextToSpeechSession(t,i,r){const s=this.c.get(t);if(!s)return;const n=new ie,o=new Qe;this.d.set(i,o);const a=await s.provideTextToSpeechSession(o.token,r?{language:r}:void 0);a&&(this.f.set(i,a),n.add(a.onDidChange(c=>{o.token.isCancellationRequested||this.b.$emitTextToSpeechEvent(i,c)})),n.add(o.token.onCancellationRequested(()=>n.dispose())))}async $synthesizeSpeech(t,i){this.f.get(t)?.synthesize(i)}async $cancelTextToSpeechSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t),this.f.delete(t)}async $createKeywordRecognitionSession(t,i){const r=this.c.get(t);if(!r)return;const s=new ie,n=new Qe;this.d.set(i,n);const o=await r.provideKeywordRecognitionSession(n.token);o&&(s.add(o.onDidChange(a=>{n.token.isCancellationRequested||this.b.$emitKeywordRecognitionEvent(i,a)})),s.add(n.token.onCancellationRequested(()=>s.dispose())))}async $cancelKeywordRecognitionSession(t){this.d.get(t)?.dispose(!0),this.d.delete(t)}registerProvider(t,i,r){const s=JN.a++;return this.c.set(s,r),this.b.$registerProvider(s,i,{extension:t,displayName:t.value}),te(()=>{this.b.$unregisterProvider(s),this.c.delete(s)})}},lY=class iv{static{this.a=0}static{this.b=new Map([["statusBarItem.errorBackground",new Ku("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new Ku("statusBarItem.warningForeground")]])}#e;#t;constructor(t,i,r,s,n,o=no.Left,a,c){if(this.v=c,this.i=!1,this.k="",this.r=new ie,this.#e=t,this.#t=i,n&&s){this.c=MW(s.identifier,n);const l=r.get(this.c);l&&(o=l.alignLeft?no.Left:no.Right,a=l.priority,this.j=!0,this.name=l.name,this.text=l.text,this.tooltip=l.tooltip,this.command=l.command,this.accessibilityInformation=l.accessibilityInformation)}else this.c=String(iv.a++);this.e=s,this.f=n,this.g=o,this.h=this.w(a)}w(t){if(Er(t))return t===Number.POSITIVE_INFINITY?Number.MAX_VALUE:t===Number.NEGATIVE_INFINITY?-Number.MAX_VALUE:t}get id(){return this.f??this.e.identifier.value}get entryId(){return this.c}get alignment(){return this.g}get priority(){return this.h}get text(){return this.k}get name(){return this.n}get tooltip(){return this.l}get tooltip2(){return this.e&&T(this.e,"statusBarItemTooltip"),this.m}get color(){return this.o}get backgroundColor(){return this.p}get command(){return this.s?.fromApi}get accessibilityInformation(){return this.u}set text(t){this.k=t,this.x()}set name(t){this.n=t,this.x()}set tooltip(t){this.l=t,this.x()}set tooltip2(t){this.e&&T(this.e,"statusBarItemTooltip"),this.m=t,this.x()}set color(t){this.o=t,this.x()}set backgroundColor(t){t&&!iv.b.has(t.id)&&(t=void 0),this.p=t,this.x()}set command(t){this.s?.fromApi!==t&&(this.q&&this.r.add(this.q),this.q=new ie,typeof t=="string"?this.s={fromApi:t,internal:this.#t.toInternal({title:"",command:t},this.q)}:t?this.s={fromApi:t,internal:this.#t.toInternal(t,this.q)}:this.s=void 0,this.x())}set accessibilityInformation(t){this.u=t,this.x()}show(){this.j=!0,this.x()}hide(){clearTimeout(this.t),this.j=!1,this.#e.$disposeEntry(this.c)}x(){this.i||!this.j||(clearTimeout(this.t),this.t=setTimeout(()=>{this.t=void 0;let t;this.e?this.f?t=`${this.e.identifier.value}.${this.f}`:t=this.e.identifier.value:t=this.f;let i;this.n?i=this.n:i=d(3028,null,this.e.displayName||this.e.name);let r=this.o;this.p&&(r=iv.b.get(this.p.id));let s,n;typeof this.m=="function"?(s=ge.fromStrict(this.l),n=!0):(s=ge.fromStrict(this.m??this.l),n=!1),this.#e.$setEntry(this.c,t,this.e?.identifier.value,i,this.k,s,n,this.s?.internal,r,this.p,this.g===no.Left,this.h,this.u),this.r.clear()},0))}dispose(){this.hide(),this.v?.(),this.i=!0}},uY=class{constructor(e){this.b=[],this.a=e.createStatusBarEntry(void 0,"status.extensionMessage",no.Left,Number.MIN_VALUE),this.a.name=d(3029,null)}dispose(){this.b.length=0,this.a.dispose()}setMessage(e){const t={message:e};return this.b.unshift(t),this.c(),new ke(()=>{const i=this.b.indexOf(t);i>=0&&(this.b.splice(i,1),this.c())})}c(){this.b.length>0?(this.a.text=this.b[0].message,this.a.show()):this.a.hide()}},hY=class{constructor(e,t){this.e=new Map,this.f=new Map,this.a=e.getProxy(X.MainThreadStatusBar),this.b=t,this.c=new uY(this)}$acceptStaticEntries(e){for(const t of e)this.f.set(t.entryId,t)}async $provideTooltip(e,t){const i=this.e.get(e);if(!i)return;const r=typeof i.tooltip2=="function"?await i.tooltip2(t):i.tooltip2;return t.isCancellationRequested?void 0:ge.fromStrict(r)}createStatusBarEntry(e,t,i,r){const s=new lY(this.a,this.b,this.f,e,t,i,r,()=>this.e.delete(s.entryId));return this.e.set(s.entryId,s),s}setStatusBarMessage(e,t){const i=this.c.setMessage(e);let r;return typeof t=="number"?r=setTimeout(()=>i.dispose(),t):typeof t<"u"&&t.then(()=>i.dispose(),()=>i.dispose()),new ke(()=>{i.dispose(),clearTimeout(r)})}},dY=class extends Q{constructor(e,t){super(),this.n=t,this.a=new I,this.b=new I,this.c=new I,this.f=new I,this.g=new I,this.h=new I,this.j=new I,this.onDidChangeTextEditorSelection=this.a.event,this.onDidChangeTextEditorOptions=this.b.event,this.onDidChangeTextEditorVisibleRanges=this.c.event,this.onDidChangeTextEditorViewColumn=this.f.event,this.onDidChangeTextEditorDiffInformation=this.g.event,this.onDidChangeActiveTextEditor=this.h.event,this.onDidChangeVisibleTextEditors=this.j.event,this.m=e.getProxy(X.MainThreadTextEditors),this.D(this.n.onDidChangeVisibleTextEditors(i=>this.j.fire(i))),this.D(this.n.onDidChangeActiveTextEditor(i=>this.h.fire(i)))}getActiveTextEditor(){return this.n.activeEditor()}getVisibleTextEditors(e){const t=this.n.allEditors();return e?t:t.map(i=>i.value)}async showTextDocument(e,t,i){let r;typeof t=="number"?r={position:Xt.from(t),preserveFocus:i}:typeof t=="object"?r={position:Xt.from(t.viewColumn),preserveFocus:t.preserveFocus,selection:typeof t.selection=="object"?j.from(t.selection):void 0,pinned:typeof t.preview=="boolean"?!t.preview:void 0}:r={preserveFocus:!1};const s=await this.m.$tryShowTextDocument(e.uri,r),n=s&&this.n.getEditor(s);if(n)return n.value;throw s?new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`):new Error(`Could NOT open editor for "${e.uri.toString()}".`)}createTextEditorDecorationType(e,t){return new IV(this.m,e,t).value}$acceptEditorPropertiesChanged(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(t.options&&i._acceptOptions(t.options),t.selections){const r=t.selections.selections.map(ss.to);i._acceptSelections(r)}if(t.visibleRanges){const r=gt(t.visibleRanges.map(j.to));i._acceptVisibleRanges(r)}if(t.options&&this.b.fire({textEditor:i.value,options:{...t.options,lineNumbers:sl.to(t.options.lineNumbers)}}),t.selections){const r=Lc.fromValue(t.selections.source),s=t.selections.selections.map(ss.to);this.a.fire({textEditor:i.value,selections:s,kind:r})}if(t.visibleRanges){const r=gt(t.visibleRanges.map(j.to));this.c.fire({textEditor:i.value,visibleRanges:r})}}$acceptEditorPositionData(e){for(const t in e){const i=this.n.getEditor(t);if(!i)throw new Error("Unknown text editor");const r=Xt.to(e[t]);i.value.viewColumn!==r&&(i._acceptViewColumn(r),this.f.fire({textEditor:i.value,viewColumn:r}))}}$acceptEditorDiffInformation(e,t){const i=this.n.getEditor(e);if(!i)throw new Error("unknown text editor");if(!t){i._acceptDiffInformation(void 0),this.g.fire({textEditor:i.value,diffInformation:void 0});return}const r=this,s=t.map(n=>{const o=y.revive(n.original),a=y.revive(n.modified),c=n.changes.map(l=>{const[u,h,f,p]=l;let g;return u===h?g=Oc.Addition:f===p?g=Oc.Deletion:g=Oc.Modification,{original:{startLineNumber:u,endLineNumberExclusive:h},modified:{startLineNumber:f,endLineNumberExclusive:p},kind:g}});return Object.freeze({documentVersion:n.documentVersion,original:o,modified:a,changes:c,get isStale(){return r.n.getDocument(a)?.version!==n.documentVersion}})});i._acceptDiffInformation(s),this.g.fire({textEditor:i.value,diffInformation:s})}getDiffInformation(e){return Promise.resolve(this.m.$getDiffInformation(e))}},RS=class{constructor(t){this.a=new Vp(lo.Dark),this.b=new I}get activeColorTheme(){return this.a}$onColorThemeChange(t){let i;switch(t){case"light":i=lo.Light;break;case"hcDark":i=lo.HighContrast;break;case"hcLight":i=lo.HighContrastLight;break;default:i=lo.Dark}this.a=new Vp(i),this.b.fire(this.a)}get onDidChangeActiveColorTheme(){return this.b.event}};RS=__decorate([__param(0,Ce)],RS);var xle=H("IExtHostTimeline"),fY=class{constructor(e,t){this.b=new Map,this.c=new Map,this.a=e.getProxy(X.MainThreadTimeline),t.registerArgumentProcessor({processArgument:(i,r)=>{if(i&&i.$mid===12)if(this.b.get(i.source)&&r&&et(r,"timeline")){const s=i.uri===void 0?void 0:y.revive(i.uri);return this.c.get(i.source)?.get(RT(s))?.get(i.handle)}else return;return i}})}async $getTimeline(e,t,i,r){return this.b.get(e)?.provider.provideTimeline(y.revive(t),i,r)}registerTimelineProvider(e,t,i,r){const s=new ie,n=this.d(t.id,r,s).bind(this);let o;t.onDidChange&&(o=t.onDidChange(c=>this.a.$emitTimelineChangeEvent({uri:void 0,reset:!0,...c,id:t.id}),this));const a=this.c;return this.f({...t,scheme:e,onDidChange:void 0,async provideTimeline(c,l,u){l?.resetCache&&(s.clear(),a.get(t.id)?.clear());const h=await t.provideTimeline(c,l,u);if(h==null)return;const f=n(c,l);return{...h,source:t.id,items:h.items.map(f)}},dispose(){for(const c of a.values())c.get(t.id)?.clear();o?.dispose(),s.dispose()}},i)}d(e,t,i){return(r,s)=>{let n;if(s?.cacheResults){let o=this.c.get(e);o===void 0&&(o=new Map,this.c.set(e,o));const a=RT(r);n=o.get(a),n===void 0&&(n=new Map,o.set(a,n))}return o=>{const{iconPath:a,...c}=o,l=`${e}|${o.id??o.timestamp}`;n?.set(l,o);let u,h,f;o.iconPath&&(a instanceof Di?f={id:a.id,color:a.color}:y.isUri(a)?(u=a,h=a):{light:u,dark:h}=a);let p;return ji.isMarkdownString(c.tooltip)?p=ge.from(c.tooltip):Oe(c.tooltip)?p=c.tooltip:ji.isMarkdownString(c.detail)?(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=ge.from(c.detail)):Oe(c.detail)&&(console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip"),p=c.detail),{...c,id:c.id??void 0,handle:l,source:e,command:o.command?t.toInternal(o.command,i):void 0,icon:u,iconDark:h,themeIcon:f,tooltip:p,accessibilityInformation:o.accessibilityInformation}}}}f(e,t){if(this.b.get(e.id))throw new Error(`Timeline Provider ${e.id} already exists.`);return this.a.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme}),this.b.set(e.id,{provider:e,extension:t}),te(()=>{for(const r of this.c.values())r.get(e.id)?.clear();this.b.delete(e.id),this.a.$unregisterTimelineProvider(e.id),e.dispose()})}};function RT(e){return e?.toString()}var kle=d(4627,null),Cle=Jh("default-view-icon",oe.window,d(4628,null)),D1;(function(e){e.ViewContainersRegistry="workbench.registry.view.containers",e.ViewsRegistry="workbench.registry.view"})(D1||(D1={}));var LT;(function(e){e[e.Sidebar=0]="Sidebar",e[e.Panel=1]="Panel",e[e.AuxiliaryBar=2]="AuxiliaryBar"})(LT||(LT={}));var pY=class extends Q{constructor(){super(...arguments),this.c=this.D(new I),this.onDidRegister=this.c.event,this.f=this.D(new I),this.onDidDeregister=this.f.event,this.g=new Map,this.h=[]}get all(){return[...this.g.values()].flat()}registerViewContainer(e,t,i){const r=this.get(e.id);if(r)return r;const s=e;return s.openCommandActionDescriptor=i?.doNotRegisterOpenCommand?void 0:s.openCommandActionDescriptor??{id:s.id},VR(this.g,t,[]).push(s),i?.isDefault&&this.h.push(s),this.c.fire({viewContainer:s,viewContainerLocation:t}),s}deregisterViewContainer(e){for(const t of this.g.keys()){const i=this.g.get(t),r=i?.indexOf(e);if(r!==-1){i?.splice(r,1),i.length===0&&this.g.delete(t),this.f.fire({viewContainer:e,viewContainerLocation:t});return}}}get(e){return this.all.filter(t=>t.id===e)[0]}getViewContainers(e){return[...this.g.get(e)||[]]}getViewContainerLocation(e){return[...this.g.keys()].filter(t=>this.getViewContainers(t).filter(i=>i?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.h.find(t=>this.getViewContainerLocation(t)===e)}};Zt.add(D1.ViewContainersRegistry,new pY);var P1;(function(e){e.Open="2_open",e.Debug="4_debug",e.SCM="5_scm",e.More="9_more"})(P1||(P1={}));function gY(e,t){const i=e.group??P1.More,r=t.group??P1.More;return i!==r?i.localeCompare(r):(e.order??5)-(t.order??5)}var mY=class extends Q{constructor(){super(...arguments),this.c=this.D(new I),this.onViewsRegistered=this.c.event,this.f=this.D(new I),this.onViewsDeregistered=this.f.event,this.g=this.D(new I),this.onDidChangeContainer=this.g.event,this.h=this.D(new I),this.onDidChangeViewWelcomeContent=this.h.event,this.j=[],this.m=new Map,this.n=new Y5}registerViews(e,t){this.registerViews2([{views:e,viewContainer:t}])}registerViews2(e){e.forEach(({views:t,viewContainer:i})=>this.q(t,i)),this.c.fire(e)}deregisterViews(e,t){const i=this.r(e,t);i.length&&this.f.fire({views:i,viewContainer:t})}moveViews(e,t){for(const i of this.m.keys())if(i!==t){const r=this.r(e,i);r.length&&(this.q(r,t),this.g.fire({views:r,from:i,to:t}))}}getViews(e){return this.m.get(e)||[]}getView(e){for(const t of this.j){const i=(this.m.get(t)||[]).filter(r=>r.id===e)[0];if(i)return i}return null}getViewContainer(e){for(const t of this.j)if((this.m.get(t)||[]).filter(r=>r.id===e)[0])return t;return null}registerViewWelcomeContent(e,t){return this.n.add(e,t),this.h.fire(e),te(()=>{this.n.delete(e,t),this.h.fire(e)})}registerViewWelcomeContent2(e,t){const i=new Map;for(const[r,s]of t)this.n.add(e,s),i.set(r,te(()=>{this.n.delete(e,s),this.h.fire(e)}));return this.h.fire(e),i}getViewWelcomeContent(e){const t=[];return this.n.forEach(e,i=>t.push(i)),t.sort(gY)}q(e,t){let i=this.m.get(t);i||(i=[],this.m.set(t,i),this.j.push(t));for(const r of e){if(this.getView(r.id)!==null)throw new Error(d(4629,null,r.id));i.push(r)}}r(e,t){const i=this.m.get(t);if(!i)return[];const r=[],s=[];for(const n of i)e.includes(n)?r.push(n):s.push(n);return r.length&&(s.length?this.m.set(t,s):(this.m.delete(t),this.j.splice(this.j.indexOf(t),1))),r}};Zt.add(D1.ViewsRegistry,new mY);var $le=H("viewDescriptorService"),OT;(function(e){e[e.Default=0]="Default",e[e.Expand=1]="Expand"})(OT||(OT={}));var FT;(function(e){e[e.None=0]="None",e[e.Collapsed=1]="Collapsed",e[e.Expanded=2]="Expanded"})(FT||(FT={}));var bn=class extends Error{constructor(e){super(d(4630,null,e)),this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}},vY=class{constructor(){this.a=new Map}removeDragOperationTransfer(e){if(e&&this.a.has(e)){const t=this.a.get(e);return this.a.delete(e),t}}addDragOperationTransfer(e,t){this.a.set(e,t)}};function UT(e,t){if(Oe(e))return{label:e};if(e&&typeof e=="object"&&e.label){let i;if(Array.isArray(e.highlights)&&(i=e.highlights.filter(r=>r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"),i=i.length?i:void 0),Oe(e.label))return{label:e.label,highlights:i};if(ji.isMarkdownString(e.label))return T(t,"treeItemMarkdownLabel"),{label:ge.from(e.label),highlights:i}}}var wY=class extends Q{constructor(e,t,i){super(),this.f=e,this.g=t,this.h=i,this.a=new Map,this.b=new vY;function r(s){return s&&s.$treeViewId&&(s.$treeItemHandle||s.$selectedTreeItems||s.$focusedTreeItem)}t.registerArgumentProcessor({processArgument:s=>r(s)?this.q(s):Array.isArray(s)&&s.length>0?s.map(n=>r(n)?this.q(n):n):s})}registerTreeDataProvider(e,t,i){const r=this.createTreeView(e,{treeDataProvider:t},i);return{dispose:()=>r.dispose()}}createTreeView(e,t,i){if(!t||!t.treeDataProvider)throw new Error("Options with treeDataProvider is mandatory");const r=t.dragAndDropController?.dropMimeTypes??[],s=t.dragAndDropController?.dragMimeTypes??[],n=!!t.dragAndDropController?.handleDrag,o=!!t.dragAndDropController?.handleDrop,a=this.m(e,t,i),c={showCollapseAll:!!t.showCollapseAll,canSelectMany:!!t.canSelectMany,dropMimeTypes:r,dragMimeTypes:s,hasHandleDrag:n,hasHandleDrop:o,manuallyManageCheckboxes:!!t.manageCheckboxStateManually},l=this.f.$registerTreeViewDataProvider(e,c),u={get onDidCollapseElement(){return a.onDidCollapseElement},get onDidExpandElement(){return a.onDidExpandElement},get selection(){return a.selectedElements},get onDidChangeSelection(){return a.onDidChangeSelection},get activeItem(){return T(i,"treeViewActiveItem"),a.focusedElement},get onDidChangeActiveItem(){return T(i,"treeViewActiveItem"),a.onDidChangeActiveItem},get visible(){return a.visible},get onDidChangeVisibility(){return a.onDidChangeVisibility},get onDidChangeCheckboxState(){return a.onDidChangeCheckboxState},get message(){return a.message},set message(h){Gn(h)&&T(i,"treeViewMarkdownMessage"),a.message=h},get title(){return a.title},set title(h){a.title=h},get description(){return a.description},set description(h){a.description=h},get badge(){return a.badge},set badge(h){h!==void 0&&ib.isViewBadge(h)?a.badge={value:Math.floor(Math.abs(h.value)),tooltip:h.tooltip}:h===void 0&&(a.badge=void 0)},reveal:(h,f)=>a.reveal(h,f),dispose:async()=>{await l,this.a.delete(e),a.dispose()}};return this.D(u),u}async $getChildren(e,t){const i=this.a.get(e);if(!i)return Promise.reject(new bn(e));if(!t){const s=await i.getChildren();return s?[[0,...s]]:void 0}const r=[];for(let s=0;s<t.length;s++){const n=t[s],o=await i.getChildren(n);o&&r.push([s,...o])}return r}async $handleDrop(e,t,i,r,s,n,o,a){const c=this.a.get(e);if(!c)return Promise.reject(new bn(e));const l=hl.toDataTransfer(i,async u=>(await this.f.$resolveDropFileData(e,t,u)).buffer);return o===e&&a&&await this.j(l,c,a,s,n),c.onDrop(l,r,s)}async j(e,t,i,r,s){const n=this.b.removeDragOperationTransfer(s);if(n)(await n)?.forEach((o,a)=>{o&&e.set(a,o)});else if(s&&t.handleDrag){const o=t.handleDrag(i,e,r);this.b.addDragOperationTransfer(s,o),await o}return e}async $handleDrag(e,t,i,r){const s=this.a.get(e);if(!s)return Promise.reject(new bn(e));const n=await this.j(new Hc,s,t,r,i);if(!(!n||r.isCancellationRequested))return hl.from(n)}async $hasResolve(e){const t=this.a.get(e);if(!t)throw new bn(e);return t.hasResolve}$resolve(e,t,i){const r=this.a.get(e);if(!r)throw new bn(e);return r.resolveTreeItem(t,i)}$setExpanded(e,t,i){const r=this.a.get(e);if(!r)throw new bn(e);r.setExpanded(t,i)}$setSelectionAndFocus(e,t,i){const r=this.a.get(e);if(!r)throw new bn(e);r.setSelectionAndFocus(t,i)}$setVisible(e,t){const i=this.a.get(e);if(!i){if(!t)return;throw new bn(e)}i.setVisible(t)}$changeCheckboxState(e,t){const i=this.a.get(e);if(!i)throw new bn(e);i.setCheckboxState(t)}m(e,t,i){const r=this.D(new bY(e,t,this.f,this.g.converter,this.h,i));return this.a.set(e,r),r}q(e){const t=this.a.get(e.$treeViewId),i=e;return t&&i.$treeItemHandle?t.getExtensionElement(i.$treeItemHandle):t&&e.$focusedTreeItem?t.focusedElement:null}},bY=class rv extends Q{static{this.a="0"}static{this.b="1"}static{this.f=Symbol("extHostTreeViewRoot")}get visible(){return this.t}get selectedElements(){return this.u.map(t=>this.getExtensionElement(t)).filter(t=>!Ht(t))}get focusedElement(){return this.w?this.getExtensionElement(this.w):void 0}constructor(t,i,r,s,n,o){if(super(),this.N=t,this.O=r,this.P=s,this.Q=n,this.R=o,this.j=void 0,this.m=new Map,this.q=new Map,this.s=new Map,this.t=!1,this.u=[],this.w=void 0,this.y=this.D(new I),this.onDidExpandElement=this.y.event,this.z=this.D(new I),this.onDidCollapseElement=this.z.event,this.C=this.D(new I),this.onDidChangeSelection=this.C.event,this.F=this.D(new I),this.onDidChangeActiveItem=this.F.event,this.G=this.D(new I),this.onDidChangeVisibility=this.G.event,this.H=this.D(new I),this.onDidChangeCheckboxState=this.H.event,this.I=this.D(new I),this.J=Promise.resolve(),this.L=Promise.resolve(),this.M=new Set,this.X="",this.Y="",this.gb=new Qe,o.contributes&&o.contributes.views)for(const u in o.contributes.views)for(const h of o.contributes.views[u])h.id===t&&(this.Y=h.name);this.g=i.treeDataProvider,this.h=i.dragAndDropController,this.g.onDidChangeTreeData&&this.D(this.g.onDidChangeTreeData(u=>{Array.isArray(u)&&u.length===0||this.I.fire({message:!1,element:u})}));let a,c;const l=Ie.debounce(this.I.event,(u,h)=>(u||(u={message:!1,elements:[]}),h.element!==!1&&(a||(a=new Promise(f=>c=f),this.J=this.J.then(()=>a)),Array.isArray(h.element)?u.elements.push(...h.element):u.elements.push(h.element)),h.message&&(u.message=!0),u),200,!0);this.D(l(({message:u,elements:h})=>{h.length&&(h=$n(h),this.L=this.L.then(()=>{const f=c;a=null;const p=Array.from(this.M);return this.M.clear(),this.U("start",h,p),this.hb(h).then(()=>(this.U("done",h,p),this.Bb(p),f())).catch(g=>{const v=g instanceof Error?g.message:JSON.stringify(g);return this.U("error",h,p),this.Bb(p),this.Q.error(`Unable to refresh tree view ${this.N}: ${v}`),f()})})),u&&this.O.$setMessage(this.N,ge.fromStrict(this.X)??"")}))}S(t){const i=[];for(const s of t){if(!s){i.push("<root>");continue}const n=this.q.get(s);n&&i.push(n.item.handle)}const r=this.j?.map(s=>s.item.handle)??[];return{changed:i,roots:r}}U(t,i,r){if(this.W())try{const s=this.S(i);s.clearing=r.map(a=>a.item.handle);const n=s.changed.length,o=r.length;this.Q.debug(`[TreeView:${this.N}] refresh ${t} changed=${n} nodesToClear=${o} elements.size=${this.m.size} nodes.size=${this.q.size} handles=${JSON.stringify(s)}`)}catch{this.Q.debug(`[TreeView:${this.N}] refresh ${t} (snapshot failed)`)}}W(){try{const t=this.Q.getLevel();return t===Y.Debug||t===Y.Trace}catch{return!1}}async getChildren(t){const i=t?this.getExtensionElement(t):void 0;if(t&&!i)return this.Q.error(`No tree item with id '${t}' found.`),Promise.resolve([]);let r=this.db(t);return r||(r=await this.fb(i)),r?r.map(s=>s.item):void 0}getExtensionElement(t){return this.m.get(t)}reveal(t,i){i=i||{select:!0,focus:!1};const r=Ht(i.select)?!0:i.select,s=Ht(i.focus)?!1:i.focus,n=Ht(i.expand)?!1:i.expand;return typeof this.g.getParent!="function"?Promise.reject(new Error("Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method")):t?this.J.then(()=>this.ab(t)).then(o=>this.cb(t,o[o.length-1]).then(a=>this.O.$reveal(this.N,{item:a.item,parentChain:o.map(c=>c.item)},{select:r,focus:s,expand:n})),o=>this.Q.error(o)):this.O.$reveal(this.N,void 0,{select:r,focus:s,expand:n})}get message(){return this.X}set message(t){this.X=t,this.I.fire({message:!0,element:!1})}get title(){return this.Y}set title(t){this.Y=t,this.O.$setTitle(this.N,t,this.Z)}get description(){return this.Z}set description(t){this.Z=t,this.O.$setTitle(this.N,this.Y,t)}get badge(){return this.$}set badge(t){this.$?.value===t?.value&&this.$?.tooltip===t?.tooltip||(this.$=Rg.from(t),this.O.$setBadge(this.N,t))}setExpanded(t,i){const r=this.getExtensionElement(t);r&&(i?this.y.fire(Object.freeze({element:r})):this.z.fire(Object.freeze({element:r})))}setSelectionAndFocus(t,i){const r=!Gi(this.u,t);this.u=t;const s=this.w!==i;this.w=i,r&&this.C.fire(Object.freeze({selection:this.selectedElements})),s&&this.F.fire(Object.freeze({activeItem:this.focusedElement}))}setVisible(t){t!==this.t&&(this.t=t,this.G.fire(Object.freeze({visible:this.t})))}async setCheckboxState(t){const i=(await Promise.all(t.map(async r=>{const s=this.getExtensionElement(r.treeItemHandle);return s?{extensionItem:s,treeItem:await this.g.getTreeItem(s),newState:r.newState?Ds.Checked:Ds.Unchecked}:Promise.resolve(void 0)}))).filter(r=>r!==void 0);i.forEach(r=>{r.treeItem.checkboxState=r.newState?Ds.Checked:Ds.Unchecked}),this.H.fire({items:i.map(r=>[r.extensionItem,r.newState])})}async handleDrag(t,i,r){const s=[];for(const n of t){const o=this.getExtensionElement(n);o&&s.push(o)}if(!(!this.h?.handleDrag||s.length===0))return await this.h.handleDrag(s,i,r),i}get hasHandleDrag(){return!!this.h?.handleDrag}async onDrop(t,i,r){const s=i?this.getExtensionElement(i):void 0;if(!(!s&&i||!this.h?.handleDrop))return di(()=>this.h?.handleDrop?this.h.handleDrop(s,t,r):void 0)}get hasResolve(){return!!this.g.resolveTreeItem}async resolveTreeItem(t,i){if(!this.g.resolveTreeItem)return;const r=this.m.get(t);if(r){const s=this.q.get(r);if(s){const n=await this.g.resolveTreeItem(s.extensionItem,r,i)??s.extensionItem;return this.pb(n),s.item.tooltip=this.mb(n.tooltip),s.item.command=this.nb(s.disposableStore,n.command),s.item}}}ab(t){return this.bb(t).then(i=>i?this.ab(i).then(r=>this.cb(i,r[r.length-1]).then(s=>(r.push(s),r))):Promise.resolve([]))}bb(t){const i=this.q.get(t);return i?Promise.resolve(i.parent?this.m.get(i.parent.item.handle):void 0):di(()=>this.g.getParent(t))}cb(t,i){const r=this.q.get(t);return r?Promise.resolve(r):di(()=>this.g.getTreeItem(t)).then(s=>this.sb(t,s,i,!0)).then(s=>this.getChildren(i?i.item.handle:void 0).then(()=>{const n=this.getExtensionElement(s);if(n){const o=this.q.get(n);if(o)return Promise.resolve(o)}throw new Error(`Cannot resolve tree item for element ${s} from extension ${this.R.identifier.value}`)}))}db(t){if(t){let i;if(typeof t=="string"){const r=this.getExtensionElement(t);i=r?this.q.get(r):void 0}else i=t;return i&&i.children||void 0}return this.j}eb(t){return t??rv.f}async fb(t){this.zb(t);const i=this.eb(t);let r=this.s.get(i)??0;r++,this.s.set(i,r);const s=new Qe(this.gb.token);try{const n=await this.g.getChildren(t);if(this.s.get(i)!==r)return;const o=t?this.q.get(t):void 0;if(s.token.isCancellationRequested)return;const a=gt(n||[]),c=await Promise.all(gt(a).map(u=>this.g.getTreeItem(u)));if(this.s.get(i)!==r||s.token.isCancellationRequested)return;const l=c.map((u,h)=>u?this.lb(a[h],u,o):null);return this.s.get(i)!==r?void 0:gt(l)}finally{s.dispose()}}hb(t){if(t.some(r=>!r))return this.gb.dispose(!0),this.gb=new Qe,this.zb(),this.O.$refresh(this.N);{const r=this.ib(t);if(r.length)return this.jb(r)}return Promise.resolve(void 0)}ib(t){const i=new Set,r=t.map(n=>this.q.get(n));for(const n of r)if(n&&!i.has(n.item.handle)){let o=n;for(;o&&o.parent&&r.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1;){const a=this.m.get(o.parent.item.handle);o=a?this.q.get(a):void 0}o&&!o.parent&&i.add(n.item.handle)}const s=[];return i.forEach(n=>{const o=this.m.get(n);if(o){const a=this.q.get(o);a&&(!a.parent||!i.has(a.parent.item.handle))&&s.push(n)}}),s}jb(t){const i={};return Promise.all(t.map(r=>this.kb(r).then(s=>{s&&(i[r]=s.item)}))).then(()=>Object.keys(i).length?this.O.$refresh(this.N,i):void 0)}kb(t){const i=this.getExtensionElement(t);if(i){const r=this.q.get(i);if(r)return this.zb(i),di(()=>this.g.getTreeItem(i)).then(s=>{if(s){const n=this.qb(i,s,r.parent);return this.xb(i,n,r,r.parent),r.dispose(),n}return null})}return Promise.resolve(null)}lb(t,i,r){const s=this.qb(t,i,r);if(i.id&&this.m.has(s.item.handle))throw new Error(d(3032,null,i.id));return this.wb(t,s),this.yb(s,r),s}mb(t){return ji.isMarkdownString(t)?ge.from(t):t}nb(t,i){return i?{...this.P.toInternal(i,t),originalId:i.command}:void 0}ob(t){if(t.checkboxState===void 0)return;let i,r,s;return typeof t.checkboxState=="number"?i=t.checkboxState:(i=t.checkboxState.state,r=t.checkboxState.tooltip,s=t.checkboxState.accessibilityInformation),{isChecked:i===Ds.Checked,tooltip:r,accessibilityInformation:s}}pb(t){if(!Rp.isTreeItem(t,this.R))throw new Error(`Extension ${this.R.identifier.value} has provided an invalid tree item.`)}qb(t,i,r){this.pb(i);const s=this.D(new ie),n=this.sb(t,i,r),o=this.tb(i);return{item:{handle:n,parentHandle:r?r.item.handle:void 0,label:UT(i.label,this.R),description:i.description,resourceUri:i.resourceUri,tooltip:this.mb(i.tooltip),command:this.nb(s,i.command),contextValue:i.contextValue,icon:o,iconDark:this.ub(i)||o,themeIcon:this.rb(i),collapsibleState:Ht(i.collapsibleState)?ma.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this.ob(i)},extensionItem:i,parent:r,children:void 0,disposableStore:s,dispose(){s.dispose()}}}rb(t){return t.iconPath instanceof Di?t.iconPath:void 0}sb(t,{id:i,label:r,resourceUri:s},n,o){if(i)return`${rv.b}/${i}`;const a=UT(r,this.R),c=n?n.item.handle:rv.a;let l="";a&&(Gn(a.label)?l=a.label.value:l=a.label);let u=l||(s?dr(s):"");u=u.indexOf("/")!==-1?u.replace("/","//"):u;const h=this.q.has(t)?this.q.get(t).item.handle:void 0,f=this.db(n)||[];let p,g=0;do{if(p=`${c}/${g}:${u}`,o||!this.m.has(p)||h===p)break;g++}while(g<=f.length);return p}tb(t){if(t.iconPath&&!(t.iconPath instanceof Di))return typeof t.iconPath=="string"||y.isUri(t.iconPath)?this.vb(t.iconPath):this.vb(t.iconPath.light)}ub(t){if(t.iconPath&&!(t.iconPath instanceof Di)&&t.iconPath.dark)return this.vb(t.iconPath.dark)}vb(t){return y.isUri(t)?t:y.file(t)}wb(t,i){this.m.set(i.item.handle,t),this.q.set(t,i)}xb(t,i,r,s){this.m.delete(i.item.handle),this.q.delete(t),i.item.handle!==r.item.handle&&this.m.delete(r.item.handle),this.wb(t,i);const n=this.db(s)||[],o=n.filter(a=>a.item.handle===r.item.handle)[0];o&&n.splice(n.indexOf(o),1,i)}yb(t,i){i?(i.children||(i.children=[]),i.children.push(t)):(this.j||(this.j=[]),this.j.push(t))}zb(t){if(t){const i=this.q.get(t);if(i){if(i.children)for(const r of i.children){this.M.add(r);const s=this.m.get(r.item.handle);s&&(this.zb(s),this.q.delete(s),this.m.delete(r.item.handle))}i.children=void 0}}else this.Ab()}Ab(){this.j=void 0,this.q.forEach(t=>{this.M.add(t)}),this.q.clear(),this.m.clear(),this.s.clear()}Bb(t){Zi(t)}Cb(){this.j=void 0,this.m.clear(),Zi(this.q.values()),this.q.clear(),Zi(this.M),this.M.clear(),this.s.clear()}dispose(){super.dispose(),this.gb.dispose(),this.Cb(),this.O.$disposeTree(this.N)}},yY=class QN{static{this.a=new Set([q.http,q.https])}constructor(t){this.c=new Map,this.b=t.getProxy(X.MainThreadUriOpeners)}registerExternalUriOpener(t,i,r,s){if(this.c.has(i))throw new Error(`Opener with id '${i}' already registered`);const n=s.schemes.find(o=>!QN.a.has(o));if(n)throw new Error(`Scheme '${n}' is not supported. Only http and https are currently supported.`);return this.c.set(i,r),this.b.$registerUriOpener(i,s.schemes,t,s.label),te(()=>{this.c.delete(i),this.b.$unregisterUriOpener(i)})}async $canOpenUri(t,i,r){const s=this.c.get(t);if(!s)throw new Error(`Unknown opener with id: ${t}`);const n=y.revive(i);return s.canOpenExternalUri(n,r)}async $openUri(t,i,r){const s=this.c.get(t);if(!s)throw new Error(`Unknown opener id: '${t}'`);return s.openExternalUri(y.revive(i.resolvedUri),{sourceUri:y.revive(i.sourceUri)},r)}},AY=class extends Q{#e;#t;#i;#r;#n;#s;#a;#o;#c;#l;#u;#d;#h;constructor(e,t,i,r){super(),this.#o=void 0,this.#c=!0,this.#u=!1,this.#d=this.D(new I),this.onDidDispose=this.#d.event,this.#h=this.D(new I),this.onDidChangeViewState=this.#h.event,this.#e=e,this.#t=t,this.#r=i,this.#i=r.viewType,this.#n=r.panelOptions,this.#o=r.viewColumn,this.#s=r.title,this.#l=r.active}dispose(){this.#u||(this.#u=!0,this.#d.fire(),this.#t.$disposeWebview(this.#e),this.#r.dispose(),super.dispose())}get webview(){return this.c(),this.#r}get viewType(){return this.c(),this.#i}get title(){return this.c(),this.#s}set title(e){this.c(),this.#s!==e&&(this.#s=e,this.#t.$setTitle(this.#e,e))}get iconPath(){return this.c(),this.#a}set iconPath(e){this.c(),this.#a!==e&&(this.#a=e,this.#t.$setIconPath(this.#e,y.isUri(e)?{light:e,dark:e}:e))}get options(){return this.#n}get viewColumn(){if(this.c(),!(typeof this.#o=="number"&&this.#o<0))return this.#o}get active(){return this.c(),this.#l}get visible(){return this.c(),this.#c}_updateViewState(e){this.#u||(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn)&&(this.#l=e.active,this.#c=e.visible,this.#o=e.viewColumn,this.#h.fire({webviewPanel:this}))}reveal(e,t){this.c(),this.#t.$reveal(this.#e,{viewColumn:typeof e>"u"?void 0:Xt.from(e),preserveFocus:!!t})}c(){if(this.#u)throw new Error("Webview is disposed")}},SY=class YN extends Q{static c(){return Tt()}constructor(t,i,r){super(),this.j=i,this.m=r,this.g=new Map,this.h=new Map,this.f=t.getProxy(X.MainThreadWebviewPanels)}dispose(){super.dispose(),this.g.forEach(t=>t.dispose()),this.g.clear()}createWebviewPanel(t,i,r,s,n={}){const o=typeof s=="object"?s.viewColumn:s,a={viewColumn:Xt.from(o),preserveFocus:typeof s=="object"&&!!s.preserveFocus},c=Dl(t),l=YN.c();this.f.$createWebviewPanel(r1(t),l,i,{title:r,panelOptions:EY(n),webviewOptions:TP(t,this.m,n),serializeBuffersForPostMessage:c},a);const u=this.j.createNewWebview(l,n,t);return this.createNewWebviewPanel(l,i,r,o,n,u,!0)}$onDidChangeWebviewPanelViewStates(t){const i=Object.keys(t);i.sort((r,s)=>{const n=t[r],o=t[s];return n.active?1:o.active?-1:+n.visible-+o.visible});for(const r of i){const s=this.getWebviewPanel(r);if(!s)continue;const n=t[r];s._updateViewState({active:n.active,visible:n.visible,viewColumn:Xt.to(n.position)})}}async $onDidDisposeWebviewPanel(t){this.getWebviewPanel(t)?.dispose(),this.g.delete(t),this.j.deleteWebview(t)}registerWebviewPanelSerializer(t,i,r){if(this.h.has(i))throw new Error(`Serializer for '${i}' already registered`);return this.h.set(i,{serializer:r,extension:t}),this.f.$registerSerializer(i,{serializeBuffersForPostMessage:Dl(t)}),new ke(()=>{this.h.delete(i),this.f.$unregisterSerializer(i)})}async $deserializeWebviewPanel(t,i,r,s){const n=this.h.get(i);if(!n)throw new Error(`No serializer found for '${i}'`);const{serializer:o,extension:a}=n,c=this.j.createNewWebview(t,r.webviewOptions,a),l=this.createNewWebviewPanel(t,i,r.title,s,r.panelOptions,c,r.active);await o.deserializeWebviewPanel(l,r.state)}createNewWebviewPanel(t,i,r,s,n,o,a){const c=new AY(t,this.f,o,{viewType:i,title:r,viewColumn:s,panelOptions:n,active:a});return this.g.set(t,c),c}getWebviewPanel(t){return this.g.get(t)}};function EY(e){return{enableFindWidget:e.enableFindWidget,retainContextWhenHidden:e.retainContextWhenHidden}}var xY=class extends Q{#e;#t;#i;#r;#n;#s;#a;#o;#c;constructor(e,t,i,r,s,n){super(),this.#n=!1,this.#l=this.D(new I),this.onDidChangeVisibility=this.#l.event,this.#u=this.D(new I),this.onDidDispose=this.#u.event,this.#i=i,this.#a=r,this.#e=e,this.#t=t,this.#r=s,this.#s=n}dispose(){this.#n||(this.#n=!0,this.#u.fire(),this.#r.dispose(),super.dispose())}#l;#u;get title(){return this.a(),this.#a}set title(e){this.a(),this.#a!==e&&(this.#a=e,this.#t.$setWebviewViewTitle(this.#e,e))}get description(){return this.a(),this.#o}set description(e){this.a(),this.#o!==e&&(this.#o=e,this.#t.$setWebviewViewDescription(this.#e,e))}get visible(){return this.#s}get webview(){return this.#r}get viewType(){return this.#i}_setVisible(e){e===this.#s||this.#n||(this.#s=e,this.#l.fire())}get badge(){return this.a(),this.#c}set badge(e){this.a(),!(e?.value===this.#c?.value&&e?.tooltip===this.#c?.tooltip)&&(this.#c=Rg.from(e),this.#t.$setWebviewViewBadge(this.#e,e))}show(e){this.a(),this.#t.$show(this.#e,!!e)}a(){if(this.#n)throw new Error("Webview is disposed")}},kY=class{constructor(e,t){this.d=t,this.b=new Map,this.c=new Map,this.a=e.getProxy(X.MainThreadWebviewViews)}registerWebviewViewProvider(e,t,i,r){if(this.b.has(t))throw new Error(`View provider for '${t}' already registered`);return this.b.set(t,{provider:i,extension:e}),this.a.$registerWebviewViewProvider(r1(e),t,{retainContextWhenHidden:r?.retainContextWhenHidden,serializeBuffersForPostMessage:Dl(e)}),new ke(()=>{this.b.delete(t),this.a.$unregisterWebviewViewProvider(t)})}async $resolveWebviewView(e,t,i,r,s){const n=this.b.get(t);if(!n)throw new Error(`No view provider found for '${t}'`);const{provider:o,extension:a}=n,c=this.d.createNewWebview(e,{},a),l=new xY(e,this.a,t,i,c,!0);this.c.set(e,l),await o.resolveWebviewView(l,{state:r},s)}async $onDidChangeWebviewViewVisibility(e,t){this.e(e)._setVisible(t)}async $disposeWebviewView(e){const t=this.e(e);this.c.delete(e),t.dispose(),this.d.deleteWebview(e)}e(e){const t=this.c.get(e);if(!t)throw new Error("No webview found");return t}},LS=class extends Q{constructor(t){super(),this.b=0,this.c=new Map,this.f=0,this.g=new Map,this.a=t.getProxy(X.MainThreadChatContext)}async $provideChatContext(t,i){this.g.delete(t);const r=this.n(t);if(!r.provideChatContextExplicit)throw new Error("provideChatContext not implemented");const s=await r.provideChatContextExplicit(i)??[],n=[];for(const o of s){const a=this.h(t,o);n.push({handle:a,icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value})}return n}h(t,i){const r=this.f++;return this.g.has(t)||this.g.set(t,new Map),this.g.get(t).set(r,i),r}async $provideChatContextForResource(t,i,r){const s=this.n(t);if(!s.provideChatContextForResource)throw new Error("provideChatContextForResource not implemented");const n=await s.provideChatContextForResource({resource:y.revive(i.resource)},r);if(!n)return;const a={handle:this.h(t,n),icon:n.icon,label:n.label,modelDescription:n.modelDescription,value:i.withValue?n.value:void 0};if(i.withValue&&!a.value&&s.resolveChatContext){const c=await s.resolveChatContext(n,r);a.value=c?.value}return a}async j(t,i,r,s){const o=await t.resolveChatContext(r,s)??i;return{handle:i.handle,icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value}}async $resolveChatContext(t,i,r){const s=this.n(t);if(!s.resolveChatContext)throw new Error("resolveChatContext not implemented");const n=this.g.get(t)?.get(i.handle);if(!n)throw new Error("Chat context item not found");return this.j(s,i,n,r)}registerChatContextProvider(t,i,r){const s=this.b++,n=new ie;return this.m(s,r,n),this.c.set(s,{provider:r,disposables:n}),this.a.$registerChatContextProvider(s,`${i}`,t?Sa.from(t):void 0,{},{supportsResource:!!r.provideChatContextForResource,supportsResolve:!!r.resolveChatContext}),{dispose:()=>{this.c.delete(s),this.a.$unregisterChatContextProvider(s),n.dispose()}}}m(t,i,r){!i.onDidChangeWorkspaceChatContext||!i.provideWorkspaceChatContext||r.add(i.onDidChangeWorkspaceChatContext(async()=>{const s=await i.provideWorkspaceChatContext(Fe.None),n=[];for(const o of s??[]){const a={icon:o.icon,label:o.label,modelDescription:o.modelDescription,value:o.value,handle:this.f++},c=await this.j(i,a,o,Fe.None);n.push(c)}this.a.$updateWorkspaceContextItems(t,n)}))}n(t){if(!this.c.has(t))throw new Error("Chat context provider not found");return this.c.get(t).provider}dispose(){super.dispose();for(const{disposables:t}of this.c.values())t.dispose()}};LS=__decorate([__param(0,Ce)],LS);function CY(e){const t=e.get(Ft),i=e.get(pc),r=e.get(Uh),s=e.get(fn),n=e.get(Nr),o=e.get(pm),a=e.get(vr),c=e.get(wu),l=e.get(Ce),u=e.get(eA),h=e.get(iA),f=e.get(_n),p=e.get(Se),g=e.get(dm),v=e.get(El),b=e.get(vm),S=e.get(wm),E=e.get(RA),$=e.get(kl),U=e.get(FA),O=e.get(bm),J=e.get(AA),F=e.get(xA),V=e.get(Bm),z=e.get(v8);l.set(ne.ExtHostFileSystemInfo,i),l.set(ne.ExtHostLogLevelServiceShape,f),l.set(ne.ExtHostWorkspace,n),l.set(ne.ExtHostConfiguration,a),l.set(ne.ExtHostExtensionService,s),l.set(ne.ExtHostStorage,u),l.set(ne.ExtHostTunnelService,g),l.set(ne.ExtHostWindow,b),l.set(ne.ExtHostUrls,S),l.set(ne.ExtHostSecretState,E),l.set(ne.ExtHostTelemetry,o),l.set(ne.ExtHostEditorTabs,$),l.set(ne.ExtHostManagedSockets,U),l.set(ne.ExtHostProgress,O),l.set(ne.ExtHostAuthentication,J),l.set(ne.ExtHostChatProvider,F),l.set(ne.ExtHostDataChannels,z);const ue=l.set(ne.ExtHostDecorations,e.get(kD)),Re=l.set(ne.ExtHostDocumentsAndEditors,e.get(La)),ae=l.set(ne.ExtHostCommands,e.get(os)),Z=l.set(ne.ExtHostTerminalService,e.get(dn)),_=l.set(ne.ExtHostTerminalShellIntegration,e.get(f4)),G=l.set(ne.ExtHostDebugService,e.get(l4)),K=l.set(ne.ExtHostSearch,e.get(d4)),re=l.set(ne.ExtHostTask,e.get(o4)),Ae=l.set(ne.ExtHostOutputService,e.get(xD)),Me=l.set(ne.ExtHostLocalization,e.get(OA)),Ne=l.set(ne.ExtHostDocuments,new YZ(l,Re)),mt=l.set(ne.ExtHostDocumentContentProviders,new JZ(l,Re,p)),_t=l.set(ne.ExtHostDocumentSaveParticipant,new QZ(p,Ne,l.getProxy(X.MainThreadBulkEdits))),tt=l.set(ne.ExtHostNotebook,new HQ(l,ae,Re,Ne,r,K,p)),Rt=l.set(ne.ExtHostNotebookDocuments,new BQ(tt)),Si=l.set(ne.ExtHostNotebookEditors,new $S(p,tt)),ti=l.set(ne.ExtHostNotebookKernels,new IS(l,t,tt,ae,p)),br=l.set(ne.ExtHostNotebookRenderers,new JQ(l,tt)),kn=l.set(ne.ExtHostNotebookDocumentSaveParticipant,new WQ(p,tt,l.getProxy(X.MainThreadBulkEdits))),vi=l.set(ne.ExtHostEditors,new dY(l,Re)),ql=l.set(ne.ExtHostTreeViews,new wY(l.getProxy(X.MainThreadTreeViews),ae,p)),Bs=l.set(ne.ExtHostEditorInsets,new $Z(l.getProxy(X.MainThreadEditorInsets),vi,t.remote)),lr=l.set(ne.ExtHostDiagnostics,new H4(l,p,i,Re)),Je=l.set(ne.ExtHostLanguages,new wQ(l,Ne,ae.converter,c)),Le=l.set(ne.ExtHostLanguageFeatures,new yJ(l,c,Ne,ae,lr,p,v,o)),Cn=l.set(ne.ExtHostCodeMapper,new IZ(l)),zr=l.set(ne.ExtHostFileSystem,new nJ(l,Le)),yr=l.set(ne.ExtHostFileSystemEventService,new gJ(l,p,Re)),gs=l.set(ne.ExtHostQuickOpen,XQ(l,n,ae)),Ga=l.set(ne.ExtHostSCM,new NS(l,ae,Ne,p)),Ud=l.set(ne.ExtHostQuickDiff,new YQ(l,c)),Gl=l.set(ne.ExtHostShare,new aY(l,c)),Zl=l.set(ne.ExtHostComments,DZ(l,ae,Ne)),Za=l.set(ne.ExtHostLabelService,new vJ(l)),Pi=l.set(ne.ExtHostTheming,new RS(l)),Io=l.set(ne.ExtHostTimeline,new fY(l,ae)),wt=l.set(ne.ExtHostWebviews,new UZ(l,t.remote,n,p,v)),ni=l.set(ne.ExtHostWebviewPanels,new SY(l,wt,n)),nv=l.set(ne.ExtHostCustomEditors,new _Z(l,Ne,h,wt,ni)),ov=l.set(ne.ExtHostWebviewViews,new kY(l,wt)),Hr=l.set(ne.ExtHostTesting,e.get(td)),Jl=l.set(ne.ExtHostUriOpeners,new yY(l)),P=l.set(ne.ExtHostProfileContentHandlers,new QQ(l)),R=l.set(ne.ExtHostChatOutputRenderer,new yZ(l,wt));l.set(ne.ExtHostInteractive,new mJ(l,tt,Re,ae,p));const L=l.set(ne.ExtHostLanguageModelTools,new vQ(l,F)),de=l.set(ne.ExtHostChatSessions,new j4(ae,F,l,p)),we=l.set(ne.ExtHostChatAgents2,new mZ(l,p,ae,Ne,Re,F,lr,L)),ii=l.set(ne.ExtHostChatContext,new LS(l)),it=l.set(ne.ExtHostAiRelatedInformation,new cZ(l)),Ei=l.set(ne.ExtHostAiEmbeddingVector,new KZ(l)),jt=l.set(ne.ExtHostAiSettingsSearch,new lZ(l)),oi=l.set(ne.ExtHostStatusBar,new hY(l,ae.converter)),Ar=l.set(ne.ExtHostSpeech,new cY(l)),bt=l.set(ne.ExtHostEmbeddings,new XZ(l));l.set(ne.ExtHostMcp,e.get(Bm));const ai=Object.values(ne);l.assertRegistered(ai);const xi=new O4(l,Re),ur=new xZ(l),Ee=new pS(l,p),je=new ZZ(l),pt=new SZ(l);return pZ.register(ae),function(x,Ct,Ja){function se(w){return(A,C,pe)=>{const Ze=w(Jt=>{try{A.call(C,Jt)}catch(vR){Hd(new _k(x.identifier,vR,"FAILED to handle event"))}});return pe?.push(Ze),Ze}}const Ge=function(){let w=!x.isUnderDevelopment;function A(){w||(p.info(`Extension '${x.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`),w=!0)}return function C(pe){if(Array.isArray(pe))pe.forEach(C);else if(typeof pe=="string")A();else{const Ze=pe;typeof Ze.scheme>"u"&&A(),typeof Ze.exclusive=="boolean"&&T(x,"documentFiltersExclusive")}return pe}}(),eR={getSession(w,A,C){return(typeof C?.forceNewSession=="object"&&C.forceNewSession.learnMore||typeof C?.createIfNone=="object"&&C.createIfNone.learnMore)&&T(x,"authLearnMore"),C?.authorizationServer&&T(x,"authIssuers"),J.getSession(x,w,A,C)},getAccounts(w){return J.getAccounts(w)},async hasSession(w,A){return T(x,"authSession"),!!await J.getSession(x,w,A,{silent:!0})},get onDidChangeSessions(){return se(J.getExtensionScopedSessionsEvent(x.identifier.value))},registerAuthenticationProvider(w,A,C,pe){return pe?.supportedAuthorizationServers&&T(x,"authIssuers"),J.registerAuthenticationProvider(w,A,C,pe)}},tR={registerCommand(w,A,C){return ae.registerCommand(!0,w,A,C,void 0,x)},registerTextEditorCommand(w,A,C){return ae.registerCommand(!0,w,(...pe)=>{const Ze=vi.getActiveTextEditor();if(!Ze){p.warn("Cannot execute "+w+" because there is no active text editor.");return}return Ze.edit(Jt=>{A.apply(C,[Ze,Jt,...pe])}).then(Jt=>{Jt||p.warn("Edits from command "+w+" were not applied.")},Jt=>{p.warn("An error occurred while running command "+w,Jt)})},void 0,void 0,x)},registerDiffInformationCommand:(w,A,C)=>(T(x,"diffCommand"),ae.registerCommand(!0,w,async(...pe)=>{const Ze=Re.activeEditor(!0);if(!Ze){p.warn("Cannot execute "+w+" because there is no active text editor.");return}const Jt=await vi.getDiffInformation(Ze.id);A.apply(C,[Jt,...pe])},void 0,void 0,x)),executeCommand(w,...A){return ae.executeCommand(w,...A)},getCommands(w=!1){return ae.getCommands(w)}},L5={get machineId(){return t.telemetryInfo.machineId},get devDeviceId(){return T(x,"devDeviceId"),t.telemetryInfo.devDeviceId??t.telemetryInfo.machineId},get sessionId(){return t.telemetryInfo.sessionId},get language(){return t.environment.appLanguage},get appName(){return t.environment.appName},get appRoot(){return t.environment.appRoot?.fsPath??""},get appHost(){return t.environment.appHost},get uriScheme(){return t.environment.appUriScheme},get clipboard(){return ur.value},get shell(){return Z.getDefaultShell(!1)},get onDidChangeShell(){return se(Z.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return se(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){return T(x,"telemetry"),o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){return T(x,"telemetry"),se(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return x9(t.telemetryInfo.firstSessionDate)},createTelemetryLogger(w,A){return E9.validateSender(w),o.instantiateLogger(x,w,A)},async openExternal(w,A){return b.openUri(w,{allowTunneling:t.remote.isRemote??(t.remote.authority?await g.hasTunnelProvider():!1),allowContributedOpeners:A?.allowContributedOpeners})},async asExternalUri(w){if(w.scheme===t.environment.appUriScheme)return S.createAppUri(w);try{return await b.asExternalUri(w,{allowTunneling:!!t.remote.authority})}catch(A){if(Uv(w,q.http)||Uv(w,q.https))return w;throw A}},get remoteName(){return h0(t.remote.authority)},get remoteAuthority(){return T(x,"resolvers"),t.remote.authority},get uiKind(){return t.uiKind},get logLevel(){return p.getLevel()},get onDidChangeLogLevel(){return se(p.onDidChangeLogLevel)},get appQuality(){return T(x,"resolvers"),t.quality},get appCommit(){return T(x,"resolvers"),t.commit},getDataChannel(w){return T(x,"dataChannels"),z.createDataChannel(x,w)}};t.environment.extensionTestsLocationURI||Object.freeze(L5);const iR={createTestController(w,A,C){return Hr.createTestController(x,w,A,C)},createTestObserver(){return T(x,"testObserver"),Hr.createTestObserver()},runTests(w){return T(x,"testObserver"),Hr.runTests(w)},registerTestFollowupProvider(w){return T(x,"testObserver"),Hr.registerTestFollowupProvider(w)},get onDidChangeTestResults(){return T(x,"testObserver"),se(Hr.onResultsChanged)},get testResults(){return T(x,"testObserver"),Hr.results}},jd=t.remote.isRemote?ba.Workspace:ba.UI,rR={getExtension(w,A){et(x,"extensionsAny")||(A=!1);const C=Ct.mine.getExtensionDescription(w);if(C)return new Vh(s,x.identifier,C,jd,!1);if(A){const pe=Ct.all.getExtensionDescription(w);if(pe)return new Vh(s,x.identifier,pe,jd,!0)}},get all(){const w=[];for(const A of Ct.mine.getAllExtensionDescriptions())w.push(new Vh(s,x.identifier,A,jd,!1));return w},get allAcrossExtensionHosts(){T(x,"extensionsAny");const w=new Go(Ct.mine.getAllExtensionDescriptions().map(C=>C.identifier)),A=[];for(const C of Ct.all.getAllExtensionDescriptions()){const pe=!w.has(C.identifier);A.push(new Vh(s,x.identifier,C,jd,pe))}return A},get onDidChange(){return et(x,"extensionsAny")?se(Ie.any(Ct.mine.onDidChange,Ct.all.onDidChange)):se(Ct.mine.onDidChange)}},sR={createDiagnosticCollection(w){return lr.createDiagnosticCollection(x.identifier,w)},get onDidChangeDiagnostics(){return se(lr.onDidChangeDiagnostics)},getDiagnostics:w=>lr.getDiagnostics(w),getLanguages(){return Je.getLanguages()},setTextDocumentLanguage(w,A){return Je.changeLanguage(w.uri,A)},match(w,A){const C=ay.from(w);let pe;return rP(C)&&(pe=tt.notebookDocuments.find(Ze=>Ze.apiNotebook.getCells().find(Jt=>Jt.document===A))?.apiNotebook),iP(C,A.uri,A.languageId,!0,pe?.uri,pe?.notebookType)},registerCodeActionsProvider(w,A,C){return Le.registerCodeActionProvider(x,Ge(w),A,C)},registerDocumentPasteEditProvider(w,A,C){return Le.registerDocumentPasteEditProvider(x,Ge(w),A,C)},registerCodeLensProvider(w,A){return Le.registerCodeLensProvider(x,Ge(w),A)},registerDefinitionProvider(w,A){return Le.registerDefinitionProvider(x,Ge(w),A)},registerDeclarationProvider(w,A){return Le.registerDeclarationProvider(x,Ge(w),A)},registerImplementationProvider(w,A){return Le.registerImplementationProvider(x,Ge(w),A)},registerTypeDefinitionProvider(w,A){return Le.registerTypeDefinitionProvider(x,Ge(w),A)},registerHoverProvider(w,A){return Le.registerHoverProvider(x,Ge(w),A,x.identifier)},registerEvaluatableExpressionProvider(w,A){return Le.registerEvaluatableExpressionProvider(x,Ge(w),A,x.identifier)},registerInlineValuesProvider(w,A){return Le.registerInlineValuesProvider(x,Ge(w),A,x.identifier)},registerDocumentHighlightProvider(w,A){return Le.registerDocumentHighlightProvider(x,Ge(w),A)},registerMultiDocumentHighlightProvider(w,A){return Le.registerMultiDocumentHighlightProvider(x,Ge(w),A)},registerLinkedEditingRangeProvider(w,A){return Le.registerLinkedEditingRangeProvider(x,Ge(w),A)},registerReferenceProvider(w,A){return Le.registerReferenceProvider(x,Ge(w),A)},registerRenameProvider(w,A){return Le.registerRenameProvider(x,Ge(w),A)},registerNewSymbolNamesProvider(w,A){return T(x,"newSymbolNamesProvider"),Le.registerNewSymbolNamesProvider(x,Ge(w),A)},registerDocumentSymbolProvider(w,A,C){return Le.registerDocumentSymbolProvider(x,Ge(w),A,C)},registerWorkspaceSymbolProvider(w){return Le.registerWorkspaceSymbolProvider(x,w)},registerDocumentFormattingEditProvider(w,A){return Le.registerDocumentFormattingEditProvider(x,Ge(w),A)},registerDocumentRangeFormattingEditProvider(w,A){return Le.registerDocumentRangeFormattingEditProvider(x,Ge(w),A)},registerOnTypeFormattingEditProvider(w,A,C,...pe){return Le.registerOnTypeFormattingEditProvider(x,Ge(w),A,[C].concat(pe))},registerDocumentSemanticTokensProvider(w,A,C){return Le.registerDocumentSemanticTokensProvider(x,Ge(w),A,C)},registerDocumentRangeSemanticTokensProvider(w,A,C){return Le.registerDocumentRangeSemanticTokensProvider(x,Ge(w),A,C)},registerSignatureHelpProvider(w,A,C,...pe){return typeof C=="object"?Le.registerSignatureHelpProvider(x,Ge(w),A,C):Le.registerSignatureHelpProvider(x,Ge(w),A,typeof C>"u"?[]:[C,...pe])},registerCompletionItemProvider(w,A,...C){return Le.registerCompletionItemProvider(x,Ge(w),A,C)},registerInlineCompletionItemProvider(w,A,C){return A.handleDidShowCompletionItem&&T(x,"inlineCompletionsAdditions"),A.handleDidPartiallyAcceptCompletionItem&&T(x,"inlineCompletionsAdditions"),C&&T(x,"inlineCompletionsAdditions"),Le.registerInlineCompletionsProvider(x,Ge(w),A,C)},get inlineCompletionsUnificationState(){return T(x,"inlineCompletionsAdditions"),Le.inlineCompletionsUnificationState},onDidChangeCompletionsUnificationState(w,A,C){return T(x,"inlineCompletionsAdditions"),se(Le.onDidChangeInlineCompletionsUnificationState)(w,A,C)},registerDocumentLinkProvider(w,A){return Le.registerDocumentLinkProvider(x,Ge(w),A)},registerColorProvider(w,A){return Le.registerColorProvider(x,Ge(w),A)},registerFoldingRangeProvider(w,A){return Le.registerFoldingRangeProvider(x,Ge(w),A)},registerSelectionRangeProvider(w,A){return Le.registerSelectionRangeProvider(x,w,A)},registerCallHierarchyProvider(w,A){return Le.registerCallHierarchyProvider(x,w,A)},registerTypeHierarchyProvider(w,A){return Le.registerTypeHierarchyProvider(x,w,A)},setLanguageConfiguration:(w,A)=>Le.setLanguageConfiguration(x,w,A),getTokenInformationAtPosition(w,A){return T(x,"tokenInformation"),Je.tokenAtPosition(w,A)},registerInlayHintsProvider(w,A){return Le.registerInlayHintsProvider(x,w,A)},createLanguageStatusItem(w,A){return Je.createLanguageStatusItem(x,w,A)},registerDocumentDropEditProvider(w,A,C){return Le.registerDocumentOnDropEditProvider(x,w,A,C)}},nR={get activeTextEditor(){return vi.getActiveTextEditor()},get visibleTextEditors(){return vi.getVisibleTextEditors()},get activeTerminal(){return Z.activeTerminal},get terminals(){return Z.terminals},async showTextDocument(w,A,C){y.isUri(w)&&w.scheme===q.vscodeRemote&&!w.authority&&v.report("workspace.showTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority.");const pe=await(y.isUri(w)?Promise.resolve(O5.openTextDocument(w)):Promise.resolve(w));return vi.showTextDocument(pe,A,C)},createTextEditorDecorationType(w){return vi.createTextEditorDecorationType(x,w)},onDidChangeActiveTextEditor(w,A,C){return se(vi.onDidChangeActiveTextEditor)(w,A,C)},onDidChangeVisibleTextEditors(w,A,C){return se(vi.onDidChangeVisibleTextEditors)(w,A,C)},onDidChangeTextEditorSelection(w,A,C){return se(vi.onDidChangeTextEditorSelection)(w,A,C)},onDidChangeTextEditorOptions(w,A,C){return se(vi.onDidChangeTextEditorOptions)(w,A,C)},onDidChangeTextEditorVisibleRanges(w,A,C){return se(vi.onDidChangeTextEditorVisibleRanges)(w,A,C)},onDidChangeTextEditorViewColumn(w,A,C){return se(vi.onDidChangeTextEditorViewColumn)(w,A,C)},onDidChangeTextEditorDiffInformation(w,A,C){return T(x,"textEditorDiffInformation"),se(vi.onDidChangeTextEditorDiffInformation)(w,A,C)},onDidCloseTerminal(w,A,C){return se(Z.onDidCloseTerminal)(w,A,C)},onDidOpenTerminal(w,A,C){return se(Z.onDidOpenTerminal)(w,A,C)},onDidChangeActiveTerminal(w,A,C){return se(Z.onDidChangeActiveTerminal)(w,A,C)},onDidChangeTerminalDimensions(w,A,C){return T(x,"terminalDimensions"),se(Z.onDidChangeTerminalDimensions)(w,A,C)},onDidChangeTerminalState(w,A,C){return se(Z.onDidChangeTerminalState)(w,A,C)},onDidWriteTerminalData(w,A,C){return T(x,"terminalDataWriteEvent"),se(Z.onDidWriteTerminalData)(w,A,C)},onDidExecuteTerminalCommand(w,A,C){return T(x,"terminalExecuteCommandEvent"),se(Z.onDidExecuteTerminalCommand)(w,A,C)},onDidChangeTerminalShellIntegration(w,A,C){return se(_.onDidChangeTerminalShellIntegration)(w,A,C)},onDidStartTerminalShellExecution(w,A,C){return se(_.onDidStartTerminalShellExecution)(w,A,C)},onDidEndTerminalShellExecution(w,A,C){return se(_.onDidEndTerminalShellExecution)(w,A,C)},get state(){return b.getState()},onDidChangeWindowState(w,A,C){return se(b.onDidChangeWindowState)(w,A,C)},showInformationMessage(w,...A){return Ee.showMessage(x,Mt.Info,w,A[0],A.slice(1))},showWarningMessage(w,...A){return Ee.showMessage(x,Mt.Warning,w,A[0],A.slice(1))},showErrorMessage(w,...A){return Ee.showMessage(x,Mt.Error,w,A[0],A.slice(1))},showQuickPick(w,A,C){return gs.showQuickPick(x,w,A,C)},showWorkspaceFolderPick(w){return gs.showWorkspaceFolderPick(w)},showInputBox(w,A){return gs.showInput(w,A)},showOpenDialog(w){return je.showOpenDialog(w)},showSaveDialog(w){return je.showSaveDialog(w)},createStatusBarItem(w,A,C){let pe,Ze,Jt;return typeof w=="string"?(pe=w,Ze=A,Jt=C):(Ze=w,Jt=A),oi.createStatusBarEntry(x,pe,Ze,Jt)},setStatusBarMessage(w,A){return oi.setStatusBarMessage(w,A)},withScmProgress(w){return v.report("window.withScmProgress",x,"Use 'withProgress' instead."),O.withProgress(x,{location:ao.SourceControl},(A,C)=>w({report(pe){}}))},withProgress(w,A){return O.withProgress(x,w,A)},createOutputChannel(w,A){return Ae.createOutputChannel(w,A,x)},createWebviewPanel(w,A,C,pe){return ni.createWebviewPanel(x,w,A,C,pe)},createWebviewTextEditorInset(w,A,C,pe){return T(x,"editorInsets"),Bs.createWebviewEditorInset(w,A,C,pe,x)},createTerminal(w,A,C){return typeof w=="object"?"pty"in w?Z.createExtensionTerminal(w):Z.createTerminalFromOptions(w):Z.createTerminal(w,A,C)},registerTerminalLinkProvider(w){return Z.registerLinkProvider(w)},registerTerminalProfileProvider(w,A){return Z.registerProfileProvider(x,w,A)},registerTerminalCompletionProvider(w,...A){return T(x,"terminalCompletionProvider"),Z.registerTerminalCompletionProvider(x,w,...A)},registerTerminalQuickFixProvider(w,A){return T(x,"terminalQuickFixProvider"),Z.registerTerminalQuickFixProvider(w,x.identifier.value,A)},registerTreeDataProvider(w,A){return ql.registerTreeDataProvider(w,A,x)},createTreeView(w,A){return ql.createTreeView(w,A,x)},registerWebviewPanelSerializer:(w,A)=>ni.registerWebviewPanelSerializer(x,w,A),registerCustomEditorProvider:(w,A,C={})=>nv.registerCustomEditorProvider(x,w,A,C),registerFileDecorationProvider(w){return ue.registerFileDecorationProvider(w,x)},registerUriHandler(w){return S.registerUriHandler(x,w)},createQuickPick(){return gs.createQuickPick(x)},createInputBox(){return gs.createInputBox(x)},get activeColorTheme(){return Pi.activeColorTheme},onDidChangeActiveColorTheme(w,A,C){return se(Pi.onDidChangeActiveColorTheme)(w,A,C)},registerWebviewViewProvider(w,A,C){return ov.registerWebviewViewProvider(x,w,A,C?.webviewOptions)},get activeNotebookEditor(){return tt.activeNotebookEditor},onDidChangeActiveNotebookEditor(w,A,C){return se(tt.onDidChangeActiveNotebookEditor)(w,A,C)},get visibleNotebookEditors(){return tt.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return se(tt.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(w,A,C){return se(Si.onDidChangeNotebookEditorSelection)(w,A,C)},onDidChangeNotebookEditorVisibleRanges(w,A,C){return se(Si.onDidChangeNotebookEditorVisibleRanges)(w,A,C)},showNotebookDocument(w,A){return tt.showNotebookDocument(w,A)},registerExternalUriOpener(w,A,C){return T(x,"externalUriOpener"),Jl.registerExternalUriOpener(x.identifier,w,A,C)},registerProfileContentHandler(w,A){return T(x,"profileContentHandlers"),P.registerProfileContentHandler(x,w,A)},registerQuickDiffProvider(w,A,C,pe,Ze){return T(x,"quickDiffProvider"),Ud.registerQuickDiffProvider(x,Ge(w),A,C,pe,Ze)},get tabGroups(){return $.tabGroups},registerShareProvider(w,A){return T(x,"shareProvider"),Gl.registerShareProvider(Ge(w),A)},get nativeHandle(){return T(x,"nativeWindowHandle"),b.nativeHandle},createChatStatusItem:w=>(T(x,"chatStatusItem"),pt.createChatStatusItem(x,w))},O5={get rootPath(){return v.report("workspace.rootPath",x,"Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath"),n.getPath()},set rootPath(w){throw new Do("rootPath")},getWorkspaceFolder(w){return n.getWorkspaceFolder(w)},get workspaceFolders(){return n.getWorkspaceFolders()},get name(){return n.name},set name(w){throw new Do("name")},get workspaceFile(){return n.workspaceFile},set workspaceFile(w){throw new Do("workspaceFile")},updateWorkspaceFolders:(w,A,...C)=>n.updateWorkspaceFolders(x,w,A||0,...C),onDidChangeWorkspaceFolders:function(w,A,C){return se(n.onDidChangeWorkspace)(w,A,C)},asRelativePath:(w,A)=>n.getRelativePath(w,A),findFiles:(w,A,C,pe)=>n.findFiles(w,A,C,x.identifier,pe),findFiles2:(w,A,C)=>(T(x,"findFiles2"),n.findFiles2(w,A,x.identifier,C)),findTextInFiles:(w,A,C,pe)=>{T(x,"findTextInFiles");let Ze,Jt;return typeof A=="object"?(Ze=A,Jt=C):(Ze={},Jt=A,pe=C),n.findTextInFiles(w,Ze||{},Jt,x.identifier,pe)},findTextInFiles2:(w,A,C)=>(T(x,"findTextInFiles2"),T(x,"textSearchProvider2"),n.findTextInFiles2(w,A,x.identifier,C)),save:w=>n.save(w),saveAs:w=>n.saveAs(w),saveAll:w=>n.saveAll(w),applyEdit(w,A){return xi.applyWorkspaceEdit(w,x,A)},createFileSystemWatcher:(w,A,C,pe)=>{const Ze={ignoreCreateEvents:!!A,ignoreChangeEvents:!!C,ignoreDeleteEvents:!!pe};return yr.createFileSystemWatcher(n,Ja,i,x,w,Ze)},get textDocuments(){return Ne.getAllDocumentData().map(w=>w.document)},set textDocuments(w){throw new Do("textDocuments")},openTextDocument(w,A){let C;if(A=A??w,typeof w=="string")C=Promise.resolve(y.file(w));else if(y.isUri(w))C=Promise.resolve(w);else if(!A||typeof A=="object")C=Ne.createDocumentData(A);else throw new Error("illegal argument - uriOrFileNameOrOptions");return C.then(pe=>(p.trace(`openTextDocument from ${x.identifier}`),pe.scheme===q.vscodeRemote&&!pe.authority&&v.report("workspace.openTextDocument",x,"A URI of 'vscode-remote' scheme requires an authority."),Ne.ensureDocumentData(pe,A).then(Ze=>Ze.document)))},onDidOpenTextDocument:(w,A,C)=>se(Ne.onDidAddDocument)(w,A,C),onDidCloseTextDocument:(w,A,C)=>se(Ne.onDidRemoveDocument)(w,A,C),onDidChangeTextDocument:(w,A,C)=>et(x,"textDocumentChangeReason")?se(Ne.onDidChangeDocumentWithReason)(w,A,C):se(Ne.onDidChangeDocument)(w,A,C),onDidSaveTextDocument:(w,A,C)=>se(Ne.onDidSaveDocument)(w,A,C),onWillSaveTextDocument:(w,A,C)=>se(_t.getOnWillSaveTextDocumentEvent(x))(w,A,C),get notebookDocuments(){return tt.notebookDocuments.map(w=>w.apiNotebook)},async openNotebookDocument(w,A){let C;if(y.isUri(w))C=w,await tt.openNotebookDocument(w);else if(typeof w=="string")C=y.revive(await tt.createNotebookDocument({viewType:w,content:A}));else throw new Error("Invalid arguments");return tt.getNotebookDocument(C).apiNotebook},onDidSaveNotebookDocument(w,A,C){return se(Rt.onDidSaveNotebookDocument)(w,A,C)},onDidChangeNotebookDocument(w,A,C){return se(Rt.onDidChangeNotebookDocument)(w,A,C)},onWillSaveNotebookDocument(w,A,C){return se(kn.getOnWillSaveNotebookDocumentEvent(x))(w,A,C)},get onDidOpenNotebookDocument(){return se(tt.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return se(tt.onDidCloseNotebookDocument)},registerNotebookSerializer(w,A,C,pe){return tt.registerNotebookSerializer(x,w,A,C,et(x,"notebookLiveShare")?pe:void 0)},onDidChangeConfiguration:(w,A,C)=>se(Ja.onDidChangeConfiguration)(w,A,C),getConfiguration(w,A){return A=arguments.length===1?void 0:A,Ja.getConfiguration(w,A,x)},registerTextDocumentContentProvider(w,A){return mt.registerTextDocumentContentProvider(w,A)},registerTaskProvider:(w,A)=>(v.report("window.registerTaskProvider",x,"Use the corresponding function on the 'tasks' namespace instead"),re.registerTaskProvider(x,w,A)),registerFileSystemProvider(w,A,C){return Sv(zr.registerFileSystemProvider(x,w,A,C),r.addFileSystemProvider(w,A,C))},get fs(){return r.value},registerFileSearchProvider:(w,A)=>(T(x,"fileSearchProvider"),K.registerFileSearchProviderOld(w,A)),registerTextSearchProvider:(w,A)=>(T(x,"textSearchProvider"),K.registerTextSearchProviderOld(w,A)),registerAITextSearchProvider:(w,A)=>(T(x,"aiTextSearchProvider"),T(x,"textSearchProvider2"),K.registerAITextSearchProvider(w,A)),registerFileSearchProvider2:(w,A)=>(T(x,"fileSearchProvider2"),K.registerFileSearchProvider(w,A)),registerTextSearchProvider2:(w,A)=>(T(x,"textSearchProvider2"),K.registerTextSearchProvider(w,A)),registerRemoteAuthorityResolver:(w,A)=>(T(x,"resolvers"),s.registerRemoteAuthorityResolver(w,A)),registerResourceLabelFormatter:w=>(T(x,"resolvers"),Za.$registerResourceLabelFormatter(w)),getRemoteExecServer:w=>(T(x,"resolvers"),s.getRemoteExecServer(w)),onDidCreateFiles:(w,A,C)=>se(yr.onDidCreateFile)(w,A,C),onDidDeleteFiles:(w,A,C)=>se(yr.onDidDeleteFile)(w,A,C),onDidRenameFiles:(w,A,C)=>se(yr.onDidRenameFile)(w,A,C),onWillCreateFiles:(w,A,C)=>se(yr.getOnWillCreateFileEvent(x))(w,A,C),onWillDeleteFiles:(w,A,C)=>se(yr.getOnWillDeleteFileEvent(x))(w,A,C),onWillRenameFiles:(w,A,C)=>se(yr.getOnWillRenameFileEvent(x))(w,A,C),openTunnel:w=>(T(x,"tunnels"),g.openTunnel(x,w).then(A=>{if(!A)throw new Error("cannot open tunnel");return A})),get tunnels(){return T(x,"tunnels"),g.getTunnels()},onDidChangeTunnels:(w,A,C)=>(T(x,"tunnels"),se(g.onDidChangeTunnels)(w,A,C)),registerPortAttributesProvider:(w,A)=>(T(x,"portsAttributes"),g.registerPortsAttributesProvider(w,A)),registerTunnelProvider:(w,A)=>(T(x,"tunnelFactory"),g.registerTunnelProvider(w,A)),registerTimelineProvider:(w,A)=>(T(x,"timeline"),Io.registerTimelineProvider(w,A,x.identifier,ae.converter)),get isTrusted(){return n.trusted},requestWorkspaceTrust:w=>(T(x,"workspaceTrust"),n.requestWorkspaceTrust(w)),onDidGrantWorkspaceTrust:(w,A,C)=>se(n.onDidGrantWorkspaceTrust)(w,A,C),registerEditSessionIdentityProvider:(w,A)=>(T(x,"editSessionIdentityProvider"),n.registerEditSessionIdentityProvider(w,A)),onWillCreateEditSessionIdentity:(w,A,C)=>(T(x,"editSessionIdentityProvider"),se(n.getOnWillCreateEditSessionIdentityEvent(x))(w,A,C)),registerCanonicalUriProvider:(w,A)=>(T(x,"canonicalUriProvider"),n.registerCanonicalUriProvider(w,A)),getCanonicalUri:(w,A,C)=>(T(x,"canonicalUriProvider"),n.provideCanonicalUri(w,A,C)),decode(w,A){return n.decode(w,A)},encode(w,A){return n.encode(w,A)}},oR={get inputBox(){return v.report("scm.inputBox",x,"Use 'SourceControl.inputBox' instead"),Ga.getLastInputBox(x)},createSourceControl(w,A,C,pe,Ze){return(pe||Ze)&&T(x,"scmProviderOptions"),Ga.createSourceControl(x,w,A,C,pe,Ze)}},aR={createCommentController(w,A){return Zl.createCommentController(x,w,A)}},cR={get activeDebugSession(){return G.activeDebugSession},get activeDebugConsole(){return G.activeDebugConsole},get breakpoints(){return G.breakpoints},get activeStackItem(){return G.activeStackItem},registerDebugVisualizationProvider(w,A){return T(x,"debugVisualization"),G.registerDebugVisualizationProvider(x,w,A)},registerDebugVisualizationTreeProvider(w,A){return T(x,"debugVisualization"),G.registerDebugVisualizationTree(x,w,A)},onDidStartDebugSession(w,A,C){return se(G.onDidStartDebugSession)(w,A,C)},onDidTerminateDebugSession(w,A,C){return se(G.onDidTerminateDebugSession)(w,A,C)},onDidChangeActiveDebugSession(w,A,C){return se(G.onDidChangeActiveDebugSession)(w,A,C)},onDidReceiveDebugSessionCustomEvent(w,A,C){return se(G.onDidReceiveDebugSessionCustomEvent)(w,A,C)},onDidChangeBreakpoints(w,A,C){return se(G.onDidChangeBreakpoints)(w,A,C)},onDidChangeActiveStackItem(w,A,C){return se(G.onDidChangeActiveStackItem)(w,A,C)},registerDebugConfigurationProvider(w,A,C){return G.registerDebugConfigurationProvider(w,A,C||e1.Initial)},registerDebugAdapterDescriptorFactory(w,A){return G.registerDebugAdapterDescriptorFactory(x,w,A)},registerDebugAdapterTrackerFactory(w,A){return G.registerDebugAdapterTrackerFactory(w,A)},startDebugging(w,A,C){return!C||typeof C=="object"&&"configuration"in C?G.startDebugging(w,A,{parentSession:C}):G.startDebugging(w,A,C||{})},stopDebugging(w){return G.stopDebugging(w)},addBreakpoints(w){return G.addBreakpoints(w)},removeBreakpoints(w){return G.removeBreakpoints(w)},asDebugSourceUri(w,A){return G.asDebugSourceUri(w,A)}},lR={registerTaskProvider:(w,A)=>re.registerTaskProvider(x,w,A),fetchTasks:w=>re.fetchTasks(w),executeTask:w=>re.executeTask(x,w),get taskExecutions(){return re.taskExecutions},onDidStartTask:(w,A,C)=>{const pe=Ze=>{et(x,"taskExecutionTerminal")||Ze?.execution?.terminal!==void 0&&(Ze.execution.terminal=void 0);const Jt={...Ze,execution:Ze.execution};return w.call(A,Jt)};return se(re.onDidStartTask)(pe,A,C)},onDidEndTask:(w,A,C)=>se(re.onDidEndTask)(w,A,C),onDidStartTaskProcess:(w,A,C)=>se(re.onDidStartTaskProcess)(w,A,C),onDidEndTaskProcess:(w,A,C)=>se(re.onDidEndTaskProcess)(w,A,C),onDidStartTaskProblemMatchers:(w,A,C)=>(T(x,"taskProblemMatcherStatus"),se(re.onDidStartTaskProblemMatchers)(w,A,C)),onDidEndTaskProblemMatchers:(w,A,C)=>(T(x,"taskProblemMatcherStatus"),se(re.onDidEndTaskProblemMatchers)(w,A,C))},uR={createNotebookController(w,A,C,pe,Ze){return ti.createNotebookController(x,w,A,C,pe,et(x,"notebookMessaging")?Ze:void 0)},registerNotebookCellStatusBarItemProvider:(w,A)=>tt.registerNotebookCellStatusBarItemProvider(x,w,A),createRendererMessaging(w){return br.createRendererMessaging(x,w)},createNotebookControllerDetectionTask(w){return T(x,"notebookKernelSource"),ti.createNotebookControllerDetectionTask(x,w)},registerKernelSourceActionProvider(w,A){return T(x,"notebookKernelSource"),ti.registerKernelSourceActionProvider(x,w,A)}},hR={t(...w){if(typeof w[0]=="string"){const A=w.shift(),C=!w||typeof w[0]!="object"?w:w[0];return Me.getMessage(x.identifier.value,{message:A,args:C})}return Me.getMessage(x.identifier.value,w[0])},get bundle(){return Me.getBundle(x.identifier.value)},get uri(){return Me.getBundleUri(x.identifier.value)}},dR={transferActiveChat(w){return T(x,"interactive"),we.transferActiveChat(w)}},fR={getRelatedInformation(w,A){return T(x,"aiRelatedInformation"),it.getRelatedInformation(x,w,A)},registerRelatedInformationProvider(w,A){return T(x,"aiRelatedInformation"),it.registerRelatedInformationProvider(x,w,A)},registerEmbeddingVectorProvider(w,A){return T(x,"aiRelatedInformation"),Ei.registerEmbeddingVectorProvider(x,w,A)},registerSettingsSearchProvider(w){return T(x,"aiSettingsSearch"),jt.registerSettingsSearchProvider(x,w)}},pR={registerMappedEditsProvider(w,A){return T(x,"mappedEditsProvider"),{dispose(){}}},registerMappedEditsProvider2(w){return T(x,"mappedEditsProvider"),Cn.registerMappedEditsProvider(x,w)},createChatParticipant(w,A){return we.createChatAgent(x,w,A)},createDynamicChatParticipant(w,A,C){return T(x,"chatParticipantPrivate"),we.createDynamicChatAgent(x,w,A,C)},registerChatParticipantDetectionProvider(w){return T(x,"chatParticipantPrivate"),we.registerChatParticipantDetectionProvider(x,w)},registerRelatedFilesProvider(w,A){return T(x,"chatEditing"),we.registerRelatedFilesProvider(x,w,A)},onDidDisposeChatSession:(w,A,C)=>(T(x,"chatParticipantPrivate"),se(we.onDidDisposeChatSession)(w,A,C)),registerChatSessionItemProvider:(w,A)=>(T(x,"chatSessionsProvider"),de.registerChatSessionItemProvider(x,w,A)),registerChatSessionContentProvider(w,A,C,pe){return T(x,"chatSessionsProvider"),de.registerChatSessionContentProvider(x,w,C,A,pe)},registerChatOutputRenderer:(w,A)=>(T(x,"chatOutputRenderer"),R.registerChatOutputRenderer(x,w,A)),registerChatContextProvider(w,A,C){return T(x,"chatContextProvider"),ii.registerChatContextProvider(w?Ge(w):void 0,`${x.id}-${A}`,C)},registerCustomAgentsProvider(w){return T(x,"chatParticipantPrivate"),we.registerCustomAgentsProvider(x,w)}},gR={selectChatModels:w=>F.selectLanguageModels(x,w??{}),onDidChangeChatModels:(w,A,C)=>F.onDidChangeProviders(w,A,C),registerLanguageModelChatProvider:(w,A)=>F.registerLanguageModelChatProvider(x,w,A),get isModelProxyAvailable(){return T(x,"languageModelProxy"),F.isModelProxyAvailable},onDidChangeModelProxyAvailability:(w,A,C)=>(T(x,"languageModelProxy"),F.onDidChangeModelProxyAvailability(w,A,C)),getModelProxy:()=>(T(x,"languageModelProxy"),F.getModelProxy(x)),registerLanguageModelProxyProvider:w=>(T(x,"chatParticipantPrivate"),F.registerLanguageModelProxyProvider(x,w)),get embeddingModels(){return T(x,"embeddings"),bt.embeddingsModels},onDidChangeEmbeddingModels:(w,A,C)=>(T(x,"embeddings"),bt.onDidChange(w,A,C)),registerEmbeddingsProvider(w,A){return T(x,"embeddings"),bt.registerEmbeddingsProvider(x,w,A)},async computeEmbeddings(w,A,C){return T(x,"embeddings"),bt.computeEmbeddings(w,A,C)},registerTool(w,A){return L.registerTool(x,w,A)},invokeTool(w,A,C){return L.invokeTool(x,w,A,C)},get tools(){return L.getTools(x)},fileIsIgnored(w,A){return F.fileIsIgnored(x,w,A)},registerIgnoredFileProvider(w){return F.registerIgnoredFileProvider(x,w)},registerMcpServerDefinitionProvider(w,A){return V.registerMcpConfigurationProvider(x,w,A)},onDidChangeChatRequestTools(...w){return T(x,"chatParticipantAdditions"),se(we.onDidChangeChatRequestTools)(...w)}},mR={registerSpeechProvider(w,A){return T(x,"speech"),Ar.registerProvider(x.identifier,w,A)}};return{version:t.version,ai:fR,authentication:eR,commands:tR,comments:aR,chat:pR,debug:cR,env:L5,extensions:rR,interactive:dR,l10n:hR,languages:sR,lm:gR,notebooks:uR,scm:oR,speech:mR,tasks:lR,tests:iR,window:nR,workspace:O5,Breakpoint:_c,TerminalOutputAnchor:Fw,ChatResultFeedbackKind:dh,ChatVariableLevel:Cb,ChatCompletionItem:KW,ChatReferenceDiagnostic:Ub,CallHierarchyIncomingCall:r7,CallHierarchyItem:jw,CallHierarchyOutgoingCall:s7,CancellationError:dt,CancellationTokenSource:Qe,CandidatePortSource:c0,CodeAction:qu,CodeActionKind:kt,CodeActionTriggerKind:Vu,CodeLens:kp,Color:Uc,ColorInformation:Tp,ColorPresentation:Mp,ColorThemeKind:lo,CommentMode:cb,CommentState:lb,CommentThreadCollapsibleState:sh,CommentThreadState:nh,CommentThreadApplicability:oh,CommentThreadFocus:ah,CompletionItem:Ip,CompletionItemKind:ve,CompletionItemTag:Zu,CompletionList:Tc,CompletionTriggerKind:Pc,ConfigurationTarget:Wc,CustomExecution:tb,DebugAdapterExecutable:Vc,DebugAdapterInlineImplementation:th,DebugAdapterNamedPipeServer:eh,DebugAdapterServer:qc,DebugConfigurationProviderTriggerKind:e1,DebugConsoleMode:Bp,DebugVisualization:qW,DecorationRangeBehavior:pa,Diagnostic:gp,DiagnosticRelatedInformation:zu,DiagnosticSeverity:pi,DiagnosticTag:aa,Disposable:ke,DocumentHighlight:Ep,DocumentHighlightKind:Bu,MultiDocumentHighlight:xp,DocumentLink:Pp,DocumentSymbol:_u,EndOfLine:ts,EnvironmentVariableMutatorType:Ic,EvaluatableExpression:Up,InlineValueText:jp,InlineValueVariableLookup:zp,InlineValueEvaluatableExpression:Hp,InlineCompletionTriggerKind:ih,InlineCompletionsDisposeReasonKind:nn,EventEmitter:I,ExtensionKind:ba,ExtensionMode:Qc,ExternalUriOpenerPriority:mb,FileChangeType:Gc,FileDecoration:hb,FileDecoration2:hb,FileSystemError:Yt,FileType:tr,FilePermission:Zn,FoldingRange:ab,FoldingRangeKind:on,FunctionBreakpoint:wa,InlineCompletionItem:Vw,InlineCompletionList:qw,Hover:Ap,VerboseHover:Sp,HoverVerbosityAction:Uw,IndentAction:N4,Location:rr,MarkdownString:ji,OverviewRulerLane:$A,ParameterInformation:zw,PortAutoForwardAction:wb,Position:Pe,ProcessExecution:zc,ProgressLocation:ao,QuickInputButtonLocation:_p,QuickInputButtons:ch,Range:xe,RelativePattern:Bc,Selection:Cs,SelectionRange:Gu,SemanticTokens:Zc,SemanticTokensBuilder:VW,SemanticTokensEdit:u7,SemanticTokensEdits:Wp,SemanticTokensLegend:ub,ShellExecution:ga,ShellQuoting:eb,SignatureHelp:Ww,SignatureHelpTriggerKind:Bw,SignatureInformation:Hw,SnippetString:ua,SourceBreakpoint:va,StandardTokenType:uo,StatusBarAlignment:no,SymbolInformation:Wu,SymbolKind:ut,SymbolTag:Hu,Task:Np,TaskEventKind:Xw,TaskGroup:Xu,TaskPanelKind:Kw,TaskRevealKind:Yw,TaskScope:oo,TerminalLink:NW,TerminalQuickFixTerminalCommand:LW,TerminalQuickFixOpener:RW,TerminalLocation:Jw,TerminalProfile:OW,TerminalExitReason:Gw,TerminalShellExecutionCommandLineConfidence:Yu,TerminalCompletionItem:FW,TerminalCompletionItemKind:Qw,TerminalCompletionList:UW,TerminalShellType:Zw,TextDocumentSaveReason:Rc,TextEdit:so,SnippetTextEdit:Mw,TextEditorCursorStyle:$r,TextEditorChangeKind:Oc,TextEditorLineNumbersStyle:is,TextEditorRevealType:Dp,TextEditorSelectionChangeKind:Lc,SyntaxTokenType:Fc,TextDocumentChangeReason:Qu,ThemeColor:Ku,ThemeIcon:Di,TreeItem:Rp,TreeItemCheckboxState:Ds,TreeItemCollapsibleState:ma,TypeHierarchyItem:bb,UIKind:Hh,Uri:y,ViewColumn:Ju,WorkspaceEdit:da,DocumentPasteTriggerKind:sb,DocumentDropEdit:rb,DocumentDropOrPasteEditKind:co,DocumentPasteEdit:HW,InlayHint:$p,InlayHintLabelPart:Cp,InlayHintKind:_w,RemoteAuthorityResolverError:$c,ResolvedAuthority:TW,ManagedResolvedAuthority:yp,SourceControlInputBoxValidationType:jc,ExtensionRuntime:Jp,TimelineItem:pb,NotebookRange:ks,NotebookCellKind:ca,NotebookCellExecutionState:db,NotebookCellData:mp,NotebookData:X6,NotebookRendererScript:h7,NotebookCellStatusBarAlignment:qp,NotebookEditorRevealType:Gp,NotebookCellOutput:wp,NotebookCellOutputItem:K6,CellErrorStackFrame:GW,NotebookCellStatusBarItem:ZW,NotebookControllerAffinity:fb,NotebookControllerAffinity2:Zp,NotebookEdit:vp,NotebookKernelSourceAction:JW,NotebookVariablesRequestKind:uh,PortAttributes:YW,LinkedEditingRanges:QW,TestResultState:gb,TestRunRequest:Qp,TestMessage:Yp,TestMessageStackFrame:XW,TestTag:hh,TestRunProfileKind:Yc,TextSearchCompleteMessageType:Xg,DataTransfer:Hc,DataTransferItem:Lp,TestCoverageCount:Xp,FileCoverage:eg,StatementCoverage:f7,BranchCoverage:p7,DeclarationCoverage:g7,WorkspaceTrustState:vb,LanguageStatusSeverity:Dc,QuickPickItemKind:lh,InputBoxValidationSeverity:Jc,TabInputText:yb,TabInputTextDiff:tg,TabInputTextMerge:m7,TabInputCustom:Ab,TabInputNotebook:Sb,TabInputNotebookDiff:Eb,TabInputWebview:v7,TabInputTerminal:w7,TabInputInteractiveWindow:b7,TabInputChat:y7,TabInputTextMultiDiff:A7,TelemetryTrustedValue:$w,LogLevel:Y,EditSessionIdentityMatch:R4,InteractiveSessionVoteDirection:xb,ChatCopyKind:kb,ChatSessionChangedFile:tB,ChatEditingSessionActionOutcome:Ps,InteractiveEditorResponseFeedbackKind:Ib,DebugStackFrame:c7,DebugThread:l7,RelatedInformationType:Hb,SpeechToTextStatus:Bb,TextToSpeechStatus:_b,PartialAcceptTriggerKind:fa,InlineCompletionEndOfLifeReasonKind:Mc,InlineCompletionDisplayLocationKind:Nc,KeywordRecognitionStatus:Vb,ChatImageMimeType:zb,ChatResponseMarkdownPart:ig,ChatResponseFileTreePart:sg,ChatResponseAnchorPart:ph,ChatResponseProgressPart:Tb,ChatResponseProgressPart2:ng,ChatResponseThinkingProgressPart:Xc,ChatResponseReferencePart:ya,ChatResponseReferencePart2:ya,ChatResponseCodeCitationPart:cg,ChatResponseCodeblockUriPart:ag,ChatResponseWarningPart:gh,ChatResponseTextEditPart:mh,ChatResponseNotebookEditPart:ug,ChatResponseMarkdownWithVulnerabilitiesPart:fh,ChatResponseCommandButtonPart:og,ChatResponseConfirmationPart:rg,ChatResponseMovePart:lg,ChatResponseExtensionsPart:Mb,ChatResponseExternalEditPart:Pb,ChatResponsePullRequestPart:Nb,ChatPrepareToolInvocationPart:vh,ChatResponseMultiDiffPart:Db,ChatResponseReferencePartStatusKind:Ob,ChatResponseClearToPreviousToolInvocationReason:Fb,ChatRequestTurn:hg,ChatRequestTurn2:hg,ChatResponseTurn:S7,ChatResponseTurn2:eB,ChatToolInvocationPart:Rb,ChatLocation:rs,ChatSessionStatus:Lb,ChatRequestEditorData:E7,ChatRequestNotebookData:x7,ChatReferenceBinaryData:k7,ChatRequestEditedFileEventKind:$b,LanguageModelChatMessageRole:sr,LanguageModelChatMessage:C7,LanguageModelChatMessage2:$7,LanguageModelToolResultPart:Kc,LanguageModelToolResultPart2:Kc,LanguageModelTextPart:Ut,LanguageModelTextPart2:Ut,LanguageModelPartAudience:dg,ToolResultAudience:dg,LanguageModelToolCallPart:Aa,LanguageModelThinkingPart:el,LanguageModelError:an,LanguageModelToolResult:fg,LanguageModelToolResult2:I7,LanguageModelDataPart:gi,LanguageModelDataPart2:gi,LanguageModelToolExtensionSource:D7,LanguageModelToolMCPSource:P7,ExtendedLanguageModelToolResult:iB,LanguageModelChatToolMode:pg,LanguageModelPromptTsxPart:Ts,NewSymbolName:BW,NewSymbolNameTag:ob,NewSymbolNameTriggerKind:rh,ExcludeSettingOptions:un,TextSearchContext2:Yg,TextSearchMatch2:ln,AISearchKeyword:Ry,TextSearchCompleteMessageTypeNew:Xg,ChatErrorLevel:jb,McpHttpServerDefinition:M7,McpHttpServerDefinition2:M7,McpStdioServerDefinition:T7,McpStdioServerDefinition2:T7,McpToolAvailability:gg,SettingsSearchResultKind:Wb}}}var T1,M1=class{constructor(t,i,r,s,n,o,a){this.c=t,this.d=i,this.f=r,this.g=s,this.h=n,this.i=o,this.j=a,this.a=new Map,this.b=[]}async install(){this.k(),Ot("code/extHost/willWaitForConfig");const t=await this.g.getConfigProvider();Ot("code/extHost/didWaitForConfig");const i=await this.h.getExtensionPathIndex();this.register(new $Y(this.c,i,this.d,t,this.j)),this.register(this.f.createInstance(OS)),this.i.remote.isRemote&&this.register(this.f.createInstance(FS,i,this.i.environment.appUriScheme))}register(t){if("nodeModuleName"in t)if(Array.isArray(t.nodeModuleName))for(const i of t.nodeModuleName)this.a.set(i,t);else this.a.set(t.nodeModuleName,t);typeof t.alternativeModuleName=="function"&&this.b.push(i=>t.alternativeModuleName(i))}};M1=__decorate([__param(2,dc),__param(3,vr),__param(4,fn),__param(5,Ft),__param(6,Se)],M1);var OS=class{static{T1=this}static{this.a=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(t){if(t.environment.appRoot&&T1.a.size){const i=Rn(this.c(t.environment.appRoot.fsPath)),r="[a-z0-9_.-]",s=`@${r}+\\/${r}+|${r}+`,n="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.b=new RegExp(`^(${i}/${n}\\/)(${s})(.*)$`,"i")}}alternativeModuleName(t){if(!this.b)return;const i=this.b.exec(this.c(t));if(!i)return;const[,r,s,n]=i,o=T1.a.get(s);if(o!==void 0)return console.warn(`${s} as been renamed to ${o}, please update your imports`),r+o+n}c(t){return t.replace(/\\/g,"/")}};OS=T1=__decorate([__param(0,Ft)],OS);var $Y=class{constructor(e,t,i,r,s){this.c=e,this.d=t,this.e=i,this.f=r,this.g=s,this.nodeModuleName="vscode",this.a=new Wn}load(e,t){const i=this.d.findSubstr(t);if(i){let r=this.a.get(i.identifier);return r||(r=this.c(i,this.e,this.f),this.a.set(i.identifier,r)),r}if(!this.b){let r="";this.d.forEach((s,n)=>r+=`	${n} -> ${s.identifier.value}
`),this.g.warn(`Could not identify extension for 'vscode' require call from ${t}. These are the extension path mappings: 
${r}`),this.b=this.c(bW,this.e,this.f)}return this.b}},FS=class{constructor(t,i,r){this.e=t,this.f=i,this.nodeModuleName=["open","opn"],this.d=r.getProxy(X.MainThreadTelemetry);const s=r.getProxy(X.MainThreadWindow);this.c=(n,o)=>{const a=y.parse(n);return o?this.g(n,o):a.scheme==="http"||a.scheme==="https"?s.$openUri(a,n,{allowTunneling:!0}):a.scheme==="mailto"||a.scheme===this.f?s.$openUri(a,n,{}):this.g(n,o)}}load(t,i,r){const s=this.e.findSubstr(i);return s&&(this.a=s.identifier.value,this.h()),this.b=r(t),this.c}g(t,i){return this.i(),this.b(t,i)}h(){this.a&&this.d.$publicLog2("shimming.open",{extension:this.a})}i(){this.a&&this.d.$publicLog2("shimming.open.call.noForward",{extension:this.a})}};FS=__decorate([__param(2,Ce)],FS);import{LogLevel as za,createHttpPatch as jT,createProxyResolver as IY,createTlsPatch as DY,createNetPatch as PY,loadSystemCertificates as zT}from"@vscode/proxy-agent";import{createRequire as TY}from"node:module";import{parse as HT}from"url";import{spawn as MY}from"child_process";import{userInfo as NY}from"os";import*as WT from"os";var BT=/^\d+$/,RY=/^Microsoft.PowerShell_.*/,LY=/^Microsoft.PowerShellPreview_.*/,_T;(function(e){e[e.x64=0]="x64",e[e.x86=1]="x86",e[e.ARM=2]="ARM"})(_T||(_T={}));var yd;switch(process.arch){case"ia32":yd=1;break;case"arm":case"arm64":yd=2;break;default:yd=0;break}var Rl;process.env.PROCESSOR_ARCHITEW6432?Rl=process.env.PROCESSOR_ARCHITEW6432==="ARM64"?2:0:process.env.PROCESSOR_ARCHITECTURE==="ARM64"?Rl=2:process.env.PROCESSOR_ARCHITECTURE==="X86"?Rl=1:Rl=0;var Ad=class{constructor(e,t,i){this.exePath=e,this.displayName=t,this.a=i}async exists(){return this.a===void 0&&(this.a=await Ri.existsFile(this.exePath)),this.a}};function OY({useAlternateBitness:e=!1}={}){return e?yd===0?process.env["ProgramFiles(x86)"]||null:Rl===0&&process.env.ProgramW6432||null:process.env.ProgramFiles||null}async function N1({useAlternateBitness:e=!1,findPreview:t=!1}={}){const i=OY({useAlternateBitness:e});if(!i)return null;const r=_e(i,"PowerShell");if(!await Ri.existsDirectory(r))return null;let s=-1,n=null;for(const c of await nt.readdir(r)){let l=-1;if(t){const h=c.indexOf("-");if(h<0)continue;const f=c.substring(0,h);if(!BT.test(f)||c.substring(h+1)!=="preview")continue;l=parseInt(f,10)}else{if(!BT.test(c))continue;l=parseInt(c,10)}if(l<=s)continue;const u=_e(r,c,"pwsh.exe");await Ri.existsFile(u)&&(n=u,s=l)}if(!n)return null;const o=i.includes("x86")?" (x86)":"",a=t?" Preview":"";return new Ad(n,`PowerShell${a}${o}`,!0)}async function VT({findPreview:e}={}){if(!process.env.LOCALAPPDATA)return null;const t=_e(process.env.LOCALAPPDATA,"Microsoft","WindowsApps");if(!await Ri.existsDirectory(t))return null;const{pwshMsixDirRegex:i,pwshMsixName:r}=e?{pwshMsixDirRegex:LY,pwshMsixName:"PowerShell Preview (Store)"}:{pwshMsixDirRegex:RY,pwshMsixName:"PowerShell (Store)"};for(const s of await nt.readdir(t))if(i.test(s)){const n=_e(t,s,"pwsh.exe");return new Ad(n,r)}return null}function FY(){const e=_e(WT.homedir(),".dotnet","tools","pwsh.exe");return new Ad(e,".NET Core PowerShell Global Tool")}function UY(){const e=_e(WT.homedir(),"scoop","apps"),t=_e(e,"pwsh","current","pwsh.exe");return new Ad(t,"PowerShell (Scoop)")}function jY(){const e=_e(process.env.windir,yd===1&&Rl!==1?"SysNative":"System32","WindowsPowerShell","v1.0","powershell.exe");return new Ad(e,"Windows PowerShell",!0)}async function*zY(){let e=await N1();e&&(yield e),e=await N1({useAlternateBitness:!0}),e&&(yield e),e=await VT(),e&&(yield e),e=FY(),e&&(yield e),e=await N1({findPreview:!0}),e&&(yield e),e=await VT({findPreview:!0}),e&&(yield e),e=await N1({useAlternateBitness:!0,findPreview:!0}),e&&(yield e),e=await UY(),e&&(yield e),e=jY(),e&&(yield e)}async function*HY(){for await(const e of zY())await e.exists()&&(yield e)}async function WY(){for await(const e of HY())return e;return null}async function BY(e,t){return e===1?ze?VY():S8(t):_Y(e,t)}var US=null;function _Y(e,t){if($t&&e===2||Dt&&e===3)return"/bin/bash";if(!US){let i;if(ze)i="/bin/bash";else{if(i=t.SHELL,!i)try{i=NY().shell}catch{}i||(i="sh"),i==="/bin/false"&&(i="/bin/bash")}US=i}return US}var jS=null;async function VY(){return jS||(jS=(await WY()).exePath),jS}import"assert";var jle=U5(j5(),1),zle={o:d(1893,null),e:d(1894,null),t:d(1895,null),m:d(1896,null)},Hle={chat:{type:"subcommand",description:"Pass in a prompt to run in a chat session in the current working directory.",options:{_:{type:"string[]",description:d(1897,null)},mode:{type:"string",cat:"o",alias:"m",args:"mode",description:d(1898,null)},"add-file":{type:"string[]",cat:"o",alias:"a",args:"path",description:d(1899,null)},maximize:{type:"boolean",cat:"o",description:d(1900,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1901,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1902,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1903,null)},help:{type:"boolean",alias:"h",description:d(1904,null)}}},"serve-web":{type:"subcommand",description:"Run a server that displays the editor UI in browsers.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1905,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"}}},tunnel:{type:"subcommand",description:"Make the current machine accessible from vscode.dev or other machines through a secure tunnel.",options:{"cli-data-dir":{type:"string",args:"dir",description:d(1906,null)},"disable-telemetry":{type:"boolean"},"telemetry-level":{type:"string"},user:{type:"subcommand",options:{login:{type:"subcommand",options:{provider:{type:"string"},"access-token":{type:"string"}}}}}}},diff:{type:"boolean",cat:"o",alias:"d",args:["file","file"],description:d(1907,null)},merge:{type:"boolean",cat:"o",alias:"m",args:["path1","path2","base","result"],description:d(1908,null)},add:{type:"boolean",cat:"o",alias:"a",args:"folder",description:d(1909,null)},remove:{type:"boolean",cat:"o",args:"folder",description:d(1910,null)},goto:{type:"boolean",cat:"o",alias:"g",args:"file:line[:character]",description:d(1911,null)},"new-window":{type:"boolean",cat:"o",alias:"n",description:d(1912,null)},"reuse-window":{type:"boolean",cat:"o",alias:"r",description:d(1913,null)},wait:{type:"boolean",cat:"o",alias:"w",description:d(1914,null)},waitMarkerFilePath:{type:"string"},locale:{type:"string",cat:"o",args:"locale",description:d(1915,null)},"user-data-dir":{type:"string",cat:"o",args:"dir",description:d(1916,null)},profile:{type:"string",cat:"o",args:"profileName",description:d(1917,null)},help:{type:"boolean",cat:"o",alias:"h",description:d(1918,null)},"extensions-dir":{type:"string",deprecates:["extensionHomePath"],cat:"e",args:"dir",description:d(1919,null)},"extensions-download-dir":{type:"string"},"builtin-extensions-dir":{type:"string"},"list-extensions":{type:"boolean",cat:"e",description:d(1920,null)},"show-versions":{type:"boolean",cat:"e",description:d(1921,null)},category:{type:"string",allowEmptyValue:!0,cat:"e",description:d(1922,null),args:"category"},"install-extension":{type:"string[]",cat:"e",args:"ext-id | path",description:d(1923,null)},"pre-release":{type:"boolean",cat:"e",description:d(1924,null)},"uninstall-extension":{type:"string[]",cat:"e",args:"ext-id",description:d(1925,null)},"update-extensions":{type:"boolean",cat:"e",description:d(1926,null)},"enable-proposed-api":{type:"string[]",allowEmptyValue:!0,cat:"e",args:"ext-id",description:d(1927,null)},"add-mcp":{type:"string[]",cat:"m",args:"json",description:d(1928,null)},version:{type:"boolean",cat:"t",alias:"v",description:d(1929,null)},verbose:{type:"boolean",cat:"t",global:!0,description:d(1930,null)},log:{type:"string[]",cat:"t",args:"level",global:!0,description:d(1931,null)},status:{type:"boolean",alias:"s",cat:"t",description:d(1932,null)},"prof-startup":{type:"boolean",cat:"t",description:d(1933,null)},"prof-append-timers":{type:"string"},"prof-duration-markers":{type:"string[]"},"prof-duration-markers-file":{type:"string"},"no-cached-data":{type:"boolean"},"prof-startup-prefix":{type:"string"},"prof-v8-extensions":{type:"boolean"},"disable-extensions":{type:"boolean",deprecates:["disableExtensions"],cat:"t",description:d(1934,null)},"disable-extension":{type:"string[]",cat:"t",args:"ext-id",description:d(1935,null)},sync:{type:"string",cat:"t",description:d(1936,null),args:["on | off"]},"inspect-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugPluginHost"],args:"port",cat:"t",description:d(1937,null)},"inspect-brk-extensions":{type:"string",allowEmptyValue:!0,deprecates:["debugBrkPluginHost"],args:"port",cat:"t",description:d(1938,null)},"disable-lcd-text":{type:"boolean",cat:"t",description:d(1939,null)},"disable-gpu":{type:"boolean",cat:"t",description:d(1940,null)},"disable-chromium-sandbox":{type:"boolean",cat:"t",description:d(1941,null)},sandbox:{type:"boolean"},"locate-shell-integration-path":{type:"string",cat:"t",args:["shell"],description:d(1942,null)},telemetry:{type:"boolean",cat:"t",description:d(1943,null)},remote:{type:"string",allowEmptyValue:!0},"folder-uri":{type:"string[]",cat:"o",args:"uri"},"file-uri":{type:"string[]",cat:"o",args:"uri"},"locate-extension":{type:"string[]"},extensionDevelopmentPath:{type:"string[]"},extensionDevelopmentKind:{type:"string[]"},extensionTestsPath:{type:"string"},extensionEnvironment:{type:"string"},debugId:{type:"string"},debugRenderer:{type:"boolean"},"inspect-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-brk-ptyhost":{type:"string",allowEmptyValue:!0},"inspect-search":{type:"string",deprecates:["debugSearch"],allowEmptyValue:!0},"inspect-brk-search":{type:"string",deprecates:["debugBrkSearch"],allowEmptyValue:!0},"inspect-sharedprocess":{type:"string",allowEmptyValue:!0},"inspect-brk-sharedprocess":{type:"string",allowEmptyValue:!0},"export-default-configuration":{type:"string"},"export-policy-data":{type:"string",allowEmptyValue:!0},"install-source":{type:"string"},"enable-smoke-test-driver":{type:"boolean"},logExtensionHostCommunication:{type:"boolean"},"skip-release-notes":{type:"boolean"},"skip-welcome":{type:"boolean"},"disable-telemetry":{type:"boolean"},"disable-updates":{type:"boolean"},transient:{type:"boolean",cat:"t",description:d(1944,null)},"use-inmemory-secretstorage":{type:"boolean",deprecates:["disable-keytar"]},"password-store":{type:"string"},"disable-workspace-trust":{type:"boolean"},"disable-crash-reporter":{type:"boolean"},"crash-reporter-directory":{type:"string"},"crash-reporter-id":{type:"string"},"skip-add-to-recently-opened":{type:"boolean"},"open-url":{type:"boolean"},"file-write":{type:"boolean"},"file-chmod":{type:"boolean"},"install-builtin-extension":{type:"string[]"},force:{type:"boolean"},"do-not-sync":{type:"boolean"},"do-not-include-pack-dependencies":{type:"boolean"},trace:{type:"boolean"},"trace-memory-infra":{type:"boolean"},"trace-category-filter":{type:"string"},"trace-options":{type:"string"},"preserve-env":{type:"boolean"},"force-user-env":{type:"boolean"},"force-disable-user-env":{type:"boolean"},"open-devtools":{type:"boolean"},"disable-gpu-sandbox":{type:"boolean"},logsPath:{type:"string"},"__enable-file-policy":{type:"boolean"},editSessionId:{type:"string"},continueOn:{type:"string"},"enable-coi":{type:"boolean"},"unresponsive-sample-interval":{type:"string"},"unresponsive-sample-period":{type:"string"},"enable-rdp-display-tracking":{type:"boolean"},"disable-layout-restore":{type:"boolean"},"disable-experiments":{type:"boolean"},"no-proxy-server":{type:"boolean"},"no-sandbox":{type:"boolean",alias:"sandbox"},"proxy-server":{type:"string"},"proxy-bypass-list":{type:"string"},"proxy-pac-url":{type:"string"},"js-flags":{type:"string"},inspect:{type:"string",allowEmptyValue:!0},"inspect-brk":{type:"string",allowEmptyValue:!0},nolazy:{type:"boolean"},"force-device-scale-factor":{type:"string"},"force-renderer-accessibility":{type:"boolean"},"ignore-certificate-errors":{type:"boolean"},"allow-insecure-localhost":{type:"boolean"},"log-net-log":{type:"string"},vmodule:{type:"string"},_urls:{type:"string[]"},"disable-dev-shm-usage":{type:"boolean"},"profile-temp":{type:"boolean"},"ozone-platform":{type:"string"},"enable-tracing":{type:"string"},"trace-startup-format":{type:"string"},"trace-startup-file":{type:"string"},"trace-startup-duration":{type:"string"},"xdg-portal-required-version":{type:"string"},_:{type:"string[]"}};function qT(e){return e.VSCODE_CLI==="1"}var zS=void 0;async function qY(e,t,i,r){return i["force-disable-user-env"]?(t.trace("resolveShellEnv(): skipped (--force-disable-user-env)"),{}):ze?(t.trace("resolveShellEnv(): skipped (Windows)"),{}):qT(r)&&!i["force-user-env"]?(t.trace("resolveShellEnv(): skipped (VSCODE_CLI is set)"),{}):(qT(r)?t.trace("resolveShellEnv(): running (--force-user-env)"):t.trace("resolveShellEnv(): running (macOS/Linux)"),zS||(zS=Un.withAsyncBody(async(s,n)=>{const o=new Qe;let a=1e4;const c=e.getValue("application.shellEnvironmentResolutionTimeout");typeof c=="number"&&(a=rj(c,1,120)*1e3);const l=setTimeout(()=>{o.dispose(!0),n(new Error(d(2310,null)))},a);try{s(await GY(t,o.token))}catch(u){!Ti(u)&&!o.token.isCancellationRequested?n(new Error(d(2311,null,ys(u)))):s({})}finally{clearTimeout(l),o.dispose()}})),zS)}async function GY(e,t){const i=process.env.ELECTRON_RUN_AS_NODE;e.trace("getUnixShellEnvironment#runAsNode",i);const r=process.env.ELECTRON_NO_ATTACH_CONSOLE;e.trace("getUnixShellEnvironment#noAttach",r);const s=Tt().replace(/-/g,"").substr(0,12),n=new RegExp(s+"({.*})"+s),o={...process.env,ELECTRON_RUN_AS_NODE:"1",ELECTRON_NO_ATTACH_CONSOLE:"1",VSCODE_RESOLVING_ENVIRONMENT:"1"};e.trace("getUnixShellEnvironment#env",o);const a=await BY(Lo,o);return e.trace("getUnixShellEnvironment#shell",a),new Promise((c,l)=>{if(t.isCancellationRequested)return l(new dt);const u=At(a);let h,f;const p="";/^(?:pwsh|powershell)(?:-preview)?$/.test(u)?(h=`& '${process.execPath}' ${p} -p '''${s}'' + JSON.stringify(process.env) + ''${s}'''`,f=["-Login","-Command"]):u==="nu"?(h=`^'${process.execPath}' ${p} -p '"${s}" + JSON.stringify(process.env) + "${s}"'`,f=["-i","-l","-c"]):u==="xonsh"?(h=`import os, json; print("${s}", json.dumps(dict(os.environ)), "${s}")`,f=["-i","-l","-c"]):(h=`'${process.execPath}' ${p} -p '"${s}" + JSON.stringify(process.env) + "${s}"'`,u==="tcsh"||u==="csh"?f=["-ic"]:f=["-i","-l","-c"]),e.trace("getUnixShellEnvironment#spawn",JSON.stringify(f),h);const g=MY(a,[...f,h],{detached:!0,stdio:["ignore","pipe","pipe"],env:o});t.onCancellationRequested(()=>(g.kill(),l(new dt))),g.on("error",S=>{e.error("getUnixShellEnvironment#errorChildProcess",ys(S)),l(S)});const v=[];g.stdout.on("data",S=>v.push(S));const b=[];g.stderr.on("data",S=>b.push(S)),g.on("close",(S,E)=>{const $=Buffer.concat(v).toString("utf8");e.trace("getUnixShellEnvironment#raw",$);const U=Buffer.concat(b).toString("utf8");if(U.trim()&&e.trace("getUnixShellEnvironment#stderr",U),S||E)return l(new Error(d(2312,null,S,E)));const O=n.exec($),J=O?O[1]:"{}";try{const F=JSON.parse(J);i?F.ELECTRON_RUN_AS_NODE=i:delete F.ELECTRON_RUN_AS_NODE,r?F.ELECTRON_NO_ATTACH_CONSOLE=r:delete F.ELECTRON_NO_ATTACH_CONSOLE,delete F.VSCODE_RESOLVING_ENVIRONMENT,delete F.XDG_RUNTIME_DIR,e.trace("getUnixShellEnvironment#result",F),c(F)}catch(F){e.error("getUnixShellEnvironment#errorCaught",ys(F)),l(F)}})})}import{parse as GT}from"url";function ZY(e,t){return e.protocol==="http:"?t.HTTP_PROXY||t.http_proxy||null:e.protocol==="https:"&&(t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy)||null}async function JY(e,t,i={}){const r=GT(e),s=i.proxyUrl||ZY(r,t);if(!s)return null;const n=GT(s);if(!/^https?:$/.test(n.protocol||""))return null;const o={host:n.hostname||"",port:(n.port?+n.port:0)||(n.protocol==="https"?443:80),auth:n.auth,rejectUnauthorized:K5(i.strictSSL)?i.strictSSL:!0};if(r.protocol==="http:"){const{default:a}=await import("http-proxy-agent");return new a.HttpProxyAgent(s,o)}else{const{default:a}=await import("https-proxy-agent");return new a.HttpsProxyAgent(s,o)}}import{createGunzip as QY}from"zlib";var ZT=class extends FJ{constructor(t,i,r,s){super(s),this.m=t,this.n=i,this.q=r,this.r(),this.D(i.onDidChangeConfiguration(n=>{n.affectsConfiguration("http")&&this.r()}))}r(){this.f=this.s("http.proxy"),this.g=!!this.s("http.proxyStrictSSL"),this.h=this.s("http.proxyAuthorization")}async request(t,i){const{f:r,g:s}=this;let n;try{n=await qY(this.n,this.b,this.q.args,process.env)}catch(c){this.j||(this.j=!0,this.b.error("resolving shell environment failed",W5(c)))}const o={...process.env,...n},a=t.agent?t.agent:await JY(t.url||"",o,{proxyUrl:r,strictSSL:s});return t.agent=a,t.strictSSL=s,this.h&&(t.headers={...t.headers||{},"Proxy-Authorization":this.h}),this.c(t,()=>QT(t,i))}async resolveProxy(t){}async lookupAuthorization(t){}async lookupKerberosAuthorization(t){try{const i=this.s("http.proxyKerberosServicePrincipal");return"Negotiate "+await JT(t,i,this.b,"RequestService#lookupKerberosAuthorization")}catch(i){this.b.debug("RequestService#lookupKerberosAuthorization Kerberos authentication failed",i);return}}async loadCertificates(){return(await import("@vscode/proxy-agent")).loadSystemCertificates({loadSystemCertificatesFromNode:()=>this.s("http.systemCertificatesNode",g1),log:this.b})}s(t,i){if(this.m==="remote")return this.n.getValue(t);const r=this.n.inspect(t);return r.userLocalValue??r.defaultValue??i}};ZT=__decorate([__param(1,yi),__param(2,Y_),__param(3,Se)],ZT);async function JT(e,t,i,r){const s=await import("kerberos"),n=s.default||s,o=new URL(e),a=t||(process.platform==="win32"?`HTTP/${o.hostname}`:`HTTP@${o.hostname}`);return i.debug(`${r} Kerberos authentication lookup`,`proxyURL:${o}`,`spn:${a}`),(await n.initializeClient(a)).step("")}async function YY(e){return(HT(e.url).protocol==="https:"?await import("https"):await import("http")).request}async function QT(e,t){return Un.withAsyncBody(async(i,r)=>{const s=HT(e.url),n=e.getRawRequest?e.getRawRequest(e):await YY(e),o={hostname:s.hostname,port:s.port?parseInt(s.port):s.protocol==="https:"?443:80,protocol:s.protocol,path:s.path,method:e.type||"GET",headers:e.headers,agent:e.agent,rejectUnauthorized:K5(e.strictSSL)?e.strictSSL:!0};e.user&&e.password&&(o.auth=e.user+":"+e.password),e.disableCache&&(o.cache="no-store");const a=n(o,c=>{const l=Er(e.followRedirects)?e.followRedirects:3;if(c.statusCode&&c.statusCode>=300&&c.statusCode<400&&l>0&&c.headers.location)QT({...e,url:c.headers.location,followRedirects:l-1},t).then(i,r);else{let u=c;!e.isChromiumNetwork&&c.headers["content-encoding"]==="gzip"&&(u=c.pipe(QY())),i({res:c,stream:mO(u)})}});if(a.on("error",r),e.timeout)if(e.isChromiumNetwork){const c=setTimeout(()=>{a.abort(),r(new Error(`Request timeout after ${e.timeout}ms`))},e.timeout);a.on("response",()=>clearTimeout(c)),a.on("error",()=>clearTimeout(c)),a.on("abort",()=>clearTimeout(c))}else a.setTimeout(e.timeout);e.isChromiumNetwork&&a.removeHeader("Content-Length"),e.data&&typeof e.data=="string"&&a.write(e.data),a.end(),t.onCancellationRequested(()=>{a.abort(),r(new dt)})})}import*as R1 from"@vscode/proxy-agent";var Ll=TY(import.meta.url),YT=Ll("http"),L1=Ll("https"),XT=Ll("tls"),KT=Ll("net"),eM=!1,tM=!1;function XY(e,t,i,r,s,n,o){const a=n.remote.isRemote,c=n.environment.useHostProxy??!a,l=c,u=c,h=()=>!a||t.getConfiguration("http").get("useLocalProxyConfiguration",c),p={resolveProxy:sX(e,s),lookupProxyAuthorization:lX.bind(void 0,e,r,s,t,{},{},n.remote.isRemote,l),getProxyURL:()=>Or(t,a,"http.proxy"),getProxySupport:()=>Or(t,a,"http.proxySupport")||"off",getNoProxyConfig:()=>Or(t,a,"http.noProxy")||[],isAdditionalFetchSupportEnabled:()=>Or(t,a,"http.fetchAdditionalSupport",!0),addCertificatesV1:()=>oX(t,a),addCertificatesV2:()=>aX(t,a),loadSystemCertificatesFromNode:()=>Or(t,a,"http.systemCertificatesNode",g1),log:r,getLogLevel:()=>{const E=r.getLevel();switch(E){case Y.Trace:return za.Trace;case Y.Debug:return za.Debug;case Y.Info:return za.Info;case Y.Warning:return za.Warning;case Y.Error:return za.Error;case Y.Off:return za.Off;default:return $(E)}function $(U){return r.error("Unknown log level",U),za.Debug}},proxyResolveTelemetry:()=>{},isUseHostProxyEnabled:h,getNetworkInterfaceCheckInterval:()=>Or(t,a,"http.experimental.networkInterfaceCheckInterval",300)*1e3,loadAdditionalCertificates:async()=>{const E=Or(t,a,"http.systemCertificatesNode",g1),$=[];if(a&&$.push(zT({loadSystemCertificatesFromNode:()=>E,log:r})),u)if(!a&&E)$.push(zT({loadSystemCertificatesFromNode:()=>E,log:r}));else{r.trace("ProxyResolver#loadAdditionalCertificates: Loading certificates from main process");const U=e.loadCertificates();U.then(O=>r.trace("ProxyResolver#loadAdditionalCertificates: Loaded certificates from main process",O.length)),$.push(U)}return n.environment.extensionTestsLocationURI&&L1.globalAgent.testCertificates?.length&&(r.trace("ProxyResolver#loadAdditionalCertificates: Loading test certificates"),$.push(Promise.resolve(L1.globalAgent.testCertificates))),(await Promise.all($)).flat()},env:process.env},{resolveProxyWithRequest:g,resolveProxyURL:v}=IY(p),b=R1.default||R1;b.resolveProxyURL=v,eX(p,t,s,n,v,o);const S=nX(p,g);return cX(i,S)}var KY=["content-length","host","trailer","te","upgrade","cookie2","keep-alive","transfer-encoding","set-cookie"];function eX(e,t,i,r,s,n){if(!globalThis.__vscodeOriginalFetch){const o=globalThis.fetch;globalThis.__vscodeOriginalFetch=o;const a=R1.createFetchPatch(e,o,s);globalThis.__vscodePatchedFetch=a;let c=!1;r.remote.isRemote||(c=t.getConfiguration("http").get("electronFetch",tM),n.add(t.onDidChangeConfiguration(l=>{l.affectsConfiguration("http.electronFetch")&&(c=t.getConfiguration("http").get("electronFetch",tM))}))),globalThis.fetch=async function(u,h){function f(O){return h&&O in h?h[O]:typeof u=="object"&&"cache"in u?u[O]:void 0}const p=typeof u=="string"?u:"cache"in u?u.url:u.toString(),g=p.startsWith("data:");g&&Ol(i,"data");const v=p.startsWith("blob:");v&&Ol(i,"blob");const b=f("redirect")==="manual";b&&Ol(i,"manualRedirect");const S=f("integrity");if(S&&Ol(i,"integrity"),!c||g||v||b||S){const O=await a(u,h);return iM(i,O,p),O}if(h?.headers){const O=new Headers(h.headers);for(const J of KY)O.delete(J);h={...h,headers:O}}const E=u instanceof URL?u.toString():u,U=await Ll("electron").net.fetch(E,h);return iM(i,U,p),U}}}function iM(e,t,i){const r=t.url;Object.defineProperty(t,"url",{get(){return Ol(e,"url"),r||i}});const s=t.type;Object.defineProperty(t,"type",{get(){return Ol(e,"typeProperty"),s!=="default"?s:"basic"}})}var rM={url:0,typeProperty:0,data:0,blob:0,integrity:0,manualRedirect:0},O1,tX=!1;function Ol(e,t){tX&&!rM[t]++&&(O1&&clearTimeout(O1),O1=setTimeout(()=>{e.$publicLog2("fetchFeatureUse",rM)},1e4),O1.unref?.())}var ui={count:0,totalDuration:0,minDuration:Number.MAX_SAFE_INTEGER,maxDuration:0,lastSentTime:0},iX=60*60*1e3;function rX(e){if(ui.count>0){const t=ui.totalDuration/ui.count;e.$publicLog2("proxyResolveStats",{count:ui.count,totalDuration:ui.totalDuration,minDuration:ui.minDuration,maxDuration:ui.maxDuration,avgDuration:t}),ui.count=0,ui.totalDuration=0,ui.minDuration=Number.MAX_SAFE_INTEGER,ui.maxDuration=0}ui.lastSentTime=Date.now()}function sX(e,t){return async i=>{const r=performance.now();try{return await e.resolveProxy(i)}finally{const s=performance.now()-r;ui.count++,ui.totalDuration+=s,ui.minDuration=Math.min(ui.minDuration,s),ui.maxDuration=Math.max(ui.maxDuration,s),Date.now()-ui.lastSentTime>=iX&&rX(t)}}}function nX(e,t){function i(r,s){const n=r.default||r;return n.__vscodeOriginal=Object.assign({},n),Object.assign(n,s)}return{http:i(YT,jT(e,YT,t)),https:i(L1,jT(e,L1,t)),net:i(KT,PY(e,KT)),tls:i(XT,DY(e,XT))}}function oX(e,t){return!Or(e,t,"http.experimental.systemCertificatesV2",eM)&&!!Or(e,t,"http.systemCertificates")}function aX(e,t){return!!Or(e,t,"http.experimental.systemCertificatesV2",eM)&&!!Or(e,t,"http.systemCertificates")}var sM=new Map;function cX(e,t){return e.getExtensionPathIndex().then(i=>{const r=Ll("module"),s=r._load;r._load=function(o,a,c){if(o==="net")return t.net;if(o==="tls")return t.tls;if(o!=="http"&&o!=="https"&&o!=="undici")return s.apply(this,arguments);const l=i.findSubstr(y.file(a.filename));let u=sM.get(l);if(u||sM.set(l,u={}),!u[o])if(o==="undici"){const h=s.apply(this,arguments);R1.patchUndici(h),u[o]=h}else{const h=t[o];u[o]={...h}}return u[o]}})}async function lX(e,t,i,r,s,n,o,a,c,l,u){const h=s[c];l&&(s[c]=l),t.trace("ProxyResolver#lookupProxyAuthorization callback",`proxyURL:${c}`,`proxyAuthenticate:${l}`,`proxyAuthenticateCache:${h}`);const f=l||h,p=Array.isArray(f)?f:typeof f=="string"?[f]:[];if(hX(i,p,o),p.some(v=>/^(Negotiate|Kerberos)( |$)/i.test(v))&&!u.kerberosRequested){u.kerberosRequested=!0;try{const v=Or(r,o,"http.proxyKerberosServicePrincipal");return"Negotiate "+await JT(c,v,t,"ProxyResolver#lookupProxyAuthorization")}catch(v){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication failed",v)}if(o&&a){t.debug("ProxyResolver#lookupProxyAuthorization Kerberos authentication lookup on host",`proxyURL:${c}`);const v=await e.lookupKerberosAuthorization(c);if(v)return"Negotiate "+v}}const g=p.find(v=>/^Basic( |$)/i.test(v));if(g)try{const v=n[c];if(v)if(u.basicAuthCacheUsed)t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication deleting cached credentials",`proxyURL:${c}`),delete n[c];else return t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication using cached credentials",`proxyURL:${c}`),u.basicAuthCacheUsed=!0,v;u.basicAuthAttempt=(u.basicAuthAttempt||0)+1;const b=/ realm="([^"]+)"/i.exec(g)?.[1];t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication lookup",`proxyURL:${c}`,`realm:${b}`);const S=new URL(c),E={scheme:"basic",host:S.hostname,port:Number(S.port),realm:b||"",isProxy:!0,attempt:u.basicAuthAttempt},$=await e.lookupAuthorization(E);if($){t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received credentials",`proxyURL:${c}`,`realm:${b}`);const U="Basic "+Buffer.from(`${$.username}:${$.password}`).toString("base64");return n[c]=U,U}else t.debug("ProxyResolver#lookupProxyAuthorization Basic authentication received no credentials",`proxyURL:${c}`,`realm:${b}`)}catch(v){t.error("ProxyResolver#lookupProxyAuthorization Basic authentication failed",v)}}var nM=!1,uX=!1;function hX(e,t,i){!uX||nM||!t.length||(nM=!0,e.$publicLog2("proxyAuthenticationRequest",{authenticationType:t.map(r=>r.split(" ")[0]).join(","),extensionHostType:i?"remote":"local"}))}function Or(e,t,i,r){if(t)return e.getConfiguration().get(i)??r;const s=e.getConfiguration().inspect(i);return s?.globalLocalValue??s?.defaultValue??r}import{tmpdir as dX}from"os";var HS=class extends Q{constructor(t,i){super();const r=t.getProxy(X.MainThreadDownloadService);i.registerCommand(!1,"_workbench.downloadResource",async s=>{const n=y.file(_e(dX(),Tt()));return await r.$download(s,n),n})}};HS=__decorate([__param(0,Ce),__param(1,os)],HS);import*as fX from"http";import*as oM from"fs";var pX=class{constructor(e,t,i){this.b=e,this.c=t,this.f=i,this.a=fX.createServer((r,s)=>this.h(r,s)),this.g().catch(r=>(t.error(r),""))}get ipcHandlePath(){return this.f}async g(){try{this.a.listen(this.ipcHandlePath),this.a.on("error",e=>this.c.error(e))}catch{this.c.error("Could not start open from terminal server.")}return this.f}h(e,t){const i=(s,n)=>{t.writeHead(s,{"content-type":"application/json"}),t.end(JSON.stringify(n||null),o=>o&&this.c.error(o))},r=[];e.setEncoding("utf8"),e.on("data",s=>r.push(s)),e.on("end",async()=>{try{const s=JSON.parse(r.join(""));let n;switch(s.type){case"open":n=await this.i(s);break;case"openExternal":n=await this.j(s);break;case"status":n=await this.l(s);break;case"extensionManagement":n=await this.k(s);break;default:i(404,`Unknown message type: ${s.type}`);break}i(200,n)}catch(s){const n=s instanceof Error?s.message:JSON.stringify(s);i(500,n),this.c.error("Error while processing pipe request",s)}})}async i(e){const{fileURIs:t,folderURIs:i,forceNewWindow:r,diffMode:s,mergeMode:n,addMode:o,removeMode:a,forceReuseWindow:c,gotoLineMode:l,waitMarkerFilePath:u,remoteAuthority:h}=e,f=[];if(Array.isArray(i))for(const b of i)try{f.push({folderUri:y.parse(b)})}catch{}if(Array.isArray(t))for(const b of t)try{hj(b)?f.push({workspaceUri:y.parse(b)}):f.push({fileUri:y.parse(b)})}catch{}const p=u?y.file(u):void 0,v={forceNewWindow:r,diffMode:s,mergeMode:n,addMode:o,removeMode:a,gotoLineMode:l,forceReuseWindow:c,preferNewWindow:!c&&!p&&!o&&!a,waitMarkerFileURI:p,remoteAuthority:h};this.b.executeCommand("_remoteCLI.windowOpen",f,v)}async j(e){for(const t of e.uris){const i=y.parse(t),r=i.scheme==="file"?i:t;await this.b.executeCommand("_remoteCLI.openExternal",r)}}async k(e){const t=r=>r?.map(s=>/\.vsix$/i.test(s)?y.parse(s):s),i={list:e.list,install:t(e.install),uninstall:t(e.uninstall),force:e.force};return await this.b.executeCommand("_remoteCLI.manageExtensions",i)}async l(e){return await this.b.executeCommand("_remoteCLI.getSystemStatus")}dispose(){this.a.close(),this.f&&process.platform!=="win32"&&oM.existsSync(this.f)&&oM.unlinkSync(this.f)}},WS=class extends pX{constructor(t,i){super(t,i,aF())}};WS=__decorate([__param(0,os),__param(1,Se)],WS);var BS=class{constructor(t,i){this.a=t.getProxy(X.MainThreadConsole),this.b=i.consoleForward.includeStack,this.c=i.consoleForward.logNative,this.d("info","log"),this.d("log","log"),this.d("warn","warn"),this.d("debug","debug"),this.d("error","error")}d(t,i){const r=this,s=console[t];Object.defineProperty(console,t,{set:()=>{},get:()=>function(){r.e(t,i,s,arguments)}})}e(t,i,r,s){this.a.$logExtensionHostMessage({type:"__$console",severity:i,arguments:mX(s,this.b)}),this.c&&this.f(t,r,s)}};BS=__decorate([__param(0,Ce),__param(1,Ft)],BS);var gX=1e5;function mX(e,t){const i=[];if(e.length)for(let r=0;r<e.length;r++){let s=e[r];if(typeof s>"u")s="undefined";else if(s instanceof Error){const n=s;n.stack?s=n.stack:s=n.toString()}i.push(s)}if(t){const r=new Error().stack;r&&i.push({__$stack:r.split(`
`).slice(3).join(`
`)})}try{const r=lF(i);return r.length>gX?"Output omitted for a large object that exceeds the limits":r}catch(r){return`Output omitted for an object that cannot be inspected ('${r.toString()}')`}}var vX=1024*1024,_S=class extends BS{constructor(t,i){super(t,i),this.g=!1,this.j("stderr","error"),this.j("stdout","log")}f(t,i,r){const s=t==="error"||t==="warn"?process.stderr:process.stdout;this.g=!0,s.write(`
START_NATIVE_LOG
`),i.apply(console,r),s.write(`
END_NATIVE_LOG
`),this.g=!1}j(t,i){const r=process[t],s=r.write;let n="";Object.defineProperty(r,"write",{set:()=>{},get:()=>(o,a,c)=>{if(!this.g){n+=o.toString(a);const l=n.length>vX?n.length:n.lastIndexOf(`
`);l!==-1&&(console[i](n.slice(0,l)),n=n.slice(l+1))}s.call(r,o,a,c)}})}};_S=__decorate([__param(0,Ce),__param(1,Ft)],_S);import{promises as Ha}from"fs";async function wX(e,t,i,r,s,n){let o;try{await bX(e,t,i,r,s,n)}catch(a){o=a}finally{o&&s.errorTransformer&&(o=s.errorTransformer(o)),typeof o<"u"&&i.error(o),i.end()}}async function bX(e,t,i,r,s,n){VS(n);const o=await e.open(t,{create:!1});try{VS(n);let a=0,c=0,l=s&&typeof s.length=="number"?s.length:void 0,u=W.alloc(Math.min(s.bufferSize,typeof l=="number"?l:s.bufferSize)),h=s&&typeof s.position=="number"?s.position:0,f=0;do c=await e.read(o,h,u.buffer,f,u.byteLength-f),h+=c,f+=c,a+=c,typeof l=="number"&&(l-=c),f===u.byteLength&&(await i.write(r(u)),u=W.alloc(Math.min(s.bufferSize,typeof l=="number"?l:s.bufferSize)),f=0);while(c>0&&(typeof l!="number"||l>0)&&VS(n)&&yX(a,s));if(f>0){let p=f;typeof l=="number"&&(p=Math.min(f,l)),i.write(r(u.slice(0,p)))}}catch(a){throw gz(a)}finally{await e.close(o)}}function VS(e){if(e.isCancellationRequested)throw Yl();return!0}function yX(e,t){if(typeof t?.limits?.size=="number"&&e>t.limits.size)throw en(d(2118,null),he.FileTooLarge);return!0}var AX=class extends Q{constructor(e,t){super(),this.a=e,this.b=t,this.c=this.D(new I),this.onDidChangeFile=this.c.event,this.g=this.D(new I),this.onDidWatchError=this.g.event,this.m=[],this.n=this.D(new au(this.h(this.m.length))),this.y=[],this.z=this.D(new au(this.h(this.y.length)))}watch(e,t){return t.recursive||this.b?.watcher?.forceUniversal?this.q(e,t):this.C(e,t)}h(e){return e>200?500:0}q(e,t){const i=this.r(e,t),r=_5(this.m,i);return this.s(),te(()=>{r(),this.s()})}r(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:t.recursive,filter:t.filter,correlationId:t.correlationId};if(oJ(i)){const r=this.b?.watcher?.recursive?.usePolling;r===!0?i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3:Array.isArray(r)&&r.includes(i.path)&&(i.pollingInterval=this.b?.watcher?.recursive?.pollingInterval??5e3)}return i}s(){this.n.trigger(()=>this.t(),this.h(this.m.length)).catch(e=>lt(e))}t(){return this.j||(this.j=this.D(this.u(e=>this.c.fire(jP(e)),e=>this.I(e),this.a.getLevel()===Y.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.j?.setVerboseLogging(this.a.getLevel()===Y.Trace)}))),this.j.watch(this.m)}C(e,t){const i={path:this.M(e),excludes:t.excludes,includes:t.includes,recursive:!1,filter:t.filter,correlationId:t.correlationId},r=_5(this.y,i);return this.F(),te(()=>{r(),this.F()})}F(){this.z.trigger(()=>this.G(),this.h(this.y.length)).catch(e=>lt(e))}G(){return this.w||(this.w=this.D(this.H(e=>this.c.fire(jP(e)),e=>this.I(e),this.a.getLevel()===Y.Trace)),this.D(this.a.onDidChangeLogLevel(()=>{this.w?.setVerboseLogging(this.a.getLevel()===Y.Trace)}))),this.w.watch(this.y)}I(e){e.type==="error"&&this.g.fire(e.message),this.J(e)}J(e){this.a[e.type](e.message)}L(e){return Zs(e.fsPath)}M(e){const t=this.L(e);return A2(t)}};import{fork as SX}from"child_process";function EX(e){const t=e;return t&&typeof t.type=="string"&&typeof t.severity=="string"}function xX(e){const t=[];let i;try{const r=JSON.parse(e.arguments),s=r[r.length-1];s&&s.__$stack&&(r.pop(),i=s.__$stack),t.push(...r)}catch{t.push("Unable to log remote console arguments",e.arguments)}return{args:t,stack:i}}function kX(e){if(!e)return e;const t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function CX(e,t){const{args:i,stack:r}=xX(e),s=typeof i[0]=="string"&&i.length===1;let n=kX(r);n&&(n=`(${n.trim()})`);let o=[];if(typeof i[0]=="string"?n&&s?o=[`%c[${t}] %c${i[0]} %c${n}`,Fl("blue"),Fl(""),Fl("grey")]:o=[`%c[${t}] %c${i[0]}`,Fl("blue"),Fl(""),...i.slice(1)]:o=[`%c[${t}]%`,Fl("blue"),...i],n&&!s&&o.push(n),typeof console[e.severity]!="function")throw new Error("Unknown console method");console[e.severity].apply(console,o)}function Fl(e){return`color: ${e}`}var $X=class{constructor(e,t){this.i=e,this.j=t,this.c=new Set,this.g=new Map,this.h=new I,this.onDidProcessExit=this.h.event;const i=t.timeout||6e4;this.b=new ax(i),this.d=null,this.f=null}getChannel(e){const t=this;return{call(i,r,s){return t.k(e,i,r,s)},listen(i,r){return t.l(e,i,r)}}}k(e,t,i,r=Fe.None){if(!this.b)return Promise.reject(new Error("disposed"));if(r.isCancellationRequested)return Promise.reject(Yl());this.b.cancel();const s=this.n(e),n=Js(c=>s.call(t,i,c)),o=r.onCancellationRequested(()=>n.cancel()),a=te(()=>n.cancel());return this.c.add(a),n.finally(()=>{o.dispose(),this.c.delete(a),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}),n}l(e,t,i){if(!this.b)return Ie.None;this.b.cancel();let r;const s=new I({onWillAddFirstListener:()=>{r=this.n(e).listen(t,i)(s.fire,s),this.c.add(r)},onDidRemoveLastListener:()=>{this.c.delete(r),r.dispose(),this.c.size===0&&this.b&&this.b.trigger(()=>this.o())}});return s.event}get m(){if(!this.f){const e=this.j.args||[],t=Object.create(null);t.env={...ot(process.env),VSCODE_PARENT_PID:String(process.pid)},this.j.env&&(t.env={...t.env,...this.j.env}),this.j.freshExecArgv&&(t.execArgv=[]),typeof this.j.debug=="number"&&(t.execArgv=["--nolazy","--inspect="+this.j.debug]),typeof this.j.debugBrk=="number"&&(t.execArgv=["--nolazy","--inspect-brk="+this.j.debugBrk]),t.execArgv===void 0&&(t.execArgv=process.execArgv.filter(u=>!/^--inspect(-brk)?=/.test(u)).filter(u=>!u.startsWith("--vscode-"))),Qq(t.env),this.d=SX(this.i,e,t);const i=new I,s=Ie.fromNodeEventEmitter(this.d,"message",u=>u)(u=>{if(EX(u)){CX(u,`IPC Library: ${this.j.serverName}`);return}i.fire(W.wrap(Buffer.from(u,"base64")))}),n=this.j.useQueue?Yq(this.d):this.d,o=u=>this.d?.connected&&n.send(u.buffer.toString("base64")),a=i.event,c={send:o,onMessage:a};this.f=new Hx(c);const l=()=>this.o();process.once("exit",l),this.d.on("error",u=>console.warn('IPC "'+this.j.serverName+'" errored with '+u)),this.d.on("exit",(u,h)=>{process.removeListener("exit",l),s.dispose(),this.c.forEach(f=>Zi(f)),this.c.clear(),u!==0&&h!=="SIGTERM"&&console.warn('IPC "'+this.j.serverName+'" crashed with exit code '+u+" and signal "+h),this.b?.cancel(),this.o(),this.h.fire({code:u,signal:h})})}return this.f}n(e){let t=this.g.get(e);return t||(t=this.m.getChannel(e),this.g.set(e,t)),t}o(){this.f&&(this.d&&(this.d.kill(),this.d=null),this.f=null,this.g.clear())}dispose(){this.h.dispose(),this.b?.cancel(),this.b=void 0,this.o(),this.c.clear()}},IX=class extends cJ{constructor(e,t,i){super(e,t,i),this.r()}q(e){const t=e.add(new $X(af.asFileUri("bootstrap-fork").fsPath,{serverName:"File Watcher",args:["--type=fileWatcher"],env:{VSCODE_ESM_ENTRYPOINT:"vs/platform/files/node/watcher/watcherMain",VSCODE_PIPE_LOGGING:"true",VSCODE_VERBOSE_LOGGING:"true"}}));return e.add(t.onDidProcessExit(({code:i,signal:r})=>this.s(`terminated by itself with code ${i}, signal: ${r} (ETERM)`))),t0.toService(GO(t.getChannel("watcher")))}};import{watchFile as DX,unwatchFile as PX}from"fs";var TX=class extends Q{constructor(){super(),this.a=this.D(new I),this.onDidChangeFile=this.a.event,this.b=this.D(new I),this.onDidLogMessage=this.b.event,this.c=this.D(new I),this.f=this.c.event,this.g=new Map,this.h=new Map,this.j=this.D(new Mo),this.m=new Set,this.n=this.D(new au(this.w())),this.q=5007,this.r=new Ni,this.R=!1,this.D(this.f(e=>this.y({id:this.t(e),correlationId:this.s(e)?e.correlationId:void 0,path:e.path})))}s(e){return FP(e)}t(e){return this.s(e)?e.correlationId:Xs(e)}async watch(e){this.r.isSettled||this.r.complete(),this.r=new Ni;try{this.g.clear(),this.h.clear();for(const t of e)this.s(t)?this.g.set(t.correlationId,t):this.h.set(this.t(t),t);for(const[t]of this.j)!this.h.has(t)&&!this.g.has(t)&&(this.j.deleteAndDispose(t),this.m.delete(t));return await this.u(!1)}finally{this.r.complete()}}u(e){const t=[];for(const[i,r]of[...this.h,...this.g])this.j.has(i)||t.push(r);return this.n.trigger(()=>this.N(t),e?this.w():0).catch(i=>lt(i))}w(){return 800}isSuspended(e){const t=this.t(e);return this.m.has(t)?"polling":this.j.has(t)}async y(e){if(this.j.has(e.id))return;const t=new ie;this.j.set(e.id,t),await this.r.p,!t.isDisposed&&(this.C(e,t),this.u(!0))}z(e){this.j.deleteAndDispose(e.id),this.m.delete(e.id),this.u(!1)}C(e,t){this.F(e,t)?(this.P(`reusing an existing recursive watcher to monitor ${e.path}`),this.m.delete(e.id)):(this.G(e,t),this.m.add(e.id))}F(e,t){const i=this.O?.subscribe(e.path,(r,s)=>{t.isDisposed||(r?this.C(e,t):s?.type===1&&this.H(e))});return i?(t.add(i),!0):!1}G(e,t){let i=!1;const r=(s,n)=>{if(t.isDisposed)return;const o=this.I(s),a=this.I(n),c=i;i=o,!o&&(a||c)&&this.H(e)};this.P(`starting fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{DX(e.path,{persistent:!1,interval:this.q},r)}catch(s){this.Q(`fs.watchFile() failed with error ${s} on path ${e.path} (correlationId: ${e.correlationId})`)}t.add(te(()=>{this.P(`stopping fs.watchFile() on ${e.path} (correlationId: ${e.correlationId})`);try{PX(e.path,r)}catch(s){this.Q(`fs.unwatchFile() failed with error ${s} on path ${e.path} (correlationId: ${e.correlationId})`)}}))}H(e){this.P(`detected ${e.path} exists again, resuming watcher (correlationId: ${e.correlationId})`);const t={resource:y.file(e.path),type:1,cId:e.correlationId};this.a.fire([t]),this.J(t,e),this.z(e)}I(e){return e.ctimeMs===0&&e.ino===0}async stop(){this.j.clearAndDisposeAll(),this.m.clear()}J(e,t){if(this.R){const i=` >> normalized ${e.type===1?"[ADDED]":e.type===2?"[DELETED]":"[CHANGED]"} ${e.resource.fsPath}`;this.L(i,t)}}L(e,t){this.R&&this.P(`${e}${typeof t.correlationId=="number"?` <${t.correlationId}> `:""}`)}M(e){return`${e.path} (excludes: ${e.excludes.length>0?e.excludes:"<none>"}, includes: ${e.includes&&e.includes.length>0?JSON.stringify(e.includes):"<all>"}, filter: ${dJ(e.filter)}, correlationId: ${typeof e.correlationId=="number"?e.correlationId:"<none>"})`}async setVerboseLogging(e){this.R=e}};import{watch as MX,promises as NX}from"fs";var RX=class sv extends Q{static{this.a=100}static{this.b=75}get isReusingRecursiveWatcher(){return this.q}get failed(){return this.r}constructor(t,i,r,s,n,o){super(),this.s=t,this.t=i,this.u=r,this.w=s,this.y=n,this.z=o,this.c=this.D(new dx({maxWorkChunkSize:100,throttleDelay:200,maxBufferedWork:1e4},c=>this.u(c))),this.f=this.D(new Y2(c=>this.M(c),sv.b)),this.m=new Qe,this.n=new Pt(async()=>{let c=this.s.path;try{c=await nt.realpath(this.s.path),this.s.path!==c&&this.Q(`correcting a path to watch that seems to be a symbolic link (original: ${this.s.path}, real: ${c})`)}catch{}return c}),this.q=!1,this.r=!1;const a=!$t;this.g=HP(this.s.path,this.s.excludes,a),this.h=this.s.includes?HP(this.s.path,this.s.includes,a):void 0,this.j=FP(this.s)?this.s.filter:void 0,this.ready=this.C()}async C(){try{const t=await NX.stat(this.s.path);if(this.m.token.isCancellationRequested)return;this.D(await this.G(t.isDirectory()))}catch(t){t.code!=="ENOENT"?this.O(t):this.Q(`ignoring a path for watching who's stat info failed to resolve: ${this.s.path} (error: ${t})`),this.F()}}F(){this.r=!0,this.w?.()}async G(t){const i=new ie;return this.H(t,i)?(this.Q(`reusing an existing recursive watcher for ${this.s.path}`),this.q=!0):(this.q=!1,await this.I(t,i)),i}H(t,i){if(t)return!1;const r=y.file(this.s.path),s=this.t?.subscribe(this.s.path,async(n,o)=>{i.isDisposed||(n?await aL(this.G(t),i):o&&(typeof o.cId=="number"||typeof this.s.correlationId=="number")&&this.L({resource:r,type:o.type,cId:this.s.correlationId},!0))});return s?(i.add(s),!0):!1}async I(t,i){const r=await this.n.value;if(this.m.token.isCancellationRequested)return;if(Dt&&zo(r,"/Volumes/",!0)){this.O(`Refusing to watch ${r} for changes using fs.watch() for possibly being a network share where watching is unreliable and unstable.`);return}const s=new Qe(this.m.token);i.add(te(()=>s.dispose(!0)));const n=new ie;i.add(n);try{const o=y.file(this.s.path),a=At(r),c=MX(r);n.add(te(()=>{c.removeAllListeners(),c.close()})),this.Q(`Started watching: '${r}'`);const l=new Set;if(t)try{for(const h of await nt.readdir(r))l.add(h)}catch(h){this.O(h)}if(s.token.isCancellationRequested)return;const u=new Map;n.add(te(()=>{for(const[,h]of u)h.dispose();u.clear()})),c.on("error",(h,f)=>{s.token.isCancellationRequested||(this.O(`Failed to watch ${r} for changes using fs.watch() (${h}, ${f})`),this.F())}),c.on("change",(h,f)=>{if(s.token.isCancellationRequested)return;this.z&&this.R(`[raw] ["${h}"] ${f}`);let p="";if(f&&(p=f.toString(),Dt&&(p=pf(p))),!(!p||h!=="change"&&h!=="rename"))if(t)if(h==="rename"){u.get(p)?.dispose();const g=setTimeout(async()=>{if(u.delete(p),rf(p,a,!$t)&&!await nt.exists(r)){this.J(o);return}if(s.token.isCancellationRequested)return;const v=await this.N(_e(r,p));if(s.token.isCancellationRequested)return;let b;v?l.has(p)?b=0:(b=1,l.add(p)):(l.delete(p),b=2),this.L({resource:It(o,p),type:b,cId:this.s.correlationId})},sv.a);u.set(p,te(()=>clearTimeout(g)))}else{let g;l.has(p)?g=0:(g=1,l.add(p)),this.L({resource:It(o,p),type:g,cId:this.s.correlationId})}else if(h==="rename"||!rf(p,a,!$t)){const g=setTimeout(async()=>{const v=await nt.exists(r);s.token.isCancellationRequested||(v?(this.L({resource:o,type:0,cId:this.s.correlationId},!0),n.add(await this.G(!1))):this.J(o))},sv.a);n.clear(),n.add(te(()=>clearTimeout(g)))}else this.L({resource:o,type:0,cId:this.s.correlationId},!0)})}catch(o){if(s.token.isCancellationRequested)return;this.O(`Failed to watch ${r} for changes using fs.watch() (${o.toString()})`),this.F()}}J(t){this.P("Watcher shutdown because watched path got deleted"),this.L({resource:t,type:2,cId:this.s.correlationId},!0),this.f.flush(),this.F()}L(t,i=!1){this.m.token.isCancellationRequested||(this.z&&this.R(`${t.type===1?"[ADDED]":t.type===2?"[DELETED]":"[CHANGED]"} ${t.resource.fsPath}`),!i&&this.g.some(r=>r(t.resource.fsPath))?this.z&&this.R(` >> ignored (excluded) ${t.resource.fsPath}`):!i&&this.h&&this.h.length>0&&!this.h.some(r=>r(t.resource.fsPath))?this.z&&this.R(` >> ignored (not included) ${t.resource.fsPath}`):this.f.work(t))}M(t){const i=lJ(t),r=[];for(const n of i){if(hJ(n,this.j)){this.z&&this.R(` >> ignored (filtered) ${n.resource.fsPath}`);continue}r.push(n)}if(r.length===0)return;if(this.z)for(const n of r)this.R(` >> normalized ${n.type===1?"[ADDED]":n.type===2?"[DELETED]":"[CHANGED]"} ${n.resource.fsPath}`);this.c.work(r)?this.c.pending>0&&this.Q(`started throttling events due to large amount of file change events at once (pending: ${this.c.pending}, most recent change: ${r[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`):this.P(`started ignoring events due to too many file change events at once (incoming: ${r.length}, most recent change: ${r[0].resource.fsPath}). Use 'files.watcherExclude' setting to exclude folders with lots of changing files (e.g. compilation output).`)}async N(t){if($t)return nt.exists(t);try{const i=At(t);return(await nt.readdir(Mi(t))).some(s=>s===i)}catch(i){return this.Q(i),!1}}setVerboseLogging(t){this.z=t}O(t){this.m.token.isCancellationRequested||this.y?.({type:"error",message:`[File Watcher (node.js)] ${t}`})}P(t){this.m.token.isCancellationRequested||this.y?.({type:"warn",message:`[File Watcher (node.js)] ${t}`})}Q(t){!this.m.token.isCancellationRequested&&this.z&&this.y?.({type:"trace",message:`[File Watcher (node.js)] ${t}`})}R(t){!this.m.token.isCancellationRequested&&this.z&&this.Q(`${t}${typeof this.s.correlationId=="number"?` <${this.s.correlationId}> `:""}`)}dispose(){this.m.dispose(!0),super.dispose()}},LX=class extends TX{get watchers(){return this.S.values()}constructor(e){super(),this.O=e,this.onDidError=Ie.None,this.S=new Map,this.U=this.D(new Br)}async N(e){e=this.cb(e);const t=[],i=new Set(Array.from(this.watchers));for(const r of e){const s=this.S.get(this.Z(r));s&&jI(s.request.excludes,r.excludes)&&jI(s.request.includes,r.includes)?i.delete(s):t.push(r)}t.length&&this.P(`Request to start watching: ${t.map(r=>this.M(r)).join(",")}`),i.size&&this.P(`Request to stop watching: ${Array.from(i).map(r=>this.M(r.request)).join(",")}`),this.U.clear();for(const r of i)this.bb(r);this.Y().work(t)}Y(){return this.U.value=new dx({maxWorkChunkSize:100,throttleDelay:100,maxBufferedWork:Number.MAX_VALUE},e=>{for(const t of e)this.ab(t)}),this.U.value}Z(e){return typeof e.correlationId=="number"?e.correlationId:this.$(e.path)}$(e){return $t?e:e.toLowerCase()}ab(e){const t=new RX(e,this.O,r=>this.a.fire(r),()=>this.c.fire(e),r=>this.b.fire(r),this.R),i={request:e,instance:t};this.S.set(this.Z(e),i)}async stop(){await super.stop();for(const e of this.watchers)this.bb(e)}bb(e){this.P("stopping file watcher",e),this.S.delete(this.Z(e.request)),e.instance.dispose()}cb(e){const t=new Map;for(const i of e){let r=t.get(i.correlationId);r||(r=new Map,t.set(i.correlationId,r));const s=this.$(i.path);r.has(s)&&this.P(`ignoring a request for watching who's path is already watched: ${this.M(i)}`),r.set(s,i)}return Array.from(t.values()).flatMap(i=>Array.from(i.values()))}async setVerboseLogging(e){super.setVerboseLogging(e);for(const t of this.watchers)t.instance.setVerboseLogging(e)}P(e,t){this.R&&this.b.fire({type:"trace",message:this.fb(e,t)})}Q(e){this.b.fire({type:"warn",message:this.fb(e)})}fb(e,t){return t?`[File Watcher (node.js)] ${e} (${this.M(t.request)})`:`[File Watcher (node.js)] ${e}`}},OX=class extends aJ{constructor(e,t,i){super(e,t,i),this.r()}q(e){return e.add(new LX(void 0))}},FX=class Fd extends AX{constructor(){super(...arguments),this.onDidChangeCapabilities=Ie.None,this.R=new zt(t=>jv.getComparisonKey(t)),this.Z=new Map,this.$=new Map,this.ab=new Map}static{this.N=!1}get capabilities(){return this.O||(this.O=516126,$t&&(this.O|=1024)),this.O}async stat(t){try{const{stat:i,symbolicLink:r}=await Ri.stat(this.L(t));return{type:this.Q(i,r),ctime:i.birthtime.getTime(),mtime:i.mtime.getTime(),size:i.size,permissions:(i.mode&128)===0?Zn.Locked:void 0}}catch(i){throw this.jb(i)}}async P(t){try{return await this.stat(t)}catch{return}}async realpath(t){const i=this.L(t);return nt.realpath(i)}async readdir(t){try{const i=await nt.readdir(this.L(t),{withFileTypes:!0}),r=[];return await Promise.all(i.map(async s=>{try{let n;s.isSymbolicLink()?n=(await this.stat(It(t,s.name))).type:n=this.Q(s),r.push([s.name,n])}catch(n){this.a.trace(n)}})),r}catch(i){throw this.jb(i)}}Q(t,i){let r;return i?.dangling?r=tr.Unknown:t.isFile()?r=tr.File:t.isDirectory()?r=tr.Directory:r=tr.Unknown,i&&(r|=tr.SymbolicLink),r}async S(t){const i=this.L(t);this.U(`[Disk FileSystemProvider]: createResourceLock() - request to acquire resource lock (${i})`);let r;for(;r=this.R.get(t);)this.U(`[Disk FileSystemProvider]: createResourceLock() - waiting for resource lock to be released (${i})`),await r.wait();const s=new fr;return this.R.set(t,s),this.U(`[Disk FileSystemProvider]: createResourceLock() - new resource lock created (${i})`),te(()=>{this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock dispose() (${i})`),this.R.get(t)===s&&(this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock removed from resource-lock map (${i})`),this.R.delete(t)),this.U(`[Disk FileSystemProvider]: createResourceLock() - resource lock barrier open() (${i})`),s.open()})}async readFile(t,i){let r;try{i?.atomic&&(this.U(`[Disk FileSystemProvider]: atomic read operation started (${this.L(t)})`),r=await this.S(t));const s=this.L(t);return await Ha.readFile(s)}catch(s){throw this.jb(s)}finally{r?.dispose()}}U(t){Fd.N&&this.a.trace(t)}readFileStream(t,i,r){const s=uf(n=>W.concat(n.map(o=>W.wrap(o))).buffer);return wX(this,t,s,n=>n.buffer,{...i,bufferSize:256*1024},r),s}async writeFile(t,i,r){return r?.atomic!==!1&&r?.atomic?.postfix&&await this.W(t)?this.X(t,It(ou(t),`${dr(t)}${r.atomic.postfix}`),i,r):this.Y(t,i,r)}async W(t){try{const i=this.L(t),{symbolicLink:r}=await Ri.stat(i);if(r)return!1}catch{}return!0}async X(t,i,r,s){const n=new ie;try{n.add(await this.S(t)),n.add(await this.S(i)),await this.Y(i,r,s,!0);try{await this.rename(i,t,{overwrite:!0})}catch(o){try{await this.delete(i,{recursive:!1,useTrash:!1,atomic:!1})}catch{}throw o}}finally{n.dispose()}}async Y(t,i,r,s){let n;try{const o=this.L(t);if(!r.create||!r.overwrite){if(await nt.exists(o)){if(!r.overwrite)throw en(d(2121,null),he.FileExists)}else if(!r.create)throw en(d(2122,null),he.FileNotFound)}n=await this.open(t,{create:!0,unlock:r.unlock},s),await this.write(n,0,i,0,i.byteLength)}catch(o){throw await this.kb(t,o)}finally{typeof n=="number"&&await this.close(n)}}static{this.bb=!0}static configureFlushOnWrite(t){Fd.bb=t}async open(t,i,r){const s=this.L(t);let n;bc(i)&&!r&&(n=await this.S(t));let o;try{if(bc(i)&&i.unlock)try{const{stat:a}=await Ri.stat(s);a.mode&128||await Ha.chmod(s,a.mode|128)}catch(a){a.code!=="ENOENT"&&this.a.trace(a)}if(ze&&bc(i))try{o=await nt.open(s,"r+"),await nt.ftruncate(o,0)}catch(a){if(a.code!=="ENOENT"&&this.a.trace(a),typeof o=="number"){try{await nt.close(o)}catch(c){this.a.trace(c)}o=void 0}}typeof o!="number"&&(o=await nt.open(s,bc(i)?"w":"r"))}catch(a){throw n?.dispose(),bc(i)?await this.kb(t,a):this.jb(a)}if(this.Z.set(o,0),bc(i)&&this.ab.set(o,t),n){const a=this.$.get(o);this.U(`[Disk FileSystemProvider]: open() - storing lock for handle ${o} (${s})`),this.$.set(o,n),a&&(this.U(`[Disk FileSystemProvider]: open() - disposing a previous lock that was still stored on same handle ${o} (${s})`),a.dispose())}return o}async close(t){const i=this.$.get(t);try{if(this.Z.delete(t),this.ab.delete(t)&&Fd.bb)try{await nt.fdatasync(t)}catch(r){Fd.configureFlushOnWrite(!1),this.a.error(r)}return await nt.close(t)}catch(r){throw this.jb(r)}finally{i&&(this.$.get(t)===i&&(this.U(`[Disk FileSystemProvider]: close() - resource lock removed from handle-lock map ${t}`),this.$.delete(t)),this.U(`[Disk FileSystemProvider]: close() - disposing lock for handle ${t}`),i.dispose())}}async read(t,i,r,s,n){const o=this.cb(t,i);let a=null;try{a=(await nt.read(t,r,s,n,o)).bytesRead}catch(c){throw this.jb(c)}finally{this.db(t,o,a)}return a}cb(t,i){return i===this.Z.get(t)?null:i}db(t,i,r){const s=this.Z.get(t);typeof s=="number"&&(typeof i=="number"||(typeof r=="number"?this.Z.set(t,s+r):this.Z.delete(t)))}async write(t,i,r,s,n){return eO(()=>this.eb(t,i,r,s,n),100,3)}async eb(t,i,r,s,n){const o=this.cb(t,i);let a=null;try{a=(await nt.write(t,r,s,n,o)).bytesWritten}catch(c){throw await this.kb(this.ab.get(t),c)}finally{this.db(t,o,a)}return a}async mkdir(t){try{await Ha.mkdir(this.L(t))}catch(i){throw this.jb(i)}}async delete(t,i){try{const r=this.L(t);if(i.recursive){let s;i?.atomic!==!1&&i.atomic.postfix&&(s=_e(Mi(r),`${At(r)}${i.atomic.postfix}`)),await nt.rm(r,Wo.MOVE,s)}else try{await Ha.unlink(r)}catch(s){if(s.code==="EPERM"||s.code==="EISDIR"){let n=!1;try{const{stat:o,symbolicLink:a}=await Ri.stat(r);n=o.isDirectory()&&!a}catch{}if(n)await Ha.rmdir(r);else throw s}else throw s}}catch(r){throw this.jb(r)}}async rename(t,i,r){const s=this.L(t),n=this.L(i);if(s!==n)try{await this.fb(t,i,"move",r.overwrite),await nt.rename(s,n)}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2123,null,At(s),At(Mi(n)),o.toString()))),this.jb(o)}}async copy(t,i,r){const s=this.L(t),n=this.L(i);if(s!==n)try{await this.fb(t,i,"copy",r.overwrite),await nt.copy(s,n,{preserveSymlinks:!0})}catch(o){throw(o.code==="EINVAL"||o.code==="EBUSY"||o.code==="ENAMETOOLONG")&&(o=new Error(d(2124,null,At(s),At(Mi(n)),o.toString()))),this.jb(o)}}async fb(t,i,r,s){const n=this.L(t),o=this.L(i);let a=!1;if(!!(this.capabilities&1024)||(a=rf(n,o,!0)),a){if(r==="copy")throw en(d(2125,null),he.FileExists);if(r==="move")return}const l=await this.P(t);if(!l)throw en(d(2126,null),he.FileNotFound);const u=await this.P(i);if(u){if(!s)throw en(d(2127,null),he.FileExists);(l.type&tr.File)!==0&&(u.type&tr.File)!==0||await this.delete(i,{recursive:!0,useTrash:!1,atomic:!1})}}async cloneFile(t,i){return this.gb(t,i,!1)}async gb(t,i,r){const s=this.L(t),n=this.L(i),o=!!(this.capabilities&1024);if(rf(s,n,!o))return;const a=new ie;try{a.add(await this.S(t)),a.add(await this.S(i)),r&&await Ha.mkdir(Mi(n),{recursive:!0}),await Ha.copyFile(s,n)}catch(c){if(c.code==="ENOENT"&&!r)return this.gb(t,i,!0);throw this.jb(c)}finally{a.dispose()}}u(t,i,r){return new IX(s=>t(s),s=>i(s),r)}H(t,i,r){return new OX(s=>t(s),s=>i(s),r)}jb(t){if(t instanceof Lf)return t;let i=t,r;switch(t.code){case"ENOENT":r=he.FileNotFound;break;case"EISDIR":r=he.FileIsADirectory;break;case"ENOTDIR":r=he.FileNotADirectory;break;case"EEXIST":r=he.FileExists;break;case"EPERM":case"EACCES":r=he.NoPermissions;break;case"ERR_UNC_HOST_NOT_ALLOWED":i=`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`,r=he.Unknown;break;default:r=he.Unknown}return en(i,r)}async kb(t,i){let r=this.jb(i);if(t&&r.code===he.NoPermissions)try{const{stat:s}=await Ri.stat(this.L(t));s.mode&128||(r=en(i,he.FileWriteLocked))}catch(s){this.a.trace(s)}return r}},qS=class{constructor(t,i){t.addFileSystemProvider(q.file,new UX(i),{isCaseSensitive:$t})}};qS=__decorate([__param(0,Uh),__param(1,Se)],qS);var UX=class{constructor(e){this.a=new FX(e)}async stat(e){const t=await this.a.stat(e);return{type:t.type,ctime:t.ctime,mtime:t.mtime,size:t.size,permissions:t.permissions===Zn.Readonly?1:void 0}}readDirectory(e){return this.a.readdir(e)}createDirectory(e){return this.a.mkdir(e)}readFile(e){return this.a.readFile(e)}writeFile(e,t,i){return this.a.writeFile(e,t,{...i,unlock:!1,atomic:!1})}delete(e,t){return this.a.delete(e,{...t,useTrash:!1,atomic:!1})}rename(e,t,i){return this.a.rename(e,t,i)}copy(e,t,i){return this.a.copy(e,t,i)}get onDidChangeFile(){throw new Error("Method not implemented.")}watch(e,t){throw new Error("Method not implemented.")}};import aM from"node:module";var cM=aM.createRequire(import.meta.url),jX=class extends M1{k(){const e=this,t=cM("module"),i=t._load;t._load=function(a,c,l){return a=n(a),e.a.has(a)?e.a.get(a).load(a,y.file(Tx(c.filename)),u=>i.apply(this,[u,c,l])):i.apply(this,arguments)};const r=t._resolveLookupPaths;t._resolveLookupPaths=(o,a)=>r.call(this,n(o),a);const s=t._resolveFilename;t._resolveFilename=function(a,c,l,u){return a==="vsda"&&Array.isArray(u?.paths)&&u.paths.length===0&&(u.paths=t._nodeModulePaths(import.meta.dirname)),s.call(this,a,c,l,u)};const n=o=>{for(const a of e.b){const c=a(o);if(c){o=c;break}}return o}}},zX=class Vl extends M1{constructor(){super(...arguments),this.o=new ie}static l(t){return`data:text/javascript;base64,${Buffer.from(t).toString("base64")}`}static{this.m=`
	let lookup;
	export const initialize = async (context) => {
		let requestIds = 0;
		const { port } = context;
		const pendingRequests = new Map();
		port.onmessage = (event) => {
			const { id, url } = event.data;
			pendingRequests.get(id)?.(url);
		};
		lookup = url => {
			// debugger;
			const myId = requestIds++;
			return new Promise((resolve) => {
				pendingRequests.set(myId, resolve);
				port.postMessage({ id: myId, url, });
			});
		};
	};
	export const resolve = async (specifier, context, nextResolve) => {
		if (specifier !== 'vscode' || !context.parentURL) {
			return nextResolve(specifier, context);
		}
		const otherUrl = await lookup(context.parentURL);
		return {
			url: otherUrl,
			shortCircuit: true,
		};
	};`}static{this.n="_VSCODE_IMPORT_VSCODE_API"}dispose(){this.o.dispose()}k(){const t=new QR,i=new Map;Object.defineProperty(globalThis,Vl.n,{enumerable:!1,configurable:!1,writable:!1,value:a=>t.getKey(a)});const{port1:r,port2:s}=new MessageChannel;let n;const o=r;o.onmessage=a=>{n||(n=this.a.get("vscode"),bv(n));const{id:c,url:l}=a.data,u=y.parse(l),h=n.load("_not_used",u,()=>{throw new Error("CANNOT LOAD MODULE from here.")});let f=t.get(h);f||(f=Tt(),t.set(h,f));let p=i.get(f);if(!p){const g=`const _vscodeInstance = globalThis.${Vl.n}('${f}');

${Object.keys(h).map(v=>`export const ${v} = _vscodeInstance['${v}'];`).join(`
`)}`;p=Vl.l(g),i.set(f,p)}r.postMessage({id:c,url:p})},aM.register(Vl.l(Vl.m),{parentURL:import.meta.url,data:{port:s},transferList:[s]}),this.o.add(te(()=>{r.close(),s.close()}))}},HX=class extends zA{constructor(){super(...arguments),this.extensionRuntime=Jp.Node}async wb(){this.h.createInstance(_S);const e=this.h.invokeFunction(CY);if(this.h.createInstance(HS),this.f.remote.isRemote&&this.f.remote.authority){const i=this.h.createInstance(WS);process.env.VSCODE_IPC_HOOK_CLI=i.ipcHandlePath}this.h.createInstance(qS),await this.h.createInstance(jX,e,{mine:this.J,all:this.L}).install(),await this.B.add(this.h.createInstance(zX,e,{mine:this.J,all:this.L})).install(),Ot("code/extHost/didInitAPI");const t=await this.m.getConfigProvider();await XY(this.j,t,this,this.q,this.y,this.f,this.B),Ot("code/extHost/didInitProxyResolver")}xb(e){return e.main}async Cb(e,t,i,r){if(t.scheme!==q.file)throw new Error(`Cannot load URI: '${t}', must be of file-scheme`);let s=null;i.codeLoadingStart(),this.q.trace(`ExtensionService#loadModule [${r}] -> ${t.toString(!0)}`),this.q.flush();const n=e?.identifier.value;e&&await this.u.initializeLocalizedMessages(e);try{n&&Ot(`code/extHost/willLoadExtensionCode/${n}`),r==="esm"?s=await import(t.toString(!0)):s=cM(t.fsPath)}finally{n&&Ot(`code/extHost/didLoadExtensionCode/${n}`),i.codeLoadingStop()}return s}async yb(e,t,i){return this.Cb(e,t,i,"cjs")}async zb(e,t,i){return this.Cb(e,t,i,"esm")}async $setRemoteEnvironment(e){if(this.f.remote.isRemote)for(const t in e){const i=e[t];i===null?delete process.env[t]:process.env[t]=i}}};import*as Sd from"fs";import{exec as lM}from"child_process";var WX=(e,t,i)=>{const r=new Uint8Array(16);for(let o=0;o<16;o++)r[o]=Math.round(Math.random()*256);const s=oc(W.wrap(r));return[`GET ws://localhost${e}?${t}&skipWebSocketFrames=true HTTP/1.1`,"Connection: Upgrade","Upgrade: websocket",`Sec-WebSocket-Key: ${s}`].join(`\r
`)+`\r
\r
`},uM=W.fromString(`\r
\r
`);async function BX(e,t,i,r,s){e.write(W.fromString(WX(t,i,r)));const n=new ie;try{return await new Promise((o,a)=>{let c;n.add(e.onData(l=>{c?c=W.concat([c,l],c.byteLength+l.byteLength):c=l;const u=c.indexOf(uM);if(u===-1)return;o(e),e.pauseData();const h=c.slice(u+uM.byteLength);h.byteLength&&s.onData.fire(h)})),n.add(e.onClose(l=>a(l??new Error("socket closed")))),n.add(e.onEnd(()=>a(new Error("socket ended"))))})}catch(o){throw e.dispose(),o}finally{n.dispose()}}var _X=class extends Q{constructor(e,t){super(),this.g=e,this.a=this.D(new tu),this.onData=(...i)=>(this.a.isPaused&&queueMicrotask(()=>this.a.resume()),this.a.event(...i)),this.b=this.D(new I),this.onDidDispose=this.b.event,this.f=!1,this.D(t.onData),this.D(t.onData.event(i=>this.a.fire(i))),this.onClose=this.D(t.onClose).event,this.onEnd=this.D(t.onEnd).event}pauseData(){this.a.pause()}drain(){return Promise.resolve()}end(){this.f=!0,this.h()}traceSocketEvent(e,t){vf.traceSocketEvent(this,this.g,e,t)}dispose(){this.f||this.h(),this.b.fire(),super.dispose()}},VX="signService",Ed=H(VX);import*as qX from"net";import*as GX from"os";import*as ZX from"net";var hM={1:!0,7:!0,9:!0,11:!0,13:!0,15:!0,17:!0,19:!0,20:!0,21:!0,22:!0,23:!0,25:!0,37:!0,42:!0,43:!0,53:!0,69:!0,77:!0,79:!0,87:!0,95:!0,101:!0,102:!0,103:!0,104:!0,109:!0,110:!0,111:!0,113:!0,115:!0,117:!0,119:!0,123:!0,135:!0,137:!0,139:!0,143:!0,161:!0,179:!0,389:!0,427:!0,465:!0,512:!0,513:!0,514:!0,515:!0,526:!0,530:!0,531:!0,532:!0,540:!0,548:!0,554:!0,556:!0,563:!0,587:!0,601:!0,636:!0,989:!0,990:!0,993:!0,995:!0,1719:!0,1720:!0,1723:!0,2049:!0,3659:!0,4045:!0,5060:!0,5061:!0,6e3:!0,6566:!0,6665:!0,6666:!0,6667:!0,6668:!0,6669:!0,6697:!0,10080:!0};function JX(e,t,i,r="127.0.0.1"){let s=!1,n,o=1;const a=ZX.createServer({pauseOnConnect:!0});function c(l,u){s||(s=!0,a.removeAllListeners(),a.close(),n&&clearTimeout(n),u(l))}return new Promise(l=>{n=setTimeout(()=>{c(0,l)},i),a.on("listening",()=>{c(e,l)}),a.on("error",u=>{u&&(u.code==="EADDRINUSE"||u.code==="EACCES")&&o<t?(e++,o++,a.listen(e,r)):c(0,l)}),a.on("close",()=>{c(0,l)}),a.listen(e,r)})}var QX=30*1e3,dM;(function(e){e[e.Management=1]="Management",e[e.ExtensionHost=2]="ExtensionHost",e[e.Tunnel=3]="Tunnel"})(dM||(dM={}));function GS(e){switch(e){case 1:return"Management";case 2:return"ExtensionHost";case 3:return"Tunnel"}}function fM(e){const t=new Qe;return setTimeout(()=>t.cancel(),e),t.token}function YX(e,t){if(e.isCancellationRequested||t.isCancellationRequested)return Fe.Cancelled;const i=new Qe;return e.onCancellationRequested(()=>i.cancel()),t.onCancellationRequested(()=>i.cancel()),i.token}var ZS=class{get didTimeout(){return this.c==="timedout"}constructor(e){this.c="pending",this.d=new ie,{promise:this.promise,resolve:this.f,reject:this.g}=nx(),e.isCancellationRequested?this.h():this.d.add(e.onCancellationRequested(()=>this.h()))}registerDisposable(e){this.c==="pending"?this.d.add(e):e.dispose()}h(){this.c==="pending"&&(this.d.dispose(),this.c="timedout",this.g(this.i()))}i(){const e=new Error("Time limit reached");return e.code="ETIMEDOUT",e.syscall="connect",e}resolve(e){this.c==="pending"&&(this.d.dispose(),this.c="resolved",this.f(e))}reject(e){this.c==="pending"&&(this.d.dispose(),this.c="rejected",this.g(e))}};function XX(e,t){const i=new ZS(t);return i.registerDisposable(e.onControlMessage(r=>{const s=JSON.parse(r.toString()),n=cK(s);n?i.reject(n):i.resolve(s)})),i.promise}function KX(e,t,i,r,s,n,o,a){const c=new ZS(a),l=Ji.create(!1);return e.info(`Creating a socket (${o})...`),Ot(`code/willCreateSocket/${n}`),t.connect(i,r,s,o).then(u=>{c.didTimeout?(Ot(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) finished after ${l.elapsed()} ms, but this is too late and has timed out already.`),u?.dispose()):(Ot(`code/didCreateSocketOK/${n}`),e.info(`Creating a socket (${o}) was successful after ${l.elapsed()} ms.`),c.resolve(u))},u=>{Ot(`code/didCreateSocketError/${n}`),e.info(`Creating a socket (${o}) returned an error after ${l.elapsed()} ms.`),e.error(u),c.reject(u)}),c.promise}function JS(e,t){const i=new ZS(t);return e.then(r=>{i.didTimeout||i.resolve(r)},r=>{i.didTimeout||i.reject(r)}),i.promise}async function eK(e,t,i,r){const s=wM(e,t);e.logService.trace(`${s} 1/6. invoking socketFactory.connect().`);let n;try{n=await KX(e.logService,e.remoteSocketFactoryService,e.connectTo,YE.getServerRootPath(),`reconnectionToken=${e.reconnectionToken}&reconnection=${e.reconnectionProtocol?"true":"false"}`,GS(t),`renderer-${GS(t)}-${e.reconnectionToken}`,r)}catch(u){throw e.logService.error(`${s} socketFactory.connect() failed or timed out. Error:`),e.logService.error(u),u}e.logService.trace(`${s} 2/6. socketFactory.connect() was successful.`);let o,a;e.reconnectionProtocol?(e.reconnectionProtocol.beginAcceptReconnection(n,null),o=e.reconnectionProtocol,a=!1):(o=new r0({socket:n}),a=!0),e.logService.trace(`${s} 3/6. sending AuthRequest control message.`);const c=await JS(e.signService.createNewMessage(Tt()),r),l={type:"auth",auth:e.connectionToken||"00000000000000000000",data:c.data};o.sendControl(W.fromString(JSON.stringify(l)));try{const u=await XX(o,YX(r,fM(1e4)));if(u.type!=="sign"||typeof u.data!="string"){const g=new Error("Unexpected handshake message");throw g.code="VSCODE_CONNECTION_ERROR",g}if(e.logService.trace(`${s} 4/6. received SignRequest control message.`),!await JS(e.signService.validate(c,u.signedData),r)){const g=new Error("Refused to connect to unsupported server");throw g.code="VSCODE_CONNECTION_ERROR",g}const f=await JS(e.signService.sign(u.data),r),p={type:"connectionType",commit:e.commit,signedData:f,desiredConnectionType:t};return i&&(p.args=i),e.logService.trace(`${s} 5/6. sending ConnectionTypeRequest control message.`),o.sendControl(W.fromString(JSON.stringify(p))),{protocol:o,ownsProtocol:a}}catch(u){throw u&&u.code==="ETIMEDOUT"&&(e.logService.error(`${s} the handshake timed out. Error:`),e.logService.error(u)),u&&u.code==="VSCODE_CONNECTION_ERROR"&&(e.logService.error(`${s} received error control message when negotiating connection. Error:`),e.logService.error(u)),a&&vM(o),u}}async function tK(e,t,i){const r=Date.now(),s=wM(e,3),{protocol:n}=await eK(e,3,t,i);return e.logService.trace(`${s} 6/6. handshake finished, connection is up and running after ${dK(r)}!`),n}async function pM(e,t,i){const{connectTo:r,connectionToken:s}=await e.addressProvider.getAddress();return{commit:e.commit,quality:e.quality,connectTo:r,connectionToken:s,reconnectionToken:t,reconnectionProtocol:i,remoteSocketFactoryService:e.remoteSocketFactoryService,signService:e.signService,logService:e.logService}}async function iK(e,t,i){const r=await pM(e,Tt(),null);return await tK(r,{host:t,port:i},Fe.None)}function rK(e){return Js(t=>new Promise((i,r)=>{const s=setTimeout(i,e*1e3);t.onCancellationRequested(()=>{clearTimeout(s),i()})}))}var gM;(function(e){e[e.ConnectionLost=0]="ConnectionLost",e[e.ReconnectionWait=1]="ReconnectionWait",e[e.ReconnectionRunning=2]="ReconnectionRunning",e[e.ReconnectionPermanentFailure=3]="ReconnectionPermanentFailure",e[e.ConnectionGain=4]="ConnectionGain"})(gM||(gM={}));var sK=class{constructor(e,t){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.type=0}},nK=class{constructor(e,t,i,r){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.durationSeconds=i,this.c=r,this.type=1}skipWait(){this.c.cancel()}},oK=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=2}},mM=class{constructor(e,t,i){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.type=4}},aK=class{constructor(e,t,i,r){this.reconnectionToken=e,this.millisSinceLastIncomingData=t,this.attempt=i,this.handled=r,this.type=3}},rue=class xn extends Q{static triggerPermanentFailure(t,i,r){this._permanentFailure=!0,this.f=t,this.g=i,this.h=r,this.j.forEach(s=>s.F(this.f,this.g,this.h))}static debugTriggerReconnection(){this.j.forEach(t=>t.y())}static debugPauseSocketWriting(){this.j.forEach(t=>t.G())}static{this._permanentFailure=!1}static{this.f=0}static{this.g=0}static{this.h=!1}static{this.j=[]}get n(){return this.c||xn._permanentFailure}constructor(t,i,r,s,n){super(),this.t=t,this.u=i,this.reconnectionToken=r,this.protocol=s,this.w=n,this.m=this.D(new I),this.onDidStateChange=this.m.event,this.c=!1,this.q=!1,this.r=!1,this.s=108e5,this.m.fire(new mM(this.reconnectionToken,0,0)),this.D(s.onSocketClose(o=>{const a=xd(this.t,this.reconnectionToken,!0);o?o.type===0?(this.u.logService.info(`${a} received socket close event (hadError: ${o.hadError}).`),o.error&&this.u.logService.error(o.error)):(this.u.logService.info(`${a} received socket close event (wasClean: ${o.wasClean}, code: ${o.code}, reason: ${o.reason}).`),o.event&&this.u.logService.error(o.event)):this.u.logService.info(`${a} received socket close event.`),this.y()})),this.D(s.onSocketTimeout(o=>{const a=xd(this.t,this.reconnectionToken,!0);this.u.logService.info(`${a} received socket timeout event (unacknowledgedMsgCount: ${o.unacknowledgedMsgCount}, timeSinceOldestUnacknowledgedMsg: ${o.timeSinceOldestUnacknowledgedMsg}, timeSinceLastReceivedSomeData: ${o.timeSinceLastReceivedSomeData}).`),this.y()})),xn.j.push(this),this.D(te(()=>{const o=xn.j.indexOf(this);o>=0&&xn.j.splice(o,1)})),this.n&&this.F(xn.f,xn.g,xn.h)}updateGraceTime(t){const i=lK(t,108e5),r=xd(this.t,this.reconnectionToken,!1);this.u.logService.trace(`${r} Applying reconnection grace time: ${i}ms (${Math.floor(i/1e3)}s)`),this.s=i}dispose(){super.dispose(),this.r=!0}async y(){if(!this.q)try{this.q=!0,await this.z()}finally{this.q=!1}}async z(){if(this.n||this.r)return;const t=xd(this.t,this.reconnectionToken,!0);this.u.logService.info(`${t} starting reconnecting loop. You can get more information with the trace log level.`),this.m.fire(new sK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData()));const i=[0,5,5,10,10,10,10,10,30],r=this.s;if(this.u.logService.info(`${t} starting reconnection with grace time: ${r}ms (${Math.floor(r/1e3)}s)`),r<=0){this.u.logService.error(`${t} reconnection grace time is set to 0ms, will not attempt to reconnect.`),this.C(this.protocol.getMillisSinceLastIncomingData(),0,!1);return}const s=Date.now();let n=-1;do{n++;const o=n<i.length?i[n]:i[i.length-1];try{if(o>0){const c=rK(o);this.m.fire(new nK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),o,c)),this.u.logService.info(`${t} waiting for ${o} seconds before reconnecting...`);try{await c}catch{}}if(this.n){this.u.logService.error(`${t} permanent failure occurred while running the reconnecting loop.`);break}this.m.fire(new oK(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1)),this.u.logService.info(`${t} resolving connection...`);const a=await pM(this.u,this.reconnectionToken,this.protocol);this.u.logService.info(`${t} connecting to ${a.connectTo}...`),await this.H(a,fM(QX)),this.u.logService.info(`${t} reconnected!`),this.m.fire(new mM(this.reconnectionToken,this.protocol.getMillisSinceLastIncomingData(),n+1));break}catch(a){if(a.code==="VSCODE_CONNECTION_ERROR"){this.u.logService.error(`${t} A permanent error occurred in the reconnecting loop! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(Date.now()-s>=r){const c=Math.round(r/1e3);this.u.logService.error(`${t} An error occurred while reconnecting, but it will be treated as a permanent error because the reconnection grace time (${c}s) has expired! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}if(Iw.isTemporarilyNotAvailable(a)){this.u.logService.info(`${t} A temporarily not available error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if((a.code==="ETIMEDOUT"||a.code==="ENETUNREACH"||a.code==="ECONNREFUSED"||a.code==="ECONNRESET")&&a.syscall==="connect"){this.u.logService.info(`${t} A network error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(Ti(a)){this.u.logService.info(`${t} A promise cancelation error occurred while trying to reconnect, will try again...`),this.u.logService.trace(a);continue}if(a instanceof Iw){this.u.logService.error(`${t} A RemoteAuthorityResolverError occurred while trying to reconnect. Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,Iw.isHandled(a));break}this.u.logService.error(`${t} An unknown error occurred while trying to reconnect, since this is an unknown case, it will be treated as a permanent error! Will give up now! Error:`),this.u.logService.error(a),this.C(this.protocol.getMillisSinceLastIncomingData(),n+1,!1);break}}while(!this.n&&!this.r)}C(t,i,r){this.w?xn.triggerPermanentFailure(t,i,r):this.F(t,i,r)}F(t,i,r){this.m.fire(new aK(this.reconnectionToken,t,i,r)),vM(this.protocol)}G(){this.protocol.pauseSocketWriting()}};function vM(e){try{e.acceptDisconnect();const t=e.getSocket();e.dispose(),t.dispose()}catch(t){lt(t)}}function cK(e){if(e&&e.type==="error"){const t=new Error(`Connection error: ${e.reason}`);return t.code="VSCODE_CONNECTION_ERROR",t}return null}function lK(e,t){return typeof e!="number"||!isFinite(e)||e<0?t:e>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:Math.floor(e)}function uK(e,t){for(;e.length<t;)e+=" ";return e}function hK(e,t){return`[remote-connection][${uK(GS(e),13)}][${t.substr(0,5)}\u2026]`}function xd(e,t,i){return`${hK(e,t)}[${i?"reconnect":"initial"}]`}function wM(e,t){return`${xd(t,e.reconnectionToken,!!e.reconnectionProtocol)}[${e.connectTo}]`}function dK(e){return`${Date.now()-e} ms`}var QS=H("remoteSocketFactoryService");async function fK(e,t,i,r,s){let n;for(let o=3;o&&(n?.dispose(),n=await new bM(e,t,i,r,s).waitForReady(),!(s&&hM[s]||!hM[n.tunnelLocalPort]));o--);return n}var bM=class extends Q{constructor(e,t,i,r,s){super(),this.m=t,this.n=s,this.privacy=Rs.Private,this.j=new Map,this.a=e,this.b=qX.createServer(),this.c=new fr,this.f=()=>this.c.open(),this.b.on("listening",this.f),this.g=n=>this.q(n),this.b.on("connection",this.g),this.h=()=>{},this.b.on("error",this.h),this.tunnelRemotePort=r,this.tunnelRemoteHost=i}async dispose(){super.dispose(),this.b.removeListener("listening",this.f),this.b.removeListener("connection",this.g),this.b.removeListener("error",this.h),this.b.close(),Array.from(this.j.values()).forEach(t=>{t()})}async waitForReady(){const e=this.n??this.tunnelRemotePort,t=hn(this.m)?"0.0.0.0":"127.0.0.1";let i=await JX(e,2,1e3,t),r=null;return this.b.listen(i,this.m),await this.c.wait(),r=this.b.address(),r||(i=0,this.b.listen(i,this.m),await this.c.wait(),r=this.b.address()),this.tunnelLocalPort=r.port,this.localAddress=`${this.tunnelRemoteHost==="127.0.0.1"?"127.0.0.1":"localhost"}:${r.port}`,this}async q(e){e.pause();const t=Na(this.tunnelRemoteHost)||hn(this.tunnelRemoteHost)?"localhost":this.tunnelRemoteHost,i=await iK(this.a,t,this.tunnelRemotePort),r=i.getSocket(),s=i.readEntireBuffer();i.dispose(),s.byteLength>0&&e.write(s.buffer),e.on("end",()=>{e.localAddress&&this.j.delete(e.localAddress),r.end()}),e.on("close",()=>r.end()),e.on("error",()=>{e.localAddress&&this.j.delete(e.localAddress),r instanceof uu?r.socket.destroy():r.end()}),r instanceof uu?this.s(e,r):this.r(e,r),e.localAddress&&this.j.set(e.localAddress,()=>{e.end(),r.end()})}r(e,t){t.onClose(()=>e.destroy()),t.onEnd(()=>e.end()),t.onData(i=>e.write(i.buffer)),e.on("data",i=>t.write(W.wrap(i))),e.resume()}s(e,t){const i=t.socket;i.on("end",()=>e.end()),i.on("close",()=>e.end()),i.on("error",()=>{e.destroy()}),i.pipe(e),e.pipe(i)}},YS=class extends sA{constructor(t,i,r,s,n){super(i,n),this.H=t,this.I=r,this.J=s}isPortPrivileged(t){return t_(t,this.s,Lo,GX.release())}F(t,i,r,s,n,o,a,c){const l=this.C(i,r);if(l)return++l.refcount,l.value;if(KB(t))return this.G(t,i,r,n,o,a,c);{this.q.trace(`ForwardedPorts: (TunnelService) Creating tunnel without provider ${i}:${r} on local port ${n}.`);const u={commit:this.J.commit,quality:this.J.quality,addressProvider:t,remoteSocketFactoryService:this.H,signService:this.I,logService:this.q,ipcLogger:null},h=fK(u,s,i,r,n);return this.q.trace("ForwardedPorts: (TunnelService) Tunnel created without provider."),this.y(i,r,h),h}}};YS=__decorate([__param(0,QS),__param(1,Se),__param(2,Ed),__param(3,Zh),__param(4,yi)],YS);var XS=class extends YS{constructor(t,i,r,s,n){super(t,i,r,s,n)}};XS=__decorate([__param(0,QS),__param(1,Se),__param(2,Ed),__param(3,Zh),__param(4,yi)],XS);var yM=class extends Q{constructor(t,i,r,s,n){super(),this.b=t,this.c=i,this.f=r,this.g=s,this.h=n,this.a=new Map}async openTunnel(t,i,r,s,n,o,a,c,l){if(this.c.trace(`ForwardedPorts: (SharedTunnelService) openTunnel request for ${r}:${s} on local port ${o}.`),!this.a.has(t)){const u=new XS(this.b,this.c,this.g,this.f,this.h);this.D(u),this.a.set(t,u),u.onTunnelClosed(async()=>{(await u.tunnels).length===0&&(u.dispose(),this.a.delete(t))})}return this.a.get(t).openTunnel(i,r,s,n,o,a,c,l)}};yM=__decorate([__param(0,QS),__param(1,Se),__param(2,Zh),__param(3,Ed),__param(4,yi)],yM);var pK=10*1e3,F1="remote.tunnels.toRestore",KS="remote.tunnels.toRestoreExpiration",gK=1e3*60*60*24*14,AM="onTunnel",aue=new k("forwardedPortsViewEnabled",!1,d(15784,null)),mK=new k("forwardedPortsViewOnlyEnabled",!1,d(15785,null));function SM(e){const t=e.match(/^([a-zA-Z0-9_-]+(?:\.[a-zA-Z0-9_-]+)*:)?([0-9]+)$/);if(t)return{host:t[1]?.substring(0,t[1].length-1)||"localhost",port:Number(t[2])}}var kd;(function(e){e.Other="Other",e.User="User",e.AutoForwardEnd="AutoForwardEnd"})(kd||(kd={}));var yn;(function(e){e[e.User=0]="User",e[e.Auto=1]="Auto",e[e.Extension=2]="Extension"})(yn||(yn={}));var e5={source:yn.User,description:d(15786,null)},cue={source:yn.Auto,description:d(15787,null)};function EM(e,t,i){const r=e.get(or(t,i));if(r)return r;if(Na(t))for(const s of jh){const n=or(s,i);if(e.has(n))return e.get(n)}else if(hn(t))for(const s of hm){const n=or(s,i);if(e.has(n))return e.get(n)}}function Vi(e,t,i){const r=EM(e,t,i);if(r)return r;const s=hn(t)?"localhost":Na(t)?"0.0.0.0":void 0;if(s)return EM(e,s,i)}function or(e,t){return e+":"+t}var xo;(function(e){e.Notify="notify",e.OpenBrowser="openBrowser",e.OpenBrowserOnce="openBrowserOnce",e.OpenPreview="openPreview",e.Silent="silent",e.Ignore="ignore"})(xo||(xo={}));function vK(e){return e&&"host"in e&&typeof e.host=="string"&&"port"in e&&typeof e.port=="number"&&(!("detail"in e)||typeof e.detail=="string")&&(!("pid"in e)||typeof e.pid=="string")}var xM=class ps extends Q{static{this.c="remote.portsAttributes"}static{this.f="remote.otherPortsAttributes"}static{this.g=/^(\d+)\-(\d+)$/}static{this.h=/^([a-z0-9\-]+):(\d{1,5})$/}constructor(t){super(),this.q=t,this.j=[],this.n=new I,this.onDidChangeAttributes=this.n.event,this.D(t.onDidChangeConfiguration(i=>{(i.affectsConfiguration(ps.c)||i.affectsConfiguration(ps.f))&&this.r()})),this.r()}r(){this.j=this.w(),this.n.fire()}getAttributes(t,i,r){let s=this.u(t,i,r,this.j,0);const n={label:void 0,onAutoForward:void 0,elevateIfNeeded:void 0,requireLocalPort:void 0,protocol:void 0};for(;s>=0;){const o=this.j[s];o.key===t?(n.onAutoForward=o.onAutoForward??n.onAutoForward,n.elevateIfNeeded=o.elevateIfNeeded!==void 0?o.elevateIfNeeded:n.elevateIfNeeded,n.label=o.label??n.label,n.requireLocalPort=o.requireLocalPort,n.protocol=o.protocol):(n.onAutoForward=n.onAutoForward??o.onAutoForward,n.elevateIfNeeded=n.elevateIfNeeded!==void 0?n.elevateIfNeeded:o.elevateIfNeeded,n.label=n.label??o.label,n.requireLocalPort=n.requireLocalPort!==void 0?n.requireLocalPort:void 0,n.protocol=n.protocol??o.protocol),s=this.u(t,i,r,this.j,s+1)}return n.onAutoForward!==void 0||n.elevateIfNeeded!==void 0||n.label!==void 0||n.requireLocalPort!==void 0||n.protocol!==void 0?n:this.z()}s(t){return t.start!==void 0&&t.end!==void 0}t(t){return t.host!==void 0&&t.port!==void 0&&Oe(t.host)&&Er(t.port)}u(t,i,r,s,n){if(n>=s.length)return-1;const o=!Na(i)&&!hn(i),c=s.slice(n).findIndex(l=>Er(l.key)?o?!1:l.key===t:this.s(l.key)?o?!1:t>=l.key.start&&t<=l.key.end:this.t(l.key)?t===l.key.port&&i===l.key.host:r?l.key.test(r):!1);return c>=0?c+n:-1}w(){const t=this.q.getValue(ps.c);if(!t||!yt(t))return[];const i=[];for(const s in t){if(s===void 0)continue;const n=t[s];let o;if(Number(s))o=Number(s);else if(Oe(s))if(ps.g.test(s)){const a=s.match(ps.g);o={start:Number(a[1]),end:Number(a[2])}}else if(ps.h.test(s)){const a=s.match(ps.h);o={host:a[1],port:Number(a[2])}}else{let a;try{a=RegExp(s)}catch{}a&&(o=a)}o&&i.push({key:o,elevateIfNeeded:n.elevateIfNeeded,onAutoForward:n.onAutoForward,label:n.label,requireLocalPort:n.requireLocalPort,protocol:n.protocol})}const r=this.q.getValue(ps.f);return r&&(this.m={elevateIfNeeded:r.elevateIfNeeded,label:r.label,onAutoForward:r.onAutoForward,requireLocalPort:r.requireLocalPort,protocol:r.protocol}),this.y(i)}y(t){function i(r,s){return Er(r.key)?r.key:s.s(r.key)?r.key.start:s.t(r.key)?r.key.port:Number.MAX_VALUE}return t.sort((r,s)=>i(r,this)-i(s,this))}z(){return this.m}static providedActionToAction(t){switch(t){case wo.Notify:return xo.Notify;case wo.OpenBrowser:return xo.OpenBrowser;case wo.OpenBrowserOnce:return xo.OpenBrowserOnce;case wo.OpenPreview:return xo.OpenPreview;case wo.Silent:return xo.Silent;case wo.Ignore:return xo.Ignore;default:return}}async addAttributes(t,i,r){const n=this.q.inspect(ps.c).userRemoteValue;let o;!n||!yt(n)?o={}:o=ot(n),o[`${t}`]||(o[`${t}`]={});for(const a in i)o[`${t}`][a]=i[a];return this.q.updateValue(ps.c,o,r)}},t5=class extends Q{constructor(t,i,r,s,n,o,a,c,l,u){super(),this.H=t,this.I=i,this.J=r,this.L=s,this.M=n,this.N=o,this.O=a,this.P=c,this.Q=l,this.R=u,this.c=new Map,this.g=new I,this.onForwardPort=this.g.event,this.h=new I,this.onClosePort=this.h.event,this.j=new I,this.onPortName=this.j.event,this.n=new I,this.onCandidatesChanged=this.n.event,this.s=new I,this.onEnvironmentTunnelsSet=this.s.event,this.t=!1,this.u=void 0,this.y=!1,this.z=new I,this.C=new Map,this.F=new Map,this.G=[],this.U=!1,this.eb=new Date,this.configPortsAttributes=new xM(r),this.r=this.bb(),this.D(this.configPortsAttributes.onDidChangeAttributes(this.kb,this)),this.forwarded=new Map,this.f=new Map,this.H.tunnels.then(async h=>{const f=await this.getAttributes(h.map(p=>({port:p.tunnelRemotePort,host:p.tunnelRemoteHost})));for(const p of h)if(p.localAddress){const g=or(p.tunnelRemoteHost,p.tunnelRemotePort),v=Vi(this.m??new Map,p.tunnelRemoteHost,p.tunnelRemotePort);this.forwarded.set(g,{remotePort:p.tunnelRemotePort,remoteHost:p.tunnelRemoteHost,localAddress:p.localAddress,protocol:f?.get(p.tunnelRemotePort)?.protocol??Rr.Http,localUri:await this.Y(p.localAddress,f?.get(p.tunnelRemotePort)),localPort:p.tunnelLocalPort,name:f?.get(p.tunnelRemotePort)?.label,runningProcess:v?.detail,hasRunningProcess:!!v,pid:v?.pid,privacy:p.privacy,source:e5}),this.f.set(g,p)}}),this.detected=new Map,this.D(this.H.onTunnelOpened(async h=>{const f=or(h.tunnelRemoteHost,h.tunnelRemotePort);if(!Vi(this.forwarded,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Vi(this.detected,h.tunnelRemoteHost,h.tunnelRemotePort)&&!Vi(this.c,h.tunnelRemoteHost,h.tunnelRemotePort)&&h.localAddress){const p=Vi(this.m??new Map,h.tunnelRemoteHost,h.tunnelRemotePort),g=(await this.getAttributes([{port:h.tunnelRemotePort,host:h.tunnelRemoteHost}]))?.get(h.tunnelRemotePort);this.forwarded.set(f,{remoteHost:h.tunnelRemoteHost,remotePort:h.tunnelRemotePort,localAddress:h.localAddress,protocol:g?.protocol??Rr.Http,localUri:await this.Y(h.localAddress,g),localPort:h.tunnelLocalPort,name:g?.label,closeable:!0,runningProcess:p?.detail,hasRunningProcess:!!p,pid:p?.pid,privacy:h.privacy,source:e5})}await this.db(),this.W(!0),this.f.set(f,h),this.g.fire(this.forwarded.get(f))})),this.D(this.H.onTunnelClosed(h=>this.X(h,kd.Other))),this.W(!1)}S(){return this.Q.extensions.find(t=>t.activationEvents?.includes(AM))?(this.R.createKey(mK.key,!0),!0):!1}W(t){if(this.U||(t&&(this.U=!0),this.L.remoteAuthority!==void 0&&!t)||this.S())return;const r=this.D(this.Q.onDidRegisterExtensions(()=>{this.S()&&r.dispose()}))}async X(t,i){const r=or(t.host,t.port);this.forwarded.delete(r)&&(await this.db(),this.h.fire(t))}Y(t,i){if(t.startsWith("http"))return y.parse(t);const r=i?.protocol??"http";return y.parse(`${r}://${t}`)}async Z(t){const i=this.N.getWorkspace(),r=i.configuration?Xs(i.configuration.path):i.folders.length>0?Xs(i.folders[0].uri.path):void 0;if(r===void 0){this.O.debug("Could not get workspace hash for forwarded ports storage key.");return}return`${t}.${this.L.remoteAuthority}.${r}`}async $(){return this.Z(F1)}async ab(){return this.Z(KS)}async bb(){const t=this.I.get(F1,1);if(t)return this.I.remove(F1,1),await this.db(),t;const i=await this.$();if(i)return this.I.get(i,0)}async restoreForwarded(){if(this.cb(),this.J.getValue("remote.restoreForwardedPorts")){const t=await this.r;if(t&&t!==this.w){const i=JSON.parse(t)??[];this.O.trace(`ForwardedPorts: (TunnelModel) restoring ports ${i.map(r=>r.remotePort).join(", ")}`);for(const r of i){const s=Vi(this.detected,r.remoteHost,r.remotePort);r.source.source!==yn.Extension&&!s||r.source.source===yn.Extension&&s?await this.gb({remote:{host:r.remoteHost,port:r.remotePort},local:r.localPort,name:r.name,elevateIfNeeded:!0,source:r.source}):r.source.source===yn.Extension&&!s&&this.C.set(or(r.remoteHost,r.remotePort),r)}}}if(this.y=!0,this.z.fire(),!this.u){const t=await this.$();this.u=this.D(new ie),this.u.add(this.I.onDidChangeValue(0,void 0,this.u)(async i=>{i.key===t&&(this.r=Promise.resolve(this.I.get(t,0)),await this.restoreForwarded())}))}}cb(){const t=this.I.keys(0,0).filter(i=>i.startsWith(KS));for(const i of t){const r=this.I.getNumber(i,0);if(r&&r<Date.now()){this.r=Promise.resolve(void 0);const s=i.replace(KS,F1);this.I.remove(i,0),this.I.remove(s,0)}}}async db(){if(this.J.getValue("remote.restoreForwardedPorts")){const t=Array.from(this.forwarded.values()),i=t.map(o=>({remoteHost:o.remoteHost,remotePort:o.remotePort,localPort:o.localPort,name:o.name,localAddress:o.localAddress,localUri:o.localUri,protocol:o.protocol,source:o.source}));let r;t.length>0&&(r=JSON.stringify(i));const s=await this.$(),n=await this.ab();!r&&s&&n?(this.I.remove(s,0),this.I.remove(n,0)):r!==this.w&&s&&n&&(this.I.store(s,r,0,0),this.I.store(n,Date.now()+gK,0,0)),this.w=r}}async fb(t,i,r){if(!t.tunnelLocalPort||!r?.requireLocalPort||t.tunnelLocalPort===i)return;const s=new Date;if(this.eb.getTime()+pK>s.getTime())return;this.eb=s;const n=d(15788,null,i,t.tunnelRemotePort,t.tunnelLocalPort);return this.P.info(n)}async forward(t,i){return!this.y&&this.L.remoteAuthority&&await Ie.toPromise(this.z.event),this.gb(t,i)}async gb(t,i){await this.Q.activateByEvent(AM);const r=Vi(this.forwarded,t.remote.host,t.remote.port);i=i??(i!==null?(await this.getAttributes([t.remote]))?.get(t.remote.port):void 0);const s=t.local!==void 0?t.local:t.remote.port;let n;if(r)return this.ib(r,t,i);{const o=this.L.remoteAuthority,a=o?{getAddress:async()=>(await this.M.resolveAuthority(o)).authority}:void 0,c=or(t.remote.host,t.remote.port);this.c.set(c,!0),t=this.hb(c,t);const l=await this.H.openTunnel(a,t.remote.host,t.remote.port,void 0,s,t.elevateIfNeeded?t.elevateIfNeeded:i?.elevateIfNeeded,t.privacy,i?.protocol);if(typeof l=="string")n=l;else if(l&&l.localAddress){const u=Vi(this.m??new Map,t.remote.host,t.remote.port),h=l.protocol?l.protocol===Rr.Https?Rr.Https:Rr.Http:i?.protocol??Rr.Http,f={remoteHost:l.tunnelRemoteHost,remotePort:l.tunnelRemotePort,localPort:l.tunnelLocalPort,name:i?.label??t.name,closeable:!0,localAddress:l.localAddress,protocol:h,localUri:await this.Y(l.localAddress,i),runningProcess:u?.detail,hasRunningProcess:!!u,pid:u?.pid,source:t.source??e5,privacy:l.privacy};return this.forwarded.set(c,f),this.f.set(c,l),this.c.delete(c),await this.db(),await this.fb(l,s,i),this.g.fire(f),l}this.c.delete(c)}return n}hb(t,i){const r=this.C.has(t)?this.C:this.F.has(t)?this.F:void 0;if(r){const s=r.get(t);r.delete(t),s&&(i.name=s.name??i.name,i.local=("local"in s?s.local:"localPort"in s?s.localPort:void 0)??i.local,i.privacy=i.privacy)}return i}async ib(t,i,r){const s=r?.label??i.name;let n;(function(a){a[a.None=0]="None",a[a.Fire=1]="Fire",a[a.Reopen=2]="Reopen"})(n||(n={}));let o=n.None;switch(s!==t.name&&(t.name=s,o=n.Fire),(r?.protocol||t.protocol!==Rr.Http)&&r?.protocol!==t.protocol&&(i.source=t.source,o=n.Reopen),i.privacy&&t.privacy!==i.privacy&&(o=n.Reopen),o){case n.Fire:{this.g.fire();break}case n.Reopen:await this.close(t.remoteHost,t.remotePort,kd.User),await this.gb(i,r)}return Vi(this.f,i.remote.host,i.remote.port)}async name(t,i,r){const s=Vi(this.forwarded,t,i),n=or(t,i);if(s){s.name=r,await this.db(),this.j.fire({host:t,port:i});return}else this.detected.has(n)&&(this.detected.get(n).name=r,this.j.fire({host:t,port:i}))}async close(t,i,r){const s=or(t,i),n=this.forwarded.get(s);return r===kd.AutoForwardEnd&&n&&n.source.source===yn.Auto&&this.F.set(s,{local:n.localPort,name:n.name,privacy:n.privacy}),await this.H.closeTunnel(t,i),this.X({host:t,port:i},r)}address(t,i){const r=or(t,i);return(this.forwarded.get(r)||this.detected.get(r))?.localAddress}get environmentTunnelsSet(){return this.t}addEnvironmentTunnels(t){if(t)for(const i of t){const r=Vi(this.m??new Map,i.remoteAddress.host,i.remoteAddress.port),s=typeof i.localAddress=="string"?i.localAddress:or(i.localAddress.host,i.localAddress.port);this.detected.set(or(i.remoteAddress.host,i.remoteAddress.port),{remoteHost:i.remoteAddress.host,remotePort:i.remoteAddress.port,localAddress:s,protocol:Rr.Http,localUri:this.Y(s),closeable:!1,runningProcess:r?.detail,hasRunningProcess:!!r,pid:r?.pid,privacy:Rs.ConstantPrivate,source:{source:yn.Extension,description:d(15789,null)}}),this.H.setEnvironmentTunnel(i.remoteAddress.host,i.remoteAddress.port,s,Rs.ConstantPrivate,Rr.Http)}this.t=!0,this.s.fire(),this.g.fire()}setCandidateFilter(t){this.q=t}async setCandidates(t){let i=t;this.q&&(i=await this.q(t));const r=this.jb(i);this.O.trace(`ForwardedPorts: (TunnelModel) removed candidates ${Array.from(r.values()).map(s=>s.port).join(", ")}`),this.n.fire(r)}jb(t){const i=this.m??new Map,r=new Map;return this.m=r,t.forEach(s=>{const n=or(s.host,s.port);r.set(n,{host:s.host,port:s.port,detail:s.detail,pid:s.pid}),i.delete(n);const o=Vi(this.forwarded,s.host,s.port);o&&(o.runningProcess=s.detail,o.hasRunningProcess=!0,o.pid=s.pid)}),i.forEach((s,n)=>{const o=SM(n);if(!o)return;const a=Vi(this.forwarded,o.host,o.port);a&&(a.runningProcess=void 0,a.hasRunningProcess=!1,a.pid=void 0);const c=Vi(this.detected,o.host,o.port);c&&(c.runningProcess=void 0,c.hasRunningProcess=!1,c.pid=void 0)}),i}get candidates(){return this.m?Array.from(this.m.values()):[]}get candidatesOrUndefined(){return this.m?this.candidates:void 0}async kb(){const t=Array.from(this.forwarded.values()),i=await this.getAttributes(t.map(r=>({port:r.remotePort,host:r.remoteHost})),!1);if(i)for(const r of t){const s=i.get(r.remotePort);(s?.protocol||r.protocol!==Rr.Http)&&s?.protocol!==r.protocol&&await this.gb({remote:{host:r.remoteHost,port:r.remotePort},local:r.localPort,name:r.name,source:r.source},s),s&&s.label&&s.label!==r.name&&await this.name(r.remoteHost,r.remotePort,s.label)}}async getAttributes(t,i=!0){const r=new Map,s=new Map;t.forEach(l=>{const u=Vi(this.m??new Map,jh[0],l.port)??l;if(u){r.set(l.port,u);const h=vK(u)?u.pid:void 0;s.has(h)||s.set(h,[]),s.get(h)?.push(l.port)}});const n=new Map;if(t.forEach(l=>{const u=this.configPortsAttributes.getAttributes(l.port,l.host,r.get(l.port)?.detail);u&&n.set(l.port,u)}),this.G.length===0||!i)return n.size>0?n:void 0;const o=await Promise.all(this.G.flatMap(l=>Array.from(s.entries()).map(u=>{const h=u[1],f=r.get(h[0]);return l.providePortAttributes(h,f?.pid,f?.detail,Fe.None)}))),a=new Map;if(o.forEach(l=>l.forEach(u=>{u&&a.set(u.port,u)})),!n&&!a)return;const c=new Map;return t.forEach(l=>{const u=n.get(l.port),h=a.get(l.port);c.set(l.port,{elevateIfNeeded:u?.elevateIfNeeded,label:u?.label,onAutoForward:u?.onAutoForward??xM.providedActionToAction(h?.autoForwardAction),requireLocalPort:u?.requireLocalPort,protocol:u?.protocol})}),c}addAttributesProvider(t){this.G.push(t)}};__decorate([mf(1e3)],t5.prototype,"db",null),t5=__decorate([__param(0,XB),__param(1,Ua),__param(2,yi),__param(3,PA),__param(4,IW),__param(5,xf),__param(6,Se),__param(7,R3),__param(8,W6),__param(9,Bn)],t5);function wK(e){const t=e.trim().split(`
`),i=[];return t.forEach(s=>{const n=/\/proc\/(\d+)\/fd\/\d+ -> socket:\[(\d+)\]/.exec(s);n&&n.length>=3&&i.push({pid:parseInt(n[1],10),socket:parseInt(n[2],10)})}),i.reduce((s,n)=>(s[n.socket]=n,s),{})}function bK(...e){const t=[].concat(...e.map(AK));return[...new Map(t.filter(i=>i.st==="0A").map(i=>{const r=i.local_address.split(":");return{socket:parseInt(i.inode,10),ip:yK(r[0]),port:parseInt(r[1],16)}}).map(i=>[i.ip+":"+i.port,i])).values()]}function yK(e){let t="";if(e.length===8)for(let i=e.length-2;i>=0;i-=2)t+=parseInt(e.substr(i,2),16),i!==0&&(t+=".");else for(let i=0;i<e.length;i+=8){const r=e.substring(i,i+8);let s="";for(let n=8;n>=2;n-=2)s+=r.substring(n-2,n),(n===6||n===2)&&(s=parseInt(s,16).toString(16),t+=`${s}`,s="",i+n!==e.length-6&&(t+=":"))}return t}function AK(e){const t=e.trim().split(`
`),i=t.shift().trim().split(/\s+/).filter(s=>s!=="rx_queue"&&s!=="tm->when");return t.map(s=>s.trim().split(/\s+/).reduce((n,o,a)=>(n[i[a]||a]=o,n),{}))}function SK(e){return e.length>500?!1:!!e.match(/.*\.vscode-server-[a-zA-Z]+\/bin.*/)||e.indexOf("out/server-main.js")!==-1||e.indexOf("_productName=VSCode")!==-1}function EK(e){const t=e.trim().split(`
`),i=[];return t.forEach(r=>{const s=/^\d+\s+\D+\s+root\s+(\d+)\s+(\d+).+\d+\:\d+\:\d+\s+(.+)$/.exec(r);s&&s.length>=4&&i.push({pid:parseInt(s[1],10),ppid:parseInt(s[2]),cmd:s[3]})}),i}async function xK(e,t,i){const r=i.reduce((n,o)=>(n[o.pid]=o,n),{}),s=[];return e.forEach(({socket:n,ip:o,port:a})=>{const c=t[n]?t[n].pid:void 0,l=c?r[c]?.cmd:void 0;c&&l&&!SK(l)&&s.push({host:o,port:a,detail:l,pid:c})}),s}function kK(e,t,i){const r=new Map,s=EK(t);for(const n of e){const o=i.get(n.port);if(o){r.set(n.port,o);continue}const a=s.find(c=>c.cmd.includes(`${n.port}`));if(a){let c=a,l;do l=s.find(u=>u.ppid===c.pid),l&&(c=l);while(l);r.set(n.port,{host:n.ip,port:n.port,pid:c.pid,detail:c.cmd,ppid:c.ppid})}else r.set(n.port,{host:n.ip,port:n.port,ppid:Number.MAX_VALUE})}return r}var i5=class extends fm{constructor(t,i,r,s,n){super(t,i,r),this.C=i,this.F=s,this.G=n,this.w=void 0,this.y=new Map,this.z=!1,$t&&i.remote.isRemote&&i.remote.authority&&(this.a.$setRemoteTunnelService(process.pid),this.I())}async $registerCandidateFinder(t){if(t&&this.z)return;this.z=t;let i;this.w&&(i=this.w,await this.a.$onFoundNewCandidates(this.w));const r=new nj;let s=0;for(;this.z;){const n=new Date().getTime(),o=(await this.J()).filter(l=>Na(l.host)||hn(l.host));this.r.trace(`ForwardedPorts: (ExtHostTunnelService) found candidate ports ${o.map(l=>l.port).join(", ")}`);const a=new Date().getTime()-n;this.r.trace(`ForwardedPorts: (ExtHostTunnelService) candidate port scan took ${a} ms.`),s++>3&&r.update(a),(!i||JSON.stringify(i)!==JSON.stringify(o))&&(i=o,await this.a.$onFoundNewCandidates(i));const c=this.H(r.value);this.r.trace(`ForwardedPorts: (ExtHostTunnelService) next candidate port scan in ${c} ms.`),await new Promise(l=>setTimeout(()=>l(),c))}}H(t){return Math.max(t*20,2e3)}async I(){this.w=await this.J(),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) Initial candidates found: ${this.w.map(t=>t.port).join(", ")}`)}async J(){let t="",i="";try{t=await Sd.promises.readFile("/proc/net/tcp","utf8"),i=await Sd.promises.readFile("/proc/net/tcp6","utf8")}catch{}const r=bK(t,i),s=await new Promise(f=>{lM("ls -l /proc/[0-9]*/fd/[0-9]* | grep socket:",(p,g,v)=>{f(g)})}),n=wK(s),o=await nt.readdir("/proc"),a=[];for(const f of o)try{const p=Number(f),g=It(y.file("/proc"),f);if((await Sd.promises.stat(g.fsPath)).isDirectory()&&!isNaN(p)){const b=await Sd.promises.readlink(It(g,"cwd").fsPath),S=await Sd.promises.readFile(It(g,"cmdline").fsPath,"utf8");a.push({pid:p,cwd:b,cmd:S})}}catch{}const c=[],l=r.filter(f=>{const p=n[f.socket];return p||c.push(f),p}),u=xK(l,n,a);let h;if(this.r.trace(`ForwardedPorts: (ExtHostTunnelService) number of possible root ports ${c.length}`),c.length>0){const f=await new Promise(p=>{lM("ps -F -A -l | grep root",(g,v,b)=>{p(v)})});this.y=kK(c,f,this.y),h=Array.from(this.y.values()),this.r.trace(`ForwardedPorts: (ExtHostTunnelService) heuristic ports ${h.map(p=>p.port).join(", ")}`)}return u.then(f=>h?f.concat(h):f)}async L(){const t=(await this.G.getConfigProvider()).getConfiguration("remote").get("localPortHost");return!t||t==="localhost"?"127.0.0.1":"0.0.0.0"}u(t){return async i=>{const r=new bM({commit:this.C.commit,quality:this.C.quality,logService:this.r,ipcLogger:null,remoteSocketFactoryService:{_serviceBrand:void 0,async connect(n,o,a,c){const l=await t.makeConnection();return CK.connect(l,o,a,c)},register(){throw new Error("not implemented")}},addressProvider:{getAddress(){return Promise.resolve({connectTo:new J6(0),connectionToken:t.connectionToken})}},signService:this.F},await this.L(),i.remoteAddress.host||"localhost",i.remoteAddress.port,i.localAddressPort);await r.waitForReady();const s=new I;return{localAddress:SM(r.localAddress)??r.localAddress,remoteAddress:{port:r.tunnelRemotePort,host:r.tunnelRemoteHost},onDidDispose:s.event,dispose:()=>{r.dispose(),s.fire(),s.dispose()}}}}};i5=__decorate([__param(0,Ce),__param(1,Ft),__param(2,Se),__param(3,Ed),__param(4,vr)],i5);var CK=class XN extends _X{static connect(t,i,r,s){const n=new ie,o={onClose:n.add(new I),onData:n.add(new I),onEnd:n.add(new I)};n.add(t.onDidReceiveMessage(c=>o.onData.fire(W.wrap(c)))),n.add(t.onDidEnd(()=>o.onEnd.fire())),n.add(t.onDidClose(c=>o.onClose.fire({type:0,error:c,hadError:!!c})));const a=new XN(t,s,o);return a.D(n),BX(a,i,r,s,o)}constructor(t,i,r){super(i,r),this.n=t}write(t){this.n.send(t.buffer)}h(){this.n.end()}async drain(){await this.n.drain?.()}};import*as Wa from"fs";var $K=class extends rA{constructor(){super(...arguments),this.i=null}async g(e){const t=await super.g(e);if(t.scheme!==q.file)return t;if(this.b.skipWorkspaceStorageLock)return this.d.info(`Skipping acquiring lock for ${t.fsPath}.`),t;const i=t.fsPath;let r=0;do{let s;r===0?s=i:s=/[/\\]$/.test(i)?`${i.substr(0,i.length-1)}-${r}`:`${i}-${r}`,await IK(s);const n=_e(s,"vscode.lock"),o=await CM(this.d,n,!1);if(o)return this.i=o,process.on("exit",()=>{o.dispose()}),y.file(s);r++}while(r<10);return t}onWillDeactivateAll(){this.i?.setWillRelease(6e3)}};async function IK(e){try{await Wa.promises.stat(e);return}catch{}try{await Wa.promises.mkdir(e,{recursive:!0})}catch{}}var DK=1e3,kM=10*60*1e3,PK=class extends Q{constructor(e,t){super(),this.b=e,this.c=t,this.a=this.D(new ux),this.a.cancelAndSet(async()=>{const i=await r5(e,t);(!i||i.pid!==process.pid)&&(e.info(`Lock '${t}': The lock was lost unexpectedly.`),this.a.cancel());try{await Wa.promises.utimes(t,new Date,new Date)}catch(r){e.error(r),e.info(`Lock '${t}': Could not update mtime.`)}},DK)}dispose(){super.dispose();try{Wa.unlinkSync(this.c)}catch{}}async setWillRelease(e){this.b.info(`Lock '${this.c}': Marking the lockfile as scheduled to be released in ${e} ms.`);try{const t={pid:process.pid,willReleaseAt:Date.now()+e};await nt.writeFile(this.c,JSON.stringify(t),{flag:"w"})}catch(t){this.b.error(t)}}};async function CM(e,t,i){try{const s={pid:process.pid,willReleaseAt:0};await nt.writeFile(t,JSON.stringify(s),{flag:"wx"})}catch(s){e.error(s)}const r=await r5(e,t);return!r||r.pid!==process.pid?i?(e.info(`Lock '${t}': Could not acquire lock, giving up.`),null):(e.info(`Lock '${t}': Could not acquire lock, checking if the file is stale.`),MK(e,t)):(e.info(`Lock '${t}': Lock acquired.`),new PK(e,t))}async function r5(e,t){let i;try{i=await Wa.promises.readFile(t)}catch(r){return e.error(r),null}try{return JSON.parse(String(i))}catch(r){return e.error(r),null}}async function s5(e,t){let i;try{i=await Wa.promises.stat(t)}catch(r){return e.error(r),0}return i.mtime.getTime()}function TK(e){try{return process.kill(e,0),!0}catch{return!1}}async function MK(e,t){const i=await r5(e,t);if(!i)return e.info(`Lock '${t}': Could not read pid of lock holder.`),Cd(e,t);if(i.willReleaseAt){let a=i.willReleaseAt-Date.now();if(a<5e3){for(a>0?e.info(`Lock '${t}': The lockfile is scheduled to be released in ${a} ms.`):e.info(`Lock '${t}': The lockfile is scheduled to have been released.`);a>0;){if(await ri(Math.min(100,a)),await s5(e,t)===0)return Cd(e,t);a=i.willReleaseAt-Date.now()}return Cd(e,t)}}if(!TK(i.pid))return e.info(`Lock '${t}': The pid ${i.pid} appears to be gone.`),Cd(e,t);const r=await s5(e,t),s=Date.now()-r;if(s<=kM)return e.info(`Lock '${t}': The lock does not look stale, elapsed: ${s} ms, giving up.`),null;e.info(`Lock '${t}': The lock looks stale, waiting for 2s.`),await ri(2e3);const n=await s5(e,t),o=Date.now()-n;return o<=kM?(e.info(`Lock '${t}': The lock does not look stale, elapsed: ${o} ms, giving up.`),null):(e.info(`Lock '${t}': The lock looks stale even after waiting for 2s.`),Cd(e,t))}async function Cd(e,t){e.info(`Lock '${t}': Deleting a stale lock.`);try{await Wa.promises.unlink(t)}catch{}return CM(e,t,!0)}var An;(function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.Off=6]="Off"})(An||(An={}));async function NK(e,t,i,r,s){try{const n=await import("@vscode/spdlog");n.setFlushOn(An.Trace);const o=await n.createAsyncRotatingLogger(e,t,i,r);return s?o.clearFormatters():o.setPattern("%Y-%m-%d %H:%M:%S.%e [%l] %v"),o}catch(n){console.error(n)}return null}function $M(e,t,i){switch(t){case Y.Trace:e.trace(i);break;case Y.Debug:e.debug(i);break;case Y.Info:e.info(i);break;case Y.Warning:e.warn(i);break;case Y.Error:e.error(i);break;case Y.Off:break;default:throw new Error(`Invalid log level ${t}`)}}function IM(e,t){switch(t){case Y.Trace:e.setLevel(An.Trace);break;case Y.Debug:e.setLevel(An.Debug);break;case Y.Info:e.setLevel(An.Info);break;case Y.Warning:e.setLevel(An.Warning);break;case Y.Error:e.setLevel(An.Error);break;case Y.Off:e.setLevel(An.Off);break;default:throw new Error(`Invalid log level ${t}`)}}var RK=class extends k0{constructor(e,t,i,r,s){super(),this.n=[],this.setLevel(s),this.q=this.s(e,t,i,r),this.D(this.onDidChangeLogLevel(n=>{this.r&&IM(this.r,n)}))}async s(e,t,i,r){const s=i?6:1,n=30/s*k$.MB,o=await NK(e,t,n,s,r);if(o){this.r=o,IM(this.r,this.getLevel());for(const{level:a,message:c}of this.n)$M(this.r,a,c);this.n=[]}}m(e,t){this.r?$M(this.r,e,t):this.getLevel()<=e&&this.n.push({level:e,message:t})}flush(){this.r?this.u():this.q.then(()=>this.u())}dispose(){this.r?this.w():this.q.then(()=>this.w()),super.dispose()}u(){this.r&&this.r.flush()}w(){this.r&&(this.r.drop(),this.r=void 0)}},LK=class extends Um{s(e,t,i){return e.scheme===q.file?new RK(i?.name||Tt(),e.fsPath,!i?.donotRotate,!!i?.donotUseFormatters,t):super.s(e,t,i)}registerLogger(e){super.registerLogger(e),this.c.$registerLogger(e)}deregisterLogger(e){super.deregisterLogger(e),this.c.$deregisterLogger(e)}};import{homedir as OK}from"os";var FK=class extends Rm{m(){return OK()}},UK=class extends Q{constructor(e,t=[]){super(),this.a=new VU([e,...t]),this.D(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.a.onDidChangeLogLevel}setLevel(e){this.a.setLevel(e)}getLevel(){return this.a.getLevel()}trace(e,...t){this.a.trace(e,...t)}debug(e,...t){this.a.debug(e,...t)}info(e,...t){this.a.info(e,...t)}warn(e,...t){this.a.warn(e,...t)}error(e,...t){this.a.error(e,...t)}flush(){this.a.flush()}},n5=class extends UK{constructor(t,i,r){const s=r.remote.isRemote?"remoteexthost":t?"workerexthost":"exthost",n=r.remote.isRemote?d(3023,null):d(t?3024:3025,null);super(i.createLogger(s,{name:n}))}};n5=__decorate([__param(1,_n),__param(2,Ft)],n5);import{spawn as jK}from"child_process";import{readFile as zK}from"fs/promises";import{homedir as HK}from"os";function WK(e){const t=new Map,r=e.replace(/\r\n?/g,`
`).split(`
`);for(let o of r){if(o=o.trim(),!o||o.startsWith("#"))continue;const[a,c]=s(o);a&&t.set(a,c)}return t;function s(o){o.startsWith("export ")&&(o=o.substring(7).trim());const a=n(o,h=>h==="="||h===":");if(a===-1)return[null,null];const c=o.substring(0,a).trim();let l=o.substring(a+1).trim();const u=n(l,h=>h==="#");if(u!==-1&&(l=l.substring(0,u).trim()),l.length>=2){const h=l[0],f=l[l.length-1];(h==='"'&&f==='"'||h==="'"&&f==="'"||h==="`"&&f==="`")&&(l=l.substring(1,l.length-1),h==='"'&&(l=l.replace(/\\n/g,`
`).replace(/\\r/g,"\r")))}return[c,l]}function n(o,a){let c=!1,l="";for(let u=0;u<o.length;u++){const h=o[u];if(c)h===l&&o[u-1]!=="\\"&&(c=!1);else if(h==='"'||h==="'"||h==="`")c=!0,l=h;else if(a(h))return u}return-1}}import{Transform as BK}from"stream";var DM=class extends BK{constructor(e){if(super(),typeof e=="number")this.b=e,this.c=1;else{const t=Buffer.isBuffer(e)?e:Buffer.from(e);this.b=t.length===1?t[0]:t,this.c=t.length}}_transform(e,t,i){this.a?this.a=Buffer.concat([this.a,e]):this.a=e;let r=0;for(;r<this.a.length;){const s=typeof this.b=="number"?this.a.indexOf(this.b,r):wx(this.a,this.b,r);if(s===-1)break;this.push(this.a.slice(r,s+this.c)),r=s+this.c}this.a=r===this.a.length?void 0:this.a.slice(r),i()}_flush(e){this.a&&this.push(this.a),e()}},PM;(function(e){e[e.Running=0]="Running",e[e.StdinEnded=1]="StdinEnded",e[e.KilledPolite=2]="KilledPolite",e[e.KilledForceful=3]="KilledForceful"})(PM||(PM={}));var _K=class KN{static{this.a=1e4}get stopped(){return this.b!==0}constructor(t,i=KN.a){this.d=t,this.e=i,this.b=0}stop(){if(this.b===0){let t=this.e;try{this.d.stdin.end()}catch{t=1}this.b=1,this.c=new lx(()=>this.f(),t)}else this.c?.dispose(),this.g()}async f(){this.b=2,this.c=new lx(()=>this.g(),this.e),this.d.pid?ze||await A4(this.d.pid,!1).catch(()=>{this.d.kill("SIGTERM")}):this.d.kill("SIGTERM")}async g(){this.b=3,this.d.pid?await A4(this.d.pid,!0).catch(()=>{this.d.kill("SIGKILL")}):this.d.kill()}write(t){this.stopped||this.d.stdin.write(t+`
`)}dispose(){this.c?.dispose()}},VK=class extends _m{constructor(){super(...arguments),this.w=this.D(new Mo)}r(e,t,i,r){t.type===1?this.z(e,t,i):t.type===2?this.f.set(e,new qK(e,t,this.b,this.h,r)):super.r(e,t,i,r)}$stopMcp(e){const t=this.w.get(e);t?t.stop():super.$stopMcp(e)}$sendMessage(e,t){const i=this.w.get(e);i?i.write(t):super.$sendMessage(e,t)}async z(e,t,i){const r=a=>this.b.$onDidChangeState(e,{state:3,code:a.hasOwnProperty("code")?String(a.code):void 0,message:typeof a=="string"?a:a.message}),s={...process.env};if(t.envFile)try{for(const[a,c]of WK(await zK(t.envFile,"utf-8")))s[a]=c}catch(a){r(`Failed to read envFile '${t.envFile}': ${a.message}`);return}for(const[a,c]of Object.entries(t.env))s[a]=c===null?void 0:String(c);let n;try{const a=HK();let c=t.cwd?Am(t.cwd,a):i?.fsPath||a;xr(c)||(c=_e(i?i.fsPath:a,c));const{executable:l,args:u,shell:h}=await ZK(Am(t.command,a),t.args.map(f=>Am(f,a)),c,s);this.b.$onDidPublishLog(e,Y.Debug,`Server command line: ${l} ${u.join(" ")}`),n=jK(l,u,{stdio:"pipe",cwd:c,env:s,shell:h})}catch(a){r(a);return}const o=new _K(n);this.b.$onDidChangeState(e,{state:1}),n.stdout.pipe(new DM(`
`)).on("data",a=>this.b.$onDidReceiveMessage(e,a.toString())),n.stdin.on("error",r),n.stdout.on("error",r),n.stderr.pipe(new DM(`
`)).on("data",a=>this.b.$onDidPublishLog(e,Y.Warning,`[server stderr] ${a.toString().trimEnd()}`)),n.on("spawn",()=>this.b.$onDidChangeState(e,{state:2})),n.on("error",a=>{r(a)}),n.on("exit",a=>{this.w.deleteAndDispose(e),a===0||o.stopped?this.b.$onDidChangeState(e,{state:0}):this.b.$onDidChangeState(e,{state:3,message:`Process exited with code ${a}`})}),this.w.set(e,o)}},qK=class extends g8{constructor(){super(...arguments),this.U=new Pt(()=>import("undici"))}async S(e,t){const{fetch:i,Agent:r}=await this.U.value,s={...t};let n=e;const o=y.parse(e);if(o.scheme==="unix"||o.scheme==="pipe")s.dispatcher=new r({socketPath:o.path}),n=o.with({scheme:"http",authority:"localhost",path:o.fragment}).toString(!0);else return super.S(e,t);const a=await i(n,s);return{status:a.status,statusText:a.statusText,headers:a.headers,body:a.body,url:a.url,json:()=>a.json(),text:()=>a.text()}}},GK=/\.(bat|cmd)$/i,ZK=async(e,t,i,r)=>{if(process.platform!=="win32")return{executable:e,args:t,shell:!1};const s=await Vm(e,i,void 0,r);if(s&&GK.test(s)){const n=o=>o.includes(" ")?`"${o}"`:o;return{executable:n(s),args:t.map(n),shell:!0}}return{executable:e,args:t,shell:!1}};import{URL as JK}from"url";import{randomBytes as QK}from"crypto";import*as YK from"http";import{URL as XK}from"url";var KK=class{constructor(e,t,i){this.e=e,this.f=t,this.g=i,this.c=QK(16).toString("base64");const r=new Ni;this.b=r.p,this.a=YK.createServer((s,n)=>{const o=new XK(s.url,`http://${s.headers.host}`);switch(o.pathname){case"/":{const a=o.searchParams.get("code")??void 0,c=o.searchParams.get("state")??void 0,l=o.searchParams.get("error")??void 0;if(l){n.writeHead(302,{location:`/done?error=${o.searchParams.get("error_description")||l}`}),n.end(),r.error(new Error(l));break}if(!a||!c){n.writeHead(400),n.end();break}if(this.state!==c){n.writeHead(302,{location:`/done?error=${encodeURIComponent("State does not match.")}`}),n.end(),r.error(new Error("State does not match."));break}r.complete({code:a,state:c}),n.writeHead(302,{location:"/done"}),n.end();break}case"/done":this.h(n);break;default:n.writeHead(404),n.end();break}})}get state(){return this.c}get redirectUri(){if(this.d===void 0)throw new Error("Server is not started yet");return`http://127.0.0.1:${this.d}/`}h(e){const t=this.getHtml();e.writeHead(200,{"Content-Type":"text/html","Content-Length":Buffer.byteLength(t,"utf8")}),e.end(t)}start(){const e=new Ni;if(this.a.listening)throw new Error("Server is already started");const t=setTimeout(()=>{e.error(new Error("Timeout waiting for port"))},5e3);return this.a.on("listening",()=>{const i=this.a.address();if(typeof i=="string")this.d=parseInt(i);else if(i instanceof Object)this.d=i.port;else throw new Error("Unable to determine port");clearTimeout(t),e.complete()}),this.a.on("error",i=>{if("code"in i&&i.code==="EADDRINUSE"){this.e.error("Address in use, retrying with a different port..."),this.a.listen(0,"127.0.0.1");return}clearTimeout(t),e.error(new Error(`Error listening to server: ${i}`))}),this.a.on("close",()=>{e.error(new Error("Closed"))}),this.a.listen(O9,"127.0.0.1"),e.p}stop(){const e=new Ni;return this.a.listening?(this.a.close(t=>{t?e.error(t):e.complete()}),setTimeout(()=>{e.isResolved||e.error(new Error("Timeout waiting for server to close"))},5e3),e.p):(e.complete(),e.p)}waitForOAuthResponse(){return this.b}getHtml(){let e="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQABAMAAACNMzawAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAJ1BMVEUAAAD///9Qm8+ozed8tNsWer+Lvd9trNfF3u9Ck8slgsMzi8eZxeM/Qa6mAAAAAXRSTlMAQObYZgAAAAFiS0dEAf8CLd4AAAAHdElNRQfiCwYULRt0g+ZLAAAJRUlEQVR42u3SUY0CQRREUSy0hSZtBA+wfOwv4wAPYwAJSMAfAthkB6YD79HnKqikzmYjSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk6cmKhg4AAASAABAAAkAACAABIAAEgAAQAAJAAAgAAaBvBVAjtV2wfFe1ogcA+0gdFgBoe60IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAjAP/1MkWoAvBvAsUTqBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKA7gDlbFwC6AijZagAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQDM2boA0BXAqAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIATARAAAkAAvF7N1hWArgBKthoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfBrAlK0bAF0BjBoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4EQABIAAEwOtN2boB0BVAyVYDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgE8DqNm6AtAVwKgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAEwEQAAJAAPzd7xypMwDvBnAskToBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAIAAkAACAABIAAEgAAQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBKBGarsAwK5qRQ8ANGYAACAABIAAEAACQAAIAAEgAASAABAAAkDfCUCSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJC3uDtO80OSql+i8AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTA2VDIwOjQ1OjI3KzAwOjAwEjLurQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wNlQyMDo0NToyNyswMDowMGNvVhEAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAAElFTkSuQmCC')";return this.g==="Visual Studio Code"?e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS41MzQgMjU0LjI1MkMxODUuNTY2IDI1NS44MjMgMTkwLjE2NCAyNTUuNzIyIDE5NC4yMzQgMjUzLjc2NEwyNDYuOTQgMjI4LjQwM0MyNTIuNDc4IDIyNS43MzggMjU2IDIyMC4xMzIgMjU2IDIxMy45ODNWNDIuMDE4MUMyNTYgMzUuODY4OSAyNTIuNDc4IDMwLjI2MzggMjQ2Ljk0IDI3LjU5ODhMMTk0LjIzNCAyLjIzNjgxQzE4OC44OTMgLTAuMzMzMTMyIDE4Mi42NDIgMC4yOTYzNDQgMTc3Ljk1NSAzLjcwNDE4QzE3Ny4yODUgNC4xOTEgMTc2LjY0NyA0LjczNDU0IDE3Ni4wNDkgNS4zMzM1NEw3NS4xNDkgOTcuMzg2MkwzMS4xOTkyIDY0LjAyNDdDMjcuMTA3OSA2MC45MTkxIDIxLjM4NTMgNjEuMTczNSAxNy41ODU1IDY0LjYzTDMuNDg5MzYgNzcuNDUyNUMtMS4xNTg1MyA4MS42ODA1IC0xLjE2Mzg2IDg4Ljk5MjYgMy40Nzc4NSA5My4yMjc0TDQxLjU5MjYgMTI4TDMuNDc3ODUgMTYyLjc3M0MtMS4xNjM4NiAxNjcuMDA4IC0xLjE1ODUzIDE3NC4zMiAzLjQ4OTM2IDE3OC41NDhMMTcuNTg1NSAxOTEuMzdDMjEuMzg1MyAxOTQuODI3IDI3LjEwNzkgMTk1LjA4MSAzMS4xOTkyIDE5MS45NzZMNzUuMTQ5IDE1OC42MTRMMTc2LjA0OSAyNTAuNjY3QzE3Ny42NDUgMjUyLjI2NCAxNzkuNTE5IDI1My40NjcgMTgxLjUzNCAyNTQuMjUyWk0xOTIuMDM5IDY5Ljg4NTNMMTE1LjQ3OSAxMjhMMTkyLjAzOSAxODYuMTE1VjY5Ljg4NTNaIiBmaWxsPSJ3aGl0ZSIvPgo8L21hc2s+CjxnIG1hc2s9InVybCgjbWFzazApIj4KPHBhdGggZD0iTTI0Ni45NCAyNy42MzgzTDE5NC4xOTMgMi4yNDEzOEMxODguMDg4IC0wLjY5ODMwMiAxODAuNzkxIDAuNTQxNzIxIDE3NS45OTkgNS4zMzMzMkwzLjMyMzcxIDE2Mi43NzNDLTEuMzIwODIgMTY3LjAwOCAtMS4zMTU0OCAxNzQuMzIgMy4zMzUyMyAxNzguNTQ4TDE3LjQzOTkgMTkxLjM3QzIxLjI0MjEgMTk0LjgyNyAyNi45NjgyIDE5NS4wODEgMzEuMDYxOSAxOTEuOTc2TDIzOS4wMDMgMzQuMjI2OUMyNDUuOTc5IDI4LjkzNDcgMjU1Ljk5OSAzMy45MTAzIDI1NS45OTkgNDIuNjY2N1Y0Mi4wNTQzQzI1NS45OTkgMzUuOTA3OCAyNTIuNDc4IDMwLjMwNDcgMjQ2Ljk0IDI3LjYzODNaIiBmaWxsPSIjMDA2NUE5Ii8+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIwX2QpIj4KPHBhdGggZD0iTTI0Ni45NCAyMjguMzYyTDE5NC4xOTMgMjUzLjc1OUMxODguMDg4IDI1Ni42OTggMTgwLjc5MSAyNTUuNDU4IDE3NS45OTkgMjUwLjY2N0wzLjMyMzcxIDkzLjIyNzJDLTEuMzIwODIgODguOTkyNSAtMS4zMTU0OCA4MS42ODAyIDMuMzM1MjMgNzcuNDUyM0wxNy40Mzk5IDY0LjYyOThDMjEuMjQyMSA2MS4xNzMzIDI2Ljk2ODIgNjAuOTE4OCAzMS4wNjE5IDY0LjAyNDVMMjM5LjAwMyAyMjEuNzczQzI0NS45NzkgMjI3LjA2NSAyNTUuOTk5IDIyMi4wOSAyNTUuOTk5IDIxMy4zMzNWMjEzLjk0NkMyNTUuOTk5IDIyMC4wOTIgMjUyLjQ3OCAyMjUuNjk1IDI0Ni45NCAyMjguMzYyWiIgZmlsbD0iIzAwN0FDQyIvPgo8L2c+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIxX2QpIj4KPHBhdGggZD0iTTE5NC4xOTYgMjUzLjc2M0MxODguMDg5IDI1Ni43IDE4MC43OTIgMjU1LjQ1OSAxNzYgMjUwLjY2N0MxODEuOTA0IDI1Ni41NzEgMTkyIDI1Mi4zODkgMTkyIDI0NC4wMzlWMTEuOTYwNkMxOTIgMy42MTA1NyAxODEuOTA0IC0wLjU3MTE3NSAxNzYgNS4zMzMyMUMxODAuNzkyIDAuNTQxMTY2IDE4OC4wODkgLTAuNzAwNjA3IDE5NC4xOTYgMi4yMzY0OEwyNDYuOTM0IDI3LjU5ODVDMjUyLjQ3NiAzMC4yNjM1IDI1NiAzNS44Njg2IDI1NiA0Mi4wMTc4VjIxMy45ODNDMjU2IDIyMC4xMzIgMjUyLjQ3NiAyMjUuNzM3IDI0Ni45MzQgMjI4LjQwMkwxOTQuMTk2IDI1My43NjNaIiBmaWxsPSIjMUY5Q0YwIi8+CjwvZz4KPGcgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm92ZXJsYXkiIG9wYWNpdHk9IjAuMjUiPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE4MS4zNzggMjU0LjI1MkMxODUuNDEgMjU1LjgyMiAxOTAuMDA4IDI1NS43MjIgMTk0LjA3NyAyNTMuNzY0TDI0Ni43ODMgMjI4LjQwMkMyNTIuMzIyIDIyNS43MzcgMjU1Ljg0NCAyMjAuMTMyIDI1NS44NDQgMjEzLjk4M1Y0Mi4wMTc5QzI1NS44NDQgMzUuODY4NyAyNTIuMzIyIDMwLjI2MzYgMjQ2Ljc4NCAyNy41OTg2TDE5NC4wNzcgMi4yMzY2NUMxODguNzM3IC0wLjMzMzI5OSAxODIuNDg2IDAuMjk2MTc3IDE3Ny43OTggMy43MDQwMUMxNzcuMTI5IDQuMTkwODMgMTc2LjQ5MSA0LjczNDM3IDE3NS44OTIgNS4zMzMzN0w3NC45OTI3IDk3LjM4NkwzMS4wNDI5IDY0LjAyNDVDMjYuOTUxNyA2MC45MTg5IDIxLjIyOSA2MS4xNzM0IDE3LjQyOTIgNjQuNjI5OEwzLjMzMzExIDc3LjQ1MjNDLTEuMzE0NzggODEuNjgwMyAtMS4zMjAxMSA4OC45OTI1IDMuMzIxNiA5My4yMjczTDQxLjQzNjQgMTI4TDMuMzIxNiAxNjIuNzczQy0xLjMyMDExIDE2Ny4wMDggLTEuMzE0NzggMTc0LjMyIDMuMzMzMTEgMTc4LjU0OEwxNy40MjkyIDE5MS4zN0MyMS4yMjkgMTk0LjgyNyAyNi45NTE3IDE5NS4wODEgMzEuMDQyOSAxOTEuOTc2TDc0Ljk5MjcgMTU4LjYxNEwxNzUuODkyIDI1MC42NjdDMTc3LjQ4OCAyNTIuMjY0IDE3OS4zNjMgMjUzLjQ2NyAxODEuMzc4IDI1NC4yNTJaTTE5MS44ODMgNjkuODg1MUwxMTUuMzIzIDEyOEwxOTEuODgzIDE4Ni4xMTVWNjkuODg1MVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcikiLz4KPC9nPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9Ii0yMS40ODk2IiB5PSI0MC41MjI1IiB3aWR0aD0iMjk4LjgyMiIgaGVpZ2h0PSIyMzYuMTQ5IiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjxmaWx0ZXIgaWQ9ImZpbHRlcjFfZCIgeD0iMTU0LjY2NyIgeT0iLTIwLjY3MzUiIHdpZHRoPSIxMjIuNjY3IiBoZWlnaHQ9IjI5Ny4zNDciIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im92ZXJsYXkiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyIiB4MT0iMTI3Ljg0NCIgeTE9IjAuNjU5OTg4IiB4Mj0iMTI3Ljg0NCIgeTI9IjI1NS4zNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBzdG9wLWNvbG9yPSJ3aGl0ZSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K')":this.g==="Visual Studio Code - Insiders"&&(e="url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxtYXNrIGlkPSJtYXNrMCIgbWFzay10eXBlPSJhbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgo8cGF0aCBkPSJNMTc2LjA0OSAyNTAuNjY5QzE4MC44MzggMjU1LjQ1OSAxODguMTMgMjU2LjcgMTk0LjIzNCAyNTMuNzY0TDI0Ni45NCAyMjguNDE5QzI1Mi40NzggMjI1Ljc1NSAyNTYgMjIwLjE1NCAyNTYgMjE0LjAwOFY0Mi4xNDc5QzI1NiAzNi4wMDI1IDI1Mi40NzggMzAuNDAwOCAyNDYuOTQgMjcuNzM3NEwxOTQuMjM0IDIuMzkwODlDMTg4LjEzIC0wLjU0NDQxNiAxODAuODM4IDAuNjk2NjA3IDE3Ni4wNDkgNS40ODU3MkMxODEuOTUgLTAuNDE1MDYgMTkyLjAzOSAzLjc2NDEzIDE5Mi4wMzkgMTIuMTA5MVYyNDQuMDQ2QzE5Mi4wMzkgMjUyLjM5MSAxODEuOTUgMjU2LjU3IDE3Ni4wNDkgMjUwLjY2OVoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDZMMTE0LjMzIDEyOC42MzNMMTgxLjM3OSA3NS41MTE0VjE3Ljc5NEMxODEuMzc5IDEwLjg0NzcgMTczLjEyOCA3LjIwNjczIDE2Ny45OTYgMTEuODg2Mkw3NC42NTE0IDk3Ljg1MThMMzEuMTk5NCA2NC4xNDM4QzI3LjEwODEgNjEuMDM5IDIxLjM4NTEgNjEuMjk0IDE3LjU4NTMgNjQuNzQ3NkwzLjQ4OTc0IDc3LjU2MjdDLTEuMTU4NDcgODEuNzg5MyAtMS4xNjM2NyA4OS4wOTQ4IDMuNDc2NzIgOTMuMzI5MkwxNjcuOTggMjQ0LjE4NUMxNzMuMTA3IDI0OC44ODcgMTgxLjM3OSAyNDUuMjQ5IDE4MS4zNzkgMjM4LjI5MlYxODAuNjQ2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NUwzLjQ3NjcyIDE2Mi44MjhDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTdMMzYuNjkzNyAxMzQuMTk1WiIgZmlsbD0id2hpdGUiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swKSI+CjxwYXRoIGQ9Ik0xNjcuOTk2IDExLjg4NTdDMTczLjEyOCA3LjIwNjI3IDE4MS4zNzkgMTAuODQ3MyAxODEuMzc5IDE3Ljc5MzZWNzUuNTEwOUwxMDQuOTM4IDEzNi4wNzNMNjUuNTc0MiAxMDYuMjExTDE2Ny45OTYgMTEuODg1N1oiIGZpbGw9IiMwMDlBN0MiLz4KPHBhdGggZD0iTTM2LjY5MzcgMTM0LjE5NEwzLjQ3NjcyIDE2Mi44MjdDLTEuMTYzNjcgMTY3LjA2MiAtMS4xNTg0NyAxNzQuMzcgMy40ODk3NCAxNzguNTk0TDE3LjU4NTMgMTkxLjQwOUMyMS4zODUxIDE5NC44NjMgMjcuMTA4MSAxOTUuMTE4IDMxLjE5OTQgMTkyLjAxM0w2OS40NDcyIDE2NC4wNTZMMzYuNjkzNyAxMzQuMTk0WiIgZmlsbD0iIzAwOUE3QyIvPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMF9kKSI+CjxwYXRoIGQ9Ik0xODEuMzc5IDE4MC42NDVMMzEuMTk5NCA2NC4xNDI3QzI3LjEwODEgNjEuMDM3OSAyMS4zODUxIDYxLjI5MjkgMTcuNTg1MyA2NC43NDY1TDMuNDg5NzQgNzcuNTYxNkMtMS4xNTg0NyA4MS43ODgyIC0xLjE2MzY3IDg5LjA5MzcgMy40NzY3MiA5My4zMjgxTDE2Ny45NzIgMjQ0LjE3NkMxNzMuMTAyIDI0OC44ODEgMTgxLjM3OSAyNDUuMjQxIDE4MS4zNzkgMjM4LjI4VjE4MC42NDVaIiBmaWxsPSIjMDBCMjk0Ii8+CjwvZz4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjFfZCkiPgo8cGF0aCBkPSJNMTk0LjIzMyAyNTMuNzY2QzE4OC4xMyAyNTYuNzAxIDE4MC44MzcgMjU1LjQ2IDE3Ni4wNDggMjUwLjY3MUMxODEuOTQ5IDI1Ni41NzEgMTkyLjAzOSAyNTIuMzkyIDE5Mi4wMzkgMjQ0LjA0N1YxMi4xMTAzQzE5Mi4wMzkgMy43NjUzNSAxODEuOTQ5IC0wLjQxMzgzOSAxNzYuMDQ4IDUuNDg2OTRDMTgwLjgzNyAwLjY5NzgyNCAxODguMTI5IC0wLjU0MzE5MSAxOTQuMjMzIDIuMzkyMUwyNDYuOTM5IDI3LjczODZDMjUyLjQ3OCAzMC40MDIgMjU2IDM2LjAwMzcgMjU2IDQyLjE0OTFWMjE0LjAwOUMyNTYgMjIwLjE1NSAyNTIuNDc4IDIyNS43NTcgMjQ2LjkzOSAyMjguNDJMMTk0LjIzMyAyNTMuNzY2WiIgZmlsbD0iIzI0QkZBNSIvPgo8L2c+CjwvZz4KPGRlZnM+CjxmaWx0ZXIgaWQ9ImZpbHRlcjBfZCIgeD0iLTIxLjMzMzMiIHk9IjQwLjY0MTMiIHdpZHRoPSIyMjQuMDQ1IiBoZWlnaHQ9IjIyNi45ODgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz4KPGZlT2Zmc2V0Lz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTAuNjY2NyIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4xNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8ZmlsdGVyIGlkPSJmaWx0ZXIxX2QiIHg9IjE1NC43MTUiIHk9Ii0yMC41MTY5IiB3aWR0aD0iMTIyLjYxOCIgaGVpZ2h0PSIyOTcuMTkxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIi8+CjxmZU9mZnNldC8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEwLjY2NjciLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMjUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJvdmVybGF5IiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3ciIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjwvZGVmcz4KPC9zdmc+Cg==')"),`<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>GitHub Authentication - Sign In</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		html {
			height: 100%;
		}

		body {
			box-sizing: border-box;
			min-height: 100%;
			margin: 0;
			padding: 15px 30px;
			display: flex;
			flex-direction: column;
			color: white;
			font-family: "Segoe UI","Helvetica Neue","Helvetica",Arial,sans-serif;
			background-color: #2C2C32;
		}

		.branding {
			background-image: ${e};
			background-size: 24px;
			background-repeat: no-repeat;
			background-position: left center;
			padding-left: 36px;
			font-size: 20px;
			letter-spacing: -0.04rem;
			font-weight: 400;
			color: white;
			text-decoration: none;
		}

		.message-container {
			flex-grow: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 30px;
		}

		.message {
			font-weight: 300;
			font-size: 1.4rem;
		}

		body.error .message {
			display: none;
		}

		body.error .error-message {
			display: block;
		}

		.error-message {
			display: none;
			font-weight: 300;
			font-size: 1.3rem;
		}

		.error-text {
			color: red;
			font-size: 1rem;
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Light"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/light/latest.svg#web") format("svg");
			font-weight: 200
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semilight"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff2") format("woff2"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semilight/latest.svg#web") format("svg");
			font-weight: 300
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/normal/latest.svg#web") format("svg");
			font-weight: 400
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Semibold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/semibold/latest.svg#web") format("svg");
			font-weight: 600
		}

		@font-face {
			font-family: 'Segoe UI';
			src: url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.eot?#iefix") format("embedded-opentype");
			src: local("Segoe UI Bold"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff2") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.woff") format("woff"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.ttf") format("truetype"),url("https://c.s-microsoft.com/static/fonts/segoe-ui/west-european/bold/latest.svg#web") format("svg");
			font-weight: 700
		}
	</style>
</head>

<body>
	<a class="branding" href="https://code.visualstudio.com/">
		${this.g}
	</a>
	<div class="message-container">
		<div class="message">
			Sign-in successful! Returning to ${this.g}...
			<br><br>
			If you're not redirected automatically, <a href="${this.f.toString(!0)}" style="color: #85CEFF;">click here</a> or close this page.
		</div>
		<div class="error-message">
			An error occurred while signing in:
			<div class="error-text"></div>
		</div>
	</div>
	<script>
		const search = window.location.search;
		const error = (/[?&^]error=([^&]+)/.exec(search) || [])[1];
		if (error) {
			document.querySelector('.error-text')
				.textContent = decodeURIComponent(error);
			document.querySelector('body')
				.classList.add('error');
		} else {
			// Redirect to the app URI after a 1-second delay to allow page to load
			setTimeout(function() {
				window.location.href = '${this.f.toString(!0)}';
			}, 1000);
		}
	</script>
</body>
</html>`}},eee=class extends ym{constructor(e,t,i,r,s,n,o,a,c,l,u,h,f){super(e,t,i,r,s,n,o,a,c,l,u,h,f),!i.remote.isRemote&&a.authorization_endpoint&&this.g.unshift({label:d(3048,null),handler:(p,g,v)=>this.B(p,g,v)}),a.device_authorization_endpoint&&this.g.push({label:d(3049,null),handler:(p,g,v)=>this.C(p,g,v)})}async B(e,t,i){if(!this.p.authorization_endpoint)throw new Error("Authorization Endpoint required");if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");const r=this.v(64),s=await this.w(r),n=this.v(32),o=y.parse(`${this.m.environment.appUriScheme}://dynamicauthprovider/${this.authorizationServer.authority}/redirect?nonce=${n}`);let a;try{a=await this.l.createAppUri(o)}catch(f){throw new Error(`Failed to create external URI: ${f}`)}const c=new JK(this.p.authorization_endpoint);c.searchParams.append("client_id",this.r),c.searchParams.append("response_type","code"),c.searchParams.append("code_challenge",s),c.searchParams.append("code_challenge_method","S256");const l=e.join(" ");l&&c.searchParams.append("scope",l),this.q?.resource&&c.searchParams.append("resource",this.q.resource);const u=new KK(this.h,a,this.m.environment.appName);try{await u.start()}catch(f){throw new Error(`Failed to start loopback server: ${f}`)}c.searchParams.set("redirect_uri",u.redirectUri),c.searchParams.set("state",u.state);const h=u.waitForOAuthResponse();this.o.$waitForUriHandler(a);try{if(this.h.info(`Opening authorization URL for scopes: ${l}`),this.h.trace(`Authorization URL: ${c.toString()}`),!await this.k.openUri(c.toString(),{}))throw new dt;t.report({message:d(3050,null)});let p;try{p=(await cf(h,i)).code}catch(v){throw Ti(v)?(this.h.info("Authorization code request was cancelled by the user."),v):(this.h.error(`Failed to receive authorization code: ${v}`),new Error(`Failed to receive authorization code: ${v}`))}return this.h.info(`Authorization code received for scopes: ${l}`),await this.y(p,r,u.redirectUri)}finally{setTimeout(()=>{u.stop()},5e3)}}async C(e,t,i){if(!this.p.token_endpoint)throw new Error("Token endpoint not available in server metadata");if(!this.p.device_authorization_endpoint)throw new Error("Device authorization endpoint not available in server metadata");const r=this.p.device_authorization_endpoint,s=e.join(" ");this.h.info(`Starting device code flow for scopes: ${s}`);const n=new URLSearchParams;n.append("client_id",this.r),s&&n.append("scope",s),this.q?.resource&&n.append("resource",this.q.resource);let o;try{o=await fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:n.toString()})}catch(h){throw this.h.error(`Failed to request device code: ${h}`),new Error(`Failed to request device code: ${h}`)}if(!o.ok){const h=await o.text();throw new Error(`Device code request failed: ${o.status} ${o.statusText} - ${h}`)}const a=await o.json();if(!C_(a))throw this.h.error("Invalid device code response received from server"),new Error("Invalid device code response received from server");if(this.h.info(`Device code received: ${a.user_code}`),!await this.o.$showDeviceCodeModal(a.user_code,a.verification_uri))throw new dt;t.report({message:d(3051,null,a.verification_uri,a.user_code)});const l=(a.interval||5)*1e3,u=Date.now()+a.expires_in*1e3;for(;Date.now()<u;){if(i.isCancellationRequested)throw new dt;if(await new Promise(f=>setTimeout(f,l)),i.isCancellationRequested)throw new dt;const h=new URLSearchParams;h.append("grant_type","urn:ietf:params:oauth:grant-type:device_code"),h.append("device_code",a.device_code),h.append("client_id",this.r),this.q?.resource&&h.append("resource",this.q.resource);try{const f=await fetch(this.p.token_endpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:h.toString()});if(f.ok){const p=await f.json();if(!gA(p))throw this.h.error("Invalid token response received from server"),new Error("Invalid token response received from server");return this.h.info(`Device code flow completed successfully for scopes: ${s}`),p}else{let p;try{p=await f.json()}catch(g){throw this.h.error(`Failed to parse error response: ${g}`),new Error(`Token request failed with status ${f.status}: ${f.statusText}`)}if(p.error==="authorization_pending")continue;if(p.error==="slow_down"){await new Promise(g=>setTimeout(g,l));continue}else throw p.error==="expired_token"?new Error("Device code expired. Please try again."):p.error==="access_denied"?new dt:p.error==="invalid_client"?(this.h.warn(`Client ID (${this.r}) was invalid, generated a new one.`),await this.A(),new Error("Client ID was invalid, generated a new one. Please try again.")):new Error(`Token request failed: ${p.error_description||p.error||"Unknown error"}`)}}catch(f){throw Ti(f)?f:new Error(`Error polling for token: ${f}`)}}throw new Error("Device code flow timed out. Please try again.")}},tee=class extends SA{constructor(e,t,i,r,s,n,o){super(e,t,i,r,s,n,o),this.c=eee}};De(fn,HX,0),De(_n,LK,1),De(Se,new As(n5,[!1],!0)),De(Ed,k8,1),De(iA,$K,0),De(pm,new As(aA,[!1],!0)),De(AA,tee,0),De(l4,C4,0),De(d4,M4,0),De(o4,S4,0),De(dn,y4,0),De(dm,i5,0),De(Oa,FK,0),De(Bm,VK,0);import{createRequire as iee}from"node:module";var TM=iee(import.meta.url);if(process.env.VSCODE_DEV){const e=process.listeners("warning");process.removeAllListeners("warning"),process.on("warning",t=>{if(t.code==="ExperimentalWarning"||t.name==="ExperimentalWarning"||t.name==="DeprecationWarning"){console.debug(t);return}e[0](t)})}(function(){for(let t=0;t<process.execArgv.length;t++)process.execArgv[t]==="--inspect-port=0"&&(process.execArgv.splice(t,1),t--)})();var $d=(0,$R.default)(process.argv.slice(2),{boolean:["transformURIs","skipWorkspaceStorageLock","supportGlobalNavigator"],string:["useHostProxy"]});(function(){const e=TM("module"),t=e._load;e._load=function(i){if(i==="natives")throw new Error('Either the extension or an NPM dependency is using the [unsupported "natives" node module](https://go.microsoft.com/fwlink/?linkid=871887).');return t.apply(this,arguments)}})();var U1=process.exit.bind(process),ree=process.on.bind(process);function see(e){process.exit=function(t){if(e)U1(t);else{const i=new Error("An extension called process.exit() and this was prevented.");console.warn(i.stack)}},process.crash=function(){const t=new Error("An extension called process.crash() and this was prevented.");console.warn(t.stack)},process.env.ELECTRON_RUN_AS_NODE="1",process.on=function(t,i){if(t==="uncaughtException"){const r=i;i=function(...s){try{return r.apply(void 0,s)}catch{}}}ree(t,i)}}$d.supportGlobalNavigator||Object.defineProperty(globalThis,"navigator",{get:()=>{Hd(new hv("navigator is now a global in nodejs, please see https://aka.ms/vscode-extensions/navigator for additional info on this error."))}});var Us=function(e){U1()};function nee(e,t){const i=process.env[e];if(typeof i!="string"||i.trim().length===0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} not set, using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const r=Number(i);if(!isFinite(r)||r<0)return console.log(`[reconnection-grace-time] Extension host: env var ${e} invalid value '${i}', using default: ${t}ms (${Math.floor(t/1e3)}s)`),t;const s=Math.floor(r),n=s>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s;return console.log(`[reconnection-grace-time] Extension host: read ${e}=${i}ms (${Math.floor(n/1e3)}s)`),n}function oee(){const e=mV(process.env);if(e.type===3)return new Promise((t,i)=>{const r=s=>{const n=s[0],o=new Vo;n.on("message",a=>o.fire(W.wrap(a.data))),n.on("close",()=>{Us("renderer closed the MessagePort")}),n.start(),t({onMessage:o.event,send:a=>n.postMessage(a.buffer)})};process.parentPort.on("message",s=>r(s.ports))});if(e.type===2)return new Promise((t,i)=>{let r=null;const s=setTimeout(()=>{Us("VSCODE_EXTHOST_IPC_SOCKET timeout")},6e4),n=nee("VSCODE_RECONNECTION_GRACE_TIME",108e5),o=n>0?Math.min(3e5,n):0,a=new hx(()=>Us("renderer disconnected for too long (1)"),n),c=new hx(()=>Us("renderer disconnected for too long (2)"),o);process.on("message",(u,h)=>{if(u&&u.type==="VSCODE_EXTHOST_IPC_SOCKET"){h.setNoDelay(!0);const f=W.wrap(Buffer.from(u.initialDataChunk,"base64"));let p;if(u.skipWebSocketFrames)p=new uu(h,"extHost-socket");else{const g=W.wrap(Buffer.from(u.inflateBytes,"base64"));p=new tF(new uu(h,"extHost-socket"),u.permessageDeflate,g,!1)}r?(a.cancel(),c.cancel(),r.beginAcceptReconnection(p,f),r.endAcceptReconnection(),r.sendResume()):(clearTimeout(s),r=new r0({socket:p,initialChunk:f}),r.sendResume(),r.onDidDispose(()=>Us("renderer disconnected")),t(r),r.onSocketClose(()=>{a.schedule()}))}if(u&&u.type==="VSCODE_EXTHOST_IPC_REDUCE_GRACE_TIME"){if(c.isScheduled())return;a.isScheduled()&&c.schedule()}});const l={type:"VSCODE_EXTHOST_IPC_READY"};process.send?.(l)});{const t=e.pipeName;return new Promise((i,r)=>{const s=IR.createConnection(t,()=>{s.removeListener("error",r);const n=new r0({socket:new uu(s,"extHost-renderer")});n.sendResume(),i(n)});s.once("error",r),s.on("close",()=>{Us("renderer closed the socket")})})}}async function aee(){const e=await oee();return new class{constructor(){this.a=new Vo,this.onMessage=this.a.event,this.b=!1,this.d=e.onMessage(t=>{u_(t,2)?(this.b=!0,this.d.dispose(),Us("received terminate message from renderer")):this.a.fire(t)})}send(t){this.b||e.send(t)}async drain(){if(e.drain)return e.drain()}}}function cee(e){return new Promise(t=>{const i=e.onMessage(r=>{i.dispose();const s=JSON.parse(r.toString()),n=s.commit,o=bi.commit;if(n&&o&&n!==o&&U1(55),s.parentPid){let a=0;setInterval(function(){try{process.kill(s.parentPid,0),a=0}catch(l){l&&l.code==="EPERM"?(a++,a>=3&&Us(`parent process ${s.parentPid} does not exist anymore (3 x EPERM): ${l.message} (code: ${l.code}) (errno: ${l.errno})`)):Us(`parent process ${s.parentPid} does not exist anymore: ${l.message} (code: ${l.code}) (errno: ${l.errno})`)}},1e3);let c;try{c=TM("native-watchdog"),c.start(s.parentPid)}catch(l){lt(l)}}e.send(A9(0)),t({protocol:e,initData:s})});e.send(A9(1))})}async function lee(){const e=[];process.on("unhandledRejection",(a,c)=>{e.push(c),setTimeout(()=>{const l=e.indexOf(c);l>=0&&c.catch(u=>{e.splice(l,1),Ti(u)||(console.warn(`rejected promise not handled within 1 second: ${u}`),u&&u.stack&&console.warn(`stack trace: ${u.stack}`),a&&lt(a))})},1e3)}),process.on("rejectionHandled",a=>{const c=e.indexOf(a);c>=0&&e.splice(c,1)}),process.on("uncaughtException",function(a){TR(a)||lt(a)}),Ot("code/extHost/willConnectToRenderer");const t=await aee();Ot("code/extHost/didConnectToRenderer");const i=await cee(t);Ot("code/extHost/didWaitForInitData");const{initData:r}=i;see(!!r.environment.extensionTestsLocationURI),r.environment.useHostProxy=$d.useHostProxy!==void 0?$d.useHostProxy!=="false":void 0,r.environment.skipWorkspaceStorageLock=ee($d.skipWorkspaceStorageLock,!1);const s=new class{constructor(){this.pid=process.pid}exit(c){U1(c)}fsExists(c){return nt.exists(c)}fsRealpath(c){return nt.realpath(c)}};let n=null;r.remote.authority&&$d.transformURIs&&(n=pV(r.remote.authority));const o=new dV(i.protocol,r,s,n);Us=a=>o.terminate(a)}lee().catch(e=>console.log(e));

//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/994fd12f8d3a5aa16f17d42c041e5809167e845a/core/vs/workbench/api/node/extensionHostProcess.js.map
